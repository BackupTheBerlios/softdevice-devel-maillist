From stefan at lucke.in-berlin.de  Sat Oct  1 10:35:35 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 1 Oct 2005 10:35:35 +0200
Subject: [Softdevice-devel] A-V sync problems with directfb on
In-Reply-To: <57089.144.32.128.75.1128016411.squirrel@webmail.projectmeerkat.co.uk>
References: <1127384905.27018.27.camel@laser2.york.ac.uk> <433BB277.8010706@e-dition.fr> <57089.144.32.128.75.1128016411.squirrel@webmail.projectmeerkat.co.uk>
Message-ID: <200510011035.35200.stefan@lucke.in-berlin.de>

On Donnerstag, 29. September 2005 19:53, Laz wrote:
> > Stefan Lucke a ?crit :

> 
> My current feeling is that it is a timing problem somewhere: there is the
> frame time determined from two WaitForSync calls (not quite worked out
> what this is used for: is this used for timing the Flip calls?).

It is used to decide if we should sleep, in case decoded frame arrives
a bit to early. No sleep is required in case delay time is less 
displayTime for one frame.

> 
> > I don't even know how Mark can report proper field, except by counting
> > each and every frame out from the CLE266, and making sure the TV encoder
> > starts with the right field upon setup. Any frame miss will lead to the
> > wrong field identification, until the next frame miss...
> 
> I think his patch to viafb does make it keep count of the number of fields!

So I guess, once locked, it is either always wrong or correct.

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Sat Oct  1 10:40:24 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 1 Oct 2005 10:40:24 +0200
Subject: Epia sound oddity (WAS: Re: [Softdevice-devel] A-V sync problems with directfb on)
In-Reply-To: <433CFFA5.6030604@e-dition.fr>
References: <200509292059.44899.stefan@lucke.in-berlin.de> <433CFFA5.6030604@e-dition.fr>
Message-ID: <200510011040.24914.stefan@lucke.in-berlin.de>

On Freitag, 30. September 2005 11:04, Nicolas Huillard wrote:
> Stefan Lucke a ?crit :
> > Thank you very much, but this did not work for me either. But it 
> > brought me to the idea, that it must be a real wired thing.
> > And it is really brain dead.
> > 
> > So now I can control master volume, without ac97_quirk specified, by the
> > headphone control. That could be changed by ac97_quirk=1. But with
> > this quirk set, there was an error message that conlrol.9 is missing.
> > 
> > The total brain dead think is: I have to connect the speakers to the
> > upper, blue colored connector (usually line in /or 6ch rear out) and
> > unmute control "Alternate Level to Surround Out"
> 
> I don't know enough about Alsa to be of very much help, but :
> 
> nhuillard at vdr:nhuillard$ dpkg -l '*alsa*' | grep '^ii'
> ii  alsa-base      1.0.7-2        ALSA driver configuration files

Thanks, I think gentoo is on alsa 1.0.9. Perhaps thats the difference.
As I get sound now, I can live with that as is.

*  media-sound/alsa-driver
      Latest version available: 1.0.9b
      Latest version installed: 1.0.9b
      Size of downloaded files: 1,972 kB
      Homepage:    http://www.alsa-project.org/
      Description: Advanced Linux Sound Architecture kernel modules
      License:     GPL-2 LGPL-2.1

-- 
Stefan Lucke



From peter at legio.mine.nu  Sat Oct  1 22:40:21 2005
From: peter at legio.mine.nu (Peter Andersson)
Date: Sat, 1 Oct 2005 22:40:21 +0200 (CEST)
Subject: [Softdevice-devel] softdevice 0.1.3 no alsa audio
Message-ID: <44720.192.168.1.241.1128199221.squirrel@192.168.1.241>

Hi,
I'm trying to get audio output via softdevice without any luck.
I launch softdevice with these options: -P'softdevice -ao alsa:hw:0,0 -vo
xv:'.
I have verified that the settings are correct by using mplayer with the
setting -ao alsa:device=hw=0,0.
I have also played a couple of recordings made by vdr just to make sure
that they include sound.
I'm using fedora core 3, softdevice 0.1.3 and kernel 2.6.13.2 with
included alsa and dvb modules.

Does anyone have any tips they could give me?

Thanks

/Peter



From stefan at lucke.in-berlin.de  Sun Oct  2 00:13:06 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 2 Oct 2005 00:13:06 +0200
Subject: [Softdevice-devel] softdevice 0.1.3 no alsa audio
In-Reply-To: <44720.192.168.1.241.1128199221.squirrel@192.168.1.241>
References: <44720.192.168.1.241.1128199221.squirrel@192.168.1.241>
Message-ID: <200510020013.06926.stefan@lucke.in-berlin.de>

On Samstag, 1. Oktober 2005 22:40, Peter Andersson wrote:
> Hi,
> I'm trying to get audio output via softdevice without any luck.
> I launch softdevice with these options: -P'softdevice -ao alsa:hw:0,0 -vo
> xv:'.
> I have verified that the settings are correct by using mplayer with the
> setting -ao alsa:device=hw=0,0.

Usually I don't need to specify an alsa device name, as the default
name "default" works well. Just checked both variants and they both work.

-P'softdevice -ao alsa:hw:0,0 -vo xv:'
Oct  2 00:02:23 jarada vdr[6673]: [softdevice-audio] Opening alsa device hw:0,0
Oct  2 00:02:23 jarada vdr[6673]: [softdevice-audio] Device opened! Ready to play

-P'softdevice -ao alsa:default -vo xv:'
Oct  2 00:02:43 jarada vdr[6686]: [softdevice-audio] Opening alsa device default
Oct  2 00:02:43 jarada vdr[6686]: [softdevice-audio] Device opened! Ready to play

Are there error messages ? Usually we don't start if we cannot open alsa device.

> I have also played a couple of recordings made by vdr just to make sure
> that they include sound.
> I'm using fedora core 3, softdevice 0.1.3 and kernel 2.6.13.2 with
> included alsa and dvb modules.

Is master volume unmuted and set to non zero value ?
We adjust volume via PCM volume (not master volume).


-- 
Stefan Lucke



From peter at legio.mine.nu  Sun Oct  2 01:44:15 2005
From: peter at legio.mine.nu (Peter Andersson)
Date: Sun, 2 Oct 2005 01:44:15 +0200 (CEST)
Subject: [Softdevice-devel] softdevice 0.1.3 no alsa audio
In-Reply-To: <200510020013.06926.stefan@lucke.in-berlin.de>
References: <44720.192.168.1.241.1128199221.squirrel@192.168.1.241>
    <200510020013.06926.stefan@lucke.in-berlin.de>
Message-ID: <59870.192.168.1.241.1128210255.squirrel@192.168.1.241>

Thanks for the quick reply!

> Are there error messages ? Usually we don't start if we cannot open alsa
> device.

These are the outputs from softdevice when i ran it with these flags:
-P'softdevice -ao alsa:default -vo dummy:'

Everything looks ok to me,

[softdevice]   argv [1] = -ao
[softdevice] using alsa device default
[setup-softdevice] alsa ac3Mode set to: 0
[setup-softdevice] A/V Offset set to (0)
[softdevice] Initializing Audio Out
[softdevice] Audio out seems to be OK
[softdevice] A/V devices initialized, now initializing MPEG2 Decoder

I tried to use mplayer while running vdr and softdevice. Mplayer didn't
start playing until i shut down vdr. So the softdevice plugin is doing
something with the soundcard.

> Is master volume unmuted and set to non zero value ?
> We adjust volume via PCM volume (not master volume).

Yep, i have cranked the volume to the maximum and unmuted all channels. I
have checked this with both with a gtk app and with alsamixer. Mplayer
uses the pcm volume control too and i can verify that it is working by
playing music and changing the pcm volume.

Any other ideas?

/Peter

> On Samstag, 1. Oktober 2005 22:40, Peter Andersson wrote:
>> Hi,
>> I'm trying to get audio output via softdevice without any luck.
>> I launch softdevice with these options: -P'softdevice -ao alsa:hw:0,0
>> -vo
>> xv:'.
>> I have verified that the settings are correct by using mplayer with the
>> setting -ao alsa:device=hw=0,0.
>
> Usually I don't need to specify an alsa device name, as the default
> name "default" works well. Just checked both variants and they both work.
>
> -P'softdevice -ao alsa:hw:0,0 -vo xv:'
> Oct  2 00:02:23 jarada vdr[6673]: [softdevice-audio] Opening alsa device
> hw:0,0
> Oct  2 00:02:23 jarada vdr[6673]: [softdevice-audio] Device opened! Ready
> to play
>
> -P'softdevice -ao alsa:default -vo xv:'
> Oct  2 00:02:43 jarada vdr[6686]: [softdevice-audio] Opening alsa device
> default
> Oct  2 00:02:43 jarada vdr[6686]: [softdevice-audio] Device opened! Ready
> to play
>
> Are there error messages ? Usually we don't start if we cannot open alsa
> device.
>
>> I have also played a couple of recordings made by vdr just to make sure
>> that they include sound.
>> I'm using fedora core 3, softdevice 0.1.3 and kernel 2.6.13.2 with
>> included alsa and dvb modules.
>
> Is master volume unmuted and set to non zero value ?
> We adjust volume via PCM volume (not master volume).
>
>
> --
> Stefan Lucke
>
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
>




From heikki.satomaa at gmail.com  Sun Oct  2 02:49:37 2005
From: heikki.satomaa at gmail.com (Heikki Satomaa)
Date: Sun, 2 Oct 2005 03:49:37 +0300
Subject: [Softdevice-devel] StretchBlit problem
Message-ID: <000f01c5c6eb$2d6e3a60$4f26dc50@F49a>

Hi,
I'm trying to use softdevice+directfb with my projector with it's native 
resolution 960x540. Graphics card is a Matrox G550. 4:3 is perfect(without 
StretchBlit), but with 16:9 the picture is very ugly. Setting StretchBlit on 
from the menus fixes this, but then all the black areas in the picture get 
transparent showing some garbage.

The picture showing in the background through the transparent areas seems to 
be the picture which was on the screen while setting StretchBlit on. So if I 
select a scrambled channel (black only) and set StretchBlit on from there, 
everything seems to be ok. Is there a way to fix this? I have newest cvs 
versions of everything dealing with softdevice and directfb and my kernel is 
2.6.13.2. 



From stefan at lucke.in-berlin.de  Sun Oct  2 11:05:49 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 2 Oct 2005 11:05:49 +0200
Subject: [Softdevice-devel] StretchBlit problem
In-Reply-To: <000f01c5c6eb$2d6e3a60$4f26dc50@F49a>
References: <000f01c5c6eb$2d6e3a60$4f26dc50@F49a>
Message-ID: <200510021105.49138.stefan@lucke.in-berlin.de>

On Sonntag, 2. Oktober 2005 02:49, Heikki Satomaa wrote:
> Hi,
> I'm trying to use softdevice+directfb with my projector with it's native 
> resolution 960x540. Graphics card is a Matrox G550. 4:3 is perfect(without 
> StretchBlit), but with 16:9 the picture is very ugly.

What does ugly mean in that case ? With height 540 it is for now not
possible to show PAL resolution height without downscaling. So you
see probably the downscaling effects.

> Setting StretchBlit on 
> from the menus fixes this, but then all the black areas in the picture get 
> transparent showing some garbage.

When working with my monitor I see that too, when switching from
color key OSD to stretchblit mode. Usually a restart with stretchblit
enabled, fixes that.

> 
> The picture showing in the background through the transparent areas seems to 
> be the picture which was on the screen while setting StretchBlit on. So if I 
> select a scrambled channel (black only) and set StretchBlit on from there, 
> everything seems to be ok. Is there a way to fix this? I have newest cvs 
> versions of everything dealing with softdevice and directfb and my kernel is 
> 2.6.13.2. 


-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Sun Oct  2 11:12:40 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 2 Oct 2005 11:12:40 +0200
Subject: [Softdevice-devel] softdevice 0.1.3 no alsa audio
In-Reply-To: <59870.192.168.1.241.1128210255.squirrel@192.168.1.241>
References: <44720.192.168.1.241.1128199221.squirrel@192.168.1.241> <200510020013.06926.stefan@lucke.in-berlin.de> <59870.192.168.1.241.1128210255.squirrel@192.168.1.241>
Message-ID: <200510021112.40833.stefan@lucke.in-berlin.de>

On Sonntag, 2. Oktober 2005 01:44, Peter Andersson wrote:
> Thanks for the quick reply!
> 
> > Are there error messages ? Usually we don't start if we cannot open alsa
> > device.
> 
> These are the outputs from softdevice when i ran it with these flags:
> -P'softdevice -ao alsa:default -vo dummy:'
> 
> Everything looks ok to me,
> 
> [softdevice]   argv [1] = -ao
> [softdevice] using alsa device default
> [setup-softdevice] alsa ac3Mode set to: 0
> [setup-softdevice] A/V Offset set to (0)
> [softdevice] Initializing Audio Out
> [softdevice] Audio out seems to be OK
> [softdevice] A/V devices initialized, now initializing MPEG2 Decoder
> 
> I tried to use mplayer while running vdr and softdevice. Mplayer didn't
> start playing until i shut down vdr. So the softdevice plugin is doing
> something with the soundcard.
> 
> > Is master volume unmuted and set to non zero value ?
> > We adjust volume via PCM volume (not master volume).
> 
> Yep, i have cranked the volume to the maximum and unmuted all channels. I
> have checked this with both with a gtk app and with alsamixer. Mplayer
> uses the pcm volume control too and i can verify that it is working by
> playing music and changing the pcm volume.
> 
> Any other ideas?

Only that vdr volume itself, is set to zero. You can check that with
alsamixer. If PCM volume is zero after vdr start, you have to increase
vdr's volume. The initial startup volume is in setup.conf, entry:
CurrentVolume = 100

If that still does not help, whats your sound card/chip ?

-- 
Stefan Lucke



From heikki.satomaa at gmail.com  Sun Oct  2 14:34:44 2005
From: heikki.satomaa at gmail.com (Heikki Satomaa)
Date: Sun, 2 Oct 2005 15:34:44 +0300
Subject: [Softdevice-devel] StretchBlit problem
References: <000f01c5c6eb$2d6e3a60$4f26dc50@F49a> <200510021105.49138.stefan@lucke.in-berlin.de>
Message-ID: <000e01c5c74d$ac860280$4f26dc50@F49a>

> What does ugly mean in that case ? With height 540 it is for now not
> possible to show PAL resolution height without downscaling. So you
> see probably the downscaling effects.

Yes I think those are downscaling effects. The left border of the picture is 
waving and so are all the other straight lines.

> When working with my monitor I see that too, when switching from
> color key OSD to stretchblit mode. Usually a restart with stretchblit
> enabled, fixes that.

Well now I've discovered a new problem :). If I start vdr with StretchBlit 
set to on, the screen stays black. I have to edit setup.conf file and set 
StretchBlit to 0 to see picture again. Is this ok:

[dfb] Supported video Modes are: 960x540 at 16
[dfb] Enumerating display Layers
Layer 0 FBDev Primary Layer  Type: graphics
  Caps: brightness contrast saturation surface
Layer 1 Matrox Backend Scaler  Type: graphics picture video
  Caps: brightness contrast deinterlacing dst_colorkey screen_location 
surface
[surface capabilities] scrSurface: primary videoonly double-buffered 
flipping
[dfb] width = 960, height = 540
[dfb] got fmt = 0x00418c04 bpp = 32
[dfb] Using this layer for OSD: (FBDev Primary Layer - [736x540])
[surface capabilities] osdSurface: videoonly double-buffered flipping
[surface capabilities] videoSurface: videoonly
[dfb] Configuring CooperativeLevel for Overlay
[dfb] Configuring CooperativeLevel for OSD
[dfb] Using this layer for OSD: FBDev Primary Layer
[dfb] Using this layer for Video out: Matrox Backend Scaler
[dfb] Display frame time is 16732 microseconds
[dfb] (re)configuring Videolayer to 720 x 576 (720x576)
[dfb] creating new surface
[surface capabilities] videoSurface: videoonly
[dfb] (re)configured 0x00200806



From peter at legio.mine.nu  Sun Oct  2 14:35:27 2005
From: peter at legio.mine.nu (Peter Andersson)
Date: Sun, 2 Oct 2005 14:35:27 +0200 (CEST)
Subject: [Softdevice-devel] softdevice 0.1.3 no alsa audio
In-Reply-To: <200510021112.40833.stefan@lucke.in-berlin.de>
References: <44720.192.168.1.241.1128199221.squirrel@192.168.1.241>
    <200510020013.06926.stefan@lucke.in-berlin.de>
    <59870.192.168.1.241.1128210255.squirrel@192.168.1.241>
    <200510021112.40833.stefan@lucke.in-berlin.de>
Message-ID: <1429.192.168.1.252.1128256527.squirrel@192.168.1.252>

Hi again, thanks for bearing with me on this.

> Only that vdr volume itself, is set to zero. You can check that with
> alsamixer. If PCM volume is zero after vdr start, you have to increase
> vdr's volume. The initial startup volume is in setup.conf, entry:
> CurrentVolume = 100
>

I have checked this allready, and i have seen no problems with the volume
controls, everything is unmuted and cranked up to the maximum.

Vdr outputs "status: volume=100 mute=0"
On startup, that is correct right?

> If that still does not help, whats your sound card/chip ?

According to alsamixer its:
Card: VIA 82C686A/B rev50 (confirmed to be 82C686B via motherboard manual)
Chip: VIA Technologies VIA1612A

I can also say that alsamixer has way more options than my soundcard has.
I am using a integrated soundcard which basically has one input and one
output. Alsa mixer has about 20 options for surround etc.

Hope this might give you some clues.

/Peter


> On Sonntag, 2. Oktober 2005 01:44, Peter Andersson wrote:
>> Thanks for the quick reply!
>>
>> > Are there error messages ? Usually we don't start if we cannot open
>> alsa
>> > device.
>>
>> These are the outputs from softdevice when i ran it with these flags:
>> -P'softdevice -ao alsa:default -vo dummy:'
>>
>> Everything looks ok to me,
>>
>> [softdevice]   argv [1] = -ao
>> [softdevice] using alsa device default
>> [setup-softdevice] alsa ac3Mode set to: 0
>> [setup-softdevice] A/V Offset set to (0)
>> [softdevice] Initializing Audio Out
>> [softdevice] Audio out seems to be OK
>> [softdevice] A/V devices initialized, now initializing MPEG2 Decoder
>>
>> I tried to use mplayer while running vdr and softdevice. Mplayer didn't
>> start playing until i shut down vdr. So the softdevice plugin is doing
>> something with the soundcard.
>>
>> > Is master volume unmuted and set to non zero value ?
>> > We adjust volume via PCM volume (not master volume).
>>
>> Yep, i have cranked the volume to the maximum and unmuted all channels.
>> I
>> have checked this with both with a gtk app and with alsamixer. Mplayer
>> uses the pcm volume control too and i can verify that it is working by
>> playing music and changing the pcm volume.
>>
>> Any other ideas?
>
> Only that vdr volume itself, is set to zero. You can check that with
> alsamixer. If PCM volume is zero after vdr start, you have to increase
> vdr's volume. The initial startup volume is in setup.conf, entry:
> CurrentVolume = 100
>
> If that still does not help, whats your sound card/chip ?
>
> --
> Stefan Lucke
>
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
>




From heikki.satomaa at gmail.com  Mon Oct  3 18:32:15 2005
From: heikki.satomaa at gmail.com (Heikki Satomaa)
Date: Mon, 3 Oct 2005 19:32:15 +0300
Subject: [Softdevice-devel] StretchBlit problem
Message-ID: <000301c5c838$0582d030$4f26dc50@F49a>

Ok I've tested some new things now. If the resolution is set with fbset to 
960x540 and I start vdr with stretchBlit on, there is no picture. But if the 
resolution is set smaller than 960x540 before starting vdr, there is a 
picture but it has a black box on it in the upper left corner. The box seems 
to be the size of the console resolution. If I set a resolution larger than 
960x540 in the console, everything seems to be fine. 



From torgeir at pobox.com  Wed Oct  5 01:42:55 2005
From: torgeir at pobox.com (Torgeir Veimo)
Date: Wed, 05 Oct 2005 09:42:55 +1000
Subject: [Softdevice-devel] epia recommendations
Message-ID: <1128469375.31274.9.camel@localhost.localdomain>

Can some recommend which via epia version is best for normal tv output
configuration for use with vdr and softdevice? 

-- 
Torgeir Veimo <torgeir at pobox.com>



From nhuillard at e-dition.fr  Wed Oct  5 11:57:23 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Wed, 05 Oct 2005 11:57:23 +0200
Subject: [Softdevice-devel] epia recommendations
In-Reply-To: <1128469375.31274.9.camel@localhost.localdomain>
References: <1128469375.31274.9.camel@localhost.localdomain>
Message-ID: <4343A383.6050309@e-dition.fr>

Torgeir Veimo a ?crit :
> Can some recommend which via epia version is best for normal tv output
> configuration for use with vdr and softdevice? 

With the latest kernel frame-buffer patches and DirectFB, you can choose
either VT1622 or VT1622a/VT1623 based boards, ie. EPIA M or EPIA MII
Tested on EPIA M 10k (me) and EPIA MII 12k (I think, Mark Adams).
Works great with TV-out in 720x576 resolution, with DirectFB output
method. See directfb-users ML archives for recent threads and patches
about this.

VT1622 and VT1622a can also output RGB signals, but they do not seem to
be all wired on M and MII boards (lacks the B signal line : only 3 out
of 4 DACs are actually used : CVBS, Y, C). A bit of soldering on the
VT162x package on the board could bring top-quality TV-out with
simultaneous VGA-out...
Those who solder RAM chips on FF cards could also do that ?

-- 
NH


From stefan at lucke.in-berlin.de  Wed Oct  5 13:04:09 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Wed, 5 Oct 2005 13:04:09 +0200
Subject: [Softdevice-devel] epia recommendations
In-Reply-To: <4343A383.6050309@e-dition.fr>
References: <1128469375.31274.9.camel@localhost.localdomain> <4343A383.6050309@e-dition.fr>
Message-ID: <200510051304.09678.stefan@lucke.in-berlin.de>

On Mittwoch, 5. Oktober 2005 11:57, Nicolas Huillard wrote:
> Torgeir Veimo a ?crit :
> > Can some recommend which via epia version is best for normal tv output
> > configuration for use with vdr and softdevice? 
> 
> With the latest kernel frame-buffer patches and DirectFB, you can choose
> either VT1622 or VT1622a/VT1623 based boards, ie. EPIA M or EPIA MII
> Tested on EPIA M 10k (me) and EPIA MII 12k (I think, Mark Adams).
> Works great with TV-out in 720x576 resolution, with DirectFB output
> method. See directfb-users ML archives for recent threads and patches
> about this.
> 
> VT1622 and VT1622a can also output RGB signals, but they do not seem to
> be all wired on M and MII boards (lacks the B signal line : only 3 out
> of 4 DACs are actually used : CVBS, Y, C). A bit of soldering on the
> VT162x package on the board could bring top-quality TV-out with
> simultaneous VGA-out...

Do you have some more info but that soldering project ?

The epia MS bords have component out Y,  Cb, Cr. 
http://www.viaembedded.com/product/epia_ms_spec.jsp?motherboardId=281

Do you think it is possible to setup VGA out to resolution independant
of TV out ? When I load module viafb with option tvon=1, my LCD
goes dark.

> Those who solder RAM chips on FF cards could also do that ?


-- 
Stefan Lucke



From nhuillard at e-dition.fr  Wed Oct  5 13:29:44 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Wed, 05 Oct 2005 13:29:44 +0200
Subject: [Softdevice-devel] epia recommendations
In-Reply-To: <200510051304.09678.stefan@lucke.in-berlin.de>
References: <1128469375.31274.9.camel@localhost.localdomain> <4343A383.6050309@e-dition.fr> <200510051304.09678.stefan@lucke.in-berlin.de>
Message-ID: <4343B928.9020407@e-dition.fr>

Stefan Lucke a ?crit :
> On Mittwoch, 5. Oktober 2005 11:57, Nicolas Huillard wrote:
> 
>>Torgeir Veimo a ?crit :
>>
>>>Can some recommend which via epia version is best for normal tv output
>>>configuration for use with vdr and softdevice? 
>>
>>With the latest kernel frame-buffer patches and DirectFB, you can choose
>>either VT1622 or VT1622a/VT1623 based boards, ie. EPIA M or EPIA MII
>>Tested on EPIA M 10k (me) and EPIA MII 12k (I think, Mark Adams).
>>Works great with TV-out in 720x576 resolution, with DirectFB output
>>method. See directfb-users ML archives for recent threads and patches
>>about this.
>>
>>VT1622 and VT1622a can also output RGB signals, but they do not seem to
>>be all wired on M and MII boards (lacks the B signal line : only 3 out
>>of 4 DACs are actually used : CVBS, Y, C). A bit of soldering on the
>>VT162x package on the board could bring top-quality TV-out with
>>simultaneous VGA-out...
> 
> Do you have some more info but that soldering project ?

VT162x has 4 DACs (named A / B / C / D), that can be configured to
output either :
* conf 0 : CVBS / C / Y / CVBS
* conf 1 : Y / C / Y / C
* conf 2 : CVBS / R / G / B
* conf 3 : CVBS / Pr / Y / Pb

On the EPIA M (maybe also MII), conf 0 is used, with either DACs A + C +
B or C + B + D wired to the S-video + Composite connectors.
Complete RGB output is conf 2, with sync on DAC A (CVBS). There seems to
be no wire from DAC D, pin 16.
Thus one have to solder pin 16 to some external components (detailed in
the spec sheet), then to a connector. Using a combination of S-video +
composite + that soldering, you could have full RGB output from the VT1622.
Since the CLE266 / CN400 is configured to output 50Hz non-interlaced VGA
signal when using PAL TV-out, you have a full VGA + TV-out output.
The alternative is to build a VGA to RGB circuit (very simple), but it
requires VGA registers tweaking to output 50Hz interlaced output. This
renders the VT162x unusable, and you won't have a proper image from
boot, until VGA registers are setup (at frame-buffer driver init).

> The epia MS bords have component out Y,  Cb, Cr. 
> http://www.viaembedded.com/product/epia_ms_spec.jsp?motherboardId=281

The spec says "1 Connector for S-Video/Composite/SCART/Component (YPbPr)".
This means all 4 DACs have output circuit, and you can have full RGB
connection to a standard TV.
This board is then a great choice !

> Do you think it is possible to setup VGA out to resolution independant
> of TV out ? When I load module viafb with option tvon=1, my LCD
> goes dark.

I think the CLE266 is in fact dual-head, but wiring in the M series
doesn't use second head. I'm not exactly sure about that.
One thing I'm sure is that activating TV-out modifies VGA out signal, to
fit VT162x expectations. The same image goes to both displays.
Your LCD won't accept 720x576 50Hz non-interlaced signal ?
Maybe the for LVDS/TTL/DVI on-board connector (MS series) is connected
to the second head.

-- 
NH


From laz at club-burniston.co.uk  Wed Oct  5 14:40:14 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Wed, 05 Oct 2005 13:40:14 +0100
Subject: [Softdevice-devel] epia recommendations
In-Reply-To: <4343A383.6050309@e-dition.fr>
References: <1128469375.31274.9.camel@localhost.localdomain>
	 <4343A383.6050309@e-dition.fr>
Message-ID: <1128516014.9697.5.camel@laser2.york.ac.uk>

On Wed, 2005-10-05 at 11:57 +0200, Nicolas Huillard wrote:
> Torgeir Veimo a ?crit :
> > Can some recommend which via epia version is best for normal tv output
> > configuration for use with vdr and softdevice? 
> 
> With the latest kernel frame-buffer patches and DirectFB, you can choose
> either VT1622 or VT1622a/VT1623 based boards, ie. EPIA M or EPIA MII
> Tested on EPIA M 10k (me) and EPIA MII 12k (I think, Mark Adams).
> Works great with TV-out in 720x576 resolution, with DirectFB output
> method. See directfb-users ML archives for recent threads and patches
> about this.

I'm using an Epia MII with DirectFB with Mark Adams's patches for field
sync. Unfortunately, this gives stuttering sound and the frame sync
'just doesn't look right', if you know what I mean. It works great with
df_xine, though, so there is something that softdevice doesn't like
about the changes. I'm trying to find out what...

> VT1622 and VT1622a can also output RGB signals, but they do not seem to
> be all wired on M and MII boards (lacks the B signal line : only 3 out
> of 4 DACs are actually used : CVBS, Y, C). A bit of soldering on the
> VT162x package on the board could bring top-quality TV-out with
> simultaneous VGA-out...

Would be nice but probably beyond the scope of nearly everyone!! As
someone else said, the MS boards do have these on a jumper, I think it
is.

Cheers,

Laz



From stefan at lucke.in-berlin.de  Wed Oct  5 20:55:04 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Wed, 5 Oct 2005 20:55:04 +0200
Subject: [Softdevice-devel] [PATCH] undefined variables in configure script
In-Reply-To: <20050930182940.GA339687@kosh.hut.fi>
References: <20050930182940.GA339687@kosh.hut.fi>
Message-ID: <200510052055.04985.stefan@lucke.in-berlin.de>

On Freitag, 30. September 2005 20:29, Marko M?kel? wrote:
> Hi,
> 
> I wondered how my DirectFB key-repeat patch suddenly didn't work.
> The configure test worked, albeit with a warning, but config.h
> somehow defined HAVE_DIEF_REPEAT 0.  It turned out to be a
> misspelled variable.
> 

DIEF_REPEAT part is in cvs. There is one change I don't understand:

-PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/lib/pkgconfig/
+: ${PKG_CONFIG_PATH=/usr/local/lib/pkgconfig/}
+: ${CFLAGS=""}

My intension was to add PKG_CONFIG_PATH with /usr/local/lib/pkgconfig/
Do you run into problems, when PKG_CONFIG_PATH is not set ?

In between I added a small check for existance of an X11 enviroment.

> To prevent this in the future, I suggest that the script
> defines "set -eu" to report undefined variables.
> 
> 	Marko
> 

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Wed Oct  5 20:55:11 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Wed, 5 Oct 2005 20:55:11 +0200
Subject: [Softdevice-devel] Some AC3 progress.
Message-ID: <200510052055.11734.stefan@lucke.in-berlin.de>

Hi,

are there some people around with ac3 equipment ?

Basic support for that is working. It is based on ac3 code of ac3play-0.5.2f.
So if this as3play version works for you, than there might be a chance that 
ac3 enabled softdevice may work too.
I checked ac3out by:
ac3play -C -D 0,1 AC3_FILE_NAME

I've todo some cleanups before posting a patch.
As expected there are now some new A/V sync issues when operating
in ac3 mode. Most annoying for me is, that I  cannot switch back to normal
sound mode, as I get some segfaults :-( .

-- 
Stefan Lucke



From nhuillard at e-dition.fr  Wed Oct  5 22:11:40 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Wed, 05 Oct 2005 22:11:40 +0200
Subject: [Softdevice-devel] Some AC3 progress.
In-Reply-To: <200510052055.11734.stefan@lucke.in-berlin.de>
References: <200510052055.11734.stefan@lucke.in-berlin.de>
Message-ID: <4344337C.5030100@e-dition.fr>

Stefan Lucke a ?crit :
> Hi,
> 
> are there some people around with ac3 equipment ?

I do, and wish to test softdevice / ac3.
I can only test AC3 (DTS too, BTW) with DVDs, because TV in France have 
no more than stereo.

> Basic support for that is working. It is based on ac3 code of ac3play-0.5.2f.
> So if this as3play version works for you, than there might be a chance that 
> ac3 enabled softdevice may work too.
> I checked ac3out by:
> ac3play -C -D 0,1 AC3_FILE_NAME
> 
> I've todo some cleanups before posting a patch.
> As expected there are now some new A/V sync issues when operating
> in ac3 mode. Most annoying for me is, that I  cannot switch back to normal
> sound mode, as I get some segfaults :-( .

I'm in the process of upgrading from vdr 1.3.23 / softdevice 0.1.1 to 
vdr 1.3.33 / softdevice 0.1.3, and currently get crashes / sync 
problems. I'm hopefuly about to solve them with the help of patches 
posted to the list (viafb-related).

I'll test you patch ASAP, when posted.

-- 
NH


From marko.makela at hut.fi  Thu Oct  6 04:02:28 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Thu, 6 Oct 2005 05:02:28 +0300
Subject: [Softdevice-devel] [PATCH] undefined variables in configure script
In-Reply-To: <200510052055.04985.stefan@lucke.in-berlin.de>
References: <20050930182940.GA339687@kosh.hut.fi> <200510052055.04985.stefan@lucke.in-berlin.de>
Message-ID: <20051006020228.GA3151@localhost.localdomain>

On Wed, Oct 05, 2005 at 08:55:04PM +0200, Stefan Lucke wrote:
> DIEF_REPEAT part is in cvs. There is one change I don't understand:
> 
> -PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/lib/pkgconfig/
> +: ${PKG_CONFIG_PATH=/usr/local/lib/pkgconfig/}
> +: ${CFLAGS=""}

These are needed to avoid referencing unset variables.  My shell scripts
usually have the shell builtin command "set -eu" in the beginning.
Quoting bash(1):

-e	Exit immediately if a simple command (see SHELL GRAMMAR above)
        exits with a non-zero status.
-u	Treat unset variables as an error when performing parameter
	expansion.  If expansion is attempted on  an unset variable,
	the shell prints an error message, and, if not interactive,
	exits with a non-zero status.

The : is the builtin null command, i.e., a command that does nothing:

: [arguments]
	No  effect; the command does nothing beyond expanding arguments
	and performing any specified redirections.  A zero exit code
	is returned.

These builtin commands "set" and ":" should work on all Bourne shell
derivatives (if softdevice ever needs to be compiled on something else
than GNU/Linux).

The ${VAR=value} is the same as $VAR, except that $VAR will be
initialized to 'value' if it is unset.  In bash(1), see section
EXPANSION, subsection Parameter Expansion:

       In each of the cases below, word is subject to tilde expansion, parame-
       ter  expansion,  command  substitution, and arithmetic expansion.  When
       not performing substring expansion, bash tests for a parameter that  is
       unset  or null; omitting the colon results in a test only for a parame-
       ter that is unset.

       ${parameter:-word}
              Use Default Values.  If parameter is unset or null,  the  expan-
              sion  of word is substituted.  Otherwise, the value of parameter
              is substituted.
       ${parameter:=word}
              Assign Default Values.  If  parameter  is  unset  or  null,  the
              expansion of word is assigned to parameter.  The value of param-
              eter is then substituted.   Positional  parameters  and  special
              parameters may not be assigned to in this way.

Here is an example that you can try in an interactive shell:

$ set -u
$ i=1
$ echo i="'$i'" j="'$j'"
bash: j: unbound variable
$ echo i="'${i=2}'" j="'${j=3}'"
i='1' j='3'
$ j=
$ echo i="'${i=2}'" j="'${j=3}'"
i='1' j=''

> My intension was to add PKG_CONFIG_PATH with /usr/local/lib/pkgconfig/
> Do you run into problems, when PKG_CONFIG_PATH is not set ?

The "set -eu" I added will complain about unset variables.  I think it's
best to enable at least "set -u", because it would have caught the error
in the DIEF_REPEAT test.  If the "set -u" is omitted, unset variables
will expand to the empty string without warning.

	Marko


From stefan at lucke.in-berlin.de  Thu Oct  6 13:21:32 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 6 Oct 2005 13:21:32 +0200
Subject: [Softdevice-devel] [PATCH] ac3 passthrough 1st try
Message-ID: <200510061321.32405.stefan@lucke.in-berlin.de>

Hi,

attached is a patch which enables AC3 passthrough.
There are no longer segfaults when switching between ac3 out and
pcm out. Sync is ok for me. Code definitly needs some cleanup.

For specifying alsa device names on command line, I had to use '#' as 
a separator instead of ':'.
For me that specification works:
-P "softdevice -ao alsa:pcm=default#ac3=hw:0,1# -vo dfb:mgatv"

So you need to know which alsa name is for ac3 out. My "default"
device name is equivilant to "hw:0,0".

To get ac3 out you need to:
- enable ac3 in vdr via: Menu->Setup->DVB->Use Dolby Digital (Value: Yes)
- select an AC3 stream via audio menu
- enable 5.1 mode via Menu->Softdevice->AC3 Mode (Value: 5.1 S/P-DIF)

Test and enjoy.

-- 
Stefan Lucke
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ac3-pass-01.diff.bz2
Type: application/x-bzip2
Size: 9507 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051006/b500a218/attachment.bin>

From nhuillard at e-dition.fr  Thu Oct  6 13:47:35 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 06 Oct 2005 13:47:35 +0200
Subject: [Softdevice-devel] [PATCH] ac3 passthrough 1st try
In-Reply-To: <200510061321.32405.stefan@lucke.in-berlin.de>
References: <200510061321.32405.stefan@lucke.in-berlin.de>
Message-ID: <43450ED7.7060208@e-dition.fr>

Stefan Lucke a ?crit :
> attached is a patch which enables AC3 passthrough.

Which version is this patch diffed against ?

-- 
NH


From stefan at lucke.in-berlin.de  Thu Oct  6 13:58:02 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 6 Oct 2005 13:58:02 +0200
Subject: [Softdevice-devel] [PATCH] ac3 passthrough 1st try
In-Reply-To: <43450ED7.7060208@e-dition.fr>
References: <200510061321.32405.stefan@lucke.in-berlin.de> <43450ED7.7060208@e-dition.fr>
Message-ID: <200510061358.02848.stefan@lucke.in-berlin.de>

On Donnerstag, 6. Oktober 2005 13:47, Nicolas Huillard wrote:
> Stefan Lucke a ?crit :
> > attached is a patch which enables AC3 passthrough.
> 
> Which version is this patch diffed against ?

Current CVS version (I guess)  :-) . Any problems on patching ?

-- 
Stefan Lucke



From nhuillard at e-dition.fr  Thu Oct  6 14:27:06 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 06 Oct 2005 14:27:06 +0200
Subject: [Softdevice-devel] [PATCH] ac3 passthrough 1st try
In-Reply-To: <200510061358.02848.stefan@lucke.in-berlin.de>
References: <200510061321.32405.stefan@lucke.in-berlin.de> <43450ED7.7060208@e-dition.fr> <200510061358.02848.stefan@lucke.in-berlin.de>
Message-ID: <4345181A.5020703@e-dition.fr>

Stefan Lucke a ?crit :
> On Donnerstag, 6. Oktober 2005 13:47, Nicolas Huillard wrote:
> 
>>Stefan Lucke a ?crit :
>>
>>>attached is a patch which enables AC3 passthrough.
>>
>>Which version is this patch diffed against ?
> 
> Current CVS version (I guess)  :-) . Any problems on patching ?

Yes.
Main problem regarding the huge hunk #4 in audio.c. Maybe moving the
whole code at the end of the file would help ?
I'm patching 0.1.3.
I can't stick to CVS version, because I aim my work at packaging stuff,
and I do not have much time. You happen to release this patch at the
right time for me to test.


nhuillard at vdr:vdr-plugin-softdevice-0.1.3$ bzcat ../ac3-pass-01.diff.bz2
| patch --dry-run
patching file audio.c
Hunk #1 succeeded at 16 with fuzz 2 (offset -1 lines).
Hunk #2 succeeded at 33 (offset -8 lines).
Hunk #3 succeeded at 96 with fuzz 2 (offset -9 lines).
Hunk #4 FAILED at 142.
Hunk #5 FAILED at 885.
Hunk #6 succeeded at 971 (offset -29 lines).
Hunk #7 succeeded at 992 (offset -29 lines).
Hunk #8 succeeded at 1004 (offset -29 lines).
Hunk #9 succeeded at 1016 (offset -29 lines).
2 out of 9 hunks FAILED -- saving rejects to file audio.c.rej
patching file audio.h
patching file mpeg2decoder.c
patching file setup-softdevice.c
patching file setup-softdevice.h
patching file softdevice.c
Hunk #1 succeeded at 674 (offset -4 lines).
Hunk #2 succeeded at 811 (offset -4 lines).


-- 
NH


From stefan at lucke.in-berlin.de  Thu Oct  6 14:59:53 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 6 Oct 2005 14:59:53 +0200
Subject: [Softdevice-devel] Re: DFB with Matrox G450 cable?
In-Reply-To: <20051006090226.GA31600@seneca.muc.de>
References: <20050814090720.GA8207@seneca.muc.de> <20051006090226.GA31600@seneca.muc.de>
Message-ID: <200510061459.53488.stefan@lucke.in-berlin.de>

On Donnerstag, 6. Oktober 2005 11:02, Harald Milz wrote:
> On Sun, Aug 14, 2005 at 11:07:20AM +0200, Harald Milz wrote:
> > 
> > I would like to try using softdevice with DirectFB and my Matrox G450DH.
> 
> In the meanwhile, my hardware setup changed, and I will be able to use DVI
> out to a new TV set soon. With respect to HDTV, what would be a proper
> setup and configuration, if I use a G550 w/ DVI and VGA outputs? The
> TV set has 1366x768 native resolution, so 1280x720p would be fine. What
> happens with 1920x1080i broadcasts as far as rescaling to 1280x720p? And -
> what CPU is recommended to handle this load?

I doubt that any HDTV will be available for unencrypted decoding.
For h.264 contend there are threads threads at ffmpeg devel list. I guesss
there are still some todos.

For higher resolutions, I fanless radeons would be a good choice
too, as they have much more memory onboard. I'm now using
a radeon 9200 with 256MB. Last time (some months ago) I tested this
card with DFB it was ok. Advantage is, that this card can mix pixel 
based alpha values of different layers in hardware (OSD rgba + video YV12).

jarada:~ # lspci -s 01:00.0 -n
01:00.0 Class 0300: 1002:5961 (rev 01)

jarada:~ # lspci -v -s 01:00.0
01:00.0 VGA compatible controller: ATI Technologies Inc Radeon RV280 [Radeon 9200] (rev 01) (prog-if 00 [VGA])
        Subsystem: Unknown device 17ee:2801
        Flags: bus master, 66Mhz, medium devsel, latency 32, IRQ 16
        Memory at c0000000 (32-bit, prefetchable) [size=256M]
        I/O ports at c000 [size=256]
        Memory at d5000000 (32-bit, non-prefetchable) [size=64K]
        Expansion ROM at <unassigned> [disabled] [size=128K]
        Capabilities: [58] AGP version 2.0
        Capabilities: [50] Power Management version 2

> 
> > As for AC3 out, my board is an Asus A7V8X with a VT8235 and ALC650 codec.
> > Does anybody have the proper settings for AC3 and PCM passthrough via
> > SPDIF? 
> 
> Any news here? softdevice-0.1.3 still has the ac3 passthrough code
> commented out. Anybody who had success here? Is there anything than can be
> done to help? 

Yes, test the patch :-)  posted short time after your mail.

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Thu Oct  6 15:25:15 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 6 Oct 2005 15:25:15 +0200
Subject: [Softdevice-devel] [PATCH] ac3 passthrough 1st try
In-Reply-To: <4345181A.5020703@e-dition.fr>
References: <200510061321.32405.stefan@lucke.in-berlin.de> <200510061358.02848.stefan@lucke.in-berlin.de> <4345181A.5020703@e-dition.fr>
Message-ID: <200510061525.15980.stefan@lucke.in-berlin.de>

On Donnerstag, 6. Oktober 2005 14:27, Nicolas Huillard wrote:
> Stefan Lucke a ?crit :
> > On Donnerstag, 6. Oktober 2005 13:47, Nicolas Huillard wrote:
> > 
> >>Stefan Lucke a ?crit :
> >>
> >>>attached is a patch which enables AC3 passthrough.
> >>
> >>Which version is this patch diffed against ?
> > 
> > Current CVS version (I guess)  :-) . Any problems on patching ?
> 
> Yes.
> Main problem regarding the huge hunk #4 in audio.c. Maybe moving the
> whole code at the end of the file would help ?
> I'm patching 0.1.3.
> I can't stick to CVS version, because I aim my work at packaging stuff,
> and I do not have much time. You happen to release this patch at the
> right time for me to test.
> 
> 
> nhuillard at vdr:vdr-plugin-softdevice-0.1.3$ bzcat ../ac3-pass-01.diff.bz2
> | patch --dry-run
> patching file audio.c
> Hunk #1 succeeded at 16 with fuzz 2 (offset -1 lines).
> Hunk #2 succeeded at 33 (offset -8 lines).
> Hunk #3 succeeded at 96 with fuzz 2 (offset -9 lines).
> Hunk #4 FAILED at 142.
> Hunk #5 FAILED at 885.

Ah, thats the audio debugging code, which is present past 0.1.3 .
A uncompressed diff againt v013 is about twice as much and
doesn't include configure as that was not present at that time.
Did we change so mauch since last release ? Hm, time to next one.

When it comes to "time", I guess it's easier and  faster to checkout
cvs into a separate directory, as manual resolving failed hunks.


-- 
Stefan Lucke



From nhuillard at e-dition.fr  Thu Oct  6 16:00:51 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 06 Oct 2005 16:00:51 +0200
Subject: [Softdevice-devel] Re: [directfb-users] VIA epia framerate WaitForSync()
In-Reply-To: <200509292306.49599.stefan@lucke.in-berlin.de>
References: <200509280734.03286.stefan@lucke.in-berlin.de>	<b7f6d737050929032547e3b975@mail.gmail.com>	<200509292205.16766.stefan@lucke.in-berlin.de> <200509292306.49599.stefan@lucke.in-berlin.de>
Message-ID: <43452E13.8030701@e-dition.fr>

Stefan Lucke a ?crit :
> On Donnerstag, 29. September 2005 22:05, Stefan Lucke wrote:
> 
>>On Donnerstag, 29. September 2005 12:25, Mark Adams wrote:
>>
>>>>for A/V-sync I'm measuring the frame rate of current screen with
>>>>two WaitForSync() calls. for VIA unichrome I get some strange result:
>>>>A/V sync seems to be OK (no frames dropped) when time is set hardcoded.
>>>>Without that I'll get:
>>>>
>>>>[dfb] Display frame time is 99949 microseconds
>>>>[dfb] Display frame time is 99950 microseconds
>>>
>>>OK, I think I know what's happening there.
>>>
>>>Which framebuffer driver are you using?
>>>
>>>The 'patcher2k' version of viafb (and possibly other versions too) has
>>>a bug in it.  The vblank interrupt is enabled and a handler installed
>>>but the interrupt then gets disabled again when the video mode is set
>>>up.  Thus the driver gets no interrupts at all.  The 0.1 second
>>>interval you are seeing is the wait timeout that's there to prevent a
>>>complete hang in the event that the interrupt never arrives.
>>>
>>>If you look at one of the earlier unichrome threads, you'll find a
>>>patch for that version of viafb that I posted.  It should fix this
>>>problem (as well as providing improved tv-out capability and the
>>>option of frame syncs).  If you only want to fix this bug, you should
>>>be able to find the appropriate part of the patch to apply but if not,
>>>get back to me and I'll post further details.
>>
>>If you are referring to Nicolas mail from 2005-09-06, 
>>
>>http://mail.directfb.org/pipermail/directfb-users/2005-September/000551.html
>>
>>reenabling does not do the trick. My via_fbobj.c now has the the following
>>diff compared to patcher2k.viafb_03.diff:
> 
> 
> That is/was reenabling interrupts at the wrong place :-) .
> This was in function VIAPostSetTV3Mode(). But I'm not using TV out,
> just VGA. I moved that to a place after VIAPostSetTV3Mode() gets called.
> 
> Now I get measured frame times of:
> [surface capabilities] videoSurface: videoonly double-buffered flipping
> [dfb] (re)configured 0x08100609
> [dfb] Display frame time is 16653 microseconds
> [dfb] Display frame time is 16657 microseconds
> [softdevice] Subplugin successfully opend
> 
> My diff against patcher2k patch is attached.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> --- via_fbobj.c.orig	2005-09-23 05:01:23.000000000 +0200
> +++ via_fbobj.c	2005-09-29 23:13:48.000000000 +0200
> @@ -427,6 +427,11 @@
>                  VIAPostSetTV3Mode(info,x,y,b);
>                  break;
>          }
> +
> +    /* must now re-enable vsync interrupt */
> +    outb(0x11, 0x3d4);
> +    outb(inb(0x3d5) | 0x30, 0x3d5);
> +
>      via_set_regs();
>      return 1;
>  }
> @@ -1019,6 +1024,8 @@
>      /* Turn on all Composite and S-Video output */
>      I2C_wdata(I2CPort, I2CAddrTV, 0x0E, 0);
>  
> +    /* Reset interrupt count (and hopefully get correct field parity) */
> +    par->irq_cnt = 0;
>  }
>  
>  void VIAPostSetTV3Mode(struct fb_info *info,int xres,int yres,int bpp)

I just applied the first part of the patch (since I don't mind about
field parity), and I get the following result (0.1.3) :

[dfb] Display frame time is 17668 microseconds

(was something like 99950 us before the patch, and video was a
succession of 1s fast-paced images and 1s still-image, like someone
described on the ML recently)

Since I output on PAL TV @ 50Hz, this timing seems odd (should be 20000
us, isn't it ? not 17,668 ms / 56Hz) I'm not in front of the TV so I
can't check image quality.

root at vdr:~# fbset -i

mode "720x576-50"
    # D: 28.000 MHz, H: 31.250 kHz, V: 50.000 Hz
    geometry 720 576 720 1152 32
    timings 35714 32 8 46 0 136 3
    rgba 8/16,8/8,8/0,8/24
endmode

Frame buffer device information:
    Name        : UNICHROME
    Address     : 0xe4000000
    Size        : 33288192
    Type        : PACKED PIXELS
    Visual      : TRUECOLOR
    XPanStep    : 0
    YPanStep    : 1
    YWrapStep   : 0
    LineLength  : 2880
    MMIO Address: 0xe8000000
    MMIO Size   : 16777216
    Accelerator : Unknown (77)

-- 
NH


From stefan at lucke.in-berlin.de  Thu Oct  6 16:38:05 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 6 Oct 2005 16:38:05 +0200
Subject: [Softdevice-devel] Re: [directfb-users] VIA epia framerate WaitForSync()
In-Reply-To: <43452E13.8030701@e-dition.fr>
References: <200509280734.03286.stefan@lucke.in-berlin.de> <200509292306.49599.stefan@lucke.in-berlin.de> <43452E13.8030701@e-dition.fr>
Message-ID: <200510061638.05188.stefan@lucke.in-berlin.de>

On Donnerstag, 6. Oktober 2005 16:00, Nicolas Huillard wrote:
> Stefan Lucke a ?crit :
> > On Donnerstag, 29. September 2005 22:05, Stefan Lucke wrote:
> > 
> >>On Donnerstag, 29. September 2005 12:25, Mark Adams wrote:
> >>
> >>>>for A/V-sync I'm measuring the frame rate of current screen with
> >>>>two WaitForSync() calls. for VIA unichrome I get some strange result:
> >>>>A/V sync seems to be OK (no frames dropped) when time is set hardcoded.
> >>>>Without that I'll get:
> >>>>
> >>>>[dfb] Display frame time is 99949 microseconds
> >>>>[dfb] Display frame time is 99950 microseconds
> >>>
> >>>OK, I think I know what's happening there.
> >>>
> >>>Which framebuffer driver are you using?
> >>>
> >>>The 'patcher2k' version of viafb (and possibly other versions too) has
> >>>a bug in it.  The vblank interrupt is enabled and a handler installed
> >>>but the interrupt then gets disabled again when the video mode is set
> >>>up.  Thus the driver gets no interrupts at all.  The 0.1 second
> >>>interval you are seeing is the wait timeout that's there to prevent a
> >>>complete hang in the event that the interrupt never arrives.
> >>>
> >>>If you look at one of the earlier unichrome threads, you'll find a
> >>>patch for that version of viafb that I posted.  It should fix this
> >>>problem (as well as providing improved tv-out capability and the
> >>>option of frame syncs).  If you only want to fix this bug, you should
> >>>be able to find the appropriate part of the patch to apply but if not,
> >>>get back to me and I'll post further details.
> >>
> >>If you are referring to Nicolas mail from 2005-09-06, 
> >>
> >>http://mail.directfb.org/pipermail/directfb-users/2005-September/000551.html
> >>
> >>reenabling does not do the trick. My via_fbobj.c now has the the following
> >>diff compared to patcher2k.viafb_03.diff:
> > 
> > 
> > That is/was reenabling interrupts at the wrong place :-) .
> > This was in function VIAPostSetTV3Mode(). But I'm not using TV out,
> > just VGA. I moved that to a place after VIAPostSetTV3Mode() gets called.
> > 
> > Now I get measured frame times of:
> > [surface capabilities] videoSurface: videoonly double-buffered flipping
> > [dfb] (re)configured 0x08100609
> > [dfb] Display frame time is 16653 microseconds
> > [dfb] Display frame time is 16657 microseconds
> > [softdevice] Subplugin successfully opend
> > 
> > My diff against patcher2k patch is attached.
> > 
> > 
> > 
> > ------------------------------------------------------------------------
> > 
> > --- via_fbobj.c.orig	2005-09-23 05:01:23.000000000 +0200
> > +++ via_fbobj.c	2005-09-29 23:13:48.000000000 +0200
> > @@ -427,6 +427,11 @@
> >                  VIAPostSetTV3Mode(info,x,y,b);
> >                  break;
> >          }
> > +
> > +    /* must now re-enable vsync interrupt */
> > +    outb(0x11, 0x3d4);
> > +    outb(inb(0x3d5) | 0x30, 0x3d5);
> > +
> >      via_set_regs();
> >      return 1;
> >  }
> > @@ -1019,6 +1024,8 @@
> >      /* Turn on all Composite and S-Video output */
> >      I2C_wdata(I2CPort, I2CAddrTV, 0x0E, 0);
> >  
> > +    /* Reset interrupt count (and hopefully get correct field parity) */
> > +    par->irq_cnt = 0;
> >  }
> >  
> >  void VIAPostSetTV3Mode(struct fb_info *info,int xres,int yres,int bpp)
> 
> I just applied the first part of the patch (since I don't mind about
> field parity), and I get the following result (0.1.3) :
> 
> [dfb] Display frame time is 17668 microseconds
> 
> (was something like 99950 us before the patch, and video was a
> succession of 1s fast-paced images and 1s still-image, like someone
> described on the ML recently)
> 
> Since I output on PAL TV @ 50Hz, this timing seems odd (should be 20000
> us, isn't it ? not 17,668 ms / 56Hz) I'm not in front of the TV so I
> can't check image quality.

Yes it should be 20000 or a few counts lower. Do you use Mark Adams'
unichrome-directfb.diff posted on directfb-user on 2005-09-07 11:27 ?
There is the following hunk and there is a usleep(2500):

@@ -240,21 +245,22 @@
? ? ?UcDriverData* ?ucdrv = (UcDriverData*) driver_data;
? ? ?UcOverlayData* ucovl = (UcOverlayData*) layer_data;
? ? ?DFBResult ? ?ret;
-
- ? ?if (((flags & DSFLIP_WAITFORSYNC) == DSFLIP_WAITFORSYNC) &&
- ? ? ? ?!dfb_config->pollvsync_after)
- ? ? ? ?dfb_layer_wait_vsync( layer );
+ ? ?int field_option;
+ ? ?FBDev *dfb_fbdev = dfb_system_data();
?
? ? ?dfb_surface_flip_buffers(surface, false);
?
? ? ?ucovl->field = 0;
?
+ ? ?field_option = 2;??// wait for bottom field
+ ? ?ioctl(dfb_fbdev->fd, FBIO_WAITFORVSYNC, &field_option);
+ ? ?usleep(2500);??????// make sure field has started (so update will happen on next field)
+
? ? ?ret = uc_ovl_update(ucdrv, ucovl, UC_OVL_FLIP, surface);


-- 
Stefan Lucke



From laz at club-burniston.co.uk  Thu Oct  6 16:58:34 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Thu, 06 Oct 2005 15:58:34 +0100
Subject: [Softdevice-devel] Re: [directfb-users] VIA epia framerate
	WaitForSync()
In-Reply-To: <200510061638.05188.stefan@lucke.in-berlin.de>
References: <200509280734.03286.stefan@lucke.in-berlin.de>
	 <200509292306.49599.stefan@lucke.in-berlin.de>
	 <43452E13.8030701@e-dition.fr>
	 <200510061638.05188.stefan@lucke.in-berlin.de>
Message-ID: <1128610715.16866.10.camel@laser2.york.ac.uk>

On Thu, 2005-10-06 at 16:38 +0200, Stefan Lucke wrote:
> On Donnerstag, 6. Oktober 2005 16:00, Nicolas Huillard wrote:
> > I just applied the first part of the patch (since I don't mind about
> > field parity), and I get the following result (0.1.3) :
> > 
> > [dfb] Display frame time is 17668 microseconds
> > 
> > (was something like 99950 us before the patch, and video was a
> > succession of 1s fast-paced images and 1s still-image, like someone
> > described on the ML recently)
> > 
> > Since I output on PAL TV @ 50Hz, this timing seems odd (should be 20000
> > us, isn't it ? not 17,668 ms / 56Hz) I'm not in front of the TV so I
> > can't check image quality.
> 
> Yes it should be 20000 or a few counts lower. Do you use Mark Adams'
> unichrome-directfb.diff posted on directfb-user on 2005-09-07 11:27 ?
> There is the following hunk and there is a usleep(2500):
> 
> @@ -240,21 +245,22 @@
>      UcDriverData*  ucdrv = (UcDriverData*) driver_data;
>      UcOverlayData* ucovl = (UcOverlayData*) layer_data;
>      DFBResult    ret;
> -
> -    if (((flags & DSFLIP_WAITFORSYNC) == DSFLIP_WAITFORSYNC) &&
> -        !dfb_config->pollvsync_after)
> -        dfb_layer_wait_vsync( layer );
> +    int field_option;
> +    FBDev *dfb_fbdev = dfb_system_data();
>  
>      dfb_surface_flip_buffers(surface, false);
>  
>      ucovl->field = 0;
>  
> +    field_option = 2;  // wait for bottom field
> +    ioctl(dfb_fbdev->fd, FBIO_WAITFORVSYNC, &field_option);
> +    usleep(2500);      // make sure field has started (so update will happen on next field)
> +
>      ret = uc_ovl_update(ucdrv, ucovl, UC_OVL_FLIP, surface);

I'm sure that this is the source of my problem with softdevice,
DirectFB, and Mark's patches (picture that displays a 'jerk' or dropped
frame every few seconds, i.e. not bad, but the audio stutters quite
badly, although A-V sync isn't that bad for me now).

I have yet to play about with timings properly but a quick go of
hard-coding the frame time to 20000 - 2500 didn't seem to make any
difference.

I will have a deeper look...

Cheers,

Laz



From nhuillard at e-dition.fr  Thu Oct  6 21:04:00 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 06 Oct 2005 21:04:00 +0200
Subject: [Softdevice-devel] Re: [directfb-users] VIA epia framerate WaitForSync()
In-Reply-To: <43452E13.8030701@e-dition.fr>
References: <200509280734.03286.stefan@lucke.in-berlin.de>	<b7f6d737050929032547e3b975@mail.gmail.com>	<200509292205.16766.stefan@lucke.in-berlin.de> <200509292306.49599.stefan@lucke.in-berlin.de> <43452E13.8030701@e-dition.fr>
Message-ID: <43457520.805@e-dition.fr>

Nicolas Huillard a ?crit :
> I just applied the first part of the patch (since I don't mind about
> field parity), and I get the following result (0.1.3) :
> 
> [dfb] Display frame time is 17668 microseconds
> 
> (was something like 99950 us before the patch, and video was a
> succession of 1s fast-paced images and 1s still-image, like someone
> described on the ML recently)
> 
> Since I output on PAL TV @ 50Hz, this timing seems odd (should be 20000
> us, isn't it ? not 17,668 ms / 56Hz) I'm not in front of the TV so I
> can't check image quality.

As far as I can tell after a quarter of hour watching various german 
channels and recordings, everything is good with that odd timing 
information : sound is marvelous, video is synchronous, with no drops or 
artifacts.
Remember I do not need field parity because I almost always stretch the 
image, and thus use deinterlace filter.

-- 
NH


From nhuillard at e-dition.fr  Thu Oct  6 21:07:35 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 06 Oct 2005 21:07:35 +0200
Subject: [Softdevice-devel] 0.1.3 bug : lavc can be set but nor unset
Message-ID: <434575F7.7040108@e-dition.fr>

Hello,

It seems that I can set lavc deinterlace in the menu, but can't really 
unset it : the option is shown "off", but the lavc filter still applies.
I had awful interlacing artifacts with cropmode=16/9. They disappeared 
when setting lavc, but didn't reappear when I tried to unset lavc.
I changed channels, trying to reinitialize the stream, with no avail.

-- 
NH


From nhuillard at e-dition.fr  Thu Oct  6 21:12:38 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 06 Oct 2005 21:12:38 +0200
Subject: [Softdevice-devel] 0.1.3 bug : 16/10 cropmode luma/chroma pb
Message-ID: <43457726.4000108@e-dition.fr>

Hello again,

When setting cropmode to 16/10 on a 16/9 display, the luma and chroma 
planes seem to be detached : one is a good quarter of the screen on the 
right of the other one. Maybe it's not luma/chroma, but a third of YUV, 
because the "main" image remains at the same place, and only a ghost is 
displaced to the right.
This is the only cropmode setting with that problem. I didn't try other 
display aspect ratios.

-- 
NH


From stefan at lucke.in-berlin.de  Thu Oct  6 23:04:38 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 6 Oct 2005 23:04:38 +0200
Subject: [Softdevice-devel] 0.1.3 bug : 16/10 cropmode luma/chroma pb
In-Reply-To: <43457726.4000108@e-dition.fr>
References: <43457726.4000108@e-dition.fr>
Message-ID: <200510062304.38482.stefan@lucke.in-berlin.de>

On Donnerstag, 6. Oktober 2005 21:12, Nicolas Huillard wrote:
> Hello again,
> 
> When setting cropmode to 16/10 on a 16/9 display, the luma and chroma 
> planes seem to be detached : one is a good quarter of the screen on the 
> right of the other one. Maybe it's not luma/chroma, but a third of YUV, 
> because the "main" image remains at the same place, and only a ghost is 
> displaced to the right.
> This is the only cropmode setting with that problem. I didn't try other 
> display aspect ratios.

As I could not reproduce that, I need some more information (some confirms).
a DirectFb output
b plain 0.1.3 no configure generated definition (setting of 
   HAVE_SetSourceLocation, my guess is 0)
c Are values of Crop Top/Bottom/Left/Right to non zero ?
d epia, which uses the backend scaler

-- 
Stefan Lucke



From nhuillard at e-dition.fr  Thu Oct  6 23:22:25 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 06 Oct 2005 23:22:25 +0200
Subject: [Softdevice-devel] 0.1.3 bug : 16/10 cropmode luma/chroma pb
In-Reply-To: <200510062304.38482.stefan@lucke.in-berlin.de>
References: <43457726.4000108@e-dition.fr> <200510062304.38482.stefan@lucke.in-berlin.de>
Message-ID: <43459591.3070101@e-dition.fr>

Stefan Lucke a ?crit :
> On Donnerstag, 6. Oktober 2005 21:12, Nicolas Huillard wrote:
> 
>>Hello again,
>>
>>When setting cropmode to 16/10 on a 16/9 display, the luma and chroma 
>>planes seem to be detached : one is a good quarter of the screen on the 
>>right of the other one. Maybe it's not luma/chroma, but a third of YUV, 
>>because the "main" image remains at the same place, and only a ghost is 
>>displaced to the right.
>>This is the only cropmode setting with that problem. I didn't try other 
>>display aspect ratios.
> 
> As I could not reproduce that, I need some more information (some confirms).
> a DirectFb output

Yes.
0.9.22-5sarge1

> b plain 0.1.3 no configure generated definition (setting of 
>    HAVE_SetSourceLocation, my guess is 0)

Yes, plain 0.1.3, but Debian patches that only modify the Makefile :
01_Makefile-fPIC-fix.dpatch
02_disable_unsupported_output.dpatch
03_no_sub_libs.dpatch
04_debian_ffmpeg.dpatch
06_dfb++.dpatch

nhuillard at vdr:vdr-plugin-softdevice-0.1.3$ grep HAVE_SetSourceLocation *
video-dfb.c:# define HAVE_SetSourceLocation 0

nhuillard at vdr:vdr-plugin-softdevice-0.1.3$ grep HAVE_SetSourceLocation 
debian/patches/*
(no result)

> c Are values of Crop Top/Bottom/Left/Right to non zero ?

They are all 0.

> d epia, which uses the backend scaler

EPIA M10k / CLE266 / unichrome 0.4 DFB driver.

-- 
NH


From stefan at lucke.in-berlin.de  Thu Oct  6 23:32:18 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 6 Oct 2005 23:32:18 +0200
Subject: [Softdevice-devel] [PATCH] ac3 passthrough 1st try
In-Reply-To: <4345181A.5020703@e-dition.fr>
References: <200510061321.32405.stefan@lucke.in-berlin.de> <200510061358.02848.stefan@lucke.in-berlin.de> <4345181A.5020703@e-dition.fr>
Message-ID: <200510062332.18816.stefan@lucke.in-berlin.de>

On Donnerstag, 6. Oktober 2005 14:27, Nicolas Huillard wrote:
> Stefan Lucke a ?crit :
> > On Donnerstag, 6. Oktober 2005 13:47, Nicolas Huillard wrote:
> > 
> >>Stefan Lucke a ?crit :
> >>
> >>>attached is a patch which enables AC3 passthrough.
> >>
> >>Which version is this patch diffed against ?
> > 
> > Current CVS version (I guess)  :-) . Any problems on patching ?
> 
> Yes.
> Main problem regarding the huge hunk #4 in audio.c. Maybe moving the
> whole code at the end of the file would help ?
> I'm patching 0.1.3.
> I can't stick to CVS version, because I aim my work at packaging stuff,
> and I do not have much time. You happen to release this patch at the
> right time for me to test.

No need to patch :-) . I think it's easier for people to check out cvs for
tests than check out cvs and apply patches.

Modified (moved some code into separate files) version is now in cvs.

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Fri Oct  7 00:06:03 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 7 Oct 2005 00:06:03 +0200
Subject: [Softdevice-devel] 0.1.3 bug : 16/10 cropmode luma/chroma pb
In-Reply-To: <43459591.3070101@e-dition.fr>
References: <43457726.4000108@e-dition.fr> <200510062304.38482.stefan@lucke.in-berlin.de> <43459591.3070101@e-dition.fr>
Message-ID: <200510070006.03351.stefan@lucke.in-berlin.de>

On Donnerstag, 6. Oktober 2005 23:22, Nicolas Huillard wrote:
> Stefan Lucke a ?crit :
> > On Donnerstag, 6. Oktober 2005 21:12, Nicolas Huillard wrote:
> > 
> >>Hello again,
> >>
> >>When setting cropmode to 16/10 on a 16/9 display, the luma and chroma 
> >>planes seem to be detached : one is a good quarter of the screen on the 
> >>right of the other one. Maybe it's not luma/chroma, but a third of YUV, 
> >>because the "main" image remains at the same place, and only a ghost is 
> >>displaced to the right.
> >>This is the only cropmode setting with that problem. I didn't try other 
> >>display aspect ratios.
> > 
> > As I could not reproduce that, I need some more information (some confirms).
> > a DirectFb output
> 
> Yes.
> 0.9.22-5sarge1
> 
> > b plain 0.1.3 no configure generated definition (setting of 
> >    HAVE_SetSourceLocation, my guess is 0)
> 
> Yes, plain 0.1.3, but Debian patches that only modify the Makefile :
> 01_Makefile-fPIC-fix.dpatch
> 02_disable_unsupported_output.dpatch
> 03_no_sub_libs.dpatch
> 04_debian_ffmpeg.dpatch
> 06_dfb++.dpatch
> 
> nhuillard at vdr:vdr-plugin-softdevice-0.1.3$ grep HAVE_SetSourceLocation *
> video-dfb.c:# define HAVE_SetSourceLocation 0
> 
> nhuillard at vdr:vdr-plugin-softdevice-0.1.3$ grep HAVE_SetSourceLocation 
> debian/patches/*
> (no result)

Ok I can confirm that on my epia bord. My test was done with an 5:4 LCD
VGA monitor. The color shadow picture was seen on arbitray monitor
aspect setups via softdevice OSD. But it was only present for me when
setting crop mode to 14:9. Another precondition is
"HAVE_SetSourceLocation 0". This color shown picture is not present
when video-dfb.c is compiled with "HAVE_SetSourceLocation 1".
This value is set, when configure script  detects that in direcfb source.

So try setting that by hand, or use cvs version with configure and AC3.

I guess I've to force execution of configure for next release.

-- 
Stefan Lucke



From lucianm at users.sourceforge.net  Fri Oct  7 10:56:10 2005
From: lucianm at users.sourceforge.net (Lucian Muresan)
Date: Fri, 07 Oct 2005 10:56:10 +0200
Subject: [Softdevice-devel] [PATCH] ac3 passthrough 1st try
In-Reply-To: <200510062332.18816.stefan@lucke.in-berlin.de>
References: <200510061321.32405.stefan@lucke.in-berlin.de> <200510061358.02848.stefan@lucke.in-berlin.de> <4345181A.5020703@e-dition.fr> <200510062332.18816.stefan@lucke.in-berlin.de>
Message-ID: <4346382A.6090504@users.sourceforge.net>

Hi!

Stefan Lucke wrote:
[...]
> 
> No need to patch :-) . I think it's easier for people to check out cvs for
> tests than check out cvs and apply patches.
> 
> Modified (moved some code into separate files) version is now in cvs.

I checked out last night's softdevice CVS, ran the provided configure
script and compiled & installed, and after few attempts (until I figured
out I needed hw:0,0 for ac3) I was able to have working ac3 passthrough
on ZDF, Sat1 and ProSieben, and switching to non-ac3 channels back and
forth didn't crash (ok, only once, but the ac3 device wasn't the right
one that time). Good work, thanks!

However, it seemed to me that there where slightly A/V offsync, but my
main problem still remains the video judder (you remember my complaints
about field parity on interlaced device like plain standard analogue TV,
where I do not need any deinterlacing, but rather right field order, or
vsync, I don't know what actually the problem is). I have the same
problem with df_xine, but not with mplayer (at least not on 4:3
recordings). Maybe a look in this output from last night could reveal
you something: http://www.muresan.de/softdevice/softdevice_ac3_sync_comb.txt

Lucian


From stefan at lucke.in-berlin.de  Fri Oct  7 12:38:53 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 7 Oct 2005 12:38:53 +0200
Subject: [Softdevice-devel] [PATCH] ac3 passthrough 1st try
In-Reply-To: <4346382A.6090504@users.sourceforge.net>
References: <200510061321.32405.stefan@lucke.in-berlin.de> <200510062332.18816.stefan@lucke.in-berlin.de> <4346382A.6090504@users.sourceforge.net>
Message-ID: <200510071238.53944.stefan@lucke.in-berlin.de>

On Freitag, 7. Oktober 2005 10:56, Lucian Muresan wrote:
> Hi!
> 
> Stefan Lucke wrote:
> [...]
> > 
> > No need to patch :-) . I think it's easier for people to check out cvs for
> > tests than check out cvs and apply patches.
> > 
> > Modified (moved some code into separate files) version is now in cvs.
> 
> I checked out last night's softdevice CVS, ran the provided configure
> script and compiled & installed, and after few attempts (until I figured
> out I needed hw:0,0 for ac3) I was able to have working ac3 passthrough
> on ZDF, Sat1 and ProSieben, and switching to non-ac3 channels back and
> forth didn't crash (ok, only once, but the ac3 device wasn't the right
> one that time). Good work, thanks!

Fine, it works for another one too :-) .
I'm don't know the impact on the following message as it appears
several time in your log:
ac3play: Unable to update the IEC958 control: No such file or directory

> 
> However, it seemed to me that there where slightly A/V offsync, but my
> main problem still remains the video judder (you remember my complaints
> about field parity on interlaced device like plain standard analogue TV,
> where I do not need any deinterlacing, but rather right field order, or
> vsync, I don't know what actually the problem is). I have the same
> problem with df_xine, but not with mplayer (at least not on 4:3
> recordings). Maybe a look in this output from last night could reveal
> you something: http://www.muresan.de/softdevice/softdevice_ac3_sync_comb.txt

For short: There is no obvious strange message except that only video modes
at 16bpp are reported. That's what is reported on my system:
[dfb] Supported video Modes are: 768x576 at 24 768x576 at 32 768x576 at 32 768x576 at 32 720x576 at 24 640x480 at 32

I did my ac3 test on a similar system: normal old TV (no 100Hz box),
G400 dual head 32MB.
I definately don't see any judder effects news ticker of N24 runs fine
and deinterlaceing is turned off, as it is not needed on a interlaced tv.

Can you try to change:
osdLayer->SetFieldParity(0);
to:
osdLayer->SetFieldParity(1);

to see if fields are swapped on your card.

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Fri Oct  7 15:13:48 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 7 Oct 2005 15:13:48 +0200
Subject: [Softdevice-devel] 0.1.3 bug : 16/10 cropmode luma/chroma pb
In-Reply-To: <200510070006.03351.stefan@lucke.in-berlin.de>
References: <43457726.4000108@e-dition.fr> <43459591.3070101@e-dition.fr> <200510070006.03351.stefan@lucke.in-berlin.de>
Message-ID: <200510071513.48877.stefan@lucke.in-berlin.de>

On Freitag, 7. Oktober 2005 00:06, Stefan Lucke wrote:
> On Donnerstag, 6. Oktober 2005 23:22, Nicolas Huillard wrote:
> > Stefan Lucke a ?crit :
> > > On Donnerstag, 6. Oktober 2005 21:12, Nicolas Huillard wrote:
> > > 
> > >>Hello again,
> > >>
> > >>When setting cropmode to 16/10 on a 16/9 display, the luma and chroma 
> > >>planes seem to be detached : one is a good quarter of the screen on the 
> > >>right of the other one. Maybe it's not luma/chroma, but a third of YUV, 
> > >>because the "main" image remains at the same place, and only a ghost is 
> > >>displaced to the right.
> > >>This is the only cropmode setting with that problem. I didn't try other 
> > >>display aspect ratios.
> > > 

> Ok I can confirm that on my epia bord. My test was done with an 5:4 LCD
> VGA monitor. The color shadow picture was seen on arbitray monitor
> aspect setups via softdevice OSD. But it was only present for me when
> setting crop mode to 14:9. Another precondition is
> "HAVE_SetSourceLocation 0". This color shown picture is not present
> when video-dfb.c is compiled with "HAVE_SetSourceLocation 1".
> This value is set, when configure script  detects that in direcfb source.

Vidix-out showed the same behaviour. It was an odd line offset (syoff).
Fix is in cvs.

-- 
Stefan Lucke



From torgeir at pobox.com  Fri Oct  7 16:25:47 2005
From: torgeir at pobox.com (Torgeir Veimo)
Date: Sat, 08 Oct 2005 00:25:47 +1000
Subject: [Softdevice-devel] epia recommendations
In-Reply-To: <4343A383.6050309@e-dition.fr>
References: <1128469375.31274.9.camel@localhost.localdomain>
	 <4343A383.6050309@e-dition.fr>
Message-ID: <1128695147.24442.5.camel@localhost.localdomain>

On Wed, 2005-10-05 at 11:57 +0200, Nicolas Huillard wrote: 
> 
> With the latest kernel frame-buffer patches and DirectFB, you can
> choose
> either VT1622 or VT1622a/VT1623 based boards, ie. EPIA M or EPIA MII
> Tested on EPIA M 10k (me) and EPIA MII 12k (I think, Mark Adams). 

It seems the Epia board are almost similarly priced, with little to save
going with M or MII boards as opposed to SP boards? The SP 8000E is
fanless, have the CN400 chipset and cost about ?129. Is there any
advantage in having the CN400 chipset for MPEG2 playback? 

-- 
Torgeir Veimo <torgeir at pobox.com>



From lucianm at users.sourceforge.net  Sat Oct  8 09:35:37 2005
From: lucianm at users.sourceforge.net (Lucian Muresan)
Date: Sat, 08 Oct 2005 09:35:37 +0200
Subject: [Softdevice-devel] [PATCH] ac3 passthrough 1st try
In-Reply-To: <200510071238.53944.stefan@lucke.in-berlin.de>
References: <200510061321.32405.stefan@lucke.in-berlin.de> <200510062332.18816.stefan@lucke.in-berlin.de> <4346382A.6090504@users.sourceforge.net> <200510071238.53944.stefan@lucke.in-berlin.de>
Message-ID: <434776C9.90802@users.sourceforge.net>

Stefan Lucke wrote:
[...]
> 
> Fine, it works for another one too :-) .
> I'm don't know the impact on the following message as it appears
> several time in your log:
> ac3play: Unable to update the IEC958 control: No such file or directory

Don't know, at least I can't notice anything wrong with sound, and as it
turned out in the end, it doesn't even cause this judder, just read on ;-)

[...]
> For short: There is no obvious strange message except that only video modes
> at 16bpp are reported. That's what is reported on my system:
> [dfb] Supported video Modes are: 768x576 at 24 768x576 at 32 768x576 at 32 768x576 at 32 720x576 at 24 640x480 at 32

I first thought this is due to settings /etc/directfbrc or modelines in
/etc/fb.modes. Well, I had a line depth=32 in my directfbrc and
commented it out, with no difference to this output. Then I noticed, my
fb.modes had all modelines labeled like "720x576 50Hz 16bit", but hey,
those are only labels after all. However, the number of reported video
modes is exactly the number of modelines from fb.modes, and after all, I
know that for CRTC2 this file is irrelevant, as the PAL and NTSC modes
are actually hard-coded in the CRTC2 gfxdriver by Ville (I think).

> I did my ac3 test on a similar system: normal old TV (no 100Hz box),
> G400 dual head 32MB.
> I definately don't see any judder effects news ticker of N24 runs fine
> and deinterlaceing is turned off, as it is not needed on a interlaced tv.
> 
> Can you try to change:
> osdLayer->SetFieldParity(0);
> to:
> osdLayer->SetFieldParity(1);
> 
> to see if fields are swapped on your card.

I tried that, and even to hack the similar code at a place where
videoLayer is configured, and it did not help. BUT, then I played again
with the softdevice setup options in the OSD!!!! Man, what a moron I was
when I did it some time ago and changed the aspect ratio, I had the
impression that 5:4 "looked better" on my 4:3 PAL TV (because of
overscan - btw, is there a way to tweak this for G400 CRTC2 used with
DirectFB?). Well, the moment I switched back to 4:3, the image became
crisp and clear, no judder, everything looks just as it should, only
once in a while there seems to be a synchronisation catch up where
horizontally scrolling text for example, speeds up a little bit and then
moves with constant speed again, but it's not too obviously noticeable.

So my judder issue is solved now, I'm curious if A/V sync can still be
improved.

On to the next, but I'll start another topic...

Lucian


From stefan at lucke.in-berlin.de  Sat Oct  8 09:53:52 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 8 Oct 2005 09:53:52 +0200
Subject: [Softdevice-devel] [PATCH] ac3 passthrough 1st try
In-Reply-To: <434776C9.90802@users.sourceforge.net>
References: <200510061321.32405.stefan@lucke.in-berlin.de> <200510071238.53944.stefan@lucke.in-berlin.de> <434776C9.90802@users.sourceforge.net>
Message-ID: <200510080953.52831.stefan@lucke.in-berlin.de>

On Samstag, 8. Oktober 2005 09:35, Lucian Muresan wrote:
> Stefan Lucke wrote:

> > 
> > Can you try to change:
> > osdLayer->SetFieldParity(0);
> > to:
> > osdLayer->SetFieldParity(1);
> > 
> > to see if fields are swapped on your card.
> 
> I tried that, and even to hack the similar code at a place where
> videoLayer is configured, and it did not help. BUT, then I played again
> with the softdevice setup options in the OSD!!!! Man, what a moron I was
> when I did it some time ago and changed the aspect ratio, I had the
> impression that 5:4 "looked better" on my 4:3 PAL TV (because of
> overscan - btw, is there a way to tweak this for G400 CRTC2 used with
> DirectFB?). 

Yup, that was the one thing I forgot to ask. Display aspect ratio
has to be set correct. As it we are now talking about scaling, have a
look at my postings at directfb-user. There are some hard things
to be done ..

> Well, the moment I switched back to 4:3, the image became
> crisp and clear, no judder, everything looks just as it should, only
> once in a while there seems to be a synchronisation catch up where
> horizontally scrolling text for example, speeds up a little bit and then
> moves with constant speed again, but it's not too obviously noticeable.
> 
> So my judder issue is solved now, I'm curious if A/V sync can still be
> improved.

Well in ac3 mode, there seems to be a slight offset for a short while.
But a few seconds later the speaker seems to be lipsync again without
any noticable frame dropping.
Perhaps I'll delay that issue for a short time and release 0.2.0 version
very soon, hopefully this evening, so that people can do tests over 
the weekend.

-- 
Stefan Lucke



From lucianm at users.sourceforge.net  Sat Oct  8 10:52:37 2005
From: lucianm at users.sourceforge.net (Lucian Muresan)
Date: Sat, 08 Oct 2005 10:52:37 +0200
Subject: [Softdevice-devel] [PATCH] Gentoo packaging
Message-ID: <434788D5.4010307@users.sourceforge.net>

Hi folks,


I'd like to contribute for convenient intallation on Gentoo, 2 ebuilds
for softdevice, one for the released version, and one for the CVS version.

http://www.muresan.de/softdevice/vdrplugin-softdevice-0.1.3.ebuild
http://www.muresan.de/softdevice/vdrplugin-softdevice-cvs-0.1.3.ebuild

If Stefan would accept the following patch (maybe even for the 0.2.0
release tonight, unless there aren't major changes in the configure
script handling), then "make dist" will generate the properly versioned
ebuild anytime, and "make clean" will do it's job too.

http://www.muresan.de/softdevice/softdevice-gentoo_packaging.diff

What do you think?

Lucian


From seppo.ingalsuo at iki.fi  Sat Oct  8 11:24:53 2005
From: seppo.ingalsuo at iki.fi (Seppo Ingalsuo)
Date: Sat, 08 Oct 2005 12:24:53 +0300
Subject: [Softdevice-devel] Softdevice hangs?
Message-ID: <43479065.1060109@iki.fi>

Hi,

I'm running vdr in a dedicated box 24/7 so I have often suspended 
softdevice by pausing a recording. Now with Marko's suspend patch 
applied I don't probably need that any more but I thought this is worth 
reporting. I'm experiencing sometimes hangs of video when resuming 
playback with the same key after a couple of hours. Audio starts to play 
OK but not video. I'm not 100% sure but I think the osd is as well 
non-functional when a hang occurs. If I do nothing vdr watchdog kicks in 
and restarts eventually. I'm sometimes able to cure the hang by pressing 
green or yellow soft keys for skipping in the recording immediately 
after noticing the hang.

I have seen also (fortunately not often) similar hangs when zapping in 
live tv viewing and in that case watchdog restart cannot be avoided. Has 
anyone else experienced this kind of problem with softdevice?

My vdr box runs 2.6.12 kernel with LD_ASSUME_KERNEL=2.4.1 hack. 
Softdevice might be fine with NPTL but some plugins I need are not. 
Softdevice version is quite fresh CVS, grabbed just before AC3 support 
(I'll try that next!).

BR,
Seppo



From stefan at lucke.in-berlin.de  Sat Oct  8 13:19:20 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 8 Oct 2005 13:19:20 +0200
Subject: [Softdevice-devel] epia recommendations
In-Reply-To: <1128695147.24442.5.camel@localhost.localdomain>
References: <1128469375.31274.9.camel@localhost.localdomain> <4343A383.6050309@e-dition.fr> <1128695147.24442.5.camel@localhost.localdomain>
Message-ID: <200510081319.20472.stefan@lucke.in-berlin.de>

On Freitag, 7. Oktober 2005 16:25, Torgeir Veimo wrote:
> On Wed, 2005-10-05 at 11:57 +0200, Nicolas Huillard wrote: 
> > 
> > With the latest kernel frame-buffer patches and DirectFB, you can
> > choose
> > either VT1622 or VT1622a/VT1623 based boards, ie. EPIA M or EPIA MII
> > Tested on EPIA M 10k (me) and EPIA MII 12k (I think, Mark Adams). 
> 
> It seems the Epia board are almost similarly priced, with little to save
> going with M or MII boards as opposed to SP boards? The SP 8000E is
> fanless, have the CN400 chipset and cost about ?129. Is there any
> advantage in having the CN400 chipset for MPEG2 playback? 
> 

I found a good comparison chart on (small german contend):
http://www.mini-itx.de/boards-cpu.htm

CN400 has support for MPEG4, but thats not supported as MPEG2 hardware
decoding in softdevice. I you should look at available interface connectors
like P/S ATA, number of USB2 ports, Firewire, RGB/Component out, ..

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Sat Oct  8 13:23:11 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 8 Oct 2005 13:23:11 +0200
Subject: [Softdevice-devel] [PATCH] Gentoo packaging
In-Reply-To: <434788D5.4010307@users.sourceforge.net>
References: <434788D5.4010307@users.sourceforge.net>
Message-ID: <200510081323.11897.stefan@lucke.in-berlin.de>

On Samstag, 8. Oktober 2005 10:52, Lucian Muresan wrote:
> Hi folks,
> 
> 
> I'd like to contribute for convenient intallation on Gentoo, 2 ebuilds
> for softdevice, one for the released version, and one for the CVS version.
> 
> http://www.muresan.de/softdevice/vdrplugin-softdevice-0.1.3.ebuild
> http://www.muresan.de/softdevice/vdrplugin-softdevice-cvs-0.1.3.ebuild
> 
> If Stefan would accept the following patch (maybe even for the 0.2.0
> release tonight, unless there aren't major changes in the configure
> script handling), then "make dist" will generate the properly versioned
> ebuild anytime, and "make clean" will do it's job too.
> 
> http://www.muresan.de/softdevice/softdevice-gentoo_packaging.diff
> 
> What do you think?

It would be nice to have better support for some distributions. But I'd
like to delay that to the following series, so I can do some test
myself on my epia gentoo box.


-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Sat Oct  8 13:30:28 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 8 Oct 2005 13:30:28 +0200
Subject: [Softdevice-devel] Softdevice hangs?
In-Reply-To: <43479065.1060109@iki.fi>
References: <43479065.1060109@iki.fi>
Message-ID: <200510081330.28684.stefan@lucke.in-berlin.de>

On Samstag, 8. Oktober 2005 11:24, Seppo Ingalsuo wrote:
> Hi,
> 
> I'm running vdr in a dedicated box 24/7 so I have often suspended 
> softdevice by pausing a recording. Now with Marko's suspend patch 
> applied I don't probably need that any more but I thought this is worth 
> reporting. I'm experiencing sometimes hangs of video when resuming 
> playback with the same key after a couple of hours. Audio starts to play 
> OK but not video. I'm not 100% sure but I think the osd is as well 
> non-functional when a hang occurs. If I do nothing vdr watchdog kicks in 
> and restarts eventually. I'm sometimes able to cure the hang by pressing 
> green or yellow soft keys for skipping in the recording immediately 
> after noticing the hang.

Sitting in oause mode for a couple of hours is a hard test case. Maybe
I've seen such a hang, but did not noticed as such, because I looked
for other things happen. But now I'm prepared when odd behaviour
occures next time.


-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Sat Oct  8 15:55:27 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 8 Oct 2005 15:55:27 +0200
Subject: [Softdevice-devel] Fwd: [vdr] [ANNOUNCE] vdr-softdevice-0.2.0
Message-ID: <200510081555.27315.stefan@lucke.in-berlin.de>


----------  Forwarded Message  ----------

Subject: [vdr] [ANNOUNCE] vdr-softdevice-0.2.0
Date: Samstag, 8. Oktober 2005 15:27
From: Stefan Lucke <stefan at lucke.in-berlin.de>
To: vdr at linuxtv.org

Hello,

softdevice team (Torgeir Veimo, Martin Wache and me, Stefan Lucke)
is pleased to announce a new release of vdr softdevice plugin.

General info:
  Softdevice plugin enables vdr to run on your desktop with
  so called budget cards. You'll get vdr output via framebuffer or X11-Xv or
  DirectFB or vidix to your screen. Decoding is done via ffmpeg.

Special in this release (from README):
- AC3 pass through:
  For using AC3 pass through, you have to specify the IEC958 device name of
  your sound card. Which device to use, can be checked with ac3play.
  For my system, ac3play works with: "ac3play -C -D 0,1 AC3_FILE_NAME"
  So my vdr call with parameter list for softdevice looks like:
  -P "softdevice -ao alsa:pcm=default#ac3=hw:0,1# -vo dfb:mgatv"
  Notice the trailing '#' of the last alsa subparameter.
  AC3 pass through is mainly based on the code of ac3play-0.5.2f, so
  many thanks to the authors of that program.

- configure script
  By default you should "cd" to softdevice directory and run "./configure" .
  This will generate config.h and config.mak files, which will guide make.
  Available parameters of configure are listed by "./configure --help" .
  To get rid of these generated files a "make dist-clean" should be done.
  Without running configure, you'll have to modify the Makefile to your needs.

Plugin's homepage is located at: http://softdevice.berlios.de/

Changelog since last release:
2005-10-08: softdevice-0.2.0
2005-10-07:
    - dfb+vidix: fix colored shadow bug for some crop modes
    - configure: fix VIDIX_DIR path
2005-10-06:
    - configure: check if X11 is present
    - audio: AC3 pass through
2005-09-18:
    - Makefile: compatibility for build without configure
    - subplugin targets: changed prefix from libvdr to libsubvdr. so it doesn't
      interfere with vdr's "load all plugins" for plain help command.
2005-09-17:
    - configure: check if vidix compiles, optionally disable fb-out via
                 command line "--disable-fb" and/or subplugins via "--disable-subplugins"
2005-09-16:
    - introduce audio debug
    - return 0 in GetDelay if pcm is not running
2005-09-15:
    - modified previous OSD redraw handling (timed redraw after _all_ OSD bitmaps
      have been drawn)
    - video-dfb: keyrepeat handling + configure check for DIET_REPEAT
2005-09-11:
    - fix for segfaults with some OSD activity
    - introduced configure script: try ./configure --help
2005-09-06:
    - video-out (all methods): fix for missing actions upon aspect ratio change
    - audio-out: fix potentially div by zero.

-- 
Stefan Lucke


_______________________________________________
vdr mailing list
vdr at linuxtv.org
http://www.linuxtv.org/cgi-bin/mailman/listinfo/vdr


-------------------------------------------------------

-- 
Stefan Lucke



From lucianm at users.sourceforge.net  Sat Oct  8 18:28:40 2005
From: lucianm at users.sourceforge.net (Lucian Muresan)
Date: Sat, 08 Oct 2005 18:28:40 +0200
Subject: [Softdevice-devel] [PATCH] Gentoo packaging
In-Reply-To: <200510081323.11897.stefan@lucke.in-berlin.de>
References: <434788D5.4010307@users.sourceforge.net> <200510081323.11897.stefan@lucke.in-berlin.de>
Message-ID: <4347F3B8.4000908@users.sourceforge.net>

Stefan Lucke wrote:
> On Samstag, 8. Oktober 2005 10:52, Lucian Muresan wrote:
>> Hi folks,
>> 
>> 
>> I'd like to contribute for convenient intallation on Gentoo, 2 ebuilds
>> for softdevice, one for the released version, and one for the CVS version.
>> 
>> http://www.muresan.de/softdevice/vdrplugin-softdevice-0.1.3.ebuild
>> http://www.muresan.de/softdevice/vdrplugin-softdevice-cvs-0.1.3.ebuild
>> 
>> If Stefan would accept the following patch (maybe even for the 0.2.0
>> release tonight, unless there aren't major changes in the configure
>> script handling), then "make dist" will generate the properly versioned
>> ebuild anytime, and "make clean" will do it's job too.
>> 
>> http://www.muresan.de/softdevice/softdevice-gentoo_packaging.diff
>> 
>> What do you think?
> 
> It would be nice to have better support for some distributions. But I'd
> like to delay that to the following series, so I can do some test
> myself on my epia gentoo box.

Ok, please do so, maybe Nicolas Huillard will also provide some Debian
stuff. In the meantime I've updated the patch, maybe you'll find some
time to have a look
http://www.muresan.de/softdevice/softdevice-gentoo_packaging.diff and
generated also ebuilds for version 0.2.0 for direct testing:
http://www.muresan.de/softdevice/vdrplugin-softdevice-0.2.0.ebuild
http://www.muresan.de/softdevice/vdrplugin-softdevice-cvs-0.2.0.ebuild
put this in the respective 'files" subdirectory:
http://www.muresan.de/softdevice/vdr.softdevice

Lucian


From stefan at lucke.in-berlin.de  Sun Oct  9 10:21:54 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 9 Oct 2005 10:21:54 +0200
Subject: [Softdevice-devel] playing music ac3 files with softplay :-)
Message-ID: <200510091021.54471.stefan@lucke.in-berlin.de>

Hi,

just did a test with a music ac3 file. It just plays fine with softdevice + softplay
I found a link, from where it is possible to download some music titles free
and for personal use only. But thats fine for testing.
http://www.lynnemusic.com/surroundmusic.html

Some other test files are here (untested):
http://koti.mbnet.fi/bab5/ac3/

-- 
Stefan Lucke



From marko.makela at hut.fi  Mon Oct 10 09:00:10 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Mon, 10 Oct 2005 10:00:10 +0300
Subject: [Softdevice-devel] very wide aspect ratio
In-Reply-To: <200509290752.51616.stefan@lucke.in-berlin.de>
References: <20050928164622.GB269465@kosh.hut.fi> <200509290752.51616.stefan@lucke.in-berlin.de>
Message-ID: <20051010070010.GB141827@kosh.hut.fi>

On Thu, Sep 29, 2005 at 07:52:51AM +0200, Stefan Lucke wrote:
> On Mittwoch, 28. September 2005 18:46, Marko M?kel? wrote:
> > I came across to a recording that misleads softdevice to display some very weird
> > aspect ratio, something like 4:1 instead of the correct 16:9.
> > 
> > I sent a link to the clip privately to Stefan Lucke.
> > 
> > Suggested fix: if the aspect ratio is reported as wider than 16:9 or narrower than
> > 4:3, clamp it to these values.
> 
> Stream starts in 4:3 when first mark is
> set to 00:00:00.06. Thats the point a can set the first marker (vdr-1.3.32) to.
> Videorepacker or ffmpeg. Do jou have some more contend which starts earlier ?
> It strange that when starting at the beginning, not further transition is recognized.

As I don't usually watch this channel [Nelonen (4), a free-to-air
commercial-driven channel on DVB-T], I haven't noticed these
problems before.  I think they're pretty common, because I saw
the symptoms yesterday during live view (had to cure it with
channel zapping) and this morning twice in a recording,
apparently caused by the same commercial.  I made a 27-megabyte
clip of the commercial and some preceding and following video.
I'll send you the URL in private mail.

My ffmpeg is CVS checked out on October 3, if that matters.

	Marko


From nhuillard at e-dition.fr  Mon Oct 10 11:12:24 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Mon, 10 Oct 2005 11:12:24 +0200
Subject: [Softdevice-devel] [PATCH] Gentoo packaging
In-Reply-To: <4347F3B8.4000908@users.sourceforge.net>
References: <434788D5.4010307@users.sourceforge.net> <200510081323.11897.stefan@lucke.in-berlin.de> <4347F3B8.4000908@users.sourceforge.net>
Message-ID: <434A3078.8000403@e-dition.fr>

Lucian Muresan a ?crit :
> Stefan Lucke wrote:
> 
>>It would be nice to have better support for some distributions. But I'd
>>like to delay that to the following series, so I can do some test
>>myself on my epia gentoo box.
> 
> Ok, please do so, maybe Nicolas Huillard will also provide some Debian

I'll update the Debian package for the configure stuff, based on you
patch. I'll also package softplay, sooner or later...
All that packages are/will be on www.e-tobi.net (vdr-experimental).

> stuff. In the meantime I've updated the patch, maybe you'll find some
> time to have a look
> http://www.muresan.de/softdevice/softdevice-gentoo_packaging.diff and
> generated also ebuilds for version 0.2.0 for direct testing:
> http://www.muresan.de/softdevice/vdrplugin-softdevice-0.2.0.ebuild
> http://www.muresan.de/softdevice/vdrplugin-softdevice-cvs-0.2.0.ebuild
> put this in the respective 'files" subdirectory:
> http://www.muresan.de/softdevice/vdr.softdevice

-- 
NH


From stefan at lucke.in-berlin.de  Mon Oct 10 21:37:21 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Mon, 10 Oct 2005 21:37:21 +0200
Subject: [Softdevice-devel] very wide aspect ratio
In-Reply-To: <20051010070010.GB141827@kosh.hut.fi>
References: <20050928164622.GB269465@kosh.hut.fi> <200509290752.51616.stefan@lucke.in-berlin.de> <20051010070010.GB141827@kosh.hut.fi>
Message-ID: <200510102137.21180.stefan@lucke.in-berlin.de>

On Montag, 10. Oktober 2005 09:00, Marko M?kel? wrote:
> On Thu, Sep 29, 2005 at 07:52:51AM +0200, Stefan Lucke wrote:
> > On Mittwoch, 28. September 2005 18:46, Marko M?kel? wrote:
> > > I came across to a recording that misleads softdevice to display some very weird
> > > aspect ratio, something like 4:1 instead of the correct 16:9.
> > > 
> > > I sent a link to the clip privately to Stefan Lucke.
> > > 
> > > Suggested fix: if the aspect ratio is reported as wider than 16:9 or narrower than
> > > 4:3, clamp it to these values.
> > 
> > Stream starts in 4:3 when first mark is
> > set to 00:00:00.06. Thats the point a can set the first marker (vdr-1.3.32) to.
> > Videorepacker or ffmpeg. Do jou have some more contend which starts earlier ?
> > It strange that when starting at the beginning, not further transition is recognized.
> 
> As I don't usually watch this channel [Nelonen (4), a free-to-air
> commercial-driven channel on DVB-T], I haven't noticed these
> problems before.  I think they're pretty common, because I saw
> the symptoms yesterday during live view (had to cure it with
> channel zapping) and this morning twice in a recording,
> apparently caused by the same commercial.  I made a 27-megabyte
> clip of the commercial and some preceding and following video.
> I'll send you the URL in private mail.
> 

Did not yet download 2nd example, but:
Hm, now I think it's our probelm, dilemma. We have to choose ...
Look at video.c. There is a comment:
  /* --------------------------------------------------------------------------
   * removed aspect ratio calculation based on picture->pan_scan->width
   * as this value seems to be wrong on some dvds.
   */

Reintroducing that calculation would fix that stream (the first of 
your example) ;-) . So I've to look at those/this dvd(s) which were 
displayed wrong with that calculation.

Index: video.c
===================================================================
RCS file: /cvsroot/softdevice/softdevice/video.c,v
retrieving revision 1.32
diff -U3 -r1.32 video.c
--- video.c     7 Oct 2005 13:07:15 -0000       1.32
+++ video.c     10 Oct 2005 19:34:39 -0000
@@ -331,6 +331,13 @@
   {
     new_asp = (float) (context->width) / (float) (context->height);
   }
+  else if (picture->pan_scan->width)
+  {
+    new_asp = (float) (picture->pan_scan->width *
+                        context->sample_aspect_ratio.num) /
+                (float) (picture->pan_scan->height *
+                          context->sample_aspect_ratio.den);
+  }
   else
   {
     new_asp = (float) (context->width * context->sample_aspect_ratio.num) /

-- 
Stefan Lucke



From marko.makela at hut.fi  Mon Oct 10 22:56:17 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Mon, 10 Oct 2005 23:56:17 +0300
Subject: [Softdevice-devel] very wide aspect ratio
In-Reply-To: <200510102137.21180.stefan@lucke.in-berlin.de>
References: <20050928164622.GB269465@kosh.hut.fi> <200509290752.51616.stefan@lucke.in-berlin.de> <20051010070010.GB141827@kosh.hut.fi> <200510102137.21180.stefan@lucke.in-berlin.de>
Message-ID: <20051010205617.GD3099@localhost.localdomain>

On Mon, Oct 10, 2005 at 09:37:21PM +0200, Stefan Lucke wrote:
> Hm, now I think it's our probelm, dilemma. We have to choose ...
> Look at video.c. There is a comment:
>   /* --------------------------------------------------------------------------
>    * removed aspect ratio calculation based on picture->pan_scan->width
>    * as this value seems to be wrong on some dvds.
>    */
> 
> Reintroducing that calculation would fix that stream (the first of 
> your example) ;-) . So I've to look at those/this dvd(s) which were 
> displayed wrong with that calculation.

If all else fails, make it another configuration flag? :-)

	Marko


From nhuillard at e-dition.fr  Tue Oct 11 11:11:28 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Tue, 11 Oct 2005 11:11:28 +0200
Subject: [Softdevice-devel] Wrong PLUGINLIBDIR = stop without any message
Message-ID: <434B81C0.30009@e-dition.fr>

Hello,

I'm testing 0.2.0 now, and have a few problems related to packaging.
When USE_SUBPLUGINS=1, and PLUGINLIBDIR is not adjusted, VDR starts then
stop without any message. I checked cSoftDevice::LoadSubPlugin, which
seems to handle every situation, except when "void *handle = dlopen
(subPluginFileName, RTLD_NOW);" does not work.

Here is the log :

root at vdr:~# /usr/bin/vdr-dbg -v /home/video -c /var/lib/vdr -L
/usr/lib/vdr/plugins -r /usr/lib/vdr/vdr-recordingaction -s
/usr/lib/vdr/vdr-shutdown.wrapper -E /var/cache/vdr/epg.data -u vdr -g
vdr --port 2001 --lirc -P 'softdevice -vo dfb: -L /toto' -w 60
[softdevice] processing args
[softdevice]   argv [0] = softdevice
[softdevice]   argv [1] = -vo
vo_argv: dfb:
[softdevice]   argv [3] = -L
[setup-softdevice] alsa ac3Mode set to: 1
[setup-softdevice] alsa device set to: default
[setup-softdevice] A/V Offset set to (0)
[setup-softdevice] Cropping 0 lines from bottom
[setup-softdevice] Cropping 0 columns from left
[setup-softdevice] cropping mode set to 2 (16:9)
[setup-softdevice] cropping mode toggle key set to 0 (none)
[setup-softdevice] Cropping 0 columns from right
[setup-softdevice] Cropping 0 lines from top
[setup-softdevice] deinterlace method set to 0 none
[setup-softdevice] setting alpha blend mode to pseudo
[softdevice] picture mirroring set to 0 (off)
[setup-softdevice] pixel format set to (I420)
[setup-softdevice] shouldSuspend to: 1
[softdevice] UseStretchBlitset to off
[setup-softdevice] startup aspect set to (4:3 normal)
[softdevice] initializing Plugin
[softdevice] Initializing Video Out
[softdevice] ffmpeg version(CVS) build(3211265)
root at vdr:~#

Setting the right -L option make it work.
Debian sarge with add-on repositories. Not clean for the moment.
vdr 1.3.33, softdevice 0.2.0

-- 
NH


From nhuillard at e-dition.fr  Tue Oct 11 11:29:23 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Tue, 11 Oct 2005 11:29:23 +0200
Subject: [Softdevice-devel] ffmpeg : pkg-config vs. ffmpeg-config
Message-ID: <434B85F3.5020305@e-dition.fr>

Hello,

I'm currently packaging softdevice 0.2.0 for the Debian e-tobi
repository, adding ./configure support.

I've tested the following patch to ./configure, that use ffmpeg-config
instead of pkg-config, because they give different outputs, at least on
my unclean box.
Should we use one or the other ? Are all these lib really necessary
(-lraw1394 -ldc1394_control -lgsm...) ?


nhuillard at vdr:vdr-plugin-softdevice-0.2.0$ pkg-config --libs libavcodec
libavformat
-lavformat -lavcodec -ldts -lz -ldl -lvorbis -lm -ltheora -lavutil -logg

With these libs, I get the following message when running vdr/softdevice:
vdr: /usr/lib/vdr/plugins/libvdr-softdevice.so.1.3.33: undefined symbol:
dc1394_create_handle


nhuillard at vdr:vdr-plugin-softdevice-0.2.0$ ffmpeg-config --plugin-libs
avcodec avformat
-lavcodec_pic -lavutil_pic -lavformat_pic -lavutil_pic -lavcodec_pic
-lvorbis -lvorbisenc -ltheora -logg -ldts_pic -la52 -lraw1394
-ldc1394_control -lgsm -lz -lm


Other problem on my box is that I did not install postproc (for
testing), but ffmpeg-config still outputs libs, thus I can't tell
whether postproc is installed or not :

nhuillard at vdr:vdr-plugin-softdevice-0.2.0$ ffmpeg-config --plugin-libs
postproc
-lpostproc_pic -lavutil_pic -lavcodec_pic -lvorbis -lvorbisenc -ltheora
-logg -ldts_pic -la52 -lraw1394 -ldc1394_control -lgsm -lz -lm

nhuillard at vdr:vdr-plugin-softdevice-0.2.0$ pkg-config --libs libpostproc
Package libpostproc was not found in the pkg-config search path.
Perhaps you should add the directory containing `libpostproc.pc'
to the PKG_CONFIG_PATH environment variable
No package 'libpostproc' found




--- ./configure 2005-10-07 15:37:53.000000000 +0200
+++ ./configure.debian  2005-10-11 00:49:11.000000000 +0200
@@ -64,12 +64,12 @@
 #########################################################
 # start ffmpeg test
 #
-ffmpeg_l1="libavcodec libavformat"
+ffmpeg_l1="avcodec avformat"

-pkg-config --libs libpostproc >/dev/null 2>&1 && {
ffmpeg_l1="$ffmpeg_l1 libpostproc";libpostproc="yes"; }
+pkg-config --libs libpostproc >/dev/null 2>&1 && {
ffmpeg_l1="$ffmpeg_l1 postproc";libpostproc="yes"; }

-ffmpeg_libs=`pkg-config --libs $ffmpeg_l1`
-ffmpeg_cflags=`pkg-config --cflags $ffmpeg_l1`
+ffmpeg_libs=`ffmpeg-config --plugin-libs $ffmpeg_l1`
+ffmpeg_cflags=`ffmpeg-config --cflags`

 #########################################################
 # start of DirectFB specific tests

-- 
NH


From nhuillard at e-dition.fr  Tue Oct 11 11:50:12 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Tue, 11 Oct 2005 11:50:12 +0200
Subject: [Softdevice-devel] [PATCH] Gentoo packaging
In-Reply-To: <434A3078.8000403@e-dition.fr>
References: <434788D5.4010307@users.sourceforge.net> <200510081323.11897.stefan@lucke.in-berlin.de> <4347F3B8.4000908@users.sourceforge.net> <434A3078.8000403@e-dition.fr>
Message-ID: <434B8AD4.8080200@e-dition.fr>

Nicolas Huillard a ?crit :
> Lucian Muresan a ?crit :
> 
>>Stefan Lucke wrote:
>>
>>>It would be nice to have better support for some distributions. But I'd
>>>like to delay that to the following series, so I can do some test
>>>myself on my epia gentoo box.
>>
>>Ok, please do so, maybe Nicolas Huillard will also provide some Debian
> 
> I'll update the Debian package for the configure stuff, based on you
> patch. I'll also package softplay, sooner or later...

Well, I didn't check your diff before packaging myself. It appears to
add Gentoo-specific things in the Makefile : will it run cleanly on
other distros ?
When packaging for Debian, we usually do not modify upstream for the
packaging needs, because packaging has really different problems than
coding.

-- 
NH


From laz at club-burniston.co.uk  Tue Oct 11 12:00:06 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Tue, 11 Oct 2005 11:00:06 +0100
Subject: [Softdevice-devel] [PATCH] Gentoo packaging
In-Reply-To: <434B8AD4.8080200@e-dition.fr>
References: <434788D5.4010307@users.sourceforge.net>
	 <200510081323.11897.stefan@lucke.in-berlin.de>
	 <4347F3B8.4000908@users.sourceforge.net> <434A3078.8000403@e-dition.fr>
	 <434B8AD4.8080200@e-dition.fr>
Message-ID: <1129024806.18094.0.camel@laser2.york.ac.uk>

On Tue, 2005-10-11 at 11:50 +0200, Nicolas Huillard wrote:
> Nicolas Huillard a ?crit :
> > Lucian Muresan a ?crit :
> > 
> >>Stefan Lucke wrote:
> >>
> >>>It would be nice to have better support for some distributions. But I'd
> >>>like to delay that to the following series, so I can do some test
> >>>myself on my epia gentoo box.
> >>
> >>Ok, please do so, maybe Nicolas Huillard will also provide some Debian
> > 
> > I'll update the Debian package for the configure stuff, based on you
> > patch. I'll also package softplay, sooner or later...
> 
> Well, I didn't check your diff before packaging myself. It appears to
> add Gentoo-specific things in the Makefile : will it run cleanly on
> other distros ?
> When packaging for Debian, we usually do not modify upstream for the
> packaging needs, because packaging has really different problems than
> coding.

I've never got it to build after using the configure script on Debian: I
think the main thing is ffmpeg, as you say. I usually end up scrapping
make.config and editing the Makefile like I used to!

;-)

Cheers,

Laz



From nhuillard at e-dition.fr  Tue Oct 11 12:24:04 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Tue, 11 Oct 2005 12:24:04 +0200
Subject: [Softdevice-devel] [PATCH] Gentoo packaging
In-Reply-To: <1129024806.18094.0.camel@laser2.york.ac.uk>
References: <434788D5.4010307@users.sourceforge.net>	 <200510081323.11897.stefan@lucke.in-berlin.de>	 <4347F3B8.4000908@users.sourceforge.net> <434A3078.8000403@e-dition.fr>	 <434B8AD4.8080200@e-dition.fr> <1129024806.18094.0.camel@laser2.york.ac.uk>
Message-ID: <434B92C4.7040107@e-dition.fr>

Laurence Abbott a ?crit :
> I've never got it to build after using the configure script on Debian: I
> think the main thing is ffmpeg, as you say. I usually end up scrapping
> make.config and editing the Makefile like I used to!

Well, this means I either have something useful to give, or a big
problem with my box.
Try the attached ./debian/ directory (PLUGINLIBDIR not set correctly yet)

-- 
NH
-------------- next part --------------
A non-text attachment was scrubbed...
Name: softdevice-0.2.0_debian.tar.gz
Type: application/x-gzip
Size: 5576 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051011/e174991f/attachment.bin>

From lucianm at users.sourceforge.net  Tue Oct 11 12:42:34 2005
From: lucianm at users.sourceforge.net (Lucian Muresan)
Date: Tue, 11 Oct 2005 12:42:34 +0200
Subject: [Softdevice-devel] [PATCH] Gentoo packaging
In-Reply-To: <434B8AD4.8080200@e-dition.fr>
References: <434788D5.4010307@users.sourceforge.net> <200510081323.11897.stefan@lucke.in-berlin.de> <4347F3B8.4000908@users.sourceforge.net> <434A3078.8000403@e-dition.fr> <434B8AD4.8080200@e-dition.fr>
Message-ID: <434B971A.1060804@users.sourceforge.net>

Nicolas Huillard wrote:
> Nicolas Huillard a ?crit :
> 
>>Lucian Muresan a ?crit :
>>
>>
>>>Stefan Lucke wrote:
>>>
>>>
>>>>It would be nice to have better support for some distributions. But I'd
>>>>like to delay that to the following series, so I can do some test
>>>>myself on my epia gentoo box.
>>>
>>>Ok, please do so, maybe Nicolas Huillard will also provide some Debian
>>
>>I'll update the Debian package for the configure stuff, based on you
>>patch. I'll also package softplay, sooner or later...
> 
> 
> Well, I didn't check your diff before packaging myself. It appears to
> add Gentoo-specific things in the Makefile : will it run cleanly on
> other distros ?

That would run, it only renames files reaey to use as ebuilds ("packages").

> When packaging for Debian, we usually do not modify upstream for the
> packaging needs, because packaging has really different problems than
> coding.

Your're right, I'd better provide a script in that gentoo subfolder (it
would then only rely on the directory structure, to be able to get the
current plugin version from softdevice.c.

However, even if modifying upstream for packaging needs isn't nice,
sometimes it's useful if configure scripts and makefiles follow certain
rules that won't harm, like for example, using a lot variables that they
only set if found unset (example: gentoo likes to control the prefix
where a package is installed by setting the variable DESTDIR, which
could have a default value that the software author likes for example,
in the upstream configure script or makefile, but actually only uses
that value if DESTDIR is not aleready set from the outside...)
I guess Stefan does exactly this with the PKG_CONFIG_PATH variable, and
fortunately the rest of the build also runs cleanly on gentoo (if
dependencies are satisfied), I only have some doubts in the results of
those more specific tests made in the configure script, if they fail,
the makefile is generated too and the gentoo ebuild continues as if
everything would be ok and then only later compilation fails, and one
has to figure out why, which might be difficult for non-programmers. I
think the configure script lacks exit (0 for success, 1 for failure)
values to signalize the status  at some points in the script, which
Stefan knows better. That way, the gentoo script would be able to fail
with a proper message (using the "die" command if configure failed, the
"gentoo way").

That being said, I was about to update the gfentoo packaging stuff
anyway (will take out those gentoo specifics from the Makefile, and
maybe try to pus some 'exit' statements in the configure script), so
stay tuned.

Lucian



From nhuillard at e-dition.fr  Tue Oct 11 13:04:42 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Tue, 11 Oct 2005 13:04:42 +0200
Subject: [Softdevice-devel] [PATCH] Gentoo packaging
In-Reply-To: <434B971A.1060804@users.sourceforge.net>
References: <434788D5.4010307@users.sourceforge.net> <200510081323.11897.stefan@lucke.in-berlin.de> <4347F3B8.4000908@users.sourceforge.net> <434A3078.8000403@e-dition.fr> <434B8AD4.8080200@e-dition.fr> <434B971A.1060804@users.sourceforge.net>
Message-ID: <434B9C4A.4000306@e-dition.fr>

Lucian Muresan a ?crit :
> Nicolas Huillard wrote:
> 
>>When packaging for Debian, we usually do not modify upstream for the
>>packaging needs, because packaging has really different problems than
>>coding.
> 
> 
> Your're right, I'd better provide a script in that gentoo subfolder (it
> would then only rely on the directory structure, to be able to get the
> current plugin version from softdevice.c.
> 
> However, even if modifying upstream for packaging needs isn't nice,
> sometimes it's useful if configure scripts and makefiles follow certain
> rules that won't harm, like for example, using a lot variables that they
> only set if found unset (example: gentoo likes to control the prefix
> where a package is installed by setting the variable DESTDIR, which
> could have a default value that the software author likes for example,
> in the upstream configure script or makefile, but actually only uses
> that value if DESTDIR is not aleready set from the outside...)
> I guess Stefan does exactly this with the PKG_CONFIG_PATH variable, and
> fortunately the rest of the build also runs cleanly on gentoo (if
> dependencies are satisfied), I only have some doubts in the results of
> those more specific tests made in the configure script, if they fail,
> the makefile is generated too and the gentoo ebuild continues as if
> everything would be ok and then only later compilation fails, and one
> has to figure out why, which might be difficult for non-programmers. I
> think the configure script lacks exit (0 for success, 1 for failure)
> values to signalize the status  at some points in the script, which
> Stefan knows better. That way, the gentoo script would be able to fail
> with a proper message (using the "die" command if configure failed, the
> "gentoo way").
> 
> That being said, I was about to update the gfentoo packaging stuff
> anyway (will take out those gentoo specifics from the Makefile, and
> maybe try to pus some 'exit' statements in the configure script), so
> stay tuned.

OK. I think we do the same things. I didn't check precisely the needs of
the ./configure script, WRT DESTDIR et al.
Your patches will be welcome.

Do you have an idea concerning the ffmpeg-config thing I posted earlier
("ffmpeg : pkg-config vs. ffmpeg-config") ?

-- 
NH


From lucianm at users.sourceforge.net  Tue Oct 11 13:44:50 2005
From: lucianm at users.sourceforge.net (Lucian Muresan)
Date: Tue, 11 Oct 2005 13:44:50 +0200
Subject: [Softdevice-devel] [PATCH] Gentoo packaging
In-Reply-To: <434B9C4A.4000306@e-dition.fr>
References: <434788D5.4010307@users.sourceforge.net> <200510081323.11897.stefan@lucke.in-berlin.de> <4347F3B8.4000908@users.sourceforge.net> <434A3078.8000403@e-dition.fr> <434B8AD4.8080200@e-dition.fr> <434B971A.1060804@users.sourceforge.net> <434B9C4A.4000306@e-dition.fr>
Message-ID: <434BA5B2.2060803@users.sourceforge.net>

Nicolas Huillard wrote:
[...]
> Do you have an idea concerning the ffmpeg-config thing I posted earlier
> ("ffmpeg : pkg-config vs. ffmpeg-config") ?

Sorry, no, ffmpeg-0.4.9_p20050906 which I have now on th gentoo I have
access to right now (inside colinux :-) ) has no ffmpeg-config.



From stefan at lucke.in-berlin.de  Tue Oct 11 13:59:10 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Tue, 11 Oct 2005 13:59:10 +0200
Subject: [Softdevice-devel] [PATCH] Gentoo packaging
In-Reply-To: <434BA5B2.2060803@users.sourceforge.net>
References: <434788D5.4010307@users.sourceforge.net> <200510081323.11897.stefan@lucke.in-berlin.de> <4347F3B8.4000908@users.sourceforge.net> <434A3078.8000403@e-dition.fr> <434B8AD4.8080200@e-dition.fr> <434B971A.1060804@users.sourceforge.net> <434B9C4A.4000306@e-dition.fr> <434BA5B2.2060803@users.sourceforge.net>
Message-ID: <1129031950.434ba90e658d6@webmail.in-berlin.de>

Quoting Lucian Muresan <lucianm at users.sourceforge.net>:

> Nicolas Huillard wrote:
> [...]
> > Do you have an idea concerning the ffmpeg-config thing I posted earlier
> > ("ffmpeg : pkg-config vs. ffmpeg-config") ?
>
> Sorry, no, ffmpeg-0.4.9_p20050906 which I have now on th gentoo I have
> access to right now (inside colinux :-) ) has no ffmpeg-config.
>

My guess is that ffmpeg-config is debian specific.
I had a look at ffmpegs cvs. Pkg-config suport for dc1394 libs seems
to be added on 2nd or 4th of Oct.

Stefan Lucke


From lucianm at users.sourceforge.net  Tue Oct 11 15:20:07 2005
From: lucianm at users.sourceforge.net (Lucian Muresan)
Date: Tue, 11 Oct 2005 15:20:07 +0200
Subject: [Softdevice-devel] [PATCH] Gentoo packaging (updated)
Message-ID: <434BBC07.4080902@users.sourceforge.net>

Hi,

I updated the gentoo packaging.

Patch to support gentoo in the distribution archive itself:
http://www.muresan.de/softdevice/softdevice-gentoo_packaging.diff
- no longer touches the makefile
- gnerates just one ebuild, usable for both release, and CVS,
controllable via the USE flag "cvs_softdevice";

For "gentoo end-users", the ebuild that would be generated for the
current version:
http://www.muresan.de/softdevice/vdrplugin-softdevice-0.2.0.ebuild
If you get this ebuild, put this in it's "files" subdirectory:
http://www.muresan.de/softdevice/vdr.softdevice

I thought just one ebuild is easier to maintain instead of two, and
because I intend to write ebuilds for softplay and why not, softieee1394
as well, as they depend on softdevice, the two ebuilds would have
required complicated dependency hacks.

Lucian


From marko.makela at hut.fi  Tue Oct 11 20:12:32 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Tue, 11 Oct 2005 21:12:32 +0300
Subject: [Softdevice-devel] very wide aspect ratio
In-Reply-To: <200510102137.21180.stefan@lucke.in-berlin.de>
References: <20050928164622.GB269465@kosh.hut.fi> <200509290752.51616.stefan@lucke.in-berlin.de> <20051010070010.GB141827@kosh.hut.fi> <200510102137.21180.stefan@lucke.in-berlin.de>
Message-ID: <20051011181232.GA121966@kosh.hut.fi>

On Mon, Oct 10, 2005 at 09:37:21PM +0200, Stefan Lucke wrote:
> Reintroducing that calculation would fix that stream (the first of 
> your example) ;-) . So I've to look at those/this dvd(s) which were 
> displayed wrong with that calculation.

It also fixes the second sample, provided that the problematic
16:9 commercial is actually sent as 4:3 with black bars at the
top and bottom.  The following short movie certainly is sent
in that way.

	Marko


From nhuillard at e-dition.fr  Thu Oct 13 00:19:59 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 13 Oct 2005 00:19:59 +0200
Subject: [Softdevice-devel] softplay Debian packaging : problems related to development
Message-ID: <434D8C0F.8060601@e-dition.fr>

Hello,

I'm beginning this packaging, and have the following problems :

1) I have to patch SoftPlayer.h to include softdevice.h from the proper 
directory, which is not the same as your vdr-like development tree. Real 
problem is that I have to hard-code my directory into the Debian 
package, which is really bad. The packaging alternative is to create a 
softdevice-dev package to hold softdevice.h, in order for SoftPlayer.h 
to #include <softdevice.h>
The other alternative would be for softdevice and softplay to agree on 
an interface a-la-recently implemented in VDR, IIRC.

=========================
--- ./SoftPlayer.h      2005-05-16 21:07:54.000000000 +0200
+++ ./SoftPlayer.h.debian       2005-10-13 00:06:02.000000000 +0200
@@ -17,7 +17,7 @@

  #include <avformat.h>

-#include "../softdevice/softdevice.h"
+#include 
"../../vdr-plugin-softdevice/vdr-plugin-softdevice-0.2.0/softdevice.h"
  #include "PlayList.h"

  class cSoftPlayer : public cPlayer, cThread {
=========================


2) compile error, related to ffmpeg, I think:

=========================
g++ -O2 -Wall -Woverloaded-virtual -c -D_GNU_SOURCE 
-DPLUGIN_NAME_I18N='"softplay"' -I/usr/include/vdr/include 
-I/usr/include -I/usr/include/ffmpeg SoftPlayer.c
SoftPlayer.c: In member function `virtual void cSoftPlayer::Action()':
SoftPlayer.c:173: error: request for member `codec_type' in `
 
this->cSoftPlayer::ic->AVFormatContext::streams[pkt.AVPacket::stream_index]->AVStream::codec
    ', which is of non-class type `AVCodecContext*'
SoftPlayer.c:178: error: request for member `codec_type' in `
 
this->cSoftPlayer::ic->AVFormatContext::streams[pkt.AVPacket::stream_index]->AVStream::codec
    ', which is of non-class type `AVCodecContext*'
SoftPlayer.c:222: error: request for member `codec_id' in `
 
this->cSoftPlayer::ic->AVFormatContext::streams[i]->AVStream::codec', which
    is of non-class type `AVCodecContext*'
SoftPlayer.c: In member function `ePlayMode
    cSoftPlayer::GetPlayMode(AVFormatContext*)':
SoftPlayer.c:248: error: request for member `codec_type' in `
    IC->AVFormatContext::streams[i]->AVStream::codec', which is of non-class
    type `AVCodecContext*'
SoftPlayer.c:250: error: request for member `codec_type' in `
    IC->AVFormatContext::streams[i]->AVStream::codec', which is of non-class
    type `AVCodecContext*'
=========================

I use libav{codec|format} version "0.cvs20050811-2sarge2" from e-tobi's 
repository...

-- 
NH


From malcolm.caldwell at cdu.edu.au  Thu Oct 13 03:19:50 2005
From: malcolm.caldwell at cdu.edu.au (Malcolm Caldwell)
Date: Thu, 13 Oct 2005 10:49:50 +0930
Subject: [Softdevice-devel] directfb g450 field order wrong?
Message-ID: <1129166390.4639.38.camel@localhost.localdomain>

Hello,

I have now setup my new vdr box with a matrox g450 and softdevice via
directfb using tvout.

After a bit of work, things are working reasonably well.   My only real
complaint is that the picture on my tv looks bad.

I am fairly sure that the problem is that the fields are in the wrong
order, ie top first vs bottom first issues.  My assumption is based on
the fact a) scrolling text has artifacts around the boundaries b)
movement especially panning has strange shimmering effects and c) the
effect is not evident when I turn on de-interlacing.

While I can just use de-interlacing, this is not an optimal solution: it
makes the picture less clear and increases the amount of CPU time
required.

Where can I start looking to work out what the problem is?  Is it a
softdevice or a directfb issue?



From malcolm.caldwell at ntu.edu.au  Thu Oct 13 03:10:00 2005
From: malcolm.caldwell at ntu.edu.au (Malcolm Caldwell)
Date: Thu, 13 Oct 2005 10:40:00 +0930
Subject: [Softdevice-devel] directfb g450 field order wrong?
Message-ID: <1129165800.4639.30.camel@localhost.localdomain>

Hello,

I have now setup my new vdr box with a matrox g450 and softdevice via
directfb using tvout.

After a bit of work, things are working reasonably well.   My only real
complaint is that the picture on my tv looks bad.

I am fairly sure that the problem is that the fields are in the wrong
order, ie top first vs bottom first issues.  My assumption is based on
the fact a) scrolling text has artifacts around the boundaries b)
movement especially panning has strange shimmering effects and c) the
effect is not evident when I turn on de-interlacing.

While I can just use de-interlacing, this is not an optimal solution: it
makes the picture less clear and increases the amount of CPU time
required.

Where can I start looking to work out what the problem is?  Is it a
softdevice or a directfb issue?



From stefan at lucke.in-berlin.de  Thu Oct 13 08:36:26 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 13 Oct 2005 08:36:26 +0200
Subject: [Softdevice-devel] directfb g450 field order wrong?
In-Reply-To: <1129165800.4639.30.camel@localhost.localdomain>
References: <1129165800.4639.30.camel@localhost.localdomain>
Message-ID: <1129185386.434e006a0f049@webmail.in-berlin.de>

Quoting Malcolm Caldwell :

> Hello,
>
> I have now setup my new vdr box with a matrox g450 and softdevice via
> directfb using tvout.
>
> After a bit of work, things are working reasonably well.   My only real
> complaint is that the picture on my tv looks bad.
>
> I am fairly sure that the problem is that the fields are in the wrong
> order, ie top first vs bottom first issues.  My assumption is based on
> the fact a) scrolling text has artifacts around the boundaries b)
> movement especially panning has strange shimmering effects and c) the
> effect is not evident when I turn on de-interlacing.

Did you set setup option "Screen Aspect" to 4:3 ?
Whats your softdevice version ?

Stefan Lucke


From stefan at lucke.in-berlin.de  Thu Oct 13 08:45:58 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 13 Oct 2005 08:45:58 +0200
Subject: [Softdevice-devel] softplay Debian packaging : problems related to development
In-Reply-To: <434D8C0F.8060601@e-dition.fr>
References: <434D8C0F.8060601@e-dition.fr>
Message-ID: <1129185958.434e02a66acda@webmail.in-berlin.de>

Quoting Nicolas Huillard:

> Hello,
>
> I'm beginning this packaging, and have the following problems :
>


> 2) compile error, related to ffmpeg, I think:
>
> =========================
> g++ -O2 -Wall -Woverloaded-virtual -c -D_GNU_SOURCE
> -DPLUGIN_NAME_I18N='"softplay"' -I/usr/include/vdr/include
> -I/usr/include -I/usr/include/ffmpeg SoftPlayer.c
> SoftPlayer.c: In member function `virtual void cSoftPlayer::Action()':
> SoftPlayer.c:173: error: request for member `codec_type' in `

Is that with released version 0.0.2 or with cvs. Cvs version has some checks
for ffmpeg, but ... .

Stefan Lucke


From lucianm at users.sourceforge.net  Thu Oct 13 09:16:20 2005
From: lucianm at users.sourceforge.net (Lucian Muresan)
Date: Thu, 13 Oct 2005 09:16:20 +0200
Subject: [Softdevice-devel] directfb g450 field order wrong?
In-Reply-To: <1129166390.4639.38.camel@localhost.localdomain>
References: <1129166390.4639.38.camel@localhost.localdomain>
Message-ID: <434E09C4.9050507@users.sourceforge.net>

Malcolm Caldwell wrote:
> Hello,
> 
> I have now setup my new vdr box with a matrox g450 and softdevice via
> directfb using tvout.
> 
> After a bit of work, things are working reasonably well.   My only real
> complaint is that the picture on my tv looks bad.
> 
> I am fairly sure that the problem is that the fields are in the wrong
> order, ie top first vs bottom first issues.  My assumption is based on
> the fact a) scrolling text has artifacts around the boundaries b)
> movement especially panning has strange shimmering effects and c) the
> effect is not evident when I turn on de-interlacing.
> 
> While I can just use de-interlacing, this is not an optimal solution: it
> makes the picture less clear and increases the amount of CPU time
> required.
> 
> Where can I start looking to work out what the problem is?  Is it a
> softdevice or a directfb issue?

I'd say a settings issue, I had exactly the same problem lately, if the
aspect ratio is not set correctly in the softdevice setup menu, you get
this, it's because of the scaling of the picture to different aspect
ratio than the display's native one (speaking of what DirectFB considers
that to be). I once set 5:4 and thought the images fits better on my 4:3
TV, but after switching back to 4:3 the judder has gone...

Lucian


From nhuillard at e-dition.fr  Thu Oct 13 10:46:13 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 13 Oct 2005 10:46:13 +0200
Subject: [Softdevice-devel] softplay Debian packaging : problems related
 to development
In-Reply-To: <1129185958.434e02a66acda@webmail.in-berlin.de>
References: <434D8C0F.8060601@e-dition.fr> <1129185958.434e02a66acda@webmail.in-berlin.de>
Message-ID: <434E1ED5.2040404@e-dition.fr>

Stefan Lucke a ?crit :
> Quoting Nicolas Huillard:
> 
>>Hello,
>>
>>I'm beginning this packaging, and have the following problems :
> 
>>2) compile error, related to ffmpeg, I think:
>>
>>=========================
>>g++ -O2 -Wall -Woverloaded-virtual -c -D_GNU_SOURCE
>>-DPLUGIN_NAME_I18N='"softplay"' -I/usr/include/vdr/include
>>-I/usr/include -I/usr/include/ffmpeg SoftPlayer.c
>>SoftPlayer.c: In member function `virtual void cSoftPlayer::Action()':
>>SoftPlayer.c:173: error: request for member `codec_type' in `
> 
> 
> Is that with released version 0.0.2 or with cvs. Cvs version has some checks
> for ffmpeg, but ... .

It is strictly version 0.0.2
Maybe it's time for a new release ? Or I'll try CVS, but I can't track
CVS when packaging.

-- 
NH


From malcolm.caldwell at ntu.edu.au  Thu Oct 13 09:51:04 2005
From: malcolm.caldwell at ntu.edu.au (Malcolm Caldwell)
Date: Thu, 13 Oct 2005 17:21:04 +0930
Subject: [Softdevice-devel] directfb g450 field order wrong?
In-Reply-To: <1129185386.434e006a0f049@webmail.in-berlin.de>
References: <1129165800.4639.30.camel@localhost.localdomain>
	 <1129185386.434e006a0f049@webmail.in-berlin.de>
Message-ID: <1129189864.4639.53.camel@localhost.localdomain>

On Thu, 2005-10-13 at 08:36 +0200, Stefan Lucke wrote:
> Quoting Malcolm Caldwell :
> 
> > Hello,
> >
> > I have now setup my new vdr box with a matrox g450 and softdevice via
> > directfb using tvout.
> >
> > After a bit of work, things are working reasonably well.   My only real
> > complaint is that the picture on my tv looks bad.
> >
> > I am fairly sure that the problem is that the fields are in the wrong
> > order, ie top first vs bottom first issues.  My assumption is based on
> > the fact a) scrolling text has artifacts around the boundaries b)
> > movement especially panning has strange shimmering effects and c) the
> > effect is not evident when I turn on de-interlacing.
> 
> Did you set setup option "Screen Aspect" to 4:3 ?

I tried a few different valuse for "Screen Aspect".  I will check this
again and confirm that this is the case.

> Whats your softdevice version ?

CVS from a week ago or so (I would know the date if the power had not
been disconnected at home today!)


> Stefan Lucke
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel



From lucianm at users.sourceforge.net  Thu Oct 13 14:24:23 2005
From: lucianm at users.sourceforge.net (Lucian Muresan)
Date: Thu, 13 Oct 2005 14:24:23 +0200
Subject: [Softdevice-devel] [announce] Gentoo ebuilds for several DirectFB projects, 0.9.22 series
 and current CVS
Message-ID: <434E51F7.4000906@users.sourceforge.net>

Hi folks,

I made up some Gentoo ebuilds for the 0.9.22 series of several DirectFB
projects, including for 0.9.23 which is now in CVS. Some of them of
course, have a different version pattern (DFBTutorials and the released
LiTE, which btw. requests DirectFB-0.9.23 already :-) ). For
linux-fusion I didn't know what other version to use than 0.9.23 as
there is no other way of getting it, than CVS. Btw, Denis & co-devs,
would you mind having a look at the tiny patch I had to do for the
linux-fusion makefile, in order to make it work under gentoo (as the
depmod command is issued automatically ehen emerging kernel module
stuff). Could you accept that one?
http://www.muresan.de/DirectFB/linux-fusion_gentoo-makefile.diff

Now here is the list:
++DFB/
	++DFB-0.9.22.ebuild
	++DFB-0.9.23.ebuild

DFB++/
	DFB++-0.9.22.ebuild
	DFB++-0.9.23.ebuild

DFBTutorials/
	DFBTutorials-0.5.0.ebuild

DirectFB/
	DirectFB-0.9.22.ebuild
	DirectFB-0.9.23.ebuild

DirectFB-examples/
	DirectFB-examples-0.9.22.ebuild
	DirectFB-examples-0.9.23.ebuild

DirectFB-extra/
	DirectFB-extra-0.9.22.ebuild
	DirectFB-extra-0.9.23.ebuild

FusionSound/
	FusionSound-0.9.22.ebuild
	FusionSound-0.9.23.ebuild

LiTE/
	LiTE-0.3.1.ebuild

linux-fusion-cvs/
	linux-fusion-cvs-0.9.23.ebuild
	files/
		linux-fusion_gentoo-makefile.diff


To get the ebuilds, just unpack
http://www.muresan.de/DirectFB/DirectFB_gentoo-ebuilds.tar.bz2 in your
portage overlay folder, and generate digests before attempting to emerge
anything, but please read ahead first.

So if you want to use just 0.9.22 stuff, just mask the 0.9.23 out. If
you're curious and look in the ebuilds themselves, you'll notice that
they're identical. So these ebuilds are able to fetch either the
released versions or from CVS, controlled by the following USE flags
(they're also included in profiles/use.local.desc):

cvs_directfb cvs_dfbpp cvs_ppdfb cvs_dfbfusionsound cvs_dfblite
cvs_dfbextra cvs_dfbexamples cvs_dfbtutorials

The cvs_ flags are independent to allow mixing (you should know what
you're doing, sometimes this only works with equal versions) released
projects with CVS projects.

Further flags: voodoo unique trace extra-warnings ieee-floats accuracy
lite swfdec mpeg3

Please report dependency problems (proposals for the proper library
versions welcome) especially with DirectFB-extra, on which avifile,
libmpeg3 and swfdec failed on my X-less box, Openquicktime is blocked by
libquicktime which I need for transcode, didn't test yet libsvg-cairo,
will try it on my desktop box, but hey, the important thing for mew was
that df_xine is working :-D .


Have phun,
Lucian




From nhuillard at e-dition.fr  Thu Oct 13 15:10:20 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 13 Oct 2005 15:10:20 +0200
Subject: [Softdevice-devel] softdevice / DFB : scaling + OSD transparency
Message-ID: <434E5CBC.8020000@e-dition.fr>

Hello,

I didn't know what was visualy wrong when testing 0.1.3 and 0.2.0 : this
actualy is the fact that the grey background of the OSD is fully
transparent !

Looking at STDERR, I see the following regularly appearing :

...
[dfb] (re)configuring Videolayer to 736 x 576 (720x576)
[dfb] SetParams: action=IDirectFBDisplayLayer::SetLevel(int), result=Not
supported! Failed: SetLevel()
uc_overlay: color-keying is enabled
uc_overlay: color-keying is enabled
uc_overlay: color-keying is enabled
uc_overlay: color-keying is enabled
uc_overlay: color-keying is enabled
[surface capabilities] videoSurface: videoonly double-buffered flipping
[dfb] (re)configured 0x08100609
...


1) "result=Not supported! Failed: SetLevel()"
I use the following DirectfB version, Debian packages from e-tobi, dated
2005-08-03 :

libdirectfb-0.9-22                          0.9.22-5sarge1
libdirectfb-bin                             0.9.22-5sarge1
libdirectfb-dev                             0.9.22-5sarge1
libdirectfb-extra                           0.9.22-5sarge1


2) "736 x 576"
Looking at the code, I wonder why it wants a 736 pixel width, and what
problems may arise from this (the actual resolution is 720x576, and I
have only this one).
Specially since th first reconfigure is 720x576 :

[surface capabilities] videoSurface: videoonly
[dfb] Configuring CooperativeLevel for Overlay
[dfb] Configuring CooperativeLevel for OSD
[dfb] Using this layer for OSD: FBDev Primary Layer
[dfb] Using this layer for Video out: VIA Unichrome Video
[dfb] Display frame time is 19991 microseconds
[dfb] (re)configuring Videolayer to 720 x 576 (720x576)
[dfb] SetParams: action=IDirectFBDisplayLayer::SetLevel(int), result=Not
supported! Failed: SetLevel()
uc_overlay: color-keying is enabled
uc_overlay: color-keying is enabled
uc_overlay: color-keying is enabled
uc_overlay: color-keying is enabled
[surface capabilities] videoSurface: videoonly double-buffered flipping
[dfb] (re)configured 0x08100609

-- 
NH


From lucianm at users.sourceforge.net  Thu Oct 13 14:22:18 2005
From: lucianm at users.sourceforge.net (Lucian Muresan)
Date: Thu, 13 Oct 2005 14:22:18 +0200
Subject: [Softdevice-devel] [announce] Gentoo ebuilds for several DirectFB projects, 0.9.22 series
 and current CVS
Message-ID: <434E517A.4080804@users.sourceforge.net>

Hi folks,

I made up some Gentoo ebuilds for the 0.9.22 series of several DirectFB
projects, including for 0.9.23 which is now in CVS. Some of them of
course, have a different version pattern (DFBTutorials and the released
LiTE, which btw. requests DirectFB-0.9.23 already :-) ). For
linux-fusion I didn't know what other version to use than 0.9.23 as
there is no other way of getting it, than CVS. Btw, Denis & co-devs,
would you mind having a look at the tiny patch I had to do for the
linux-fusion makefile, in order to make it work under gentoo (as the
depmod command is issued automatically ehen emerging kernel module
stuff). Could you accept that one?
http://www.muresan.de/DirectFB/linux-fusion_gentoo-makefile.diff

Now here is the list:
++DFB/
	++DFB-0.9.22.ebuild
	++DFB-0.9.23.ebuild

DFB++/
	DFB++-0.9.22.ebuild
	DFB++-0.9.23.ebuild

DFBTutorials/
	DFBTutorials-0.5.0.ebuild

DirectFB/
	DirectFB-0.9.22.ebuild
	DirectFB-0.9.23.ebuild

DirectFB-examples/
	DirectFB-examples-0.9.22.ebuild
	DirectFB-examples-0.9.23.ebuild

DirectFB-extra/
	DirectFB-extra-0.9.22.ebuild
	DirectFB-extra-0.9.23.ebuild

FusionSound/
	FusionSound-0.9.22.ebuild
	FusionSound-0.9.23.ebuild

LiTE/
	LiTE-0.3.1.ebuild

linux-fusion-cvs/
	linux-fusion-cvs-0.9.23.ebuild
	files/
		linux-fusion_gentoo-makefile.diff


To get the ebuilds, just unpack
http://www.muresan.de/DirectFB/DirectFB_gentoo-ebuilds.tar.bz2 in your
portage overlay folder, and generate digests before attempting to emerge
anything, but please read ahead first.

So if you want to use just 0.9.22 stuff, just mask the 0.9.23 out. If
you're curious and look in the ebuilds themselves, you'll notice that
they're identical. So these ebuilds are able to fetch either the
released versions or from CVS, controlled by the following USE flags
(they're also included in profiles/use.local.desc):

cvs_directfb cvs_dfbpp cvs_ppdfb cvs_dfbfusionsound cvs_dfblite
cvs_dfbextra cvs_dfbexamples cvs_dfbtutorials

The cvs_ flags are independent to allow mixing (you should know what
you're doing, sometimes this only works with equal versions) released
projects with CVS projects.

Further flags: voodoo unique trace extra-warnings ieee-floats accuracy
lite swfdec mpeg3

Please report dependency problems (proposals for the proper library
versions welcome) especially with DirectFB-extra, on which avifile,
libmpeg3 and swfdec failed on my X-less box, Openquicktime is blocked by
libquicktime which I need for transcode, didn't test yet libsvg-cairo,
will try it on my desktop box, but hey, the important thing for mew was
that df_xine is working :-D .


Have phun,
Lucian



From stefan at lucke.in-berlin.de  Thu Oct 13 16:32:01 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 13 Oct 2005 16:32:01 +0200
Subject: [Softdevice-devel] softdevice / DFB : scaling + OSD transparency
In-Reply-To: <434E5CBC.8020000@e-dition.fr>
References: <434E5CBC.8020000@e-dition.fr>
Message-ID: <1129213921.434e6fe136b47@webmail.in-berlin.de>

Quoting Nicolas Huillard:

> Hello,
>
> I didn't know what was visualy wrong when testing 0.1.3 and 0.2.0 : this
> actualy is the fact that the grey background of the OSD is fully
> transparent !
>
> Looking at STDERR, I see the following regularly appearing :

..

> 1) "result=Not supported! Failed: SetLevel()"
> I use the following DirectfB version, Debian packages from e-tobi, dated
> 2005-08-03 :
>
> libdirectfb-0.9-22                          0.9.22-5sarge1

Quite antique version :-) . Directfb micro version is at 23 since 2005-02-28.
Hm, on 2005-02-27 DOK applied a mini patch of me, regarding DLCAPS_LEVELS .
Perhaps it is caused by that.

Stefan Lucke


From nhuillard at e-dition.fr  Thu Oct 13 16:57:03 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 13 Oct 2005 16:57:03 +0200
Subject: [Softdevice-devel] softdevice / DFB : scaling + OSD transparency
In-Reply-To: <1129213921.434e6fe136b47@webmail.in-berlin.de>
References: <434E5CBC.8020000@e-dition.fr> <1129213921.434e6fe136b47@webmail.in-berlin.de>
Message-ID: <434E75BF.1030702@e-dition.fr>

Stefan Lucke a ?crit :
> Quoting Nicolas Huillard:
> 
>>1) "result=Not supported! Failed: SetLevel()"
>>I use the following DirectfB version, Debian packages from e-tobi, dated
>>2005-08-03 :
>>
>>libdirectfb-0.9-22                          0.9.22-5sarge1
> 
> Quite antique version :-) . Directfb micro version is at 23 since 2005-02-28.
> Hm, on 2005-02-27 DOK applied a mini patch of me, regarding DLCAPS_LEVELS .
> Perhaps it is caused by that.

OK. I'll update, one way or the other.
BTW : is the CLE266 patch related to field parity commited into
DirectFB's CVS ?

-- 
NH


From M.Wache at gmx.net  Thu Oct 13 18:49:54 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Thu, 13 Oct 2005 18:49:54 +0200
Subject: [Softdevice-devel] softplay Debian packaging : problems related
 to development
In-Reply-To: <434E1ED5.2040404@e-dition.fr>
References: <434D8C0F.8060601@e-dition.fr> <1129185958.434e02a66acda@webmail.in-berlin.de> <434E1ED5.2040404@e-dition.fr>
Message-ID: <434E9032.4060901@gmx.net>

Nicolas Huillard schrieb:
> Stefan Lucke a ?crit :
> 
>>Quoting Nicolas Huillard:
>>
>>
>>>Hello,
>>>
>>>I'm beginning this packaging, and have the following problems :
>>
>>>2) compile error, related to ffmpeg, I think:
>>>
>>>=========================
>>>g++ -O2 -Wall -Woverloaded-virtual -c -D_GNU_SOURCE
>>>-DPLUGIN_NAME_I18N='"softplay"' -I/usr/include/vdr/include
>>>-I/usr/include -I/usr/include/ffmpeg SoftPlayer.c
>>>SoftPlayer.c: In member function `virtual void cSoftPlayer::Action()':
>>>SoftPlayer.c:173: error: request for member `codec_type' in `
>>
>>
>>Is that with released version 0.0.2 or with cvs. Cvs version has some checks
>>for ffmpeg, but ... .
> 
> 
> It is strictly version 0.0.2
> Maybe it's time for a new release ? Or I'll try CVS, but I can't track
> CVS when packaging.
> 
The compile error is fixed in the CVS, and also the problem with
including softdevice.h will be solved in the next release. I'm now
useing the new "Service" interface in vdr which makes including
softdevice.h obsolete.
Most of my recent changes to softplay are not yet in the CVS, there are
many new features that I've implemented, but some other important
features are still missing. For instance saveing of Playlists is now
possible, but not the opening of saved playlists (at least not from the
osd...)
I'm not sure when I will have the time to finish these features and be
able to release a new version... Maybe I will commit what I finished to
the CVS this weekend, I will have a look at how useable my version is now.

Martin


From malcolm.caldwell at cdu.edu.au  Fri Oct 14 02:41:04 2005
From: malcolm.caldwell at cdu.edu.au (Malcolm Caldwell)
Date: Fri, 14 Oct 2005 10:11:04 +0930
Subject: [Softdevice-devel] directfb g450 field order wrong?
In-Reply-To: <1129189864.4639.53.camel@localhost.localdomain>
References: <1129165800.4639.30.camel@localhost.localdomain>
	 <1129185386.434e006a0f049@webmail.in-berlin.de>
	 <1129189864.4639.53.camel@localhost.localdomain>
Message-ID: <1129250465.4510.4.camel@localhost.localdomain>

On Thu, 2005-10-13 at 17:21 +0930, Malcolm Caldwell wrote:
> On Thu, 2005-10-13 at 08:36 +0200, Stefan Lucke wrote:
> > Quoting Malcolm Caldwell :
> > 
> > > Hello,
> > >
> > > I have now setup my new vdr box with a matrox g450 and softdevice via
> > > directfb using tvout.
> > >
> > > After a bit of work, things are working reasonably well.   My only real
> > > complaint is that the picture on my tv looks bad.
> > >
> > > I am fairly sure that the problem is that the fields are in the wrong
> > > order, ie top first vs bottom first issues.  My assumption is based on
> > > the fact a) scrolling text has artifacts around the boundaries b)
> > > movement especially panning has strange shimmering effects and c) the
> > > effect is not evident when I turn on de-interlacing.
> > 
> > Did you set setup option "Screen Aspect" to 4:3 ?
> 
> I tried a few different valuse for "Screen Aspect".  I will check this
> again and confirm that this is the case.

I have checked - regardless of the setting of "Screen Aspect" I see the
problem.

> > Whats your softdevice version ?
> 
> CVS from a week ago or so (I would know the date if the power had not
> been disconnected at home today!)

And today, and I forgot to check the date last night.

> 
> > Stefan Lucke
> > _______________________________________________
> > Softdevice-devel mailing list
> > Softdevice-devel at lists.berlios.de
> > http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel



From stefan at lucke.in-berlin.de  Fri Oct 14 08:36:52 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 14 Oct 2005 08:36:52 +0200
Subject: [Softdevice-devel] directfb g450 field order wrong?
In-Reply-To: <1129250465.4510.4.camel@localhost.localdomain>
References: <1129165800.4639.30.camel@localhost.localdomain>  <1129185386.434e006a0f049@webmail.in-berlin.de>  <1129189864.4639.53.camel@localhost.localdomain> <1129250465.4510.4.camel@localhost.localdomain>
Message-ID: <1129271812.434f520479094@webmail.in-berlin.de>

Quoting Malcolm Caldwell:

> On Thu, 2005-10-13 at 17:21 +0930, Malcolm Caldwell wrote:
> > On Thu, 2005-10-13 at 08:36 +0200, Stefan Lucke wrote:
> > > Quoting Malcolm Caldwell :
> > >
> > > > Hello,
> > > >
> > > > I have now setup my new vdr box with a matrox g450 and softdevice via
> > > > directfb using tvout.
> > > >
> > > > After a bit of work, things are working reasonably well.   My only real
> > > > complaint is that the picture on my tv looks bad.
> > > >
> > > > I am fairly sure that the problem is that the fields are in the wrong
> > > > order, ie top first vs bottom first issues.  My assumption is based on
> > > > the fact a) scrolling text has artifacts around the boundaries b)
> > > > movement especially panning has strange shimmering effects and c) the
> > > > effect is not evident when I turn on de-interlacing.
> > >
> > > Did you set setup option "Screen Aspect" to 4:3 ?
> >
> > I tried a few different valuse for "Screen Aspect".  I will check this
> > again and confirm that this is the case.
>
> I have checked - regardless of the setting of "Screen Aspect" I see the
> problem.

Can you show us the messages reported in syslog regarding areas
in use ? I'm interested in messages with "aspect changed" ,
"resolution changed" and "[VideoOut]: %dx%d [%d,%d %dx%d] -> %dx%d [%d,%d %dx%d]".

Can you prepare a short clip that shows your viewed effects ? Don't
know if I really need that, but could be next but 2nd step.

You can try changeing the field order in video-dfb.c , by changing
SetFieldParity(0); from 0 to 1 to see if that changes something.

Did you verify that you are using the right connector of your card,
/etc/directfbrc is correct and cable/adaptor is correct ?

>
> > > Whats your softdevice version ?
> >
> > CVS from a week ago or so (I would know the date if the power had not
> > been disconnected at home today!)
>
> And today, and I forgot to check the date last night.

CVS from a week ago should be fine, as there were no changes in that direction.

Stefan Lucke


From malcolm.caldwell at cdu.edu.au  Fri Oct 14 10:03:46 2005
From: malcolm.caldwell at cdu.edu.au (Malcolm Caldwell)
Date: Fri, 14 Oct 2005 17:33:46 +0930
Subject: [Softdevice-devel] directfb g450 field order wrong?
In-Reply-To: <1129271812.434f520479094@webmail.in-berlin.de>
References: <1129165800.4639.30.camel@localhost.localdomain>
	 <1129185386.434e006a0f049@webmail.in-berlin.de>
	 <1129189864.4639.53.camel@localhost.localdomain>
	 <1129250465.4510.4.camel@localhost.localdomain>
	 <1129271812.434f520479094@webmail.in-berlin.de>
Message-ID: <1129277027.4510.40.camel@localhost.localdomain>

On Fri, 2005-10-14 at 08:36 +0200, Stefan Lucke wrote:
> Quoting Malcolm Caldwell:
> 
> > On Thu, 2005-10-13 at 17:21 +0930, Malcolm Caldwell wrote:
> > > On Thu, 2005-10-13 at 08:36 +0200, Stefan Lucke wrote:
> > > > Quoting Malcolm Caldwell :
> > > >
> > > > > Hello,
> > > > >
> > > > > I have now setup my new vdr box with a matrox g450 and softdevice via
> > > > > directfb using tvout.
> > > > >
> > > > > After a bit of work, things are working reasonably well.   My only real
> > > > > complaint is that the picture on my tv looks bad.
> > > > >
> > > > > I am fairly sure that the problem is that the fields are in the wrong
> > > > > order, ie top first vs bottom first issues.  My assumption is based on
> > > > > the fact a) scrolling text has artifacts around the boundaries b)
> > > > > movement especially panning has strange shimmering effects and c) the
> > > > > effect is not evident when I turn on de-interlacing.
> > > >
> > > > Did you set setup option "Screen Aspect" to 4:3 ?
> > >
> > > I tried a few different valuse for "Screen Aspect".  I will check this
> > > again and confirm that this is the case.
> >
> > I have checked - regardless of the setting of "Screen Aspect" I see the
> > problem.
> 
> Can you show us the messages reported in syslog regarding areas
> in use ? I'm interested in messages with "aspect changed" ,
> "resolution changed" and "[VideoOut]: %dx%d [%d,%d %dx%d] -> %dx%d [%d,%d %dx%d]".


Oct 14 17:26:05 guava vdr[6848]: [VideoOut]: resolution changed: W(544 -> 720); H(576 ->576)
Oct 14 17:26:05 guava vdr[6848]: [VideoOut]: aspect changed (0 -> 0 ; 1.333333 -> 1.777778)
Oct 14 17:26:05 guava vdr[6848]: [VideoOut]: 720x576 [0,0 720x576] -> 720x576 [0,85 720x405]

(I am at work and cannot see the OSD so I am not sure what the aspect is set to.  Config files says
softdevice.PixelAspect = 0)

> Can you prepare a short clip that shows your viewed effects ? Don't
> know if I really need that, but could be next but 2nd step.

It will be hard to make a clip: this happens on all my channels, so the
actual video should be fine.  To make a clip I would have to capture the
analogue signal and then digitise it. (Or have I misunderstood?)

> You can try changeing the field order in video-dfb.c , by changing
> SetFieldParity(0); from 0 to 1 to see if that changes something.

OK - I will try that later tonight.

> Did you verify that you are using the right connector of your card,

I am fairly sure I am connected to the second output.

> /etc/directfbrc is correct

I did not find a lot of documentation on what I should use.  A friend
who has this working gave me his config.  This is what I have:

        # layer setup
        #
        system=fbdev
        fbdev=/dev/fb0
        matrox-crtc2
        matrox-tv-standard=pal
        videoram-limit=32768
        depth=32
        mode=720x576
        pixelformat=ARGB
        matrox-cable-type=composite
        primary-layer=2
        capslock-meta
        tmpfs=/dev/shm


>  and cable/adaptor is correct ?

This I have no way to verify, besides un-plugging it and using a
multimeter.

> >
> > > > Whats your softdevice version ?
> > >
> > > CVS from a week ago or so (I would know the date if the power had not
> > > been disconnected at home today!)
> >
> > And today, and I forgot to check the date last night.
> 
> CVS from a week ago should be fine, as there were no changes in that direction.
> 
> Stefan Lucke
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel



From stefan at lucke.in-berlin.de  Fri Oct 14 10:20:09 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 14 Oct 2005 10:20:09 +0200
Subject: [Softdevice-devel] directfb g450 field order wrong?
In-Reply-To: <1129277027.4510.40.camel@localhost.localdomain>
References: <1129165800.4639.30.camel@localhost.localdomain>  <1129185386.434e006a0f049@webmail.in-berlin.de>  <1129189864.4639.53.camel@localhost.localdomain>  <1129250465.4510.4.camel@localhost.localdomain>  <1129271812.434f520479094@webmail.in-berlin.de> <1129277027.4510.40.camel@localhost.localdomain>
Message-ID: <1129278009.434f6a3999d0c@webmail.in-berlin.de>

Quoting Malcolm Caldwell:

> On Fri, 2005-10-14 at 08:36 +0200, Stefan Lucke wrote:
> > Quoting Malcolm Caldwell:
> >
> > > On Thu, 2005-10-13 at 17:21 +0930, Malcolm Caldwell wrote:
> > > > On Thu, 2005-10-13 at 08:36 +0200, Stefan Lucke wrote:
> > > > > Quoting Malcolm Caldwell :
> > > > >
> > > > > > Hello,
> > > > > >
> > > > > > I have now setup my new vdr box with a matrox g450 and softdevice via
> > > > > > directfb using tvout.
> > > > > >
> > > > > > After a bit of work, things are working reasonably well.   My only real
> > > > > > complaint is that the picture on my tv looks bad.
> > > > > >
> > > > > > I am fairly sure that the problem is that the fields are in the wrong
> > > > > > order, ie top first vs bottom first issues.  My assumption is based on
> > > > > > the fact a) scrolling text has artifacts around the boundaries b)
> > > > > > movement especially panning has strange shimmering effects and c) the
> > > > > > effect is not evident when I turn on de-interlacing.
> > > > >
> > > > > Did you set setup option "Screen Aspect" to 4:3 ?
> > > >
> > > > I tried a few different valuse for "Screen Aspect".  I will check this
> > > > again and confirm that this is the case.
> > >
> > > I have checked - regardless of the setting of "Screen Aspect" I see the
> > > problem.
> >
> > Can you show us the messages reported in syslog regarding areas
> > in use ? I'm interested in messages with "aspect changed" ,
> > "resolution changed" and "[VideoOut]: %dx%d [%d,%d %dx%d] -> %dx%d [%d,%d %dx%d]".
>
>
> Oct 14 17:26:05 guava vdr[6848]: [VideoOut]: resolution changed: W(544 -> 720); H(576 ->576)
> Oct 14 17:26:05 guava vdr[6848]: [VideoOut]: aspect changed (0 -> 0 ; 1.333333 -> 1.777778)
> Oct 14 17:26:05 guava vdr[6848]: [VideoOut]: 720x576 [0,0 720x576] -> 720x576 [0,85 720x405]
>
> (I am at work and cannot see the OSD so I am not sure what the aspect is set to.  Config files says
> softdevice.PixelAspect = 0)

If that happens with 16:9 video to be displayed on a 4:3 TV, you may
have a look at:
http://mail.directfb.org/pipermail/directfb-users/2005-October/000770.html

That is still an open issue :-( .

>
> > Can you prepare a short clip that shows your viewed effects ? Don't
> > know if I really need that, but could be next but 2nd step.
>
> It will be hard to make a clip: this happens on all my channels, so the
> actual video should be fine.  To make a clip I would have to capture the
> analogue signal and then digitise it. (Or have I misunderstood?)

I meant a short recording of 2/3 minutes.

>
> > You can try changeing the field order in video-dfb.c , by changing
> > SetFieldParity(0); from 0 to 1 to see if that changes something.
>
> OK - I will try that later tonight.
>
> > Did you verify that you are using the right connector of your card,
>
> I am fairly sure I am connected to the second output.
>
> > /etc/directfbrc is correct
>
> I did not find a lot of documentation on what I should use.  A friend
> who has this working gave me his config.  This is what I have:
>
>         # layer setup
>         #
>         system=fbdev
>         fbdev=/dev/fb0
>         matrox-crtc2
>         matrox-tv-standard=pal
>         videoram-limit=32768
>         depth=32
>         mode=720x576
>         pixelformat=ARGB
>         matrox-cable-type=composite
>         primary-layer=2
>         capslock-meta
>         tmpfs=/dev/shm
>
>

Looks good, but try to comment out system & fbdev, as thats not needed (on my system).

> >  and cable/adaptor is correct ?
>
> This I have no way to verify, besides un-plugging it and using a
> multimeter.

Matrox 4pin s-video+composit adaptor should be ok.

>


Stefan Lucke


From stefan at lucke.in-berlin.de  Fri Oct 14 10:24:47 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 14 Oct 2005 10:24:47 +0200
Subject: [Softdevice-devel] directfb g450 field order wrong?
In-Reply-To: <1129278009.434f6a3999d0c@webmail.in-berlin.de>
References: <1129165800.4639.30.camel@localhost.localdomain>  <1129185386.434e006a0f049@webmail.in-berlin.de>  <1129189864.4639.53.camel@localhost.localdomain>  <1129250465.4510.4.camel@localhost.localdomain>  <1129271812.434f520479094@webmail.in-berlin.de> <1129277027.4510.40.camel@localhost.localdomain> <1129278009.434f6a3999d0c@webmail.in-berlin.de>
Message-ID: <1129278287.434f6b4fdae76@webmail.in-berlin.de>

Quoting Stefan Lucke:

> Quoting Malcolm Caldwell:
>
> > On Fri, 2005-10-14 at 08:36 +0200, Stefan Lucke wrote:
> > > Quoting Malcolm Caldwell:
> > >
> > > > On Thu, 2005-10-13 at 17:21 +0930, Malcolm Caldwell wrote:
> > > > > On Thu, 2005-10-13 at 08:36 +0200, Stefan Lucke wrote:
> > > > > > Quoting Malcolm Caldwell :
> > > > > >
> > > > > > > Hello,
> > > > > > >
> > > > > > > I have now setup my new vdr box with a matrox g450 and softdevice via
> > > > > > > directfb using tvout.
> > > > > > >
> > > > > > > After a bit of work, things are working reasonably well.   My only real
> > > > > > > complaint is that the picture on my tv looks bad.
> > > > > > >
> > > > > > > I am fairly sure that the problem is that the fields are in the wrong
> > > > > > > order, ie top first vs bottom first issues.  My assumption is based on
> > > > > > > the fact a) scrolling text has artifacts around the boundaries b)
> > > > > > > movement especially panning has strange shimmering effects and c) the
> > > > > > > effect is not evident when I turn on de-interlacing.
> > > > > >
> > > > > > Did you set setup option "Screen Aspect" to 4:3 ?
> > > > >
> > > > > I tried a few different valuse for "Screen Aspect".  I will check this
> > > > > again and confirm that this is the case.
> > > >
> > > > I have checked - regardless of the setting of "Screen Aspect" I see the
> > > > problem.
> > >
> > > Can you show us the messages reported in syslog regarding areas
> > > in use ? I'm interested in messages with "aspect changed" ,
> > > "resolution changed" and "[VideoOut]: %dx%d [%d,%d %dx%d] -> %dx%d [%d,%d %dx%d]".
> >
> >
> > Oct 14 17:26:05 guava vdr[6848]: [VideoOut]: resolution changed: W(544 -> 720); H(576 ->576)
> > Oct 14 17:26:05 guava vdr[6848]: [VideoOut]: aspect changed (0 -> 0 ; 1.333333 -> 1.777778)
> > Oct 14 17:26:05 guava vdr[6848]: [VideoOut]: 720x576 [0,0 720x576] -> 720x576 [0,85 720x405]
> >
> > (I am at work and cannot see the OSD so I am not sure what the aspect is set to.  Config files says
> > softdevice.PixelAspect = 0)
>
> If that happens with 16:9 video to be displayed on a 4:3 TV, you may
> have a look at:
> http://mail.directfb.org/pipermail/directfb-users/2005-October/000770.html
>
> That is still an open issue :-( .

And setting cropmode to 4:3 (center cut out) should make a difference.

Stefan Lucke


From stefan at lucke.in-berlin.de  Fri Oct 14 20:20:46 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 14 Oct 2005 20:20:46 +0200
Subject: [Softdevice-devel] very wide aspect ratio
In-Reply-To: <20051011181232.GA121966@kosh.hut.fi>
References: <20050928164622.GB269465@kosh.hut.fi> <200510102137.21180.stefan@lucke.in-berlin.de> <20051011181232.GA121966@kosh.hut.fi>
Message-ID: <200510142020.46346.stefan@lucke.in-berlin.de>

On Dienstag, 11. Oktober 2005 20:12, Marko M?kel? wrote:
> On Mon, Oct 10, 2005 at 09:37:21PM +0200, Stefan Lucke wrote:
> > Reintroducing that calculation would fix that stream (the first of 
> > your example) ;-) . So I've to look at those/this dvd(s) which were 
> > displayed wrong with that calculation.
> 
> It also fixes the second sample, provided that the problematic
> 16:9 commercial is actually sent as 4:3 with black bars at the
> top and bottom.  The following short movie certainly is sent
> in that way.
> 

I reverted that change from cvs. The effect mentioned here

http://lists.berlios.de/pipermail/softdevice-devel/2005q1/000153.html

is not reproducable any more even with very different ffmpeg versions.

-- 
Stefan Lucke



From seppo.ingalsuo at iki.fi  Sat Oct 15 11:56:32 2005
From: seppo.ingalsuo at iki.fi (Seppo Ingalsuo)
Date: Sat, 15 Oct 2005 12:56:32 +0300
Subject: [Softdevice-devel] FFmpeg/softdevice problem
Message-ID: <4350D250.7080000@iki.fi>

Hi,

I tried to upgrade latest ffmpeg CVS because softplay doesn't play Star 
Wreck xvid avi correctly.  It didn't help and I got another problem: 
MPEG-1 layer II audio decoding in softdevice/ffmpeg is now broken. I get 
only strong noise sound for most TV channels. AC3 pass trough works and 
Ogg music plays correctly. Have others seen this problem?

BR,
Seppo



From stefan at lucke.in-berlin.de  Sat Oct 15 12:40:01 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 15 Oct 2005 12:40:01 +0200
Subject: [Softdevice-devel] FFmpeg/softdevice problem
In-Reply-To: <4350D250.7080000@iki.fi>
References: <4350D250.7080000@iki.fi>
Message-ID: <200510151240.01544.stefan@lucke.in-berlin.de>

On Samstag, 15. Oktober 2005 11:56, Seppo Ingalsuo wrote:
> Hi,
> 
> I tried to upgrade latest ffmpeg CVS because softplay doesn't play Star 
> Wreck xvid avi correctly.  It didn't help and I got another problem: 
> MPEG-1 layer II audio decoding in softdevice/ffmpeg is now broken. I get 
> only strong noise sound for most TV channels. AC3 pass trough works and 
> Ogg music plays correctly. Have others seen this problem?

I just can confirm that there is something wrong with ffmpeg current audio
decoding. A fresh checkout from a view minutes ago is just producing
noise, whereas the downsampled AC3 of ZDF still works.

I cannot access ffmpeg / mplayer pages. For checkout I used:
cvs -z3 -d:pserver:anonymous at mplayerhq.hu:/cvsroot/ffmpeg co ffmpeg

My last stable version is from 2005-09-17 .

On noisy channels (almost all) selecting audio from right ch, gives a very deep
slow sound.

-- 
Stefan Lucke



From nhuillard at e-dition.fr  Sat Oct 15 15:53:02 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Sat, 15 Oct 2005 15:53:02 +0200
Subject: [Softdevice-devel] Segfault in softplay CVS 20051014
Message-ID: <435109BE.5000502@e-dition.fr>

Hello,

When closing menu :

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread -1210515328 (LWP 29203)]
0xb7e03e84 in mallopt () from /lib/tls/libc.so.6
(gdb) bt
#0  0xb7e03e84 in mallopt () from /lib/tls/libc.so.6
#1  0xb7e02dcb in free () from /lib/tls/libc.so.6
#2  0xb7f82d13 in operator delete () from /usr/lib/libstdc++.so.5
#3  0xb71b05a7 in cMenuDirectory::~cMenuDirectory ()
   from /usr/lib/vdr/plugins/libvdr-softplay.so.1.3.33
#4  0x080e357f in cOsdMenu::CloseSubMenu (this=0x86b15b8) at osdbase.c:429
#5  0x080e3600 in cOsdMenu::ProcessKey (this=0x86b15b8, Key=kBack) at
osdbase.c:441
#6  0x080d44a8 in cMenuMain::ProcessKey (this=0x86b15b8, Key=kBack) at
menu.c:2584
#7  0x0812bd4b in main (argc=30, argv=0xbffffa14) at vdr.c:973

-- 
NH


From nhuillard at e-dition.fr  Sat Oct 15 15:55:38 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Sat, 15 Oct 2005 15:55:38 +0200
Subject: [Softdevice-devel] playing music ac3 files with softplay :-)
In-Reply-To: <200510091021.54471.stefan@lucke.in-berlin.de>
References: <200510091021.54471.stefan@lucke.in-berlin.de>
Message-ID: <43510A5A.1000609@e-dition.fr>

Stefan Lucke a ?crit :
> just did a test with a music ac3 file. It just plays fine with softdevice + softplay

Confirmed.
My softdevice params are :
	-ao alsa:pcm=default#ac3=spdif#
	-vo dfb:

"spdif" is an alias or link, created in /usr/share/alsa/alsa.conf :
	pcm.spdif cards.pcm.iec958

Easier to guess than hw:0,1

-- 
NH


From nhuillard at e-dition.fr  Sat Oct 15 16:23:19 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Sat, 15 Oct 2005 16:23:19 +0200
Subject: [Softdevice-devel] softdevice AC3 with DVD
Message-ID: <435110D7.5020301@e-dition.fr>

Hello,

Since my only regular source of AC3 content is DVD's, I tested that, and
it appears that there are lots of "white" in the sound output : every 15
or 30 seconds (not regular), the receiver kind of looses sync, and
outputs no sound. The sound reappears in much less than a second. The
"whites" are just long enough to miss a few words.
I didn't test on live TV (I don't know where to get AC3 on DVB), nor
recording (same reason).

dvd 0.3.5.2+0.3.6b03-9
softdevice 0.2.0
vdr 1.3.33

-- 
NH


From nhuillard at e-dition.fr  Sat Oct 15 16:30:37 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Sat, 15 Oct 2005 16:30:37 +0200
Subject: [Softdevice-devel] Softplay-ing PCM on S/PDIF or analog out
Message-ID: <4351128D.8080306@e-dition.fr>

Hello again,

Changing the -ao softdevice param allow to output audio either on stereo
analog out or S/PDIF :

* analog : -ao alsa:pcm=default#ac3=spdif#
* digital : -ao alsa:pcm=spdif#ac3=spdif#

When playing audio with softplay on digital-out, the audio play 1 minute
of audio in 56 seconds : that's nearly 10% faster, really audible (not
pitch, but rather tempo is clearly faster).
Tried with OGG files played with softplay.
Live TV is OK, recordings unknown.

BTW : the # separator you chose is a comment sign in many languages, and
appear to comment-out the -ao ac3 part when using Debian plugin params
files. Can you change the "#" into "," (good) or ";" (may be the same
problem), or do I have to change the exclude regexp in Debian vdr package ?

-- 
NH


From stefan at lucke.in-berlin.de  Sat Oct 15 17:39:14 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 15 Oct 2005 17:39:14 +0200
Subject: [Softdevice-devel] FFmpeg/softdevice problem
In-Reply-To: <4350D250.7080000@iki.fi>
References: <4350D250.7080000@iki.fi>
Message-ID: <200510151739.14976.stefan@lucke.in-berlin.de>

On Samstag, 15. Oktober 2005 11:56, Seppo Ingalsuo wrote:
> Hi,
> 
> I tried to upgrade latest ffmpeg CVS because softplay doesn't play Star 
> Wreck xvid avi correctly.  It didn't help and I got another problem: 
> MPEG-1 layer II audio decoding in softdevice/ffmpeg is now broken. I get 
> only strong noise sound for most TV channels. AC3 pass trough works and 
> Ogg music plays correctly. Have others seen this problem?

You can work around this by specifying "--disable-mpegaudio-hp" for
ffmpeg configure script (untested).

or use the attached patch:

-- 
Stefan Lucke
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ffmpeg_audio_fix.diff
Type: text/x-diff
Size: 851 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051015/30d10533/attachment.diff>

From seppo.ingalsuo at iki.fi  Sat Oct 15 19:57:35 2005
From: seppo.ingalsuo at iki.fi (Seppo Ingalsuo)
Date: Sat, 15 Oct 2005 20:57:35 +0300
Subject: [Softdevice-devel] FFmpeg/softdevice problem
In-Reply-To: <200510151739.14976.stefan@lucke.in-berlin.de>
References: <4350D250.7080000@iki.fi> <200510151739.14976.stefan@lucke.in-berlin.de>
Message-ID: <4351430F.1080704@iki.fi>

Stefan Lucke wrote:

>>MPEG-1 layer II audio decoding in softdevice/ffmpeg is now broken. I get 
>>only strong noise sound for most TV channels. 
>>    
>>
>
>You can work around this by specifying "--disable-mpegaudio-hp" for
>ffmpeg configure script (untested).
>  
>
That works, thanks!

Seppo



From stefan at lucke.in-berlin.de  Sat Oct 15 21:04:52 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 15 Oct 2005 21:04:52 +0200
Subject: [Softdevice-devel] Softplay-ing PCM on S/PDIF or analog out
In-Reply-To: <4351128D.8080306@e-dition.fr>
References: <4351128D.8080306@e-dition.fr>
Message-ID: <200510152104.52706.stefan@lucke.in-berlin.de>

On Samstag, 15. Oktober 2005 16:30, Nicolas Huillard wrote:
> Hello again,
> 
> Changing the -ao softdevice param allow to output audio either on stereo
> analog out or S/PDIF :
> 
> * analog : -ao alsa:pcm=default#ac3=spdif#
> * digital : -ao alsa:pcm=spdif#ac3=spdif#
> 
> When playing audio with softplay on digital-out, the audio play 1 minute
> of audio in 56 seconds : that's nearly 10% faster, really audible (not
> pitch, but rather tempo is clearly faster).
> Tried with OGG files played with softplay.

Are they with 44100 Hz sampled and your audio device plays out 
48000Hz only ?

> Live TV is OK, recordings unknown.
> 
> BTW : the # separator you chose is a comment sign in many languages, and
> appear to comment-out the -ao ac3 part when using Debian plugin params
> files. Can you change the "#" into "," (good) or ";" (may be the same
> problem), or do I have to change the exclude regexp in Debian vdr package ?

',' is bad either as it could be part of the device name "hw:0,0".
Oh, we get low single specials chars. I'll think of it. Some quoting or
something like [pcm|ac3]=(name[,card,device]) .

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Sat Oct 15 22:55:40 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 15 Oct 2005 22:55:40 +0200
Subject: [Softdevice-devel] FFmpeg/softdevice problem
In-Reply-To: <4351430F.1080704@iki.fi>
References: <4350D250.7080000@iki.fi> <200510151739.14976.stefan@lucke.in-berlin.de> <4351430F.1080704@iki.fi>
Message-ID: <200510152255.40409.stefan@lucke.in-berlin.de>

On Samstag, 15. Oktober 2005 19:57, Seppo Ingalsuo wrote:
> Stefan Lucke wrote:
> 
> >>MPEG-1 layer II audio decoding in softdevice/ffmpeg is now broken. I get 
> >>only strong noise sound for most TV channels. 
> >>    
> >>
> >
> >You can work around this by specifying "--disable-mpegaudio-hp" for
> >ffmpeg configure script (untested).
> >  
> >
> That works, thanks!

For the record: from ffmpeg's cvs changelog it looks like the change which
caused trouble has been reverted.

RCS file: /cvsroot/ffmpeg/ffmpeg/libavcodec/mpegaudiodec.c,v
Working file: mpegaudiodec.c
head: 1.61
branch:
locks: strict
access list:
symbolic names:
        release_0_4_9_pre1: 1.39
        release_0_4_8: 1.31
        release_0_4_7: 1.28
        release_0_4_6: 1.21
        version_0_4_5_pre: 1.1.1.1
        ffmpeg: 1.1.1
keyword substitution: kv
total revisions: 62;    selected revisions: 62
description:
----------------------------
revision 1.61
date: 2005/10/15 16:29:58;  author: rtognimp;  state: Exp;  lines: +2 -2
Reverse patch 1.59->1.60, it break mp3 in ffplay and ffmpeg
Reversing approved by patch author
----------------------------
revision 1.60
date: 2005/10/12 22:37:42;  author: alex;  state: Exp;  lines: +2 -2
removed unused CONFIG_AUDIO_NONSHORT
----------------------------

> 
> Seppo
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 

-- 
Stefan Lucke



From nhuillard at e-dition.fr  Sun Oct 16 00:56:09 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Sun, 16 Oct 2005 00:56:09 +0200
Subject: [Softdevice-devel] Softplay-ing PCM on S/PDIF or analog out
In-Reply-To: <200510152104.52706.stefan@lucke.in-berlin.de>
References: <4351128D.8080306@e-dition.fr> <200510152104.52706.stefan@lucke.in-berlin.de>
Message-ID: <43518909.9030309@e-dition.fr>

Stefan Lucke a ?crit :
> On Samstag, 15. Oktober 2005 16:30, Nicolas Huillard wrote:
> 
>>Changing the -ao softdevice param allow to output audio either on stereo
>>analog out or S/PDIF :
>>
>>* analog : -ao alsa:pcm=default#ac3=spdif#
>>* digital : -ao alsa:pcm=spdif#ac3=spdif#
>>
>>When playing audio with softplay on digital-out, the audio play 1 minute
>>of audio in 56 seconds : that's nearly 10% faster, really audible (not
>>pitch, but rather tempo is clearly faster).
>>Tried with OGG files played with softplay.
> 
> Are they with 44100 Hz sampled and your audio device plays out 
> 48000Hz only ?

Yes, the file is 44.1kHz :

nhuillard at vdr:nhuillard$ file 01\ -\ Dancing\ Queen.ogg
01 - Dancing Queen.ogg: Ogg data, Vorbis audio, stereo, 44100 Hz,
~192003 bps, created by: Xiph.Org libVorbis I (1.0)

I don't know what the device is capable of (EPIA M10k), but the audio
plays well when using analog audio out (-ao alsa:pcm=default) and faster
when using digital audio out (-ao alsa:pcm=spdif).

And then again : thank you very much for the great software you built,
and every effort you make in supporting it !
The addition of AC3 out is a great thing !

-- 
NH


From stefan at lucke.in-berlin.de  Sun Oct 16 07:31:11 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 16 Oct 2005 07:31:11 +0200
Subject: [Softdevice-devel] Softplay-ing PCM on S/PDIF or analog out
In-Reply-To: <43518909.9030309@e-dition.fr>
References: <4351128D.8080306@e-dition.fr> <200510152104.52706.stefan@lucke.in-berlin.de> <43518909.9030309@e-dition.fr>
Message-ID: <200510160731.11256.stefan@lucke.in-berlin.de>

On Sonntag, 16. Oktober 2005 00:56, Nicolas Huillard wrote:
> Stefan Lucke a ?crit :
> > On Samstag, 15. Oktober 2005 16:30, Nicolas Huillard wrote:
> > 
> >>Changing the -ao softdevice param allow to output audio either on stereo
> >>analog out or S/PDIF :
> >>
> >>* analog : -ao alsa:pcm=default#ac3=spdif#
> >>* digital : -ao alsa:pcm=spdif#ac3=spdif#
> >>
> >>When playing audio with softplay on digital-out, the audio play 1 minute
> >>of audio in 56 seconds : that's nearly 10% faster, really audible (not
> >>pitch, but rather tempo is clearly faster).
> >>Tried with OGG files played with softplay.
> > 
> > Are they with 44100 Hz sampled and your audio device plays out 
> > 48000Hz only ?
> 
> Yes, the file is 44.1kHz :
> 
> nhuillard at vdr:nhuillard$ file 01\ -\ Dancing\ Queen.ogg
> 01 - Dancing Queen.ogg: Ogg data, Vorbis audio, stereo, 44100 Hz,
> ~192003 bps, created by: Xiph.Org libVorbis I (1.0)
> 
> I don't know what the device is capable of (EPIA M10k), but the audio
> plays well when using analog audio out (-ao alsa:pcm=default) and faster
> when using digital audio out (-ao alsa:pcm=spdif).

Epia ia a hard work,  and after googleing a bit I found:

1st tried google with "AC97-SPSA" ( thats control.42 in your asound.state)

2nd I tried google with "dxs_support" and found that interesting link:
http://www.issociate.de/board/goto/749819/via82xx_driver:_reporting_dxs_support_experience.html#msg_749819


-- 
Stefan Lucke



From seppo.ingalsuo at iki.fi  Sun Oct 16 12:09:15 2005
From: seppo.ingalsuo at iki.fi (Seppo Ingalsuo)
Date: Sun, 16 Oct 2005 13:09:15 +0300
Subject: [Softdevice-devel] Softdevice and image viewing with muggle or mp3 plugins
Message-ID: <435226CB.7060905@iki.fi>

Hi,

Softdevice is in very good shape nowadays so here is one much smaller 
matter :^) Image viewing for e.g. CD cover art works with vdr-xine but 
not with softdevice (dxr3 fails as well). Has someone studied why the 
images are not shown and music playback fails if that feature is enabled 
in the plugin?

Seppo



From seppo.ingalsuo at iki.fi  Sun Oct 16 18:05:07 2005
From: seppo.ingalsuo at iki.fi (Seppo Ingalsuo)
Date: Sun, 16 Oct 2005 19:05:07 +0300
Subject: [Softdevice-devel] Softplay and Star Wreck AVI
Message-ID: <43527A33.7010003@iki.fi>

Hi,

Softplay doesn't play properly the Star Wreck avi. The offical torrents 
are available at the film's web site but I extracted with mencoder (-oac 
copy -ovc copy) a one minute clip where the problems first show up.  
I'll keep it some time here:

http://personal.inet.fi/koti/seppo.ingalsuo/files/star_wreck_in_the_pirkinning_subtitled_xvid_sample.avi

The effect looks a bit similar to the music video avi which I reported 
some months ago but perhaps it is not this time related to unknown frame 
rate assumptions. There are very large block artefacts in moving objects 
and several frames are skipped. Mplayer plays it correctly:

---

Playing star_wreck_in_the_pirkinning_subtitled_xvid_sample.avi.
AVI file format detected.
VIDEO:  [XVID]  640x272  24bpp  25.000 fps  630.5 kbps (77.0 kbyte/s)
Clip info:
 Software: MEncoder 1.0pre5-3.3.4
==========================================================================
Opening audio decoder: [mp3lib] MPEG layer-2, layer-3
MP3lib: init layer2&3 finished, tables done
AUDIO: 48000 Hz, 2 ch, 16 bit (0x10), ratio: 16000->192000 (128.0 kbit)
Selected audio codec: [mp3] afm:mp3lib (mp3lib MPEG layer-2, layer-3)
==========================================================================
vo: X11 running at 1152x864 with depth 24 and 32 bpp (":0.0" => local 
display)
Disabling DPMS
==========================================================================
Opening video decoder: [ffmpeg] FFmpeg's libavcodec codec family
Selected video codec: [ffodivx] vfm:ffmpeg (FFmpeg MPEG-4)
==========================================================================
Checking audio filter chain for 48000Hz/2ch/16bit -> 48000Hz/2ch/16bit...
AF_pre: af format: 2 bps, 2 ch, 48000 hz, little endian signed int
AF_pre: 48000Hz 2ch Signed 16-bit (Little-Endian)
AO: [oss] 48000Hz 2ch Signed 16-bit (Little-Endian) (2 bps)
Building audio filter chain for 48000Hz/2ch/16bit -> 48000Hz/2ch/16bit...
Starting playback...
VDec: vo config request - 640 x 272 (preferred csp: Planar YV12)
VDec: using Planar YV12 as output csp (no 0)
Movie-Aspect is 2.35:1 - prescaling to correct movie aspect.
VO: [xv] 640x272 => 640x272 Planar YV12

---

BR,
Seppo



From stefan at lucke.in-berlin.de  Sun Oct 16 19:27:42 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 16 Oct 2005 19:27:42 +0200
Subject: [Softdevice-devel] Rescaling for a large LCD TV
In-Reply-To: <20051016125820.GA10535@seneca.muc.de>
References: <20051016125820.GA10535@seneca.muc.de>
Message-ID: <200510161927.42272.stefan@lucke.in-berlin.de>

On Sonntag, 16. Oktober 2005 14:58, Harald Milz wrote:
> Hi,
> 
> I recently got a 1366x768 LCD TV and will do some softdevice tests this
> afternoon (with a Matrox G55 DVI out w/ matroxfb).
> 
> Question. The TV set (BenQ DV3250) offers various rescaling modes. Standard
> 720x576 PAL is usually rescaled to fill the screen vertically while
> keeping an aspect ratio of 4:3.

But it should have a mode where it fills the entire screen with the
720x576 source. Thats what my 7" mini LCD does. In that mode, I set
monitor aspect to 16:9 and softdevice scales 4:3 aspect horizontally.

> The set also offers a letterbox mode which
> could be ideal for letterbox movies that are normally padded with black
> stripes above and below the normal image. Unfortunately the TV set does not
> keep a proper aspect ration when switching to letterbox mode, it looks to
> wide. It should scale vertically with a larger factor. 

Sometimes they do really strange things with movies. Thats why I
refused to buy one. Hopfully industry will offer LCD-TVs which support
our 50Hz (field-rate) PAL system. Up to now I've only seen LCDs which
are made for US/Japan 60Hz NTSC system. And don't trust anyone who
tells you something about some sophisticated pull-down/up techniques their
super LCD offers. Such technical play effects are _not_ required if they
would support our TV system.

> 
> Mathematically, one could scale 720 horizontal pixels to 1360 (an integer
> multiple of 8) with a factor of ~ 1.89. The 576 vertical pixels would
> then be rescaled to 1088 pixels.  So we would need to clip 160 pixels
> top and bottom, getting 1360x768 effectively (16:9). 

I guess you should just select 16:9 as display aspect via our OSD and
drive display in it's native 1366x768 mode.

Hm, I guess I should reintroduce OSD centering in all modes.

> 
> Question is: is that doable, and do I want to do that? Can / should
> softdevice do something like that? Or is that DFB's job? 

We have to set the correct parameters for scaling.

If there are problems, let us know which are actual scaling paramters.
They are reported via syslog.

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Sun Oct 16 21:32:45 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 16 Oct 2005 21:32:45 +0200
Subject: [Softdevice-devel] Rescaling for a large LCD TV
In-Reply-To: <20051016180718.GA11960@seneca.muc.de>
References: <20051016125820.GA10535@seneca.muc.de> <200510161927.42272.stefan@lucke.in-berlin.de> <20051016180718.GA11960@seneca.muc.de>
Message-ID: <200510162132.45965.stefan@lucke.in-berlin.de>

On Sonntag, 16. Oktober 2005 20:07, Harald Milz wrote:
> Hi Stefan,
> 
> On Sun, Oct 16, 2005 at 07:27:42PM +0200, Stefan Lucke wrote:
> > On Sonntag, 16. Oktober 2005 14:58, Harald Milz wrote:
> > > Question. The TV set (BenQ DV3250) offers various rescaling modes. Standard
> > > 720x576 PAL is usually rescaled to fill the screen vertically while
> > > keeping an aspect ratio of 4:3.
> > 
> > But it should have a mode where it fills the entire screen with the
> > 720x576 source. Thats what my 7" mini LCD does. In that mode, I set
> > monitor aspect to 16:9 and softdevice scales 4:3 aspect horizontally.
> 
> Yes it does. Normal 720x576 persons are real eggheads then ;-) 

Looks like a bug. It should be able to display anamorphic PAL which
is found on DVDs. Test that with an ordinary DVD player and set output
format to 16:9.

> 
> > If there are problems, let us know which are actual scaling paramters.
> > They are reported via syslog.
> 
> Did some tests with softdevice over DVI this afternoon. The card is a
> Matrox G550 w/ DVI on 1 and VGA on 2. The TV set accepts only DVI-D so
> I got a 24-pin dual channel cable. The Linux console comes up just fine,
> and I can set the display for 576p or 720p just fine. But there must be
> something wrong with my DFB settings.
> 
..
> /etc/fb.modes: 
> 
> # HDTV 1280x720-50 for LCD projector
> # 50 Hz
> mode "1280x720-50"
>    # D: 61.80 MHz, H: 37.50 kHz, V: 50.00 Hz
>    geometry 1280 720 1280 720 32
>    timings 16181 218 110 20 5 40 5
> endmode
> 
> # 60 Hz
> mode "1280x720-60"
>    # D: 74.25 MHz, H: 45.00 kHz, V: 60.00 Hz
>    geometry 1280 720 1280 720 16
>    timings 13468 220 110 20 5 40 5
> endmode
> 
> mode "720x576-50"
>     geometry 720 576 720 576 16
>     timings 35714 32 8 46 0 136 3
> endmode
> 
> 
> /etc/directfbrc:
> 
> mode=1280x720
> depth=32
> pixelformat=ARGB
> 
> or
> 
> mode=720x576
> depth=32
> pixelformat=ARGB
> 
> 
> No video is displayed in either resolution. There _is_ some output
> otherwise the TV set would display "Searching (DVI)" in the
> lower right corner. But the screen remains dark.

It just doesn't display "I do not support 50Hz, please give 60Hz" .
Change the sequence of 50Hz and 60Hz in /etc/fb.modes, so that
60 Hz is selected.


> [dfb] Using this layer for OSD: FBDev Primary Layer
> [dfb] Using this layer for Video out: Matrox Backend Scaler
> [dfb] Display frame time is 19960 microseconds

Thats a 50Hz mode 19960us. Choose a 60Hz one :-) .

..

> (... means unrelated stuff like channel scanning deleted)
> 
> Why does it select FBDev for OSD and Matrox BES for video? Is that a
> problem?

I guess no. You may choose YUY2 and stretchbilt = yes for getting the
OSD in alpha blend mode.

> [dfb] Display frame time is 19983 microseconds
> [dfb] (re)configuring Videolayer to 720 x 576 (720x576)

50 vs 60 Hz.

> 
> WRT AC3: how can I tell softdevice to send all sound over spdif? Just "-ao
> alsa:spdif"? This is where my DD receiver is attached to. 

-ao alsa:ac3=spdif#

if your sound conf has the corresponding alias. For my system I had to
-ao alsa:pcm=default#ac3=hw:0,1#

> 
> BTW. the BenQ LCD TV has one nice feature: it can display picture by
> picture of all active inputs, e.g. the Linux console over DVI and the VDR
> over composite. Very handy. 
>  
> -- 
> Tact, n.:
> 	The unsaid part of what you're thinking.

-- 
Stefan Lucke



From torgeir at pobox.com  Mon Oct 17 00:19:49 2005
From: torgeir at pobox.com (Torgeir Veimo)
Date: Mon, 17 Oct 2005 08:19:49 +1000
Subject: [Softdevice-devel] FYI: New unichrome.sf.net code
Message-ID: <1129501189.3078.0.camel@localhost.localdomain>

http://www.livejournal.com/users/libv/2105.html

-- 
Torgeir Veimo <torgeir at pobox.com>



From malcolm.caldwell at cdu.edu.au  Mon Oct 17 08:27:31 2005
From: malcolm.caldwell at cdu.edu.au (Malcolm Caldwell)
Date: Mon, 17 Oct 2005 15:57:31 +0930
Subject: [Softdevice-devel] bad display after pause
Message-ID: <1129530452.16067.6.camel@localhost.localdomain>

Hello,

I am running softdevice using directfb on a g450 with tv-out.

When I pause a recording and then start playback again the video is bad.
It would seem that half or more of the frames are not displayed.

If I hit exit, and then restart the recording everything works fine.

Also, if I go into the menus and change the crop mode the same problem
occurs.

This is only while replaying recordings.

softdevice and directfb are from cvs.



From stefan at lucke.in-berlin.de  Mon Oct 17 21:13:26 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Mon, 17 Oct 2005 21:13:26 +0200
Subject: [Softdevice-devel] Rescaling for a large LCD TV
In-Reply-To: <20051016180718.GA11960@seneca.muc.de>
References: <20051016125820.GA10535@seneca.muc.de> <200510161927.42272.stefan@lucke.in-berlin.de> <20051016180718.GA11960@seneca.muc.de>
Message-ID: <200510172113.26602.stefan@lucke.in-berlin.de>

On Sonntag, 16. Oktober 2005 20:07, Harald Milz wrote:
> Hi Stefan,
> 
> On Sun, Oct 16, 2005 at 07:27:42PM +0200, Stefan Lucke wrote:
> > On Sonntag, 16. Oktober 2005 14:58, Harald Milz wrote:
> > > Question. The TV set (BenQ DV3250) offers various rescaling modes. Standard
> > > 720x576 PAL is usually rescaled to fill the screen vertically while
> > > keeping an aspect ratio of 4:3.
> > 
> > But it should have a mode where it fills the entire screen with the
> > 720x576 source. Thats what my 7" mini LCD does. In that mode, I set
> > monitor aspect to 16:9 and softdevice scales 4:3 aspect horizontally.
> 
> Yes it does. Normal 720x576 persons are real eggheads then ;-) 
> 
> > If there are problems, let us know which are actual scaling paramters.
> > They are reported via syslog.
> 
> Did some tests with softdevice over DVI this afternoon. The card is a
> Matrox G550 w/ DVI on 1 and VGA on 2. The TV set accepts only DVI-D so
> I got a 24-pin dual channel cable. The Linux console comes up just fine,
> and I can set the display for 576p or 720p just fine. But there must be
> something wrong with my DFB settings.
> 
> HW/SW: 
> vdr-1.3.26
> softdevice-0.2.0
> DirectFB-0.9.22
> DFB++-0.9.22
> ffmpeg-0.4.8 (--enable-a52 --disable-ffserver --disable-ffplay
>               --enable-a52bin --disable-mmx --enable-pp --enable-shared)
> 
> SUSE 9.3 DVB modules with Werner's dvb-ttpci-01.fw-261d-patched
> rev. 1.3 FF card
> FSC Activy budget card
> Matrox Graphics, Inc. MGA G550 AGP (rev 01) (102b:2527)
> 
> 
> /etc/fb.modes: 
> 
> # HDTV 1280x720-50 for LCD projector
> # 50 Hz
> mode "1280x720-50"
>    # D: 61.80 MHz, H: 37.50 kHz, V: 50.00 Hz
>    geometry 1280 720 1280 720 32
>    timings 16181 218 110 20 5 40 5
> endmode
> 
> # 60 Hz
> mode "1280x720-60"
>    # D: 74.25 MHz, H: 45.00 kHz, V: 60.00 Hz
>    geometry 1280 720 1280 720 16
>    timings 13468 220 110 20 5 40 5
> endmode
> 
> mode "720x576-50"
>     geometry 720 576 720 576 16
>     timings 35714 32 8 46 0 136 3
> endmode

After having a look at the user manual, the BenQ devices are rather
limited in possible display resolutions. They mention only very few
resolutions for graphic input. the largest is 1024x768 :-( . All of
mentioned resolution have refresh rates >= 60 Hz .


From nhuillard at e-dition.fr  Mon Oct 17 22:56:31 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Mon, 17 Oct 2005 22:56:31 +0200
Subject: [Softdevice-devel] Softplay-ing PCM on S/PDIF or analog out
In-Reply-To: <200510160731.11256.stefan@lucke.in-berlin.de>
References: <4351128D.8080306@e-dition.fr> <200510152104.52706.stefan@lucke.in-berlin.de> <43518909.9030309@e-dition.fr> <200510160731.11256.stefan@lucke.in-berlin.de>
Message-ID: <43540FFF.6090309@e-dition.fr>

Stefan Lucke a ?crit :
> Epia ia a hard work,  and after googleing a bit I found:

Yes.Thanks for your help.

> 1st tried google with "AC97-SPSA" ( thats control.42 in your asound.state)

I had this value set to 3 instead of 0 :

0. PCM1
1. PCM2,PCM1 (rear)
2. Centre and LFE
3. PCM3,Modem,Dedicated S/PDIF

amixer set 'IEC958 Playback AC97-SPSA' 0

See http://alsa.opensrc.org/index.php?page=via8233 or 
http://www.epiawiki.org/wiki/tiki-index.php?page=EpiaSound

> 2nd I tried google with "dxs_support" and found that interesting link:
> http://www.issociate.de/board/goto/749819/via82xx_driver:_reporting_dxs_support_experience.html#msg_749819

Then it appears to be better with dxs_support=4
Since unloading + reloading modules + setting mixer setting + playing a 
file with alsaplayer doesn't always play right (not reproducible in my 
box), I'm not sure whether dxs_support=0 is not good either.

I changed /etc/modutils/alsa the run update-modules (Debian).

According to the web pages above :

#  0 - the default value; set 48000 Hz only mode in most cases, except 
on some known motherboards (which are in the whitelist).
# 1 - enable full DXS support (at any supported sample rate).
# 2 - disable DXS support completely. In this case the hardware mixing 
ability of the chip is not used.
# 3 - use DXS at 48000 Hz only.
# 4 - enable DXS at any supported sample rate, but always set the codec 
to 48000 Hz (apparently on some motherboards this works better than 
dxs_support=1).

My softdevice config is then :

-ao alsa:pcm=default#ac3=spdif#
-vo dfb:

Setting 'IEC958 Playback AC97-SPSA' to 0 allows to get PCM sound both 
through analog and SPDIF. With 3, using pcm=spdif only get audio through 
SPDIF (no analog).

-- 
NH


From nhuillard at e-dition.fr  Mon Oct 17 23:08:45 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Mon, 17 Oct 2005 23:08:45 +0200
Subject: [Softdevice-devel] softdevice AC3 with DVD
In-Reply-To: <435110D7.5020301@e-dition.fr>
References: <435110D7.5020301@e-dition.fr>
Message-ID: <435412DD.90104@e-dition.fr>

I thought this problem could have been solved by the 44.1 vs 48 kHz PCM 
setup (thread "[Softdevice-devel] Softplay-ing PCM on S/PDIF or analog 
out"), but it's not.

Nicolas Huillard a ?crit :
> Since my only regular source of AC3 content is DVD's, I tested that, and
> it appears that there are lots of "white" in the sound output : every 15
> or 30 seconds (not regular), the receiver kind of looses sync, and
> outputs no sound. The sound reappears in much less than a second. The
> "whites" are just long enough to miss a few words.

Re-reading a DVD gives better figures : "whites" are really short, just 
a blink of the receiver LED.
"Whites" occur at random times, mainly when there is action on the 
video. CPU is less the 30% idle (1GHz) when drops occur, and system load 
is between 1.5 and 2.0 : there seems to be contentions between threads 
somewhere.

> I didn't test on live TV (I don't know where to get AC3 on DVB), nor
> recording (same reason).
> 
> dvd 0.3.5.2+0.3.6b03-9
> softdevice 0.2.0
> vdr 1.3.33

-- 
NH


From stefan at lucke.in-berlin.de  Thu Oct 20 23:29:55 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 20 Oct 2005 23:29:55 +0200
Subject: [Softdevice-devel] Softplay and Star Wreck AVI
In-Reply-To: <43527A33.7010003@iki.fi>
References: <43527A33.7010003@iki.fi>
Message-ID: <200510202329.55969.stefan@lucke.in-berlin.de>

On Sonntag, 16. Oktober 2005 18:05, Seppo Ingalsuo wrote:
> Hi,
> 
> Softplay doesn't play properly the Star Wreck avi. The offical torrents 
> are available at the film's web site but I extracted with mencoder (-oac 
> copy -ovc copy) a one minute clip where the problems first show up.  
> I'll keep it some time here:

I guess thats an ffmpeg issue. I could workaround that for this avi,
but I cannot change that (now) as it would break all other video
decoding. For a test you #if 0 .. #endif lines 274 .. 276 in
softdevice mpeg2decoder.c .

> 
> http://personal.inet.fi/koti/seppo.ingalsuo/files/star_wreck_in_the_pirkinning_subtitled_xvid_sample.avi

Got the full version.


-- 
Stefan Lucke



From malcolm.caldwell at cdu.edu.au  Fri Oct 21 17:10:08 2005
From: malcolm.caldwell at cdu.edu.au (Malcolm Caldwell)
Date: Sat, 22 Oct 2005 00:40:08 +0930
Subject: [Fwd: [Softdevice-devel] bad display after pause]
Message-ID: <1129907408.5940.3.camel@localhost.localdomain>

I am resending this just in case the original did not get through (we
had a spam bot problem at work and got blacklisited...)

I still see this problem.  Recordings will play back fine for quite a
while, and then something happens (often associated with using the OSD)
and the playback breaks.  By break I mean that from then on I only see
every second field (or something like that).  To fix it I must restart
the playback.

Any ideas?

-------- Forwarded Message --------
From: Malcolm Caldwell <malcolm.caldwell at cdu.edu.au>
Reply-To: softdevice-devel at berlios.de
To: softdevice-devel at berlios.de
Subject: [Softdevice-devel] bad display after pause
Date: Mon, 17 Oct 2005 15:57:31 +0930

Hello,

I am running softdevice using directfb on a g450 with tv-out.

When I pause a recording and then start playback again the video is bad.
It would seem that half or more of the frames are not displayed.

If I hit exit, and then restart the recording everything works fine.

Also, if I go into the menus and change the crop mode the same problem
occurs.

This is only while replaying recordings.

softdevice and directfb are from cvs.

_______________________________________________
Softdevice-devel mailing list
Softdevice-devel at lists.berlios.de
http://lists.berlios.de/mailman/listinfo/softdevice-devel



From juanito at vioque.org  Mon Oct 24 18:51:00 2005
From: juanito at vioque.org (juanito at vioque.org)
Date: Mon, 24 Oct 2005 18:51:00 +0200 (CEST)
Subject: [Softdevice-devel] Sis 315
Message-ID: <49114.192.168.0.22.1130172660.squirrel@192.168.0.22>

Hello,

I am trying to use a SIS 315 (integrated in a Asus Pundit barebone) with
Softdevice via Directfb.
Directfb compiled and installed properly (demos are working).
This is the output of modprobe:

pundit:~# modprobe sisfb
sisfb: Video ROM found and copied
sisfb: Framebuffer at 0xe8000000, mapped to 0xdcc80000, size 65536k
sisfb: MMIO at 0xe5800000, mapped to 0xdcc40000, size 128k
sisfb: Memory heap starting at 64928K, size 32K
sisfb: Detected SiS301B video bridge
sisfb: CRT1 DDC probing failed
sisfb: Default mode is 800x600x8 (60Hz)
Console: switching to colour frame buffer device 100x37
sisfb: 2D acceleration is enabled, y-panning enabled (auto-max)
fb0: SiS 651 frame buffer device, Version 1.7.17
sisfb: (C) 2001-2004 Thomas Winischhofer.

And this is what I get when I start vdr (./vdr -P "softdevice -vo dfb:":

[softdevice] initializing Plugin
[softdevice] Initializing Video Out
[softdevice] ffmpeg version(CVS) build(3277056)
[dfb] init
(*) DirectFB/Config: Parsing config file '/etc/directfbrc'.

       ---------------------- DirectFB v0.9.23 ---------------------
                    (c) 2000-2002  convergence integrated media GmbH
                                 (c) 2002-2004  convergence GmbH
       -----------------------------------------------------------

(*) DirectFB/Core: Single Application Core. (2005-10-23 18:27)
(*) Direct/Memcpy: Using MMXEXT optimized memcpy()
(*) Direct/Thread: Running 'VT Switcher' (CRITICAL, 4237)...
(*) Direct/Thread: Running 'PS/2 Input' (INPUT, 4238)...
(!!!)  *** UNIMPLEMENTED [fusion_reactor_set_lock] *** [reactor.c:797]
(*) DirectFB/Input: IMPS/2 Mouse 1.0 (Convergence GmbH)
(*) Direct/Thread: Running 'Linux Input' (INPUT, 4239)...
(*) DirectFB/Input: AT Translated Set 2 keyboard (1) 0.1 (convergence
integrated media GmbH)
(*) Direct/Thread: Running 'Linux Input' (INPUT, 4240)...
(*) DirectFB/Input: PS/2 Generic Mouse (2) 0.1 (convergence integrated
media GmbH)
(*) Direct/Thread: Running 'Linux Input' (INPUT, 4241)...
(*) DirectFB/Input: PC Speaker (3) 0.1 (convergence integrated media GmbH)
(*) Direct/Thread: Running 'Keyboard Input' (INPUT, 4242)...
(*) DirectFB/Input: Keyboard 0.9 (convergence integrated media GmbH)
(*) DirectFB/Genefx: MMX detected and enabled
(*) DirectFB/Graphics: SiS 315 0.1 (Andreas Oberritter <obi at saftware.de>)
(*) DirectFB/Core/WM: Default 0.2 (Convergence GmbH)
[dfb] RAM: 66486272 bytes
[dfb] Accellerated Functions: FillRectange DrawRectange DrawLine Blit All
[dfb] Drawing Flags: none
[dfb] Surface Blitting Flags: SrcColorkey
[dfb] Supported video Modes are: 768x576 at 16 640x480 at 16 720x576 at 16
640x480 at 8 640x480 at 8 640x480 at 8 640x480 at 8 640x480 at 8 768x576 at 32 800x600 at 8
800x600 at 8 800x600 at 8 800x600 at 8 800x600 at 8 800x600 at 8 800x600 at 8 800x600 at 8
1024x768 at 8 1024x768 at 8 1024x768 at 8 1024x768 at 8 1024x768 at 8 1024x768 at 8
1024x768 at 8 1152x864 at 8 1152x864 at 8 1152x864 at 8 1152x864 at 8 1152x864 at 8
1152x864 at 8 1280x960 at 8 1280x960 at 16 1280x960 at 32 1024x1024 at 8 1280x1024 at 8
1280x1024 at 8 1280x1024 at 8 1280x1024 at 8 1280x1024 at 8 1600x1200 at 8 1600x1200 at 8
1600x1200 at 8
[dfb] Enumerating display Layers
Layer 0 FBDev Primary Layer  Type: graphics
  Caps: brightness contrast saturation surface
  [surface capabilities] scrSurface: primary videoonly double-buffered
flipping
  [dfb]: could not find suitable videolayer
   (!!!)  *** WARNING [Application exited without deinitialization of
DirectFB!] *** [core.c:630 in dfb_core_deinit_check()]

I am using softdevice 0.2.0 and vdr 1.3.34.
And Linux version is Debian Sarge upgraded to testing:

juanito at pundit:~$ uname -a
Linux pundit 2.6.12-1-686 #1 Tue Sep 27 12:52:50 JST 2005 i686 GNU/Linux


Any idea?
If this is not the right place to ask or if it is too obvious, please dont
be cruel :-)



From stefan at lucke.in-berlin.de  Mon Oct 24 21:01:34 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Mon, 24 Oct 2005 21:01:34 +0200
Subject: [Softdevice-devel] Sis 315
In-Reply-To: <49114.192.168.0.22.1130172660.squirrel@192.168.0.22>
References: <49114.192.168.0.22.1130172660.squirrel@192.168.0.22>
Message-ID: <200510242101.34736.stefan@lucke.in-berlin.de>

On Montag, 24. Oktober 2005 18:51, juanito at vioque.org wrote:
> Hello,
> 
> I am trying to use a SIS 315 (integrated in a Asus Pundit barebone) with
> Softdevice via Directfb.
> Directfb compiled and installed properly (demos are working).
> This is the output of modprobe:
> 
> pundit:~# modprobe sisfb
> sisfb: Video ROM found and copied
> sisfb: Framebuffer at 0xe8000000, mapped to 0xdcc80000, size 65536k
> sisfb: MMIO at 0xe5800000, mapped to 0xdcc40000, size 128k
> sisfb: Memory heap starting at 64928K, size 32K
> sisfb: Detected SiS301B video bridge
> sisfb: CRT1 DDC probing failed
> sisfb: Default mode is 800x600x8 (60Hz)
> Console: switching to colour frame buffer device 100x37
> sisfb: 2D acceleration is enabled, y-panning enabled (auto-max)
> fb0: SiS 651 frame buffer device, Version 1.7.17
> sisfb: (C) 2001-2004 Thomas Winischhofer.

> [dfb] Enumerating display Layers
> Layer 0 FBDev Primary Layer  Type: graphics
>   Caps: brightness contrast saturation surface
>   [surface capabilities] scrSurface: primary videoonly double-buffered
> flipping
>   [dfb]: could not find suitable videolayer

It seems that this card has no supported video acceleration by directfb.
So you have to use either X11 or vidix. With them it should be possible
to do YUV to RGB conversion and scaling in hardware.

> Any idea?
> If this is not the right place to ask or if it is too obvious, please dont
> be cruel :-)

If you are a programmer, you could try to add more SIS315 features
to directfb by taking X11 and vidix as a sample.

-- 
Stefan Lucke



From nhuillard at e-dition.fr  Mon Oct 24 23:31:25 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Mon, 24 Oct 2005 23:31:25 +0200
Subject: [Softdevice-devel] Crop mode in 0.2.0 vs. 0.1.3
Message-ID: <435D52AD.6010305@e-dition.fr>

Hello,

There is no vertical scaling anymore in 0.2.0 when setting 16/9 crop 
mode on a 16/9 display. Using 0.1.3, setting 16/9 resulted in a vertical 
up-scaling.

The log is the following :
* setting 16/9 crop-mode:
Oct 24 23:24:51 vdr vdr[2322]: [VideoOut]: 720x576 [0,72 720x432] -> 
720x576 [0,0 720x576]
* setting 4/3 crop-mode :
Oct 24 23:24:53 vdr vdr[2322]: [VideoOut]: 720x576 [0,0 720x576] -> 
720x576 [90,0 540x576]

Values are different, but image is exactly the same.
Softdevice 0.2.0
DirectFB 0.9.23

BTW : I can't switch on stretchblit in the menu, but the unichrome 
DirectFB driver seems to be able to do that.

-- 
NH


From nhuillard at e-dition.fr  Mon Oct 24 23:34:06 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Mon, 24 Oct 2005 23:34:06 +0200
Subject: [Softdevice-devel] softdevice-dfb contents ?
Message-ID: <435D534E.8070500@e-dition.fr>

Hello all,

I can't manage to learn remote keys for the softdevice-dfb remote (used 
for crop-mode, isn't it ?)
Does anyone have a sample content for that remote config ? Are the codes 
the same as the LIRC codes, or keyboard codes ?

-- 
NH


From marko.makela at hut.fi  Mon Oct 24 23:42:02 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Tue, 25 Oct 2005 00:42:02 +0300
Subject: [Softdevice-devel] softdevice-dfb contents ?
In-Reply-To: <435D534E.8070500@e-dition.fr>
References: <435D534E.8070500@e-dition.fr>
Message-ID: <20051024214202.GB4169@localhost.localdomain>

On Mon, Oct 24, 2005 at 11:34:06PM +0200, Nicolas Huillard wrote:
> I can't manage to learn remote keys for the softdevice-dfb remote (used 
> for crop-mode, isn't it ?)
> Does anyone have a sample content for that remote config ? Are the codes 
> the same as the LIRC codes, or keyboard codes ?

It depends.  DirectFB supports several different remote control units,
as far as I've understood.  I'm using the linux input event interface
to the supplied RCU of my Nova-T PCI 90002 card.

Add a printf to an appropriate place in video-dfb.c.  That's what I did
when VDR wouldn't accept any keys in the learn mode.  I redirected
the added debug output to a file, dug the keycodes from there and
wrote them to the remote.conf file.  Not exactly user friendly, but
I didn't have time to study the problem at that time.

	Marko


From laz at club-burniston.co.uk  Tue Oct 25 00:28:08 2005
From: laz at club-burniston.co.uk (Laz)
Date: Mon, 24 Oct 2005 23:28:08 +0100
Subject: [Softdevice-devel] Matrox G450 DirectFB output setup
Message-ID: <200510242328.08176.laz@club-burniston.co.uk>

I've just acquired a Matrox G450 and I'm trying to get it going with 
vdr-softdevice with DirectFB output: it's half getting there but then hangs:

vdr -P'softdevice -vo dfb:mgatv' gives the following output:

[softdevice] processing args
[softdevice]   argv [0] = softdevice
[softdevice]   argv [1] = -vo
[softdevice] initializing Plugin
[softdevice] Initializing Video Out
[softdevice] ffmpeg version(0.4.8) build(4680)
[dfb] init
(*) DirectFB/Config: Parsing config file '/etc/directfbrc'.

       ---------------------- DirectFB v0.9.23 ---------------------
             (c) 2000-2002  convergence integrated media GmbH
             (c) 2002-2004  convergence GmbH
        -----------------------------------------------------------

(*) DirectFB/Core: Single Application Core. (2005-10-23 19:39)
(*) Direct/Memcpy: Using MMXEXT optimized memcpy()
(*) Direct/Modules: suppress module 'joystick'
(*) Direct/Modules: suppress module 'lirc'
(*) Direct/Thread: Running 'Linux Input' (INPUT, 3197)...
 (!!!)  *** UNIMPLEMENTED [fusion_reactor_set_lock] *** 
[../../../lib/fusion/reactor.c:797]
(*) DirectFB/Input: AT Translated Set 2 keyboard (1) 0.1 (convergence 
integrated media GmbH)
(*) Direct/Thread: Running 'Linux Input' (INPUT, 3198)...
(*) DirectFB/Input: ImPS/2 Generic Wheel Mouse (2) 0.1 (convergence integrated 
media GmbH)
(*) DirectFB/Genefx: MMX detected and enabled
(*) DirectFB/Graphics: Matrox G450 0.7 (directfb.org)
(*) DirectFB/Core/WM: Default 0.2 (Convergence GmbH)
[dfb] RAM: 16777216 bytes
[dfb] Accellerated Functions: FillRectange DrawRectange DrawLine FillTriangle 
Blit StretchBlit All
[dfb] Drawing Flags: Blend
[dfb] Surface Blitting Flags: BlendAlpha BlendColorAlpha Colorize SrcColorkey 
Deinterlace
[dfb] Supported video Modes are: 720x576 at 32 720x576 at 16 768x576 at 32
[dfb] Enumerating display Layers
Layer 2 FBDev Primary Layer  Type: graphics
  Caps: brightness contrast saturation surface
Layer 1 Matrox Backend Scaler  Type: graphics picture video
  Caps: brightness contrast deinterlacing dst_colorkey screen_location surface
Layer 0 Matrox CRTC2 Layer  Type: graphics picture video
  Caps: brightness contrast flicker_filtering hue field_parity saturation 
surface
[surface capabilities] scrSurface: videoonly flipping interlaced 
triple-buffered
[dfb] width = 720, height = 576
[dfb] got fmt = 0x00418c04 bpp = 32
[dfb] Using this layer for OSD: (Matrox CRTC2 Layer - [720x576])
[surface capabilities] osdSurface: videoonly double-buffered flipping
[surface capabilities] videoSurface: videoonly
[dfb] Using this layer for OSD: Matrox CRTC2 Layer
[dfb] Using this layer for Video out: Matrox CRTC2 Layer
[dfb] Display frame time is 19965 microseconds
[dfb] (re)configuring Videolayer to 720 x 576 (720x576)
[dfb] creating new surface
[surface capabilities] videoSurface: videoonly
[dfb] (re)configured 0x00200806
[softdevice] Video Out seems to be OK
[softdevice] Initializing Audio Out
[softdevice] Audio out seems to be OK
[softdevice] A/V devices initialized, now initializing MPEG2 Decoder
cSoftDevice::MakePrimaryDevice

and then it just sits there! From my experiences with DirectFB and an Epia 
board, the above looks OK to me.

I have the following config (gleaned from various web pages):
/etc/directfbrc:
no-debug
matrox-crtc2
matrox-tv-standard=pal
primary-layer=2
mode=720x576
depth=32
no-vt
pixelformat=ARGB
matrox-cable-type=scart-rgb
disable-module=lirc
disable-module=joystick

/etc/fb.modes:
mode "720x576-50"
    # D: 28.000 MHz, H: 32.250 kHz, V: 50.00 Hz
    geometry 720 576 720 1152 32
    timings 35714 32 8 46 0 136 3
    rgba 8/16,8/8,8/0,8/24
    bcast true
endmode

mode "720x576 50Hz 32bit"
    geometry 720 576 720 576 16
    timings 31208 144 40 32 10 128 3
endmode

mode "my-pal-32"
    geometry 768 576 768 576 32
    timings  67723 106 1 44 1 70 4
    csync high
    laced true
    bcast true
endmode

Am I getting anywhere close with these modes? I hope to use a home-made 
HD15-Scart RGB cable on the second head for this. There seem to be several 
different versions of this cable to be found on the web so I'm not totally 
convinced that the one I've made will work as it is but I would have hoped 
that vdr would run fine regardless of whether anything is actually connected 
to the output.

At the moment, I lose control of the keyboard when running vdr or anything 
else with DirectFB output: am I missing anything from my /etc/directfbrc? 
CTRL-C etc. work fine on my Epia box to kill vdr with DirectFB output! I'm 
also getting lots of kernel messages like:
matroxfb: cannot set xres to 720, rounded up to 736

This is with vdr-1.3.31, softdevice-0.2.0, DirectFB-0.9.23, and matroxfb built 
into a 2.6.13.4 kernel (patched with the matrox-full-memory and 
matrox-g400-clock patches.

Any clues?

Cheers,

Laz


From malcolm.caldwell at ntu.edu.au  Tue Oct 25 04:30:21 2005
From: malcolm.caldwell at ntu.edu.au (Malcolm Caldwell)
Date: Tue, 25 Oct 2005 12:00:21 +0930
Subject: [Fwd: [Softdevice-devel] bad display after pause]
In-Reply-To: <1129907408.5940.3.camel@localhost.localdomain>
References: <1129907408.5940.3.camel@localhost.localdomain>
Message-ID: <1130207421.4462.20.camel@localhost.localdomain>

On Sat, 2005-10-22 at 00:40 +0930, Malcolm Caldwell wrote:
> I am resending this just in case the original did not get through (we
> had a spam bot problem at work and got blacklisited...)
> 
> I still see this problem.  Recordings will play back fine for quite a
> while, and then something happens (often associated with using the OSD)
> and the playback breaks.  By break I mean that from then on I only see
> every second field (or something like that).  To fix it I must restart
> the playback.

I guess this particular bug does sound familiar to anyone? 

This problem happens in live TV as well as recordings.  My feeling is it
is perhaps more likely to happen with higher bandwidth streams.  Display
is jerky, missing 50% of frames, sort of like a strobe effect, and it
lasts until I reset the stream.  I reset the stream either by chan
up/chan down, "menu 2 ok", or for recordings "exit play".

Can anyone suggest where I should start looking to see what is
happening.  Before anyone suggests it, yes the source is a great place
to start, as are the logs :)

The logs do not seem to have specific output when the problem starts.

I will have a look at the source, but was hoping for a suggestion on
what functions to look at.

> Any ideas?
> 
> -------- Forwarded Message --------
> From: Malcolm Caldwell <malcolm.caldwell at cdu.edu.au>
> Reply-To: softdevice-devel at berlios.de
> To: softdevice-devel at berlios.de
> Subject: [Softdevice-devel] bad display after pause
> Date: Mon, 17 Oct 2005 15:57:31 +0930
> 
> Hello,
> 
> I am running softdevice using directfb on a g450 with tv-out.
> 
> When I pause a recording and then start playback again the video is bad.
> It would seem that half or more of the frames are not displayed.
> 
> If I hit exit, and then restart the recording everything works fine.
> 
> Also, if I go into the menus and change the crop mode the same problem
> occurs.
> 
> This is only while replaying recordings.
> 
> softdevice and directfb are from cvs.
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel



From malcolm.caldwell at ntu.edu.au  Tue Oct 25 05:48:29 2005
From: malcolm.caldwell at ntu.edu.au (Malcolm Caldwell)
Date: Tue, 25 Oct 2005 13:18:29 +0930
Subject: [Fwd: [Softdevice-devel] bad display after pause]
In-Reply-To: <1129907408.5940.3.camel@localhost.localdomain>
References: <1129907408.5940.3.camel@localhost.localdomain>
Message-ID: <1130212109.4462.31.camel@localhost.localdomain>

On Sat, 2005-10-22 at 00:40 +0930, Malcolm Caldwell wrote:
> I am resending this just in case the original did not get through (we
> had a spam bot problem at work and got blacklisited...)
> 
> I still see this problem.  Recordings will play back fine for quite a
> while, and then something happens (often associated with using the
OSD)
> and the playback breaks.  By break I mean that from then on I only see
> every second field (or something like that).  To fix it I must restart
> the playback.

I guess this particular bug does not sound familiar to anyone? 

This problem happens in live TV as well as recordings.  My feeling is it
is perhaps more likely to happen with higher bandwidth streams.  Display
is jerky, missing 50% of frames, sort of like a strobe effect, and it
lasts until I reset the stream.  I reset the stream either by chan
up/chan down, "menu 2 ok", or for recordings "exit play".

Can anyone suggest where I should start looking to see what is
happening.  Before anyone suggests it, yes the source is a great place
to start, as are the logs :)

The logs do not seem to have specific output when the problem starts.  I
will restart tonight so I can read any output to stderr.

I will have a look at the source, but was hoping for a suggestion on
what functions to look at.

> Any ideas?
> 
> -------- Forwarded Message --------
> From: Malcolm Caldwell <malcolm.caldwell at cdu.edu.au>
> Reply-To: softdevice-devel at berlios.de
> To: softdevice-devel at berlios.de
> Subject: [Softdevice-devel] bad display after pause
> Date: Mon, 17 Oct 2005 15:57:31 +0930
> 
> Hello,
> 
> I am running softdevice using directfb on a g450 with tv-out.
> 
> When I pause a recording and then start playback again the video is
bad.
> It would seem that half or more of the frames are not displayed.
> 
> If I hit exit, and then restart the recording everything works fine.
> 
> Also, if I go into the menus and change the crop mode the same problem
> occurs.
> 
> This is only while replaying recordings.
> 
> softdevice and directfb are from cvs.
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel



From stefan at lucke.in-berlin.de  Tue Oct 25 07:43:24 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Tue, 25 Oct 2005 07:43:24 +0200
Subject: [Fwd: [Softdevice-devel] bad display after pause]
In-Reply-To: <1130207421.4462.20.camel@localhost.localdomain>
References: <1129907408.5940.3.camel@localhost.localdomain> <1130207421.4462.20.camel@localhost.localdomain>
Message-ID: <200510250743.24087.stefan@lucke.in-berlin.de>

On Dienstag, 25. Oktober 2005 04:30, Malcolm Caldwell wrote:
> On Sat, 2005-10-22 at 00:40 +0930, Malcolm Caldwell wrote:
> > I am resending this just in case the original did not get through (we
> > had a spam bot problem at work and got blacklisited...)
> > 
> > I still see this problem.  Recordings will play back fine for quite a
> > while, and then something happens (often associated with using the OSD)
> > and the playback breaks.  By break I mean that from then on I only see
> > every second field (or something like that).  To fix it I must restart
> > the playback.
> 
> I guess this particular bug does sound familiar to anyone? 

Thats not exact reproducable for me. When that happens, it took a while
to resync, but it did resync. During that resync, there where written
'+' chars to stderr which indicates that we drop frames.

I guess it's just a missing call to reset the synctimer.

What cpu do you use ?

> 
> This problem happens in live TV as well as recordings.  My feeling is it
> is perhaps more likely to happen with higher bandwidth streams.  Display
> is jerky, missing 50% of frames, sort of like a strobe effect, and it
> lasts until I reset the stream.  I reset the stream either by chan
> up/chan down, "menu 2 ok", or for recordings "exit play".
> 
> Can anyone suggest where I should start looking to see what is
> happening.  Before anyone suggests it, yes the source is a great place
> to start, as are the logs :)
> 
> The logs do not seem to have specific output when the problem starts.
> 
> I will have a look at the source, but was hoping for a suggestion on
> what functions to look at.
> 
> > Any ideas?

-- 
Stefan Lucke



From laz at club-burniston.co.uk  Tue Oct 25 15:16:50 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Tue, 25 Oct 2005 14:16:50 +0100
Subject: [Softdevice-devel] Matrox G450 DirectFB output...
Message-ID: <1130246210.14184.9.camel@laser2.york.ac.uk>

Hi,

I sent a much longer email to the list last night but it seems to have
disappeared down a big black hole!

I am setting up softdevice with a Matrox G450 dual-head card which I was
hoping would be much simpler than the Epia system I've also been working
on.

I can get df_xine and mplayer to output to my TV using a home-made
HD15-SCART RGB cable (although that needs modifying...). It was quite a
decent picture with no interlace artifacts or anything like that, so my
fb.modes and directfbrc can't be far off!

When I try to start vdr-1.3.32 with softdevice-0.2.0, all looks fine in
the output, i.e. it finds the CRTC2 layer for both OSD and video, and
gets as far as outputting:

cSoftDevice::MakePrimaryDevice

and then it stops and just sits there presumably waiting for something.

After reading back over archives of DirectFB and softdevice mailing
lists, I found mention where someone had a similar problem and it was
solved by setting the pixel format to YUY2. Looking at the source for
softdevice, the pixel format should be forced to YUY2 when "-vo
dfb:mgatv" is used.

I am not getting far enough to get any softdevice.x bits in my
setup.conf but I will try copying over that chunk from my Epia box and
force the pixel format to YUY2 to see if that makes any difference!

Can anyone shed any light on this?

I'm also losing control of the keyboard when I run a DirectFB
application, meaning I have to ssh in and kill df_xine after it has
finished playback or vdr once it is sitting there. This is probably a
separate issue though!

Cheers,

Laz



From nhuillard at e-dition.fr  Wed Oct 26 00:09:50 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Wed, 26 Oct 2005 00:09:50 +0200
Subject: [Softdevice-devel] softdevice-dfb contents ?
In-Reply-To: <20051024214202.GB4169@localhost.localdomain>
References: <435D534E.8070500@e-dition.fr> <20051024214202.GB4169@localhost.localdomain>
Message-ID: <435EAD2E.4000802@e-dition.fr>

Marko M?kel? a ?crit :
> On Mon, Oct 24, 2005 at 11:34:06PM +0200, Nicolas Huillard wrote:
> 
>>I can't manage to learn remote keys for the softdevice-dfb remote (used 
>>for crop-mode, isn't it ?)
>>Does anyone have a sample content for that remote config ? Are the codes 
>>the same as the LIRC codes, or keyboard codes ?
> 
> It depends.  DirectFB supports several different remote control units,
> as far as I've understood.  I'm using the linux input event interface
> to the supplied RCU of my Nova-T PCI 90002 card.
> 
> Add a printf to an appropriate place in video-dfb.c.  That's what I did
> when VDR wouldn't accept any keys in the learn mode.  I redirected
> the added debug output to a file, dug the keycodes from there and
> wrote them to the remote.conf file.  Not exactly user friendly, but
> I didn't have time to study the problem at that time.

I put fprintf's in cDFBVideoOut::ProcessEvents to get remote key codes.
What I didn't understand at first is that, using LIRC through DFB :
1) those codes are not the same as LIRC codes that the normal VDR LURC 
remote receives
2) not all remote keys are actually received by DFB

In fact, LIRC remote key codes are translated, by the LIRC DirectFB 
input driver, into a set of "known" keycodes. There is a lot of those 
codes in directfb_keynames.h, but not the random codes one used for a 
random remote. Those codes are then translated into an interger, which 
is received by the softdevice remote object (in it's hex form).
I tried to use the "A/B" key, which is only know by DirectFB as "AB". 
The "EXT" key next to it have no obvious DirectFB name.

The resulting remotes.conf file the contains :

softdevice-dfb.User2      000000000000F04F

-- 
NH


From nhuillard at e-dition.fr  Wed Oct 26 00:32:30 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Wed, 26 Oct 2005 00:32:30 +0200
Subject: [Softdevice-devel] cropmode toggle key handling patch
Message-ID: <435EB27E.1040402@e-dition.fr>

Yes, the subject says it all!

cropmode rotation was from 0 to max + 1, that patch fixes it and 
setupstore clamp values :


--- setup-softdevice.c.orig     2005-10-26 00:30:20.000000000 +0200
+++ setup-softdevice.c  2005-10-26 00:30:32.000000000 +0200
@@ -19,8 +19,8 @@
  /* 
----------------------------------------------------------------------------
   * index to this array correspond to AFD values
   */
-#define SETUP_CROPMODES 5
-const char *crop_str[SETUP_CROPMODES];
+#define SETUP_CROPMODES 4
+const char *crop_str[SETUP_CROPMODES+1];

  /* 
---------------------------------------------------------------------------
   */
@@ -366,7 +366,10 @@
   */
  void cSetupStore::CropModeNext(void)
  {
-  cropMode = (cropMode == (SETUP_CROPMODES-1)) ? 0 : cropMode + 1;
+  if (!crop_str[++cropMode])
+  {
+    cropMode = 0;
+  }
  }

  /* 
---------------------------------------------------------------------------


-- 
NH


From laz at club-burniston.co.uk  Wed Oct 26 00:58:16 2005
From: laz at club-burniston.co.uk (Laz)
Date: Tue, 25 Oct 2005 23:58:16 +0100
Subject: [Softdevice-devel] Matrox G450, directfb: a bit of progress...
Message-ID: <200510252358.17090.laz@club-burniston.co.uk>

I'm making some progress...

Finally worked out why it was hanging at the cSoftDevice::MakePrimaryDevice 
line: I was running from a short test script to make things simple and had 
omitted a LD_KERNEL_ASSUME=2.4.1 from it! DOH!

I now get further but not a lot further. I get lots of repeats (about one 
every 4 s or so) of:

[dfb] (re)configuring Videolayer to 736 x 576 (720x576)
[dfb] creating new surface
[surface capabilities] videoSurface: videoonly
[dfb] (re)configured 0x00200806
[dfb] (re)configuring Videolayer to 736 x 576 (720x576)
[dfb] creating new surface
[surface capabilities] videoSurface: videoonly
[dfb] (re)configured 0x00200806
[dfb] (re)configuring Videolayer to 736 x 576 (720x576)
[dfb] creating new surface
[surface capabilities] videoSurface: videoonly
[dfb] (re)configured 0x00200806

and never any output to the TV.

When I run vdr my TV changed from blue (i.e. no signal) to black which means 
that it is at least trying to send something! It turns back to blue when I 
kill vdr. No vdr processes are using any CPU during this.

This is with DirectFB-0.9.23 and softdevice-0.2.0 and vdr-1.3.31 or 1.3.34.

What should I check next? I thought this was meant to 'just work' with these 
cards! df_xine gives me a decent picture on the TV. Mplayer with -vo dfbmga 
gives me a black screen similar to that given by vdr!

Cheers,

Laz


From malcolm.caldwell at cdu.edu.au  Wed Oct 26 02:50:04 2005
From: malcolm.caldwell at cdu.edu.au (Malcolm Caldwell)
Date: Wed, 26 Oct 2005 10:20:04 +0930
Subject: [Fwd: [Softdevice-devel] bad display after pause]
In-Reply-To: <200510250743.24087.stefan@lucke.in-berlin.de>
References: <1129907408.5940.3.camel@localhost.localdomain>
	 <1130207421.4462.20.camel@localhost.localdomain>
	 <200510250743.24087.stefan@lucke.in-berlin.de>
Message-ID: <1130287804.4655.5.camel@localhost.localdomain>

On Tue, 2005-10-25 at 07:43 +0200, Stefan Lucke wrote:
> On Dienstag, 25. Oktober 2005 04:30, Malcolm Caldwell wrote:
> > On Sat, 2005-10-22 at 00:40 +0930, Malcolm Caldwell wrote:
> > > I am resending this just in case the original did not get through (we
> > > had a spam bot problem at work and got blacklisited...)
> > > 
> > > I still see this problem.  Recordings will play back fine for quite a
> > > while, and then something happens (often associated with using the OSD)
> > > and the playback breaks.  By break I mean that from then on I only see
> > > every second field (or something like that).  To fix it I must restart
> > > the playback.
> > 
> > I guess this particular bug does sound familiar to anyone? 
> 
> Thats not exact reproducable for me. When that happens, it took a while
> to resync, but it did resync. During that resync, there where written
> '+' chars to stderr which indicates that we drop frames.

Yes, now that I am looking at stdout I see the dropped frames.

Also, I think that while the problem occurs vdr's usage jumps from 25%
to 75% of CPU... (Need to check this tonight.  I just noticed high CPU
usage but because I am at work I cannot confirm that this is associated
with the display problem.)

> I guess it's just a missing call to reset the synctimer.
> 
> What cpu do you use ?

Celeron D 2.66GHz 

> > 
> > This problem happens in live TV as well as recordings.  My feeling is it
> > is perhaps more likely to happen with higher bandwidth streams.  Display
> > is jerky, missing 50% of frames, sort of like a strobe effect, and it
> > lasts until I reset the stream.  I reset the stream either by chan
> > up/chan down, "menu 2 ok", or for recordings "exit play".
> > 
> > Can anyone suggest where I should start looking to see what is
> > happening.  Before anyone suggests it, yes the source is a great place
> > to start, as are the logs :)
> > 
> > The logs do not seem to have specific output when the problem starts.
> > 
> > I will have a look at the source, but was hoping for a suggestion on
> > what functions to look at.
> > 
> > > Any ideas?
> 



From marko.makela at hut.fi  Wed Oct 26 10:06:31 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Wed, 26 Oct 2005 11:06:31 +0300
Subject: [Softdevice-devel] softdevice-dfb contents ?
In-Reply-To: <435EAD2E.4000802@e-dition.fr>
References: <435D534E.8070500@e-dition.fr> <20051024214202.GB4169@localhost.localdomain> <435EAD2E.4000802@e-dition.fr>
Message-ID: <20051026080631.GA3927@localhost.localdomain>

On Wed, Oct 26, 2005 at 12:09:50AM +0200, Nicolas Huillard wrote:
> I put fprintf's in cDFBVideoOut::ProcessEvents to get remote key codes.
> What I didn't understand at first is that, using LIRC through DFB :
> 1) those codes are not the same as LIRC codes that the normal VDR LURC 
> remote receives
> 2) not all remote keys are actually received by DFB

I had similar problems with the bundled remote control unit of the
Hauppauge Nova-T PCI 90002.  In that case, there are two translation
tables that are fixed at compilation time: in the Linux kernel, and
in DirectFB.  Some mappings were missing from the kernel, and DirectFB
didn't define all key codes found in <linux/input.h>.  Both have been
fixed since then.

While looking at the DirectFB source code, I noticed that it in some
cases maps multiple keys to the same symbol.  That was not an issue for
me, but it might be for users of multimedia keyboards.

	Marko


From malcolm.caldwell at cdu.edu.au  Wed Oct 26 17:28:21 2005
From: malcolm.caldwell at cdu.edu.au (Malcolm Caldwell)
Date: Thu, 27 Oct 2005 00:58:21 +0930
Subject: [Fwd: [Softdevice-devel] bad display after pause]
In-Reply-To: <1130287804.4655.5.camel@localhost.localdomain>
References: <1129907408.5940.3.camel@localhost.localdomain>
	 <1130207421.4462.20.camel@localhost.localdomain>
	 <200510250743.24087.stefan@lucke.in-berlin.de>
	 <1130287804.4655.5.camel@localhost.localdomain>
Message-ID: <1130340501.18971.4.camel@localhost.localdomain>

On Wed, 2005-10-26 at 10:20 +0930, Malcolm Caldwell wrote:
> On Tue, 2005-10-25 at 07:43 +0200, Stefan Lucke wrote:
> > On Dienstag, 25. Oktober 2005 04:30, Malcolm Caldwell wrote:
> > > On Sat, 2005-10-22 at 00:40 +0930, Malcolm Caldwell wrote:
> > > > I am resending this just in case the original did not get through (we
> > > > had a spam bot problem at work and got blacklisited...)
> > > > 
> > > > I still see this problem.  Recordings will play back fine for quite a
> > > > while, and then something happens (often associated with using the OSD)
> > > > and the playback breaks.  By break I mean that from then on I only see
> > > > every second field (or something like that).  To fix it I must restart
> > > > the playback.
> > > 
> > > I guess this particular bug does sound familiar to anyone? 
> > 
> > Thats not exact reproducable for me. When that happens, it took a while
> > to resync, but it did resync. During that resync, there where written
> > '+' chars to stderr which indicates that we drop frames.
> 
> Yes, now that I am looking at stdout I see the dropped frames.
> 
> Also, I think that while the problem occurs vdr's usage jumps from 25%
> to 75% of CPU... (Need to check this tonight.  I just noticed high CPU
> usage but because I am at work I cannot confirm that this is associated
> with the display problem.)

OK - I have found what appears to be the cause of my problem: I had set
a postprocess mode.   I guess it was when I was trying to get rid of the
strange field related problem caused by using cropmode on tvout.

So, most of my problems with softdevice so far have been configuration
issues.  I guess this indicates that the documentation needs some work -
but I guess everyone knows that... :)

(Like, what does the postprocess stuff do anyway...)

> > I guess it's just a missing call to reset the synctimer.
> > 
> > What cpu do you use ?
> 
> Celeron D 2.66GHz 
> 
> > > 
> > > This problem happens in live TV as well as recordings.  My feeling is it
> > > is perhaps more likely to happen with higher bandwidth streams.  Display
> > > is jerky, missing 50% of frames, sort of like a strobe effect, and it
> > > lasts until I reset the stream.  I reset the stream either by chan
> > > up/chan down, "menu 2 ok", or for recordings "exit play".
> > > 
> > > Can anyone suggest where I should start looking to see what is
> > > happening.  Before anyone suggests it, yes the source is a great place
> > > to start, as are the logs :)
> > > 
> > > The logs do not seem to have specific output when the problem starts.
> > > 
> > > I will have a look at the source, but was hoping for a suggestion on
> > > what functions to look at.
> > > 
> > > > Any ideas?
> > 
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel



From nhuillard at e-dition.fr  Wed Oct 26 21:42:25 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Wed, 26 Oct 2005 21:42:25 +0200
Subject: [Softdevice-devel] softplay does not honour softdevice's suspend nor vdr suspend patch
Message-ID: <435FDC21.5020502@e-dition.fr>

Hello,

Does the subject need more explanation ?
Music or video continues to play even when suspended by activating 
softdevice's Playback switch, or Marko Makela's suspend-patch (0.4.2)

(I really like softplay, thanks Martin !)

-- 
NH


From nhuillard at e-dition.fr  Wed Oct 26 23:17:44 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Wed, 26 Oct 2005 23:17:44 +0200
Subject: [Softdevice-devel] Translations for core VDR + dd-record-option + suspend-0.4.2
Message-ID: <435FF278.8010602@e-dition.fr>

Hi,

Here are translation diffs :
* i18n_vdr-1.3.33_fr : diff against unpatched VDR 1.3.33 (sorry, not latest)
* i18n_vdr-1.3.33_dd-record-option_fr : translation for the only option 
in the DD patch from Thomas Schmidt
* i18n_vdr-1.3.33_suspend-0.4.2_fr : translations for 
vdr-1.3.32-suspend-0.4.2.patch from Marko Makela

Happy to help ;-)

-- 
NH


From nhuillard at e-dition.fr  Wed Oct 26 23:36:00 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Wed, 26 Oct 2005 23:36:00 +0200
Subject: [Softdevice-devel] Translations for core VDR + dd-record-option + suspend-0.4.2
Message-ID: <435FF6C0.2090304@e-dition.fr>

Hi,

Here are translation diffs :
* i18n_vdr-1.3.33_fr : diff against unpatched VDR 1.3.33 (sorry, not latest)
* i18n_vdr-1.3.33_dd-record-option_fr : translation for the only option
in the DD patch from Thomas Schmidt
* i18n_vdr-1.3.33_suspend-0.4.2_fr : translations for
vdr-1.3.32-suspend-0.4.2.patch from Marko Makela

Happy to help ;-)

-- 
NH

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: i18n_vdr-1.3.33_dd-record-option_fr
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051026/489fb0af/attachment.ksh>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: i18n_vdr-1.3.33_fr
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051026/489fb0af/attachment-0001.ksh>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: i18n_vdr-1.3.33_suspend-0.4.2_fr
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051026/489fb0af/attachment-0002.ksh>

From stefan at lucke.in-berlin.de  Thu Oct 27 07:32:31 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 27 Oct 2005 07:32:31 +0200
Subject: [Softdevice-devel] cropmode toggle key handling patch
In-Reply-To: <435EB27E.1040402@e-dition.fr>
References: <435EB27E.1040402@e-dition.fr>
Message-ID: <200510270732.31636.stefan@lucke.in-berlin.de>

On Mittwoch, 26. Oktober 2005 00:32, Nicolas Huillard wrote:
> Yes, the subject says it all!
> 
> cropmode rotation was from 0 to max + 1, that patch fixes it and 
> setupstore clamp values :
> 
> 
> --- setup-softdevice.c.orig     2005-10-26 00:30:20.000000000 +0200
> +++ setup-softdevice.c  2005-10-26 00:30:32.000000000 +0200
> @@ -19,8 +19,8 @@
>   /* 
> ----------------------------------------------------------------------------
>    * index to this array correspond to AFD values
>    */
> -#define SETUP_CROPMODES 5
> -const char *crop_str[SETUP_CROPMODES];
> +#define SETUP_CROPMODES 4
> +const char *crop_str[SETUP_CROPMODES+1];
> 

Committed a slight modified version, as this change doesn't
allow to select 14:9 via OSD. Your change is enough
to correct behaviour of CropModeNext().


-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Thu Oct 27 08:06:32 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 27 Oct 2005 08:06:32 +0200
Subject: [Softdevice-devel] Matrox G450, directfb: a bit of progress...
In-Reply-To: <200510252358.17090.laz@club-burniston.co.uk>
References: <200510252358.17090.laz@club-burniston.co.uk>
Message-ID: <200510270806.32069.stefan@lucke.in-berlin.de>

On Mittwoch, 26. Oktober 2005 00:58, Laz wrote:
> 
> I'm making some progress...
> 
> Finally worked out why it was hanging at the cSoftDevice::MakePrimaryDevice 
> line: I was running from a short test script to make things simple and had 
> omitted a LD_KERNEL_ASSUME=2.4.1 from it! DOH!
> 
> I now get further but not a lot further. I get lots of repeats (about one 
> every 4 s or so) of:
> 
> [dfb] (re)configuring Videolayer to 736 x 576 (720x576)
> [dfb] creating new surface
> [surface capabilities] videoSurface: videoonly
> [dfb] (re)configured 0x00200806
> [dfb] (re)configuring Videolayer to 736 x 576 (720x576)
> [dfb] creating new surface
> [surface capabilities] videoSurface: videoonly
> [dfb] (re)configured 0x00200806
> [dfb] (re)configuring Videolayer to 736 x 576 (720x576)
> [dfb] creating new surface
> [surface capabilities] videoSurface: videoonly
> [dfb] (re)configured 0x00200806
> 
> and never any output to the TV.

Is there a receiver attached ?
In your previous mail you wrote:
matrox-cable-type=scart-rgb

Did you check, that your selfmade cable is correct ?
I had some problems with my cable too. Matorx cable only supports
composite and s-video.

> 
> When I run vdr my TV changed from blue (i.e. no signal) to black which means 
> that it is at least trying to send something! It turns back to blue when I 
> kill vdr. No vdr processes are using any CPU during this.
> 
> This is with DirectFB-0.9.23 and softdevice-0.2.0 and vdr-1.3.31 or 1.3.34.
> 
> What should I check next? I thought this was meant to 'just work' with these 
> cards! df_xine gives me a decent picture on the TV. Mplayer with -vo dfbmga 
> gives me a black screen similar to that given by vdr!


-- 
Stefan Lucke



From marko.makela at hut.fi  Thu Oct 27 08:43:41 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Thu, 27 Oct 2005 09:43:41 +0300
Subject: [Softdevice-devel] softplay does not honour softdevice's suspend nor vdr suspend patch
In-Reply-To: <435FDC21.5020502@e-dition.fr>
References: <435FDC21.5020502@e-dition.fr>
Message-ID: <20051027064341.GB3823@localhost.localdomain>

On Wed, Oct 26, 2005 at 09:42:25PM +0200, Nicolas Huillard wrote:
> Hello,
> 
> Does the subject need more explanation ?
> Music or video continues to play even when suspended by activating 
> softdevice's Playback switch, or Marko Makela's suspend-patch (0.4.2)

My suspend patch <http://www.iki.fi/~msmakela/software/vdr/#suspend>
declares the virtual method cStatus::SetSuspend() that softplay could
listen to.

It might be a good idea for my patch to introduce a #define in
plugin.h that could be checked by #ifdef in plugins.  Otherwise,
plugins that need to be aware of the suspend patch would require
a configure script.

By the way, could you submit French translations for my suspend patch?
Currently, it only has English, Finnish, German and Swedish.

	Marko


From marko.makela at hut.fi  Thu Oct 27 08:54:34 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Thu, 27 Oct 2005 09:54:34 +0300
Subject: [Softdevice-devel] softplay does not honour softdevice's suspend nor vdr suspend patch
In-Reply-To: <20051027064341.GB3823@localhost.localdomain>
References: <435FDC21.5020502@e-dition.fr> <20051027064341.GB3823@localhost.localdomain>
Message-ID: <20051027065434.GC3823@localhost.localdomain>

On Thu, Oct 27, 2005 at 09:43:41AM +0300, Marko M?kel? wrote:
> By the way, could you submit French translations for my suspend patch?
> Currently, it only has English, Finnish, German and Swedish.

Oh, sorry, I see that you already did.  I'll prepare a new patch soon,
including the French translations and a #define.  Perhaps something like
#define VDRSUSPEND 500 (for 0.5.0)?  Would config.h be the appropriate
place? It already defines VDRVERSNUM, which I seem to remember is
being checked in the softdevice plugin.

	Marko


From laz at club-burniston.co.uk  Thu Oct 27 10:12:20 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Thu, 27 Oct 2005 09:12:20 +0100
Subject: [Softdevice-devel] Matrox G450, directfb: a bit of progress...
In-Reply-To: <200510270806.32069.stefan@lucke.in-berlin.de>
References: <200510252358.17090.laz@club-burniston.co.uk>
	 <200510270806.32069.stefan@lucke.in-berlin.de>
Message-ID: <1130400740.4971.2.camel@laser2.york.ac.uk>

On Thu, 2005-10-27 at 08:06 +0200, Stefan Lucke wrote:
> On Mittwoch, 26. Oktober 2005 00:58, Laz wrote:
> > 
> > I'm making some progress...
> > 
> > Finally worked out why it was hanging at the cSoftDevice::MakePrimaryDevice 
> > line: I was running from a short test script to make things simple and had 
> > omitted a LD_KERNEL_ASSUME=2.4.1 from it! DOH!
> > 
> > I now get further but not a lot further. I get lots of repeats (about one 
> > every 4 s or so) of:
> > 
> > [dfb] (re)configuring Videolayer to 736 x 576 (720x576)
> > [dfb] creating new surface
> > [surface capabilities] videoSurface: videoonly
> > [dfb] (re)configured 0x00200806
> > [dfb] (re)configuring Videolayer to 736 x 576 (720x576)
> > [dfb] creating new surface
> > [surface capabilities] videoSurface: videoonly
> > [dfb] (re)configured 0x00200806
> > [dfb] (re)configuring Videolayer to 736 x 576 (720x576)
> > [dfb] creating new surface
> > [surface capabilities] videoSurface: videoonly
> > [dfb] (re)configured 0x00200806
> > 
> > and never any output to the TV.
> 
> Is there a receiver attached ?

Using exactly the same setup but swapping softdevice for the dxr3
plugin, it works fine.

> In your previous mail you wrote:
> matrox-cable-type=scart-rgb
> 
> Did you check, that your selfmade cable is correct ?
> I had some problems with my cable too. Matorx cable only supports
> composite and s-video.

I get a picture when using df_xine so, unless softdevice is using some
different DirectFB initialisations or something, iI'd have thought it
should work with softdevice. I'll have a go with composite...

Cheers,

Laz



From nhuillard at e-dition.fr  Thu Oct 27 22:36:21 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 27 Oct 2005 22:36:21 +0200
Subject: [Softdevice-devel] FR translation for softdevice 0.2.0
Message-ID: <43613A45.2030106@e-dition.fr>

Attached. Yo.

(This appears to also be a Debian packaging patch, to put in 
debian/patches, if anyone is interested before Stefan commits it)

-- 
NH
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 10_i18n_fr.dpatch
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051027/88d72f4b/attachment.ksh>

From nhuillard at e-dition.fr  Thu Oct 27 23:14:52 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 27 Oct 2005 23:14:52 +0200
Subject: [Softdevice-devel] FR translation for softplay CVS 20051014 (0.0.2)
Message-ID: <4361434C.6050605@e-dition.fr>

Attached. Yo. (take care : same name as the softdevice i18n patch)

(This appears to also be a Debian packaging patch, to put in 
debian/patches, if anyone is interested before Martin commits it)

(BTW, @Martin : when do you plan to release next version ?)

(why am I writing between brackets ?)

-- 
NH
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: 10_i18n_fr.dpatch
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051027/efdff18c/attachment.ksh>

From marko.makela at hut.fi  Thu Oct 27 23:33:04 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Fri, 28 Oct 2005 00:33:04 +0300
Subject: [Softdevice-devel] softplay does not honour softdevice's suspend nor vdr suspend patch
In-Reply-To: <435FDC21.5020502@e-dition.fr>
References: <435FDC21.5020502@e-dition.fr>
Message-ID: <20051027213304.GA20926@localhost.localdomain>

On Wed, Oct 26, 2005 at 09:42:25PM +0200, Nicolas Huillard wrote:
> Hello,
> 
> Does the subject need more explanation ?
> Music or video continues to play even when suspended by activating 
> softdevice's Playback switch, or Marko Makela's suspend-patch (0.4.2)

Version 0.4.3 of the suspend patch
(http://www.iki.fi/~msmakela/software/vdr/vdr-1.3.34-suspend-0.4.3.patch.gz)
defines the symbol VDR_SUSPEND in config.h.  You can define an inherited
method of cStatus::SetSuspended(bool) #ifdef VDR_SUSPEND.

Hmm, I don't see anything in softdevice that would inherit cStatus.  It
doesn't seem logical to have methods for notifying status changes (such
as audio volume level) in two places: in cDevice and in cStatus.

It is not trivial for me to add a cStatus listener to softdevice.  I don't
have any experience of softplay, as I only have DVB recordings on my vdr box.

Two reasons why it would be nice if softdevice listened to
cStatus::SetSuspended(bool) events:

(1) Blank the screen (make it black) immediately when playback is suspended.
The timeout-based method seems to be disabled when a recording is paused.

(2) It'd be nice to power the monitor on or off by DPMS (or trigger the
X11 screensaver on or off) based on whether the playback is suspended.

Only the (1) annoys me slightly, but (2) was requested by a softdevice
user.  I can't fix (2), as the monitor on my VDR system is a year or two
too old to obey DPMS.

	Marko


From Neumann at do-net.de  Fri Oct 28 14:16:33 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Fri, 28 Oct 2005 14:16:33 +0200
Subject: [Softdevice-devel] RE: Matrox G450 DirectFB output setup
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B54@sbs2003.do-net.de>

Hi Laz,

try to add 

softdevice-dfb.1 

in your remote.conf and see if that helps.

I think, VDR is waiting for learning the dfb remote control keys, which
you dont need, if you use lirc.

Greetings,
-------------
Andre Neumann



From laz at club-burniston.co.uk  Fri Oct 28 14:33:13 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Fri, 28 Oct 2005 13:33:13 +0100
Subject: [Softdevice-devel] RE: Matrox G450 DirectFB output setup
In-Reply-To: <FB3B5DB3197CEA429E5FB8E83D01D039056B54@sbs2003.do-net.de>
References: <FB3B5DB3197CEA429E5FB8E83D01D039056B54@sbs2003.do-net.de>
Message-ID: <1130502793.9400.10.camel@laser2.york.ac.uk>

On Fri, 2005-10-28 at 14:16 +0200, Andre Neumann wrote:
> Hi Laz,
> 
> try to add 
> 
> softdevice-dfb.1 
> 
> in your remote.conf and see if that helps.
> 
> I think, VDR is waiting for learning the dfb remote control keys, which
> you dont need, if you use lirc.

Been there and done that: that had me confused when I was setting up a
different softdevice-dfb system. With that, I at least had the OSD
telling me that it was trying to learn keys. With the Matrox system, I
just get a black screen (and I've defined a dummy softdevice.something
in remote.conf).

Cheers,

Laz



From Neumann at do-net.de  Fri Oct 28 14:44:48 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Fri, 28 Oct 2005 14:44:48 +0200
Subject: [Softdevice-devel] RE: Matrox G450 DirectFB output setup
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B55@sbs2003.do-net.de>

Can you access VDR via telnet localhost 2001 from another ssh session?


-----Urspr?ngliche Nachricht-----
Von: softdevice-devel-admin at berlios.de [mailto:softdevice-devel-admin at berlios.de] Im Auftrag von Laurence Abbott
Gesendet: Freitag, 28. Oktober 2005 14:33
An: softdevice-devel at berlios.de
Betreff: Re: [Softdevice-devel] RE: Matrox G450 DirectFB output setup

On Fri, 2005-10-28 at 14:16 +0200, Andre Neumann wrote:
> Hi Laz,
> 
> try to add
> 
> softdevice-dfb.1
> 
> in your remote.conf and see if that helps.
> 
> I think, VDR is waiting for learning the dfb remote control keys, 
> which you dont need, if you use lirc.

Been there and done that: that had me confused when I was setting up a different softdevice-dfb system. With that, I at least had the OSD telling me that it was trying to learn keys. With the Matrox system, I just get a black screen (and I've defined a dummy softdevice.something in remote.conf).

Cheers,

Laz

_______________________________________________
Softdevice-devel mailing list
Softdevice-devel at lists.berlios.de
http://lists.berlios.de/mailman/listinfo/softdevice-devel






From laz at club-burniston.co.uk  Fri Oct 28 15:05:39 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Fri, 28 Oct 2005 14:05:39 +0100
Subject: [Softdevice-devel] RE: Matrox G450 DirectFB output setup
In-Reply-To: <FB3B5DB3197CEA429E5FB8E83D01D039056B55@sbs2003.do-net.de>
References: <FB3B5DB3197CEA429E5FB8E83D01D039056B55@sbs2003.do-net.de>
Message-ID: <1130504739.9400.13.camel@laser2.york.ac.uk>

On Fri, 2005-10-28 at 14:44 +0200, Andre Neumann wrote:
> Can you access VDR via telnet localhost 2001 from another ssh session?

No: it never gets far enough for that. I'm pretty sure it is just
looping when softdevice starts up. I just get a series of messages about
reconfiguring the video layer (or whatever the message is) and it never
gets past that.

Cheers,

Laz



From news at do-net.de  Thu Oct 27 12:54:56 2005
From: news at do-net.de (DO-net GmbH Newsletter)
Date: Thu, 27 Oct 2005 12:54:56 +0200
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
Message-ID: <200510271054.j9RAsww26172@bat.berlios.de>

Hi list,
 
I have setup my VDR with matrox g550 dvi and softdevice to be able to get
hdtv working with my sanyo
Z3 beamer. Normal VDR ist working really great, a only have a problem with
softplay when i want to
watch divx/xvid avi files.

They are displayed very ugly (many artefacts). For tests you can use the
madagascar hdtv 720p trailer from: 
http://www.divx.com/hd/ Im using DirectFB + Softdevice + ffmpeg (all from
cvs).

I also tried older versions from ffmpeg, as i think, ffmpeg is the reason
for this. When playing this file
with mplayer the output is ok.

Maybe anyone knows a solution.

Greets,
-------------
Andre Neumann




From news at do-net.de  Fri Oct 28 14:26:13 2005
From: news at do-net.de (DO-net GmbH Newsletter)
Date: Fri, 28 Oct 2005 14:26:13 +0200
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
Message-ID: <200510281226.j9SCQHw13253@bat.berlios.de>

Hi list,
 
I have setup my VDR with matrox g550 dvi and softdevice to be able to get
hdtv working with my sanyo
Z3 beamer. Normal VDR ist working really great, a only have a problem with
softplay when i want to watch divx/xvid avi files.

They are displayed very ugly (many artefacts). For tests you can use the
madagascar hdtv 720p trailer from: 
http://www.divx.com/hd/ Im using DirectFB + Softdevice + ffmpeg (all from
cvs).

I also tried older versions from ffmpeg, as i think, ffmpeg is the reason
for this. When playing this file with mplayer the output is ok.

Maybe anyone knows a solution.

Greets,
-------------
Andre Neumann




From stefan at lucke.in-berlin.de  Fri Oct 28 20:56:47 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 28 Oct 2005 20:56:47 +0200
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
In-Reply-To: <200510281226.j9SCQHw13253@bat.berlios.de>
References: <200510281226.j9SCQHw13253@bat.berlios.de>
Message-ID: <200510282056.47576.stefan@lucke.in-berlin.de>

On Freitag, 28. Oktober 2005 14:26, DO-net GmbH Newsletter wrote:
> Hi list,
>  
> I have setup my VDR with matrox g550 dvi and softdevice to be able to get
> hdtv working with my sanyo
> Z3 beamer. Normal VDR ist working really great, a only have a problem with
> softplay when i want to watch divx/xvid avi files.
> 
> They are displayed very ugly (many artefacts). For tests you can use the
> madagascar hdtv 720p trailer from: 
> http://www.divx.com/hd/ Im using DirectFB + Softdevice + ffmpeg (all from
> cvs).

Plays fine (with some restrictions) here ;-) .
For DivX we have to change something in our softdevice softplay
communication. As a quick fix you could try attached patch for ffmpeg.
I posted that fix on ffmpeg mailing list, but the fix is rejected by them.

With this fix you can play star_wreck .. avi too .

Above mentioned restrictions are:
- with xv and matrox, max area is limited to 1024x1024, so only
  leftmost 1024 pixels are shown.
- with dfb and back-end-scaler there seems to be a bug in directfb
  as there are 3 different stripes shown. YUV2 and stretchbilt works ok.

CPU load was about 50% on my P4 G2.2


-- 
Stefan Lucke
-------------- next part --------------
A non-text attachment was scrubbed...
Name: flag_truncated.diff
Type: text/x-diff
Size: 1138 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051028/1cbdb89c/attachment.diff>

From stefan at lucke.in-berlin.de  Sat Oct 29 07:11:07 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 29 Oct 2005 07:11:07 +0200
Subject: [Softdevice-devel] FR translation for softdevice 0.2.0
In-Reply-To: <43613A45.2030106@e-dition.fr>
References: <43613A45.2030106@e-dition.fr>
Message-ID: <200510290711.08027.stefan@lucke.in-berlin.de>

On Donnerstag, 27. Oktober 2005 22:36, Nicolas Huillard wrote:
> Attached. Yo.
> 
> (This appears to also be a Debian packaging patch, to put in 
> debian/patches, if anyone is interested before Stefan commits it)
> 

Thanks, committed.

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Sat Oct 29 10:34:19 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 29 Oct 2005 10:34:19 +0200
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
In-Reply-To: <200510281226.j9SCQHw13253@bat.berlios.de>
References: <200510281226.j9SCQHw13253@bat.berlios.de>
Message-ID: <200510291034.19843.stefan@lucke.in-berlin.de>

On Freitag, 28. Oktober 2005 14:26, DO-net GmbH Newsletter wrote:
> Hi list,
>  
> I have setup my VDR with matrox g550 dvi and softdevice to be able to get
> hdtv working with my sanyo
> Z3 beamer. Normal VDR ist working really great, a only have a problem with
> softplay when i want to watch divx/xvid avi files.
> 
> They are displayed very ugly (many artefacts). For tests you can use the
> madagascar hdtv 720p trailer from: 
> http://www.divx.com/hd/ Im using DirectFB + Softdevice + ffmpeg (all from
> cvs).
> 
> I also tried older versions from ffmpeg, as i think, ffmpeg is the reason
> for this. When playing this file with mplayer the output is ok.
> 
> Maybe anyone knows a solution.

Fix/work around is in softdevice cvs.

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Sat Oct 29 10:34:22 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 29 Oct 2005 10:34:22 +0200
Subject: [Softdevice-devel] Softplay and Star Wreck AVI
In-Reply-To: <43527A33.7010003@iki.fi>
References: <43527A33.7010003@iki.fi>
Message-ID: <200510291034.22564.stefan@lucke.in-berlin.de>

On Sonntag, 16. Oktober 2005 18:05, Seppo Ingalsuo wrote:
> Hi,
> 
> Softplay doesn't play properly the Star Wreck avi. The offical torrents 
> are available at the film's web site but I extracted with mencoder (-oac 
> copy -ovc copy) a one minute clip where the problems first show up.  
> I'll keep it some time here:
> 
> http://personal.inet.fi/koti/seppo.ingalsuo/files/star_wreck_in_the_pirkinning_subtitled_xvid_sample.avi
> 
> The effect looks a bit similar to the music video avi which I reported 
> some months ago but perhaps it is not this time related to unknown frame 
> rate assumptions. There are very large block artefacts in moving objects 
> and several frames are skipped. Mplayer plays it correctly:

Fix/work around is in softdevice cvs.

-- 
Stefan Lucke



From malcolm.caldwell at cdu.edu.au  Mon Oct 31 03:15:29 2005
From: malcolm.caldwell at cdu.edu.au (Malcolm Caldwell)
Date: Mon, 31 Oct 2005 11:45:29 +0930
Subject: [Softdevice-devel] Issues
Message-ID: <1130724929.4464.16.camel@localhost.localdomain>

I now have softdevice working quite well for most purposes.  I still
have a few remaining issues.  I think I will write an separate email for
each.

My setup is g450, directfb and tv-out.  Softdevice/softplay from cvs

First issue:  The "16:9 crop on 4:3 TV messes up fields order" issue.

Has there been any progress with this?



From malcolm.caldwell at cdu.edu.au  Mon Oct 31 03:21:38 2005
From: malcolm.caldwell at cdu.edu.au (Malcolm Caldwell)
Date: Mon, 31 Oct 2005 11:51:38 +0930
Subject: [Softdevice-devel] 3rd issue
Message-ID: <1130725298.4464.25.camel@localhost.localdomain>

I now have softdevice working quite well for most purposes.  I still
have a few remaining issues.  I think I will write an separate email for
each.

My setup is g450, directfb and tv-out.  Softdevice/softplay from cvs

Third issue:

I have been trying to xvid some interlaced recordings for playback via
softplay.  So far my attempts have been rather poor, with av/ofset
issues, strange field effects and blockyness.

I am using transcode to do the conversion, setting a bandwidth of
1500bps for video and 128bps for audio.

Has anyone any experience/advise for trying to get good results for
compressing material to save disk space?



From malcolm.caldwell at ntu.edu.au  Mon Oct 31 03:18:25 2005
From: malcolm.caldwell at ntu.edu.au (Malcolm Caldwell)
Date: Mon, 31 Oct 2005 11:48:25 +0930
Subject: [Softdevice-devel] 2nd Issue: ntsc
Message-ID: <1130725105.4464.20.camel@localhost.localdomain>

I now have softdevice working quite well for most purposes.  I still
have a few remaining issues.  I think I will write an separate email for
each.

My setup is g450, directfb and tv-out.  Softdevice/softplay from cvs

Second issue:

I have channels available to me that are NTSC.  It would seem that
tv-norm for mga tv-out is defined in directfbrc  Is there anyway to
change this on the fly so a NTSC picture is outputed via the matrox card
for these channels?  Does the plugin have the ability to change to mode
based on different frame rates?




From stefan at lucke.in-berlin.de  Mon Oct 31 11:37:46 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Mon, 31 Oct 2005 11:37:46 +0100
Subject: [Softdevice-devel] 3rd issue (xvid blockyness)
In-Reply-To: <1130725298.4464.25.camel@localhost.localdomain>
References: <1130725298.4464.25.camel@localhost.localdomain>
Message-ID: <1130755066.4365f3fa98c23@webmail.in-berlin.de>

Quoting Malcolm Caldwell:

> I now have softdevice working quite well for most purposes.  I still
> have a few remaining issues.  I think I will write an separate email for
> each.
>
> My setup is g450, directfb and tv-out.  Softdevice/softplay from cvs
>
> Third issue:
>
> I have been trying to xvid some interlaced recordings for playback via
> softplay.  So far my attempts have been rather poor, with av/ofset
> issues, strange field effects and blockyness.

Can you try with current cvs verion ?
On my samples blockyness is gone with softplay. If it is still threre on your
samples, I'd like to have a sample stream from you.


From stefan at lucke.in-berlin.de  Mon Oct 31 11:44:23 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Mon, 31 Oct 2005 11:44:23 +0100
Subject: [Softdevice-devel] 2nd Issue: ntsc
In-Reply-To: <1130725105.4464.20.camel@localhost.localdomain>
References: <1130725105.4464.20.camel@localhost.localdomain>
Message-ID: <1130755463.4365f58721393@webmail.in-berlin.de>

Quoting Malcolm Caldwell:

> I now have softdevice working quite well for most purposes.  I still
> have a few remaining issues.  I think I will write an separate email for
> each.
>
> My setup is g450, directfb and tv-out.  Softdevice/softplay from cvs
>
> Second issue:
>
> I have channels available to me that are NTSC.  It would seem that
> tv-norm for mga tv-out is defined in directfbrc  Is there anyway to
> change this on the fly so a NTSC picture is outputed via the matrox card
> for these channels?  Does the plugin have the ability to change to mode
> based on different frame rates?

It should be possible (with some code change) to switch tv-norm.
But I guess there is problem if your tv connection is not RGB.
DirectFB's NTSC-mode is to my understanding true NTSC and _not_ PAL60.
So if your connection is via composit (sampe applies to s-video connection I guess)
you'll get true NTSC color carrier.

Stefan Lucke


From Neumann at do-net.de  Mon Oct 31 13:45:54 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Mon, 31 Oct 2005 13:45:54 +0100
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B5D@sbs2003.do-net.de>

Thanks for the fast reply and fix. I will test it on Wednesday and report back.

Feature Request: Can you integrate a "hide mainmenu" switch in your plugin?

Greetings,
-------------
Andre Neumann
 


-----Urspr?ngliche Nachricht-----
Von: softdevice-devel-admin at berlios.de [mailto:softdevice-devel-admin at berlios.de] Im Auftrag von Stefan Lucke
Gesendet: Samstag, 29. Oktober 2005 10:34
An: softdevice-devel at lists.berlios.de
Betreff: Re: [Softdevice-devel] Softplay and divx/xvid artefacts

On Freitag, 28. Oktober 2005 14:26, DO-net GmbH Newsletter wrote:
> Hi list,
>  
> I have setup my VDR with matrox g550 dvi and softdevice to be able to 
> get hdtv working with my sanyo
> Z3 beamer. Normal VDR ist working really great, a only have a problem 
> with softplay when i want to watch divx/xvid avi files.
> 
> They are displayed very ugly (many artefacts). For tests you can use 
> the madagascar hdtv 720p trailer from:
> http://www.divx.com/hd/ Im using DirectFB + Softdevice + ffmpeg (all 
> from cvs).
> 
> I also tried older versions from ffmpeg, as i think, ffmpeg is the 
> reason for this. When playing this file with mplayer the output is ok.
> 
> Maybe anyone knows a solution.

Fix/work around is in softdevice cvs.

--
Stefan Lucke

_______________________________________________
Softdevice-devel mailing list
Softdevice-devel at lists.berlios.de
http://lists.berlios.de/mailman/listinfo/softdevice-devel






From malcolm.caldwell at cdu.edu.au  Tue Nov  1 03:39:45 2005
From: malcolm.caldwell at cdu.edu.au (Malcolm Caldwell)
Date: Tue, 01 Nov 2005 12:09:45 +0930
Subject: [Softdevice-devel] 2nd Issue: ntsc
In-Reply-To: <1130755463.4365f58721393@webmail.in-berlin.de>
References: <1130725105.4464.20.camel@localhost.localdomain>
	 <1130755463.4365f58721393@webmail.in-berlin.de>
Message-ID: <1130812785.4667.20.camel@localhost.localdomain>

On Mon, 2005-10-31 at 11:44 +0100, Stefan Lucke wrote:
> Quoting Malcolm Caldwell:
> 
> > I now have softdevice working quite well for most purposes.  I still
> > have a few remaining issues.  I think I will write an separate email for
> > each.
> >
> > My setup is g450, directfb and tv-out.  Softdevice/softplay from cvs
> >
> > Second issue:
> >
> > I have channels available to me that are NTSC.  It would seem that
> > tv-norm for mga tv-out is defined in directfbrc  Is there anyway to
> > change this on the fly so a NTSC picture is outputed via the matrox card
> > for these channels?  Does the plugin have the ability to change to mode
> > based on different frame rates?
> 
> It should be possible (with some code change) to switch tv-norm.
> But I guess there is problem if your tv connection is not RGB.
> DirectFB's NTSC-mode is to my understanding true NTSC and _not_ PAL60.
> So if your connection is via composit (sampe applies to s-video connection I guess)
> you'll get true NTSC color carrier.

I don't know about others but my TV will handle a true NTSC signal.  I
think most modern TVs sold in PAL countries do.

Regardless of wanting to switch between PAL and NTSC, I would have
thought that setting the norm via softdevice instead of directfbrc would
make the plugin easier to install.

> Stefan Lucke
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel



From Neumann at do-net.de  Tue Nov  1 14:10:18 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Tue, 1 Nov 2005 14:10:18 +0100
Subject: [Softdevice-devel] PATCH: i18n german translations
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039D13B@sbs2003.do-net.de>

Hi list,
hi Stefan,
 
i made a patch for (i hope) better german translated softdevice setup
options. If you like it, i would be happy, if you apply it in cvs.
 
Greetings,
-----------------------
Andre Neumann
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051101/711f4f5c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: softdevice-i18n.patch
Type: application/octet-stream
Size: 4428 bytes
Desc: softdevice-i18n.patch
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051101/711f4f5c/attachment.obj>

From marko.makela at hut.fi  Tue Nov  1 16:09:32 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Tue, 1 Nov 2005 17:09:32 +0200
Subject: [Softdevice-devel] PATCH: i18n german translations
In-Reply-To: <FB3B5DB3197CEA429E5FB8E83D01D039D13B@sbs2003.do-net.de>
References: <FB3B5DB3197CEA429E5FB8E83D01D039D13B@sbs2003.do-net.de>
Message-ID: <20051101150932.GB3850@localhost.localdomain>

On Tue, Nov 01, 2005 at 02:10:18PM +0100, Andre Neumann wrote:
> i made a patch for (i hope) better german translated softdevice setup
> options. If you like it, i would be happy, if you apply it in cvs.

I have a few questions:

@@ -516,7 +516,7 @@
 #endif
   },
   { "Use StretchBlit", //  1
-    "",             //  2 TODO
+    "Transparentes OSD benutzen",             //  2 TODO
     "",             //  3 TODO
     "",             //  4 TODO
     "",             //  5 TODO

StretchBlit is something for the video overlay, isn't it?
OSD transparency is something else.

@@ -700,7 +700,7 @@
 #endif
   },
   { "save",         //  1
-    "",             //  2 TODO
+    "Sicher",             //  2 TODO
     "",             //  3 TODO
     "",             //  4 TODO
     "",             //  5 TODO

Hmm, I think the Finnish translation says something about
"recordings".  What is the exact meaning of these buffer size
settings?

	Marko


From stefan at lucke.in-berlin.de  Tue Nov  1 20:23:52 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Tue, 1 Nov 2005 20:23:52 +0100
Subject: [Softdevice-devel] PATCH: i18n german translations
In-Reply-To: <20051101150932.GB3850@localhost.localdomain>
References: <FB3B5DB3197CEA429E5FB8E83D01D039D13B@sbs2003.do-net.de> <20051101150932.GB3850@localhost.localdomain>
Message-ID: <200511012023.52417.stefan@lucke.in-berlin.de>

On Dienstag, 1. November 2005 16:09, Marko M?kel? wrote:
> On Tue, Nov 01, 2005 at 02:10:18PM +0100, Andre Neumann wrote:
> > i made a patch for (i hope) better german translated softdevice setup
> > options. If you like it, i would be happy, if you apply it in cvs.
> 

Hm already prepared but not commited my own version. Some of Andre's
looks better than mine.

> I have a few questions:
> 
> @@ -516,7 +516,7 @@
>  #endif
>    },
>    { "Use StretchBlit", //  1
> -    "",             //  2 TODO
> +    "Transparentes OSD benutzen",             //  2 TODO
>      "",             //  3 TODO
>      "",             //  4 TODO
>      "",             //  5 TODO
> 
> StretchBlit is something for the video overlay, isn't it?
> OSD transparency is something else.

StretchBlit is a way video is scaled. For some cards its the olny way
to mix video and a alpha-blended (semi transparent) OSD.

So StretchBlit is the technical term for doing a pixel transfer operation.
Normal user shouldn't take care of that. But I won't separate into
enduser and developer options (now). For developers it's essential
to have a fast way to switch between several options. Perhaps
we should mark some of them with "(dev)" .

> 
> @@ -700,7 +700,7 @@
>  #endif
>    },
>    { "save",         //  1
> -    "",             //  2 TODO
> +    "Sicher",             //  2 TODO
>      "",             //  3 TODO
>      "",             //  4 TODO
>      "",             //  5 TODO
> 
> Hmm, I think the Finnish translation says something about
> "recordings".  What is the exact meaning of these buffer size
> settings?
> 

They result in using different packet buffer size (64K, 32K, 64K).
Perhaps we should find another useful name for this option.

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Tue Nov  1 21:52:07 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Tue, 1 Nov 2005 21:52:07 +0100
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
In-Reply-To: <FB3B5DB3197CEA429E5FB8E83D01D039056B5D@sbs2003.do-net.de>
References: <FB3B5DB3197CEA429E5FB8E83D01D039056B5D@sbs2003.do-net.de>
Message-ID: <200511012152.07415.stefan@lucke.in-berlin.de>

On Montag, 31. Oktober 2005 13:45, Andre Neumann wrote:
> Feature Request: Can you integrate a "hide mainmenu" switch in your plugin?

Done (via OSD).

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Wed Nov  2 02:57:54 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Wed, 2 Nov 2005 02:57:54 +0100
Subject: [Softdevice-devel] Rescaling for a large LCD TV
In-Reply-To: <20051101233029.GA20278@seneca.muc.de>
References: <20051016125820.GA10535@seneca.muc.de> <200510172113.26602.stefan@lucke.in-berlin.de> <20051101233029.GA20278@seneca.muc.de>
Message-ID: <200511020257.54800.stefan@lucke.in-berlin.de>

On Mittwoch, 2. November 2005 00:30, Harald Milz wrote:
> Hi Stefan,
> 
> I finally managed to implement your hints, and voila: it works. 
> 
> Setup: 
> BenQ DV3250 LCD TV w/ various inputs (DVI, PC, 2x Scart, YUV, etc. etc.)  
> G550 w/ DVI out
> Asus A7V8X board w/ VT8235 sound w/ SPDIF bracket
> softdevice-0.2.0
> directfb 0.9.22
> vdr-1.3.26
> DVI-D cable between G550 and TV set. Nix TV out and such things. 
> 
> /etc/fb.modes:
> mode "1280x720-60"
>    # D: 74.25 MHz, H: 45.00 kHz, V: 60.00 Hz
>    geometry 1280 720 1280 720 16
>    timings 13468 220 110 20 5 40 5
> endmode
> 
> /etc/directfbrc:
> mode=1280x720
> depth=32
> pixelformat=ARGB

Thats really good news, that you found a mode that fits to your TV.

> 
> in runvdr it says: 
> VDRCMD="$VDRCMD -P 'softdevice -ao alsa:pcm=plug:spdif#ac3=plug:spdif# -vo dfb:'"
> 
> Soooooo - 
> 
> PAL TV (720x576) is rescaled fine to 960x720. A widescreen broadcast just
> some minutes ago on ZDF is displayed as widescreen (1280x720)
> automatically. I don't need to change the scaling on the TV set itself. It
> displays everything in its native resolution ("Real"). This does not work
> using the FF card's composite out - there I need to reselect the resolution
> every other broadcasting. Here it's automatic. This is great! 
> 
> Wow. 
> 
> The CPU is an Athlon XP 2400+ running at 1800 MHz natively. By now I only
> see little artifacts and staircase patterns (no action film yet). CPU load
> is between 65 and 70% all the time. 
> 
> Question: does this line
> 
> Nov  1 22:48:25 linvdr vdr[10694]: [VideoOut]: 720x576 [0,0 720x576] -> 1280x720 [0,0 1280x720]
> 
> mean the broadcasting was sent in 720x576 and is rescaled to 1280x720? How
> do they broadcast widescreen in 720x576? No black bars here. And 

They do it correct (tm). They broadcast anamorphic video (horizontally 
compressed). But they do this not allways :-( . So from time to time
you'll see movies with black bars on all sides. That's the moment you'll
either need to correct this via TV settings or with softdevice crop mode
selection.

> 
> Nov  1 23:16:44 linvdr vdr[10694]: [VideoOut]: 720x576 [0,0 720x576] -> 1280x720 [160,0 960x720]
> 
> means a normal 4:3 720x576 picture is rescaled to 960x720 and offset by 160
> pixels? 

Exact.

> 
> How much horsepower does the rescaling need compared to decoding HDTV? 

That rescaling is done via hardware acceleration (StretchBlit() ). So
it still cost something. At DirectFB devel list, Ville Syrj?l? reports some 
improvments with matrox irq handling which seems to be very promising.

> 
> 
> > After having a look at the user manual, the BenQ devices are rather
> > limited in possible display resolutions. They mention only very few
> > resolutions for graphic input. the largest is 1024x768 :-( . All of
> > mentioned resolution have refresh rates >= 60 Hz .
> 
> 60 Hz actually helped but don't mix'em up with the 3250 which really works
> fine here. And the colours are much more realistic that with that crappy
> composite signal - which can best be seen watching human skin tones. Using
> the composite out skins sometimes look like on poorly rendered 8-bit GIF
> images. 
> 
> Sound: the DD receiver shows a DD signal on ZDF all the time. I'm using a
> coax cable from the Asus SPDIF bracket to the receiver. 

They transmit a DD stream, but most of the time it is DD 2.0 :-) . On my
logitech Z680 it is usually displayed as dolby and only on some special
transmissions it switches to display 5.1 .


-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Wed Nov  2 04:34:31 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Wed, 2 Nov 2005 04:34:31 +0100
Subject: [Softdevice-devel] Restructured OSD
Message-ID: <200511020434.31441.stefan@lucke.in-berlin.de>

Hi,

since we got many configurable parameters which can be changed
via OSD, I think it's a good time to do some restructuring.

So please checkout cvs and report back your opinions.

-- 
Stefan Lucke



From Neumann at do-net.de  Wed Nov  2 09:09:41 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Wed, 2 Nov 2005 09:09:41 +0100
Subject: [Softdevice-devel] Rescaling for a large LCD TV
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B61@sbs2003.do-net.de>

Hi,

I am surprised straight whether you are really using depth=32 since your
fb mode "1280x720-60" only uses 16bit.

Did you post a wrong modeline or am i missing something ?

Greetings,
-------------
Andre Neumann


-----Original Message-----
From: softdevice-devel-admin at berlios.de
[mailto:softdevice-devel-admin at berlios.de] On Behalf Of Harald Milz
Sent: Wednesday, November 02, 2005 12:30 AM
To: softdevice-devel at berlios.de
Cc: softdevice-devel at lists.berlios.de
Subject: Re: [Softdevice-devel] Rescaling for a large LCD TV

Hi Stefan,

I finally managed to implement your hints, and voila: it works. 

Setup: 
BenQ DV3250 LCD TV w/ various inputs (DVI, PC, 2x Scart, YUV, etc. etc.)
G550 w/ DVI out Asus A7V8X board w/ VT8235 sound w/ SPDIF bracket
softdevice-0.2.0 directfb 0.9.22
vdr-1.3.26
DVI-D cable between G550 and TV set. Nix TV out and such things. 

/etc/fb.modes:
mode "1280x720-60"
   # D: 74.25 MHz, H: 45.00 kHz, V: 60.00 Hz
   geometry 1280 720 1280 720 16
   timings 13468 220 110 20 5 40 5
endmode

/etc/directfbrc:
mode=1280x720
depth=32
pixelformat=ARGB

in runvdr it says: 
VDRCMD="$VDRCMD -P 'softdevice -ao alsa:pcm=plug:spdif#ac3=plug:spdif#
-vo dfb:'"

Soooooo - 

PAL TV (720x576) is rescaled fine to 960x720. A widescreen broadcast
just some minutes ago on ZDF is displayed as widescreen (1280x720)
automatically. I don't need to change the scaling on the TV set itself.
It displays everything in its native resolution ("Real"). This does not
work using the FF card's composite out - there I need to reselect the
resolution every other broadcasting. Here it's automatic. This is great!


Wow. 

The CPU is an Athlon XP 2400+ running at 1800 MHz natively. By now I
only see little artifacts and staircase patterns (no action film yet).
CPU load is between 65 and 70% all the time. 

Question: does this line

Nov  1 22:48:25 linvdr vdr[10694]: [VideoOut]: 720x576 [0,0 720x576] ->
1280x720 [0,0 1280x720]

mean the broadcasting was sent in 720x576 and is rescaled to 1280x720?
How do they broadcast widescreen in 720x576? No black bars here. And 

Nov  1 23:16:44 linvdr vdr[10694]: [VideoOut]: 720x576 [0,0 720x576] ->
1280x720 [160,0 960x720]

means a normal 4:3 720x576 picture is rescaled to 960x720 and offset by
160 pixels? 

How much horsepower does the rescaling need compared to decoding HDTV? 


> After having a look at the user manual, the BenQ devices are rather 
> limited in possible display resolutions. They mention only very few 
> resolutions for graphic input. the largest is 1024x768 :-( . All of 
> mentioned resolution have refresh rates >= 60 Hz .

60 Hz actually helped but don't mix'em up with the 3250 which really
works fine here. And the colours are much more realistic that with that
crappy composite signal - which can best be seen watching human skin
tones. Using the composite out skins sometimes look like on poorly
rendered 8-bit GIF images. 

Sound: the DD receiver shows a DD signal on ZDF all the time. I'm using
a coax cable from the Asus SPDIF bracket to the receiver. 

I hope I won't need to go back to composite. 

Next is replacing the FF card by another budget card and setting up
LIRC.
And getting a faster CPU to have some horsepower left for HDTV. I'm
trying to get an Athlon XP 3200+ @ FSB 333 (the board can't do FSB400).
This CPU was made as a special OEM design for HP, and they pop up on
eBay from time to time.

--
In any formula, constants (especially those obtained from handbooks) are
to be treated as variables.
_______________________________________________
Softdevice-devel mailing list
Softdevice-devel at lists.berlios.de
http://lists.berlios.de/mailman/listinfo/softdevice-devel






From stefan at lucke.in-berlin.de  Wed Nov  2 09:48:01 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Wed,  2 Nov 2005 09:48:01 +0100
Subject: [Softdevice-devel] Rescaling for a large LCD TV
In-Reply-To: <20051102081921.GA30446@seneca.muc.de>
References: <20051016125820.GA10535@seneca.muc.de> <200510172113.26602.stefan@lucke.in-berlin.de> <20051101233029.GA20278@seneca.muc.de> <200511020257.54800.stefan@lucke.in-berlin.de> <20051102081921.GA30446@seneca.muc.de>
Message-ID: <1130921281.43687d41506e2@webmail.in-berlin.de>

Quoting Harald Milz:

> On Wed, Nov 02, 2005 at 02:57:54AM +0100, Stefan Lucke wrote:

> > > Sound: the DD receiver shows a DD signal on ZDF all the time. I'm using a
> > > coax cable from the Asus SPDIF bracket to the receiver.
> >
> > They transmit a DD stream, but most of the time it is DD 2.0 :-) . On my
> > logitech Z680 it is usually displayed as dolby and only on some special
> > transmissions it switches to display 5.1 .
>
> A-ha. But it works fine, I did some watching last night, and no probs.
>
> I still have some probs with the remote module. At the moment I still use
> the IR input of the FF card J2 jack. The softdevide module learns the codes
> just fine but then interprets all key presses as two. No way to get into
> the menu :-( But I need to set up LIRC anyway because none of the RC5 VCR or
> DVD modes of my programmable remote is groked completely, i.e. either "OK"
> or "Menu" missing, and that's it.

That may be caused by reading input twice. vdr reads and softdevice via
directfb reads the events too. So you may either disable all input processing
for directfb (in that mode you cannot use the userkey remapping) or compile
vdr with keyboard and lirc disabled.

Stefan Lucke


From stefan at lucke.in-berlin.de  Wed Nov  2 16:25:22 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Wed,  2 Nov 2005 16:25:22 +0100
Subject: [Softdevice-devel] Rescaling for a large LCD TV
In-Reply-To: <20051102114916.GA6526@seneca.muc.de>
References: <20051016125820.GA10535@seneca.muc.de> <200510172113.26602.stefan@lucke.in-berlin.de> <20051101233029.GA20278@seneca.muc.de> <200511020257.54800.stefan@lucke.in-berlin.de> <20051102081921.GA30446@seneca.muc.de> <1130921281.43687d41506e2@webmail.in-berlin.de> <20051102114916.GA6526@seneca.muc.de>
Message-ID: <1130945122.4368da62cc741@webmail.in-berlin.de>

Quoting Harald Milz:

> On Wed, Nov 02, 2005 at 09:48:01AM +0100, Stefan Lucke wrote:
> > That may be caused by reading input twice. vdr reads and softdevice via
> > directfb reads the events too. So you may either disable all input processing
> > for directfb (in that mode you cannot use the userkey remapping) or compile
> > vdr with keyboard and lirc disabled.
>
> BTW: How can I use the second head (analog VGA) for the console while
> softdevice occupies the DVI head? (G550)
>

Should be possible to run a 2nd app when DFB is configured with
enable-multi and/or fusion.

Harald do you have an idea why only your mails to the list, don't appear
in the list webinterface ?

Stefan Lucke


From stefan at lucke.in-berlin.de  Wed Nov  2 22:24:53 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Wed, 2 Nov 2005 22:24:53 +0100
Subject: [Softdevice-devel] Rescaling for a large LCD TV
In-Reply-To: <20051102195346.GA18472@seneca.muc.de>
References: <20051016125820.GA10535@seneca.muc.de> <1130945122.4368da62cc741@webmail.in-berlin.de> <20051102195346.GA18472@seneca.muc.de>
Message-ID: <200511022224.53225.stefan@lucke.in-berlin.de>

On Mittwoch, 2. November 2005 20:53, Harald Milz wrote:
> On Wed, Nov 02, 2005 at 04:25:22PM +0100, Stefan Lucke wrote:
> > Should be possible to run a 2nd app when DFB is configured with
> > enable-multi and/or fusion.
> 
> Just for the text console... ? 

That would be wasted connectors. But perhaps a small LCD-touchscreen
device as 2nd monitor, so that you don't need to poweron the big one.
I wish that I would have more time for these nice things.

> 
> > Harald do you have an idea why only your mails to the list, don't appear
> > in the list webinterface ?
> 
> Ooops - no. Except if the list processes "X-no-archive: yes". Is that the
> case? Then I'll take it out. 

I went through the mail admin dialogs, but didn't find a hint for such
processing. Could you take that out, and we'll see if your mails get archived.

> 
> BTW - I overclocked my Athlon XP-M 2400+ from 1800 to 2166 MHz by setting
> the FSB to 166 instead of 133 and Vcore to 1.65V instead of 1.45. It should
> now perform like a normal 3000+. Strangely, the CPU load when watching a
> 1280x720p movie is still at about 65%. Anyhow the CPU temp is at 46?C at
> this load. 

Sometimes cpu usage is not easy to understand. HD divx plays fine here
too, but 1980x1080i (h264) is a quite different story :-( . TV-stations gave
us the chance to think of further investment, until DVB-S2 recivers are
available. To my knowledge a 3G P4 is required for software decoding
and I would like to know if 2G P-M would be enough too.

-- 
Stefan Lucke



From marko.makela at hut.fi  Thu Nov  3 09:04:55 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Thu, 3 Nov 2005 10:04:55 +0200
Subject: [Softdevice-devel] Restructured OSD
In-Reply-To: <200511020434.31441.stefan@lucke.in-berlin.de>
References: <200511020434.31441.stefan@lucke.in-berlin.de>
Message-ID: <20051103080455.GA3941@localhost.localdomain>

On Wed, Nov 02, 2005 at 04:34:31AM +0100, Stefan Lucke wrote:
> since we got many configurable parameters which can be changed
> via OSD, I think it's a good time to do some restructuring.
> 
> So please checkout cvs and report back your opinions.

I think it is a step to the right direction.  You could restructure
it further by moving audio options to a separate menu.

The submenu headings should perhaps mention the softdevice plugin.

After updating softdevice, I noticed terribly slow playback.  That went
away when I enabled StretchBlit.  I don't remember if it was previously
enabled.

	Marko


From laz at club-burniston.co.uk  Thu Nov  3 10:19:43 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Thu, 03 Nov 2005 09:19:43 +0000
Subject: [Softdevice-devel] Seg. faults with libavcodec under Debian...
Message-ID: <1131009583.22924.8.camel@laser2.york.ac.uk>

Hi,

I'm currently using vdr-1.3.32 with softdevice cvs (about a week back)
and DirectFB cvs (about a week back) and I'm currently getting quite a
few segmentation faults. Finally got round to doing a back-trace and got
the following:

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 3997708 (LWP 9130)]
0xb7a0e078 in ff_mpeg1_encode_init () from /usr/lib/libavcodec-cvs.so
(gdb) bt
#0  0xb7a0e078 in ff_mpeg1_encode_init () from /usr/lib/libavcodec-cvs.so
#1  0xb7a0d038 in ff_mpeg1_encode_init () from /usr/lib/libavcodec-cvs.so
#2  0xb7a0fb55 in ff_mpeg1_encode_init () from /usr/lib/libavcodec-cvs.so
#3  0xb7a10df3 in ff_mpeg1_find_frame_end () from /usr/lib/libavcodec-cvs.so
#4  0xb79188d9 in avcodec_decode_video () from /usr/lib/libavcodec-cvs.so
#5  0xb7c9e7fa in cVideoStreamDecoder::DecodePacket (this=0x7e4, pkt=0x85ff69c)
    at mpeg2decoder.c:543
#6  0xb7c9d845 in cStreamDecoder::Action (this=0x86fa0e0) at mpeg2decoder.c:188
#7  0x08100366 in cThread::StartThread (Thread=0x86fa0e0) at thread.c:234
#8  0xb7ec6f3c in pthread_start_thread () from /lib/libpthread.so.0
#9  0xb7ec6fca in pthread_start_thread_event () from /lib/libpthread.so.0
#10 0xb7d718ba in clone () from /lib/libc.so.6

I.e. a seg. fault in libavcodec. This seems to have been worse recently,
which might be due to bad weather, although there are very few artifacts
in the picture.

I'm using Debian and this version is:
% apt-cache policy libavcodeccvs
libavcodeccvs:
  Installed: 3:20050427-0sarge0.1
  Candidate: 3:20050427-0sarge0.1
  Version Table:
 *** 3:20050427-0sarge0.1 0
        500 ftp://ftp.nerim.net testing/main Packages
        100 /var/lib/dpkg/status

Is libavcodec2 from the main Debian archive any more stable? There was
definitely a reason why I needed the cvs version from ftp.nerim.net
(might have been for building mplayer).

I can remember lots of dependency problems from the last time I changed
the version of libavcodec so I don't really want to try several
versions!

What versions are other Debian people using with softdevice?

Cheers,

Laz



From marko.makela at hut.fi  Thu Nov  3 10:46:37 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Thu, 3 Nov 2005 11:46:37 +0200
Subject: [Softdevice-devel] Seg. faults with libavcodec under Debian...
In-Reply-To: <1131009583.22924.8.camel@laser2.york.ac.uk>
References: <1131009583.22924.8.camel@laser2.york.ac.uk>
Message-ID: <20051103094637.GB25993@localhost.localdomain>

On Thu, Nov 03, 2005 at 09:19:43AM +0000, Laurence Abbott wrote:
> What versions are other Debian people using with softdevice?

I'm using a self-compiled version of ffmpeg CVS from some point of
time.  I disabled all unnecessary codecs.  I've also compiled vdr,
softdevice, and DirectFB myself, also disabling unneeded stuff.

I'm planning to make a custom install based on uClibc and BusyBox
in order to shorten the start-up time (currently about 45 seconds,
of which 12 or 13 seconds is wasted by the BIOS and LILO).  I'd
even use LinuxBIOS if it supported my mainboard.

Probably this was not what you wanted to hear, but you asked for it. :-)

	Marko


From laz at club-burniston.co.uk  Thu Nov  3 11:01:57 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Thu, 03 Nov 2005 10:01:57 +0000
Subject: [Softdevice-devel] Seg. faults with libavcodec under Debian...
In-Reply-To: <20051103094637.GB25993@localhost.localdomain>
References: <1131009583.22924.8.camel@laser2.york.ac.uk>
	 <20051103094637.GB25993@localhost.localdomain>
Message-ID: <1131012117.22924.13.camel@laser2.york.ac.uk>

On Thu, 2005-11-03 at 11:46 +0200, Marko M?kel? wrote:
> On Thu, Nov 03, 2005 at 09:19:43AM +0000, Laurence Abbott wrote:
> > What versions are other Debian people using with softdevice?
> 
> I'm using a self-compiled version of ffmpeg CVS from some point of
> time.  I disabled all unnecessary codecs.  I've also compiled vdr,
> softdevice, and DirectFB myself, also disabling unneeded stuff.
> 
> I'm planning to make a custom install based on uClibc and BusyBox
> in order to shorten the start-up time (currently about 45 seconds,
> of which 12 or 13 seconds is wasted by the BIOS and LILO).  I'd
> even use LinuxBIOS if it supported my mainboard.
> 
> Probably this was not what you wanted to hear, but you asked for it. :-)

Doesn't bother me! vdr and DirectFB are both built from source so what's
another thing?

;-)

What version are you using at the moment? CVS or a release?

Just looking to see what will break if I remove the currently installed
packages...

I've been reading the stuff about uClibc with interest: I was trying to
get suspend2 working on my Epia board a while back but I could never get
the DVB card to wake up properly! That said, it now has a newer card in
it so I may revisit that.

Cheers,

Laz



From marko.makela at hut.fi  Thu Nov  3 12:05:32 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Thu, 3 Nov 2005 13:05:32 +0200
Subject: [Softdevice-devel] Seg. faults with libavcodec under Debian...
In-Reply-To: <1131012117.22924.13.camel@laser2.york.ac.uk>
References: <1131009583.22924.8.camel@laser2.york.ac.uk> <20051103094637.GB25993@localhost.localdomain> <1131012117.22924.13.camel@laser2.york.ac.uk>
Message-ID: <20051103110532.GD25993@localhost.localdomain>

On Thu, Nov 03, 2005 at 10:01:57AM +0000, Laurence Abbott wrote:
> What version are you using at the moment? CVS or a release?

ffmpeg CVS from several weeks ago, DirectFB 0.9.23, vdr 1.3.34 with
my suspend patch, and softdevice CVS from yesterday.

I can check the ffmpeg checkout date later today.

> I've been reading the stuff about uClibc with interest: I was trying to
> get suspend2 working on my Epia board a while back but I could never get
> the DVB card to wake up properly! That said, it now has a newer card in
> it so I may revisit that.

I'm using nvram-wakeup, which requires a reboot in order to transfer the
wakeup time from nvram to some part of the chipset.

	Marko


From stefan at lucke.in-berlin.de  Thu Nov  3 12:26:15 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu,  3 Nov 2005 12:26:15 +0100
Subject: [Softdevice-devel] Seg. faults with libavcodec under Debian...
In-Reply-To: <1131009583.22924.8.camel@laser2.york.ac.uk>
References: <1131009583.22924.8.camel@laser2.york.ac.uk>
Message-ID: <1131017175.4369f3d7f3e2d@webmail.in-berlin.de>

Quoting Laurence Abbott <laz at club-burniston.co.uk>:

>
> Hi,
>
> I'm currently using vdr-1.3.32 with softdevice cvs (about a week back)
> and DirectFB cvs (about a week back) and I'm currently getting quite a
> few segmentation faults. Finally got round to doing a back-trace and got
> the following:
>
> Program received signal SIGSEGV, Segmentation fault.
> [Switching to Thread 3997708 (LWP 9130)]
> 0xb7a0e078 in ff_mpeg1_encode_init () from /usr/lib/libavcodec-cvs.so
> (gdb) bt
> #0  0xb7a0e078 in ff_mpeg1_encode_init () from /usr/lib/libavcodec-cvs.so
> #1  0xb7a0d038 in ff_mpeg1_encode_init () from /usr/lib/libavcodec-cvs.so
> #2  0xb7a0fb55 in ff_mpeg1_encode_init () from /usr/lib/libavcodec-cvs.so
> #3  0xb7a10df3 in ff_mpeg1_find_frame_end () from /usr/lib/libavcodec-cvs.so
> #4  0xb79188d9 in avcodec_decode_video () from /usr/lib/libavcodec-cvs.so
> #5  0xb7c9e7fa in cVideoStreamDecoder::DecodePacket (this=0x7e4, pkt=0x85ff69c)
>     at mpeg2decoder.c:543
> #6  0xb7c9d845 in cStreamDecoder::Action (this=0x86fa0e0) at mpeg2decoder.c:188
> #7  0x08100366 in cThread::StartThread (Thread=0x86fa0e0) at thread.c:234
> #8  0xb7ec6f3c in pthread_start_thread () from /lib/libpthread.so.0
> #9  0xb7ec6fca in pthread_start_thread_event () from /lib/libpthread.so.0
> #10 0xb7d718ba in clone () from /lib/libc.so.6
>
> I.e. a seg. fault in libavcodec. This seems to have been worse recently,
> which might be due to bad weather, although there are very few artifacts
> in the picture.

That _was_ an issue within ffmpeg. It is resolved since 2005-05-14 .
http://article.gmane.org/gmane.comp.video.ffmpeg.devel/22305/match=find+frame+end

>
> I'm using Debian and this version is:
> % apt-cache policy libavcodeccvs
> libavcodeccvs:
>   Installed: 3:20050427-0sarge0.1
>   Candidate: 3:20050427-0sarge0.1
>   Version Table:
>  *** 3:20050427-0sarge0.1 0
>         500 ftp://ftp.nerim.net testing/main Packages
>         100 /var/lib/dpkg/status


From laz at club-burniston.co.uk  Thu Nov  3 12:39:53 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Thu, 03 Nov 2005 11:39:53 +0000
Subject: [Softdevice-devel] Seg. faults with libavcodec under Debian...
In-Reply-To: <20051103110532.GD25993@localhost.localdomain>
References: <1131009583.22924.8.camel@laser2.york.ac.uk>
	 <20051103094637.GB25993@localhost.localdomain>
	 <1131012117.22924.13.camel@laser2.york.ac.uk>
	 <20051103110532.GD25993@localhost.localdomain>
Message-ID: <1131017993.22924.17.camel@laser2.york.ac.uk>

On Thu, 2005-11-03 at 13:05 +0200, Marko M?kel? wrote:
> On Thu, Nov 03, 2005 at 10:01:57AM +0000, Laurence Abbott wrote:
> > What version are you using at the moment? CVS or a release?
> 
> ffmpeg CVS from several weeks ago, DirectFB 0.9.23, vdr 1.3.34 with
> my suspend patch, and softdevice CVS from yesterday.
> 
> I can check the ffmpeg checkout date later today.

I've just checked out and built ffmpeg CVS. Stefan Lucke pointed out
that this was a known bug in ffmpeg and was fixed back in May!

vdr is running under gdb as I type...hopefully it will continue to do so
until I get home!

> > I've been reading the stuff about uClibc with interest: I was trying to
> > get suspend2 working on my Epia board a while back but I could never get
> > the DVB card to wake up properly! That said, it now has a newer card in
> > it so I may revisit that.
> 
> I'm using nvram-wakeup, which requires a reboot in order to transfer the
> wakeup time from nvram to some part of the chipset.

Ditto. Works a treat once you work out it needs a reboot!

;)

Cheers,

Laz



From laz at club-burniston.co.uk  Thu Nov  3 13:00:38 2005
From: laz at club-burniston.co.uk (Laz)
Date: Thu, 03 Nov 2005 12:00:38 +0000
Subject: [Softdevice-devel] vdr + softdevice + Epia vt1622a A-V sync sorted (ish!)
Message-ID: <1131019238.24532.7.camel@laser2.york.ac.uk>

I have been trying to get vdr (1.3.32) + softdevice (0.2.0) to work with
DirectFB (cvs from 281005) output on my Epia MII board with a vt1622a TV
encoder. I was trying to get Mark Adams field-sync stuff working
properly but this was giving me a weird, stuttering output which looked
like there was a timing issue or something, causing it to drop a field
every second or so, giving really bad A-V sync, presumably as it was
trying to compensate and catch up.

I set myself the task of implementing an additional Unichrome tv-out
driver (in the same vein as the -vo dfb:mgatv output) and lots of
testing, rechecking, more testing. With my settings, it enabled
DLOP_FIELD_PARITY. The implementation worked but I ended up with the
same stuttering output!

I also made some other changes to the rest of the code and found that I
had an almost perfect output when I disabled my DLOP_FIELD_PARITY bits!
What I had done was reenable a couple of sections of commented out code.
I have reenabled both DLBM_TRIPLE and DLOP_DEINTERLACING, if supported.

(Why were these commented out? What did they break? ;))

With this setup, i.e. triple buffering and deinterlacing enabled and
field parity disabled, I get a good picture. It doesn't look as smooth
as it might be, maybe, but that's probably because it isn't using the
field sync stuff. A-V sync is now perfect (with a delay of -3).

This is a serious improvement on what I was getting! Maybe getting
DLOP_FIELD_PARITY to work properly would be the icing on the cake but
for now it's good.

Cheers,

Laz



From nhuillard at e-dition.fr  Thu Nov  3 14:03:37 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Thu, 03 Nov 2005 14:03:37 +0100
Subject: [Softdevice-devel] vdr + softdevice + Epia vt1622a A-V sync sorted
 (ish!)
In-Reply-To: <1131019238.24532.7.camel@laser2.york.ac.uk>
References: <1131019238.24532.7.camel@laser2.york.ac.uk>
Message-ID: <436A0AA9.7090309@e-dition.fr>

Laz a ?crit :
> I also made some other changes to the rest of the code and found that I
> had an almost perfect output when I disabled my DLOP_FIELD_PARITY bits!
> What I had done was reenable a couple of sections of commented out code.
> I have reenabled both DLBM_TRIPLE and DLOP_DEINTERLACING, if supported.
> 
> (Why were these commented out? What did they break? ;))

DLOP_DEINTERLACING was deactivated to improve resolution on low-res
streams, like http://nicolas.huillard.net/vdr/meteo-express.tar.gz
I think it has the effect of reducing resolution by augmenting
refresh-rate, which is not a good trade-off with TV-out.
There is a real (visible) improvement by disabling DLOP_DEINTERLACING :
image is much sharper, even on full-res streams.

As Mark said, DLBM_TRIPLE would be a good point for field parity.

> With this setup, i.e. triple buffering and deinterlacing enabled and
> field parity disabled, I get a good picture. It doesn't look as smooth
> as it might be, maybe, but that's probably because it isn't using the
> field sync stuff. A-V sync is now perfect (with a delay of -3).
> 
> This is a serious improvement on what I was getting! Maybe getting
> DLOP_FIELD_PARITY to work properly would be the icing on the cake but
> for now it's good.

DLOP_DEINTERLACING with no DLOP_FIELD_PARITY give a good result, but no
DLOP_DEINTERLACING gives a better result, which should be perfect if
DLOP_FIELD_PARITY is used. That should be your goal ;-)
Reading what you posted about your AV-sync, I think there is another
problems with your setup, but I can't figure what it is (except
different hardware than mine - EPIA M10k, and different software than
Mark Adams - no VDR)

I hope you will find a good solution to this ;-)

-- 
NH


From laz at club-burniston.co.uk  Thu Nov  3 14:19:25 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Thu, 03 Nov 2005 13:19:25 +0000
Subject: [Softdevice-devel] vdr + softdevice + Epia vt1622a A-V sync
	sorted (ish!)
In-Reply-To: <436A0AA9.7090309@e-dition.fr>
References: <1131019238.24532.7.camel@laser2.york.ac.uk>
	 <436A0AA9.7090309@e-dition.fr>
Message-ID: <1131023965.24532.14.camel@laser2.york.ac.uk>

On Thu, 2005-11-03 at 14:03 +0100, Nicolas Huillard wrote:
> Laz a ?crit :
> > I also made some other changes to the rest of the code and found that I
> > had an almost perfect output when I disabled my DLOP_FIELD_PARITY bits!
> > What I had done was reenable a couple of sections of commented out code.
> > I have reenabled both DLBM_TRIPLE and DLOP_DEINTERLACING, if supported.
> > 
> > (Why were these commented out? What did they break? ;))
> 
> DLOP_DEINTERLACING was deactivated to improve resolution on low-res
> streams, like http://nicolas.huillard.net/vdr/meteo-express.tar.gz
> I think it has the effect of reducing resolution by augmenting
> refresh-rate, which is not a good trade-off with TV-out.
> There is a real (visible) improvement by disabling DLOP_DEINTERLACING :
> image is much sharper, even on full-res streams.
> 
> As Mark said, DLBM_TRIPLE would be a good point for field parity.

I also replaced the videoSurface->Flip(NULL, DSFLIP_ONSYNC) with a plain
videoSurface->Flip().

> > With this setup, i.e. triple buffering and deinterlacing enabled and
> > field parity disabled, I get a good picture. It doesn't look as smooth
> > as it might be, maybe, but that's probably because it isn't using the
> > field sync stuff. A-V sync is now perfect (with a delay of -3).
> > 
> > This is a serious improvement on what I was getting! Maybe getting
> > DLOP_FIELD_PARITY to work properly would be the icing on the cake but
> > for now it's good.
> 
> DLOP_DEINTERLACING with no DLOP_FIELD_PARITY give a good result, but no
> DLOP_DEINTERLACING gives a better result, which should be perfect if
> DLOP_FIELD_PARITY is used. That should be your goal ;-)

I will have a go at disabling DLOP_DEINTERLACING again and see what
happens to my picture...

> Reading what you posted about your AV-sync, I think there is another
> problems with your setup, but I can't figure what it is (except
> different hardware than mine - EPIA M10k, and different software than
> Mark Adams - no VDR)

I'm convinced it's a timing issue somewhere along the lines: something
where the timing is 'just on the edge'.

> I hope you will find a good solution to this ;-)

I'm still working on it.

;)

As it is now, it is good enough to be my main vdr system.

Cheers,

Laz



From Neumann at do-net.de  Thu Nov  3 14:19:17 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Thu, 3 Nov 2005 14:19:17 +0100
Subject: [Softdevice-devel] Restructured OSD
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B74@sbs2003.do-net.de>

I agree with Marko. Audio Options should be a separete menu. Pixelformat and StrechBlit should be
moved to Postpressiing, i think.

> -----Original Message-----
> From: softdevice-devel-admin at berlios.de 
> [mailto:softdevice-devel-admin at berlios.de] On Behalf Of Marko M?kel?
> Sent: Thursday, November 03, 2005 9:05 AM
> To: softdevice-devel at berlios.de
> Subject: Re: [Softdevice-devel] Restructured OSD
> 
> On Wed, Nov 02, 2005 at 04:34:31AM +0100, Stefan Lucke wrote:
> > since we got many configurable parameters which can be changed
> > via OSD, I think it's a good time to do some restructuring.
> > 
> > So please checkout cvs and report back your opinions.
> 
> I think it is a step to the right direction.  You could restructure
> it further by moving audio options to a separate menu.
> 
> The submenu headings should perhaps mention the softdevice plugin.
> 
> After updating softdevice, I noticed terribly slow playback.  
> That went
> away when I enabled StretchBlit.  I don't remember if it was 
> previously
> enabled.
> 
> 	Marko
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 
> 



From Neumann at do-net.de  Thu Nov  3 14:23:07 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Thu, 3 Nov 2005 14:23:07 +0100
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B75@sbs2003.do-net.de>

Yesterday i tested the divx file (Madagascar 720p) and it works great. I need a little
more cpu power i think, because i only have a 2GHz Celeron.

I only have a good picture when using YUY2 and StrechBlit activated. But thats the
best settings i think. 

Is there a chance to get a better deinterlacer? All the options arent really good, for now
im using linblend.

Which deinterlacer other Users use ?

-------------
Andre Neumann
 

> -----Original Message-----
> From: softdevice-devel-admin at berlios.de 
> [mailto:softdevice-devel-admin at berlios.de] On Behalf Of Andre Neumann
> Sent: Monday, October 31, 2005 1:46 PM
> To: softdevice-devel at lists.berlios.de
> Subject: RE: [Softdevice-devel] Softplay and divx/xvid artefacts
> 
> Thanks for the fast reply and fix. I will test it on 
> Wednesday and report back.
> 
> Feature Request: Can you integrate a "hide mainmenu" switch 
> in your plugin?
> 
> Greetings,
> -------------
> Andre Neumann
>  
> 
> 
> -----Urspr?ngliche Nachricht-----
> Von: softdevice-devel-admin at berlios.de 
> [mailto:softdevice-devel-admin at berlios.de] Im Auftrag von Stefan Lucke
> Gesendet: Samstag, 29. Oktober 2005 10:34
> An: softdevice-devel at lists.berlios.de
> Betreff: Re: [Softdevice-devel] Softplay and divx/xvid artefacts
> 
> On Freitag, 28. Oktober 2005 14:26, DO-net GmbH Newsletter wrote:
> > Hi list,
> >  
> > I have setup my VDR with matrox g550 dvi and softdevice to 
> be able to 
> > get hdtv working with my sanyo
> > Z3 beamer. Normal VDR ist working really great, a only have 
> a problem 
> > with softplay when i want to watch divx/xvid avi files.
> > 
> > They are displayed very ugly (many artefacts). For tests 
> you can use 
> > the madagascar hdtv 720p trailer from:
> > http://www.divx.com/hd/ Im using DirectFB + Softdevice + 
> ffmpeg (all 
> > from cvs).
> > 
> > I also tried older versions from ffmpeg, as i think, ffmpeg is the 
> > reason for this. When playing this file with mplayer the 
> output is ok.
> > 
> > Maybe anyone knows a solution.
> 
> Fix/work around is in softdevice cvs.
> 
> --
> Stefan Lucke
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 
> 
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 
> 



From Neumann at do-net.de  Thu Nov  3 14:30:27 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Thu, 3 Nov 2005 14:30:27 +0100
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B76@sbs2003.do-net.de>

Maybe it is possible to integrate the deinterlace code from the Dscaler? It is the best open source deinterlace code found, i think. I do not know
much about coding, but maybe it is possible to integrate it. Stefan?

-----------------------
Andre Neumann

> -----Original Message-----
> From: softdevice-devel-admin at berlios.de 
> [mailto:softdevice-devel-admin at berlios.de] On Behalf Of Andre Neumann
> Sent: Thursday, November 03, 2005 2:23 PM
> To: softdevice-devel at berlios.de
> Subject: RE: [Softdevice-devel] Softplay and divx/xvid artefacts
> 
> Yesterday i tested the divx file (Madagascar 720p) and it 
> works great. I need a little
> more cpu power i think, because i only have a 2GHz Celeron.
> 
> I only have a good picture when using YUY2 and StrechBlit 
> activated. But thats the
> best settings i think. 
> 
> Is there a chance to get a better deinterlacer? All the 
> options arent really good, for now
> im using linblend.
> 
> Which deinterlacer other Users use ?
> 
> -------------
> Andre Neumann
>  
> 
> > -----Original Message-----
> > From: softdevice-devel-admin at berlios.de 
> > [mailto:softdevice-devel-admin at berlios.de] On Behalf Of 
> Andre Neumann
> > Sent: Monday, October 31, 2005 1:46 PM
> > To: softdevice-devel at lists.berlios.de
> > Subject: RE: [Softdevice-devel] Softplay and divx/xvid artefacts
> > 
> > Thanks for the fast reply and fix. I will test it on 
> > Wednesday and report back.
> > 
> > Feature Request: Can you integrate a "hide mainmenu" switch 
> > in your plugin?
> > 
> > Greetings,
> > -------------
> > Andre Neumann
> >  
> > 
> > 
> > -----Urspr?ngliche Nachricht-----
> > Von: softdevice-devel-admin at berlios.de 
> > [mailto:softdevice-devel-admin at berlios.de] Im Auftrag von 
> Stefan Lucke
> > Gesendet: Samstag, 29. Oktober 2005 10:34
> > An: softdevice-devel at lists.berlios.de
> > Betreff: Re: [Softdevice-devel] Softplay and divx/xvid artefacts
> > 
> > On Freitag, 28. Oktober 2005 14:26, DO-net GmbH Newsletter wrote:
> > > Hi list,
> > >  
> > > I have setup my VDR with matrox g550 dvi and softdevice to 
> > be able to 
> > > get hdtv working with my sanyo
> > > Z3 beamer. Normal VDR ist working really great, a only have 
> > a problem 
> > > with softplay when i want to watch divx/xvid avi files.
> > > 
> > > They are displayed very ugly (many artefacts). For tests 
> > you can use 
> > > the madagascar hdtv 720p trailer from:
> > > http://www.divx.com/hd/ Im using DirectFB + Softdevice + 
> > ffmpeg (all 
> > > from cvs).
> > > 
> > > I also tried older versions from ffmpeg, as i think, 
> ffmpeg is the 
> > > reason for this. When playing this file with mplayer the 
> > output is ok.
> > > 
> > > Maybe anyone knows a solution.
> > 
> > Fix/work around is in softdevice cvs.
> > 
> > --
> > Stefan Lucke
> > 
> > _______________________________________________
> > Softdevice-devel mailing list
> > Softdevice-devel at lists.berlios.de
> > http://lists.berlios.de/mailman/listinfo/softdevice-devel
> > 
> > 
> > 
> > 
> > _______________________________________________
> > Softdevice-devel mailing list
> > Softdevice-devel at lists.berlios.de
> > http://lists.berlios.de/mailman/listinfo/softdevice-devel
> > 
> > 
> > 
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 
> 




From stefan at lucke.in-berlin.de  Thu Nov  3 14:37:35 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu,  3 Nov 2005 14:37:35 +0100
Subject: [Softdevice-devel] vdr + softdevice + Epia vt1622a A-V sync sorted (ish!)
In-Reply-To: <436A0AA9.7090309@e-dition.fr>
References: <1131019238.24532.7.camel@laser2.york.ac.uk> <436A0AA9.7090309@e-dition.fr>
Message-ID: <1131025055.436a129fdb563@webmail.in-berlin.de>

Quoting Nicolas Huillard:

> Laz a ?crit :
> > I also made some other changes to the rest of the code and found that I
> > had an almost perfect output when I disabled my DLOP_FIELD_PARITY bits!
> > What I had done was reenable a couple of sections of commented out code.
> > I have reenabled both DLBM_TRIPLE and DLOP_DEINTERLACING, if supported.
> >
> > (Why were these commented out? What did they break? ;))
>
> DLOP_DEINTERLACING was deactivated to improve resolution on low-res
> streams, like http://nicolas.huillard.net/vdr/meteo-express.tar.gz
> I think it has the effect of reducing resolution by augmenting
> refresh-rate, which is not a good trade-off with TV-out.
> There is a real (visible) improvement by disabling DLOP_DEINTERLACING :
> image is much sharper, even on full-res streams.

DLOP_DEINTERLACING shows up only one field! I still have no success
on showing (by using this option)both fields. alternating at full half
frame rate. That showing field_0,  field_1 upscaled to full resolution
on a progressive (LCD) display.

TV + VGA:
DLBM_TRIPLE could be enabled.

TV:
DLOP_DEINTERLACING should be disabled for TV-out.
DLOP_FIELD_PARITY should be enabled for TV-out(requires DLSCL_EXCLUSIVE).

VGA:
a DLOP_DEINTERLACING (disabled as b does not work yet)
b flip fields at frame rate (TODO)


Stefan Lucke


From stefan at lucke.in-berlin.de  Thu Nov  3 14:40:03 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu,  3 Nov 2005 14:40:03 +0100
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
In-Reply-To: <FB3B5DB3197CEA429E5FB8E83D01D039056B76@sbs2003.do-net.de>
References: <FB3B5DB3197CEA429E5FB8E83D01D039056B76@sbs2003.do-net.de>
Message-ID: <1131025203.436a1333ea011@webmail.in-berlin.de>

Quoting Andre Neumann <Neumann at do-net.de>:

> Maybe it is possible to integrate the deinterlace code from the Dscaler? It is the best open source deinterlace code found, i
> think. I do not know
> much about coding, but maybe it is possible to integrate it. Stefan?

Do you have a link ?

Stefan Lucke




From Neumann at do-net.de  Thu Nov  3 14:36:29 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Thu, 3 Nov 2005 14:36:29 +0100
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B77@sbs2003.do-net.de>

http://prdownloads.sourceforge.net/deinterlace/Deinterlace120src.zip

Main Code is in DeinterlaceFiler.cpp

-------------
Andre Neumann 

> -----Original Message-----
> From: softdevice-devel-admin at berlios.de 
> [mailto:softdevice-devel-admin at berlios.de] On Behalf Of Stefan Lucke
> Sent: Thursday, November 03, 2005 2:40 PM
> To: softdevice-devel at berlios.de
> Subject: RE: [Softdevice-devel] Softplay and divx/xvid artefacts
> 
> Quoting Andre Neumann <Neumann at do-net.de>:
> 
> > Maybe it is possible to integrate the deinterlace code from 
> the Dscaler? It is the best open source deinterlace code found, i
> > think. I do not know
> > much about coding, but maybe it is possible to integrate it. Stefan?
> 
> Do you have a link ?
> 
> Stefan Lucke
> 
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 
> 



From laz at club-burniston.co.uk  Thu Nov  3 15:22:35 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Thu, 03 Nov 2005 14:22:35 +0000
Subject: [Softdevice-devel] vdr + softdevice + Epia vt1622a A-V sync
	sorted (ish!)
In-Reply-To: <1131025055.436a129fdb563@webmail.in-berlin.de>
References: <1131019238.24532.7.camel@laser2.york.ac.uk>
	 <436A0AA9.7090309@e-dition.fr>
	 <1131025055.436a129fdb563@webmail.in-berlin.de>
Message-ID: <1131027755.24532.17.camel@laser2.york.ac.uk>

On Thu, 2005-11-03 at 14:37 +0100, Stefan Lucke wrote:
> Quoting Nicolas Huillard:
> 
> > Laz a ?crit :
> > > I also made some other changes to the rest of the code and found that I
> > > had an almost perfect output when I disabled my DLOP_FIELD_PARITY bits!
> > > What I had done was reenable a couple of sections of commented out code.
> > > I have reenabled both DLBM_TRIPLE and DLOP_DEINTERLACING, if supported.
> > >
> > > (Why were these commented out? What did they break? ;))
> >
> > DLOP_DEINTERLACING was deactivated to improve resolution on low-res
> > streams, like http://nicolas.huillard.net/vdr/meteo-express.tar.gz
> > I think it has the effect of reducing resolution by augmenting
> > refresh-rate, which is not a good trade-off with TV-out.
> > There is a real (visible) improvement by disabling DLOP_DEINTERLACING :
> > image is much sharper, even on full-res streams.
> 
> DLOP_DEINTERLACING shows up only one field! I still have no success
> on showing (by using this option)both fields. alternating at full half
> frame rate. That showing field_0,  field_1 upscaled to full resolution
> on a progressive (LCD) display.

Ahhhh...so that's what it does!

> TV + VGA:
> DLBM_TRIPLE could be enabled.
> 
> TV:
> DLOP_DEINTERLACING should be disabled for TV-out.
> DLOP_FIELD_PARITY should be enabled for TV-out(requires DLSCL_EXCLUSIVE).
> 
> VGA:
> a DLOP_DEINTERLACING (disabled as b does not work yet)
> b flip fields at frame rate (TODO)

Looks like I need to keep fiddling with DLOP_FIELD_PARITY...

:-s

Cheers,

Laz



From laz at club-burniston.co.uk  Thu Nov  3 16:16:20 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Thu, 03 Nov 2005 15:16:20 +0000
Subject: [Softdevice-devel] Seg. faults with libavcodec under Debian...
In-Reply-To: <20051103094637.GB25993@localhost.localdomain>
References: <1131009583.22924.8.camel@laser2.york.ac.uk>
	 <20051103094637.GB25993@localhost.localdomain>
Message-ID: <1131030980.24532.22.camel@laser2.york.ac.uk>

On Thu, 2005-11-03 at 11:46 +0200, Marko M?kel? wrote:
> On Thu, Nov 03, 2005 at 09:19:43AM +0000, Laurence Abbott wrote:
> > What versions are other Debian people using with softdevice?
> 
> I'm using a self-compiled version of ffmpeg CVS from some point of
> time.  I disabled all unnecessary codecs.  I've also compiled vdr,
> softdevice, and DirectFB myself, also disabling unneeded stuff.

What configure command are you using to build ffmpeg? I built it with:
./configure --enable-mp3lame \
	--enable-xvid \
	--enable-pp \
	--enable-shared-pp \
	--enable-shared \
	--enable-gpl \
	--enable-libogg \
	--enable-vorbis

And softdevice builds and runs fine (or has done for several hours).

I'm just changing over to vdr-1.3.35 and it is failing when compiling
both the image and softplay plugins:

Image gives:
make[2]: Entering directory `/home/laz/dvb/vdr-1.3.35/PLUGINS/src/image-0.2.3/liboutput'
g++ -O0 -g -Wall -Woverloaded-virtual -c -D_GNU_SOURCE -I../../../../include -I../../../../../DVB/include encode.c
encode.c: In member function `bool cEncode::Encode()':
encode.c:246: error: 'struct AVCodecContext' has no member named 'frame_rate'
encode.c:247: error: 'struct AVCodecContext' has no member named '
   frame_rate_base'
make[2]: *** [encode.o] Error 1
make[2]: Leaving directory `/home/laz/dvb/vdr-1.3.35/PLUGINS/src/image-0.2.3/liboutput'
make[1]: *** [subdirs] Error 1

and softplay gives:
make[1]: Entering directory `/home/laz/dvb/vdr-1.3.35/PLUGINS/src/softplay-0.0.2'
g++ -O2 -Wall -Woverloaded-virtual -c -D_GNU_SOURCE -DPLUGIN_NAME_I18N='"softplay"' -I../../../include -I../../../../DVB/include -I/usr/local/include/ffmpeg/ SoftPlayer.c
SoftPlayer.c: In member function `virtual void cSoftPlayer::Action()':
SoftPlayer.c:173: error: request for member `codec_type' in `
   this->cSoftPlayer::ic->AVFormatContext::streams[pkt.AVPacket::stream_index]->AVStream::codec
   ', which is of non-class type `AVCodecContext*'
SoftPlayer.c:178: error: request for member `codec_type' in `
   this->cSoftPlayer::ic->AVFormatContext::streams[pkt.AVPacket::stream_index]->AVStream::codec
   ', which is of non-class type `AVCodecContext*'
SoftPlayer.c:222: error: request for member `codec_id' in `
   this->cSoftPlayer::ic->AVFormatContext::streams[i]->AVStream::codec', which
   is of non-class type `AVCodecContext*'
SoftPlayer.c: In member function `ePlayMode
   cSoftPlayer::GetPlayMode(AVFormatContext*)':
SoftPlayer.c:248: error: request for member `codec_type' in `
   IC->AVFormatContext::streams[i]->AVStream::codec', which is of non-class
   type `AVCodecContext*'
SoftPlayer.c:250: error: request for member `codec_type' in `
   IC->AVFormatContext::streams[i]->AVStream::codec', which is of non-class
   type `AVCodecContext*'
make[1]: *** [SoftPlayer.o] Error 1

Both of these look like I've missed out a configure option when I built
ffmpeg so that avcodec.h and avformat.h don't contain the required bits!

Is this the case?

Cheers,

Laz



From stefan at lucke.in-berlin.de  Thu Nov  3 16:35:02 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu,  3 Nov 2005 16:35:02 +0100
Subject: [Softdevice-devel] Seg. faults with libavcodec under Debian...
In-Reply-To: <1131030980.24532.22.camel@laser2.york.ac.uk>
References: <1131009583.22924.8.camel@laser2.york.ac.uk>  <20051103094637.GB25993@localhost.localdomain> <1131030980.24532.22.camel@laser2.york.ac.uk>
Message-ID: <1131032102.436a2e26b6f53@webmail.in-berlin.de>

Quoting Laurence Abbott :

> On Thu, 2005-11-03 at 11:46 +0200, Marko M?kel? wrote:
> > On Thu, Nov 03, 2005 at 09:19:43AM +0000, Laurence Abbott wrote:
> > > What versions are other Debian people using with softdevice?
> >
> > I'm using a self-compiled version of ffmpeg CVS from some point of
> > time.  I disabled all unnecessary codecs.  I've also compiled vdr,
> > softdevice, and DirectFB myself, also disabling unneeded stuff.
>
> What configure command are you using to build ffmpeg? I built it with:
> ./configure --enable-mp3lame \
> 	--enable-xvid \
> 	--enable-pp \
> 	--enable-shared-pp \
> 	--enable-shared \
> 	--enable-gpl \
> 	--enable-libogg \
> 	--enable-vorbis
>
> And softdevice builds and runs fine (or has done for several hours).
>
> I'm just changing over to vdr-1.3.35 and it is failing when compiling
> both the image and softplay plugins:

At least softplay's cvs version compiles with ffmpeg from last weekend.
Image plugin has to be adapted to latest ffmpeg too ;-) .


From laz at club-burniston.co.uk  Thu Nov  3 16:57:36 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Thu, 03 Nov 2005 15:57:36 +0000
Subject: [Softdevice-devel] Seg. faults with libavcodec under Debian...
In-Reply-To: <1131032102.436a2e26b6f53@webmail.in-berlin.de>
References: <1131009583.22924.8.camel@laser2.york.ac.uk>
	 <20051103094637.GB25993@localhost.localdomain>
	 <1131030980.24532.22.camel@laser2.york.ac.uk>
	 <1131032102.436a2e26b6f53@webmail.in-berlin.de>
Message-ID: <1131033456.24532.27.camel@laser2.york.ac.uk>

On Thu, 2005-11-03 at 16:35 +0100, Stefan Lucke wrote:

> At least softplay's cvs version compiles with ffmpeg from last weekend.

That sorted it: had checked out softdevice but not softplay.

> Image plugin has to be adapted to latest ffmpeg too ;-) .

I'll have a deeper delve into this...

> From time to time ffmpeg's structs change.

Oh yes...that's caught me out several times before!

Cheers,

Laz



From marko.makela at hut.fi  Thu Nov  3 17:01:06 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Thu, 3 Nov 2005 18:01:06 +0200
Subject: [Softdevice-devel] Seg. faults with libavcodec under Debian...
In-Reply-To: <1131030980.24532.22.camel@laser2.york.ac.uk>
References: <1131009583.22924.8.camel@laser2.york.ac.uk> <20051103094637.GB25993@localhost.localdomain> <1131030980.24532.22.camel@laser2.york.ac.uk>
Message-ID: <20051103160106.GA194409@kosh.hut.fi>

On Thu, Nov 03, 2005 at 03:16:20PM +0000, Laurence Abbott wrote:
> On Thu, 2005-11-03 at 11:46 +0200, Marko M?kel? wrote:
> > On Thu, Nov 03, 2005 at 09:19:43AM +0000, Laurence Abbott wrote:
> > > What versions are other Debian people using with softdevice?
> > 
> > I'm using a self-compiled version of ffmpeg CVS from some point of
> > time.  I disabled all unnecessary codecs.  I've also compiled vdr,
> > softdevice, and DirectFB myself, also disabling unneeded stuff.
> 
> What configure command are you using to build ffmpeg? I built it with:
> ./configure --enable-mp3lame \
> 	--enable-xvid \
> 	--enable-pp \
> 	--enable-shared-pp \
> 	--enable-shared \
> 	--enable-gpl \
> 	--enable-libogg \
> 	--enable-vorbis

I'm using

./configure --extra-cflags='-march=pentium3 -ffast-math' \
--disable-encoders --disable-strip --disable-network --enable-gpl

For DirectFB, I use

./configure \
--disable-{unique,multi,fusion,text,mpeg,jpeg,gif,png,freetype,video4linux{,2}} \
--with-inputdrivers=linuxinput \
--with-gfxdrivers=matrox \
C{,XX}FLAGS=-march=pentium3

> I'm just changing over to vdr-1.3.35 and it is failing when compiling
> both the image and softplay plugins:

I'm not using those plugins (only softdevice, subtitles, and my
own relay plugin for the suspend patch), but I'm going to upgrade
to 1.3.35 now.  I'll let you know in case I need to patch anything.

> Both of these look like I've missed out a configure option when I built
> ffmpeg so that avcodec.h and avformat.h don't contain the required bits!
> 
> Is this the case?

Don't ask me. :-)

	Marko


From hm at seneca.muc.de  Thu Nov  3 18:46:20 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Thu, 3 Nov 2005 18:46:20 +0100
Subject: [Softdevice-devel] Rescaling for a large LCD TV
In-Reply-To: <200511022224.53225.stefan@lucke.in-berlin.de>
References: <20051016125820.GA10535@seneca.muc.de> <1130945122.4368da62cc741@webmail.in-berlin.de> <20051102195346.GA18472@seneca.muc.de> <200511022224.53225.stefan@lucke.in-berlin.de>
Message-ID: <20051103174620.GA13960@seneca.muc.de>

On Wed, Nov 02, 2005 at 10:24:53PM +0100, Stefan Lucke wrote:
> On Mittwoch, 2. November 2005 20:53, Harald Milz wrote:
> > On Wed, Nov 02, 2005 at 04:25:22PM +0100, Stefan Lucke wrote:
> > > Should be possible to run a 2nd app when DFB is configured with
> > > enable-multi and/or fusion.
> > Just for the text console... ? 
> 
> That would be wasted connectors. But perhaps a small LCD-touchscreen

Nah - the VGA connectors are spare anyway. 

> device as 2nd monitor, so that you don't need to poweron the big one.

Hehe - it's exactly for this purpose - to have both on the big display, and
I don't need another one. I tried vt-switching in directfbrc but it didn't
work for me. Question is, is there any setting that allows me to keep the
DFB on the 1st head (DVI) and the Linux console on the 2nd (VGA). Then I
can help debugging softdevice without buying another piece of hardware... 

> I went through the mail admin dialogs, but didn't find a hint for such
> processing. Could you take that out, and we'll see if your mails get archived.

Wilco. 

> too, but 1980x1080i (h264) is a quite different story :-( . TV-stations gave
> us the chance to think of further investment, until DVB-S2 recivers are
> available. To my knowledge a 3G P4 is required for software decoding
> and I would like to know if 2G P-M would be enough too.

The next HD-TV broadcasting is mine. My XP-M 2400+ has apparently some
capacity left as far as overclocking. As far as I know 1080i will not be
used in DE country before long, but rather 720p. As I understand I do not
need to remove my FF card when PrimaryDVB points at softdevice, right? 

-- 
Electrocution, n.:
	Burning at the stake with all the modern improvements.


From hm at seneca.muc.de  Thu Nov  3 18:46:20 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Thu, 3 Nov 2005 18:46:20 +0100
Subject: [Softdevice-devel] Rescaling for a large LCD TV
In-Reply-To: <200511022224.53225.stefan@lucke.in-berlin.de>
References: <20051016125820.GA10535@seneca.muc.de> <1130945122.4368da62cc741@webmail.in-berlin.de> <20051102195346.GA18472@seneca.muc.de> <200511022224.53225.stefan@lucke.in-berlin.de>
Message-ID: <20051103174620.GA13960@seneca.muc.de>

On Wed, Nov 02, 2005 at 10:24:53PM +0100, Stefan Lucke wrote:
> On Mittwoch, 2. November 2005 20:53, Harald Milz wrote:
> > On Wed, Nov 02, 2005 at 04:25:22PM +0100, Stefan Lucke wrote:
> > > Should be possible to run a 2nd app when DFB is configured with
> > > enable-multi and/or fusion.
> > Just for the text console... ? 
> 
> That would be wasted connectors. But perhaps a small LCD-touchscreen

Nah - the VGA connectors are spare anyway. 

> device as 2nd monitor, so that you don't need to poweron the big one.

Hehe - it's exactly for this purpose - to have both on the big display, and
I don't need another one. I tried vt-switching in directfbrc but it didn't
work for me. Question is, is there any setting that allows me to keep the
DFB on the 1st head (DVI) and the Linux console on the 2nd (VGA). Then I
can help debugging softdevice without buying another piece of hardware... 

> I went through the mail admin dialogs, but didn't find a hint for such
> processing. Could you take that out, and we'll see if your mails get archived.

Wilco. 

> too, but 1980x1080i (h264) is a quite different story :-( . TV-stations gave
> us the chance to think of further investment, until DVB-S2 recivers are
> available. To my knowledge a 3G P4 is required for software decoding
> and I would like to know if 2G P-M would be enough too.

The next HD-TV broadcasting is mine. My XP-M 2400+ has apparently some
capacity left as far as overclocking. As far as I know 1080i will not be
used in DE country before long, but rather 720p. As I understand I do not
need to remove my FF card when PrimaryDVB points at softdevice, right? 

-- 
Electrocution, n.:
	Burning at the stake with all the modern improvements.


From Neumann at do-net.de  Fri Nov  4 08:22:21 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Fri, 4 Nov 2005 08:22:21 +0100
Subject: [Softdevice-devel] Rescaling for a large LCD TV
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B7A@sbs2003.do-net.de>

If you mean the HD broadcast on Pro7/Sat.1 you do not have a chance to
view it.
They send in DVB-S2 and also not in mpeg2. As far as i know, they also
use 1080i
with mpeg4/h.264 so you better buy a dual xeon system :)

Dont even know if it is possible now to decode that stream under linux.
And since
every dvb-s card out there cant recieve dvb-s2 you (and everyone) has no
chance.

-------------
Andre Neumann 

> -----Original Message-----
> From: softdevice-devel-admin at berlios.de 
> [mailto:softdevice-devel-admin at berlios.de] On Behalf Of Harald Milz
> Sent: Thursday, November 03, 2005 6:46 PM
> To: softdevice-devel at berlios.de
> Cc: softdevice-devel at lists.berlios.de
> Subject: Re: [Softdevice-devel] Rescaling for a large LCD TV
> 
> On Wed, Nov 02, 2005 at 10:24:53PM +0100, Stefan Lucke wrote:
> > On Mittwoch, 2. November 2005 20:53, Harald Milz wrote:
> > > On Wed, Nov 02, 2005 at 04:25:22PM +0100, Stefan Lucke wrote:
> > > > Should be possible to run a 2nd app when DFB is configured with
> > > > enable-multi and/or fusion.
> > > Just for the text console... ? 
> > 
> > That would be wasted connectors. But perhaps a small LCD-touchscreen
> 
> Nah - the VGA connectors are spare anyway. 
> 
> > device as 2nd monitor, so that you don't need to poweron 
> the big one.
> 
> Hehe - it's exactly for this purpose - to have both on the 
> big display, and
> I don't need another one. I tried vt-switching in directfbrc 
> but it didn't
> work for me. Question is, is there any setting that allows me 
> to keep the
> DFB on the 1st head (DVI) and the Linux console on the 2nd 
> (VGA). Then I
> can help debugging softdevice without buying another piece of 
> hardware... 
> 
> > I went through the mail admin dialogs, but didn't find a 
> hint for such
> > processing. Could you take that out, and we'll see if your 
> mails get archived.
> 
> Wilco. 
> 
> > too, but 1980x1080i (h264) is a quite different story :-( . 
> TV-stations gave
> > us the chance to think of further investment, until DVB-S2 
> recivers are
> > available. To my knowledge a 3G P4 is required for software decoding
> > and I would like to know if 2G P-M would be enough too.
> 
> The next HD-TV broadcasting is mine. My XP-M 2400+ has apparently some
> capacity left as far as overclocking. As far as I know 1080i 
> will not be
> used in DE country before long, but rather 720p. As I 
> understand I do not
> need to remove my FF card when PrimaryDVB points at 
> softdevice, right? 
> 
> -- 
> Electrocution, n.:
> 	Burning at the stake with all the modern improvements.
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 
> 



From hm at seneca.muc.de  Fri Nov  4 18:14:35 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Fri, 4 Nov 2005 18:14:35 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
Message-ID: <20051104171435.GA6992@seneca.muc.de>

Hi,

is it known that softdevice will not cooperate well with nvram-wakeup? The
latter will always try to open /dev/rtc, as documented in the man page: 

       -A, --directisa
              Use direct I/O port  access  to  access  the  nvram  instead of
              /dev/nvram.   This  option  must  be  used  if the configuration
              option upper_method is set. The device /dev/rtc is still used.

and softdevice opens it and keeps it open:

softdevice-0.2.0/sync-timer.c:      if ( (rtcFd = open("/dev/rtc",O_RDONLY)) < 0 )

# lsof|grep /dev/rtc
vdr        7875       root   40r      CHR     10,135             352286 /dev/rtc
vdr        7989       root   40r      CHR     10,135             352286 /dev/rtc
vdr        7990       root   40r      CHR     10,135             352286 /dev/rtc
vdr        7991       root   40r      CHR     10,135             352286 /dev/rtc
vdr        7993       root   40r      CHR     10,135             352286 /dev/rtc
vdr        7994       root   40r      CHR     10,135             352286 /dev/rtc
vdr        7995       root   40r      CHR     10,135             352286 /dev/rtc
vdr        7996       root   40r      CHR     10,135             352286 /dev/rtc
vdr        7997       root   40r      CHR     10,135             352286 /dev/rtc
vdr        7998       root   40r      CHR     10,135             352286 /dev/rtc

... etc. ad lib. 

Doubleplusoops. 

What gives? Does softdevice really need to keep it open? 

Or is there a workaround? I can't imagine being the first person to stumble
across this problem. 

Ciao,
hm


-- 
Alex Haley was adopted!


From stefan at lucke.in-berlin.de  Fri Nov  4 20:11:50 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 4 Nov 2005 20:11:50 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <20051104171435.GA6992@seneca.muc.de>
References: <20051104171435.GA6992@seneca.muc.de>
Message-ID: <200511042011.50993.stefan@lucke.in-berlin.de>

On Freitag, 4. November 2005 18:14, Harald Milz wrote:
> Hi,
> 
> is it known that softdevice will not cooperate well with nvram-wakeup? The
> latter will always try to open /dev/rtc, as documented in the man page: 
> 
>        -A, --directisa
>               Use direct I/O port  access  to  access  the  nvram  instead of
>               /dev/nvram.   This  option  must  be  used  if the configuration
>               option upper_method is set. The device /dev/rtc is still used.
> 
> and softdevice opens it and keeps it open:
> 
> softdevice-0.2.0/sync-timer.c:      if ( (rtcFd = open("/dev/rtc",O_RDONLY)) < 0 )
> 
> # lsof|grep /dev/rtc
> vdr        7875       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7989       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7990       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7991       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7993       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7994       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7995       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7996       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7997       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7998       root   40r      CHR     10,135             352286 /dev/rtc
> 
> ... etc. ad lib. 
> 
> Doubleplusoops. 
> 
> What gives? Does softdevice really need to keep it open? 
> 
> Or is there a workaround? I can't imagine being the first person to stumble
> across this problem. 
> 
> Ciao,
> hm
> 
> 
> -- 
> Alex Haley was adopted!
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Fri Nov  4 20:11:59 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 4 Nov 2005 20:11:59 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <20051104171435.GA6992@seneca.muc.de>
References: <20051104171435.GA6992@seneca.muc.de>
Message-ID: <200511042011.59286.stefan@lucke.in-berlin.de>

On Freitag, 4. November 2005 18:14, Harald Milz wrote:
> Hi,
> 
> is it known that softdevice will not cooperate well with nvram-wakeup? The
> latter will always try to open /dev/rtc, as documented in the man page: 
> 
>        -A, --directisa
>               Use direct I/O port  access  to  access  the  nvram  instead of
>               /dev/nvram.   This  option  must  be  used  if the configuration
>               option upper_method is set. The device /dev/rtc is still used.
> 
> and softdevice opens it and keeps it open:
> 
> softdevice-0.2.0/sync-timer.c:      if ( (rtcFd = open("/dev/rtc",O_RDONLY)) < 0 )
> 
> # lsof|grep /dev/rtc
> vdr        7875       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7989       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7990       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7991       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7993       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7994       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7995       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7996       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7997       root   40r      CHR     10,135             352286 /dev/rtc
> vdr        7998       root   40r      CHR     10,135             352286 /dev/rtc
> 
> ... etc. ad lib. 
> 
> Doubleplusoops. 
> 
> What gives? Does softdevice really need to keep it open? 

It needs it for A/V sync adjustments.

> 
> Or is there a workaround? I can't imagine being the first person to stumble
> across this problem. 

But as usual there is a workaround. Sync timer mode is selectable via OSD
(since a few minutes :-) ).

-- 
Stefan Lucke



From hm at seneca.muc.de  Fri Nov  4 21:14:23 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Fri, 4 Nov 2005 21:14:23 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <200511042011.59286.stefan@lucke.in-berlin.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de>
Message-ID: <20051104201423.GA11466@seneca.muc.de>

On Fri, Nov 04, 2005 at 08:11:59PM +0100, Stefan Lucke wrote:
> But as usual there is a workaround. Sync timer mode is selectable via OSD
> (since a few minutes :-) ).

Guess that means using the CVS version? 

Are there any drawbacks when deselecting RTC? 

Ciao,
hm

-- 
The moving cursor writes, and having written, blinks on.


From hm at seneca.muc.de  Fri Nov  4 21:14:23 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Fri, 4 Nov 2005 21:14:23 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <200511042011.59286.stefan@lucke.in-berlin.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de>
Message-ID: <20051104201423.GA11466@seneca.muc.de>

On Fri, Nov 04, 2005 at 08:11:59PM +0100, Stefan Lucke wrote:
> But as usual there is a workaround. Sync timer mode is selectable via OSD
> (since a few minutes :-) ).

Guess that means using the CVS version? 

Are there any drawbacks when deselecting RTC? 

Ciao,
hm

-- 
The moving cursor writes, and having written, blinks on.


From stefan at lucke.in-berlin.de  Fri Nov  4 21:44:31 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 4 Nov 2005 21:44:31 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <20051104201423.GA11466@seneca.muc.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104201423.GA11466@seneca.muc.de>
Message-ID: <200511042144.31031.stefan@lucke.in-berlin.de>

Hopfully only one reply this time.

On Freitag, 4. November 2005 21:14, Harald Milz wrote:
> On Fri, Nov 04, 2005 at 08:11:59PM +0100, Stefan Lucke wrote:
> > But as usual there is a workaround. Sync timer mode is selectable via OSD
> > (since a few minutes :-) ).
> 
> Guess that means using the CVS version? 
> 
> Are there any drawbacks when deselecting RTC? 

I guess no. RTC was the hardcoded default with usleep timing as
fallback. So on my system it used usleep timeing only, as RTC
is occupied by chronyd for system time trimming. The more advanced
is sig timer which should be made default (at least on my system).

-- 
Stefan Lucke



From Neumann at do-net.de  Fri Nov  4 21:48:35 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Fri, 4 Nov 2005 21:48:35 +0100
Subject: [Softdevice-devel] vidix with matrox g550 - no osd
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039D13D@sbs2003.do-net.de>

Hi,
 
i testet my setup today with vidix (before i used dfb). The video is
shown, but i get no osd. Is there somethin i must do? with dfb
everything is working fine. Anyone can 
give me a quick hint ?
 
-----------------------
Andre Neumann
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051104/e76fc7e9/attachment.html>

From stefan at lucke.in-berlin.de  Fri Nov  4 21:58:51 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 4 Nov 2005 21:58:51 +0100
Subject: [Softdevice-devel] Re: vdr-softdevice-cvs-20051104-finnish
In-Reply-To: <Pine.OSF.4.61.0511042240280.97056@kosh.hut.fi>
References: <Pine.OSF.4.61.0511022323030.79701@kosh.hut.fi> <200511042009.36624.stefan@lucke.in-berlin.de> <Pine.OSF.4.61.0511042240280.97056@kosh.hut.fi>
Message-ID: <200511042158.51942.stefan@lucke.in-berlin.de>

On Freitag, 4. November 2005 21:42, Rolf Ahrenberg wrote:
> On Fri, 4 Nov 2005, Stefan Lucke wrote:
> 
> > Thanks, in cvs now.
> 

Doh, you are fast.
Whats your radar to detect those changes, as you are not on our lists ?

> ..and another update. There's no need to translate those "empty" lines.

Ack, and committed.

Changed default timer to sig timer.

-- 
Stefan Lucke



From marko.makela at hut.fi  Fri Nov  4 22:10:05 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Fri, 4 Nov 2005 23:10:05 +0200
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <200511042011.59286.stefan@lucke.in-berlin.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de>
Message-ID: <20051104211005.GB3750@localhost.localdomain>

On Fri, Nov 04, 2005 at 08:11:59PM +0100, Stefan Lucke wrote:
> But as usual there is a workaround. Sync timer mode is selectable via OSD
> (since a few minutes :-) ).

Here's a small patch for that:

Index: setup-softdevice.c
===================================================================
RCS file: /cvsroot/softdevice/softdevice/setup-softdevice.c,v
retrieving revision 1.34
diff -r1.34 setup-softdevice.c
353c353
<     fprintf(stderr, "[setup-softdevice] syncTimerMode: %d\n",
---
>     fprintf(stderr, "[setup-softdevice] syncTimerMode: %s\n",

I didn't try it yet, as I have an ongoing recording.

	Marko


From hm at seneca.muc.de  Fri Nov  4 22:23:34 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Fri, 4 Nov 2005 22:23:34 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <200511042144.31031.stefan@lucke.in-berlin.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104201423.GA11466@seneca.muc.de> <200511042144.31031.stefan@lucke.in-berlin.de>
Message-ID: <20051104212334.GA13912@seneca.muc.de>

> On Freitag, 4. November 2005 21:14, Harald Milz wrote:
> > 
> > Guess that means using the CVS version? 

Eeeek: 

setup-softdevice.c: In constructor `
   cMenuSetupCropping::cMenuSetupCropping(const char*)':
setup-softdevice.c:434: error: no matching function for call to `cOsdItem::
   cOsdItem(const char[2], eOSState, bool)'
../../../include/vdr/osdbase.h:49: error: candidates are:
   cOsdItem::cOsdItem(const cOsdItem&)
../../../include/vdr/osdbase.h:59: error:
   cOsdItem::cOsdItem(const char*, eOSState)
../../../include/vdr/osdbase.h:58: error:
   cOsdItem::cOsdItem(eOSState)
... long list of error messages, don't compile. 

CVS as of 22:18 CET. 


-- 
Man is the best computer we can put aboard a spacecraft ... and the
only one that can be mass produced with unskilled labor.
		-- Wernher von Braun


From hm at seneca.muc.de  Fri Nov  4 22:23:34 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Fri, 4 Nov 2005 22:23:34 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <200511042144.31031.stefan@lucke.in-berlin.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104201423.GA11466@seneca.muc.de> <200511042144.31031.stefan@lucke.in-berlin.de>
Message-ID: <20051104212334.GA13912@seneca.muc.de>

> On Freitag, 4. November 2005 21:14, Harald Milz wrote:
> > 
> > Guess that means using the CVS version? 

Eeeek: 

setup-softdevice.c: In constructor `
   cMenuSetupCropping::cMenuSetupCropping(const char*)':
setup-softdevice.c:434: error: no matching function for call to `cOsdItem::
   cOsdItem(const char[2], eOSState, bool)'
../../../include/vdr/osdbase.h:49: error: candidates are:
   cOsdItem::cOsdItem(const cOsdItem&)
../../../include/vdr/osdbase.h:59: error:
   cOsdItem::cOsdItem(const char*, eOSState)
../../../include/vdr/osdbase.h:58: error:
   cOsdItem::cOsdItem(eOSState)
... long list of error messages, don't compile. 

CVS as of 22:18 CET. 


-- 
Man is the best computer we can put aboard a spacecraft ... and the
only one that can be mass produced with unskilled labor.
		-- Wernher von Braun


From stefan at lucke.in-berlin.de  Fri Nov  4 22:31:50 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 4 Nov 2005 22:31:50 +0100
Subject: [Softdevice-devel] vidix with matrox g550 - no osd
In-Reply-To: <FB3B5DB3197CEA429E5FB8E83D01D039D13D@sbs2003.do-net.de>
References: <FB3B5DB3197CEA429E5FB8E83D01D039D13D@sbs2003.do-net.de>
Message-ID: <200511042231.50099.stefan@lucke.in-berlin.de>

On Freitag, 4. November 2005 21:48, Andre Neumann wrote:
> Hi,
>  
> i testet my setup today with vidix (before i used dfb). The video is
> shown, but i get no osd. Is there somethin i must do? with dfb
> everything is working fine. Anyone can 
> give me a quick hint ?

Vidix works fine here.

Did you use dfb in YUV2 + stretchblit mode before ?
Try leaving dfb in I420 mode (with color keyed OSD).

For a couple of days I had a similar situation here and it drove me crazy.

Normally I start dfb mode within an  X session. When dfb mode was 
started in YUV2 mode I had a big black sticky rectangle in the upper 
left corner (about 720x576 ? thats a guess). Leaving dfb mode resulted in
color keyed OSD with xv out did not work.
Starting and ending dfb in I420 mode recovered that.
Starting dfb in YUV2 stretchblit brought the black box again :-((( .
I tried several versions of softdevice and directfb without any change.
The black box survived even reboot and soft-poweroff (power disconnect
was not tested).

Now my black box has gone and I do not know why.
Only a small idea. The initial surface size at dfb startup is 720x576.
I changed that once to 820x576, started in dfb YUV2-stretchblit mode
and had a very bad behaviour within softdevice.
A few frames video with sound followed by poll timeouts and codec
reinitialisation (but no black box).
Since the following vdr restart very thing is fine and smooth again.

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Fri Nov  4 22:37:06 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 4 Nov 2005 22:37:06 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <20051104211005.GB3750@localhost.localdomain>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104211005.GB3750@localhost.localdomain>
Message-ID: <200511042237.06030.stefan@lucke.in-berlin.de>

On Freitag, 4. November 2005 22:10, Marko M?kel? wrote:
> On Fri, Nov 04, 2005 at 08:11:59PM +0100, Stefan Lucke wrote:
> > But as usual there is a workaround. Sync timer mode is selectable via OSD
> > (since a few minutes :-) ).
> 
> Here's a small patch for that:
> 
> Index: setup-softdevice.c
> ===================================================================
> RCS file: /cvsroot/softdevice/softdevice/setup-softdevice.c,v
> retrieving revision 1.34
> diff -r1.34 setup-softdevice.c
> 353c353
> <     fprintf(stderr, "[setup-softdevice] syncTimerMode: %d\n",
> ---
> >     fprintf(stderr, "[setup-softdevice] syncTimerMode: %s\n",

Thanks committed.

-- 
Stefan Lucke



From marko.makela at hut.fi  Fri Nov  4 22:47:23 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Fri, 4 Nov 2005 23:47:23 +0200
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <20051104212334.GA13912@seneca.muc.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104201423.GA11466@seneca.muc.de> <200511042144.31031.stefan@lucke.in-berlin.de> <20051104212334.GA13912@seneca.muc.de>
Message-ID: <20051104214723.GA4070@localhost.localdomain>

On Fri, Nov 04, 2005 at 10:23:34PM +0100, Harald Milz wrote:
> > On Freitag, 4. November 2005 21:14, Harald Milz wrote:
> > > 
> > > Guess that means using the CVS version? 
> 
> Eeeek: 
> 
> setup-softdevice.c: In constructor `
>    cMenuSetupCropping::cMenuSetupCropping(const char*)':
> setup-softdevice.c:434: error: no matching function for call to `cOsdItem::
>    cOsdItem(const char[2], eOSState, bool)'
[...]

> ... long list of error messages, don't compile. 
> 
> CVS as of 22:18 CET. 

It worked for me.  How old is your vdr?  The interface has not changed
much at least since 1.3.31.

	Marko


From stefan at lucke.in-berlin.de  Fri Nov  4 22:55:02 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 4 Nov 2005 22:55:02 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <20051104212334.GA13912@seneca.muc.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042144.31031.stefan@lucke.in-berlin.de> <20051104212334.GA13912@seneca.muc.de>
Message-ID: <200511042255.02965.stefan@lucke.in-berlin.de>

On Freitag, 4. November 2005 22:23, Harald Milz wrote:
> > On Freitag, 4. November 2005 21:14, Harald Milz wrote:
> > > 
> > > Guess that means using the CVS version? 
> 
> Eeeek: 
> 
> setup-softdevice.c: In constructor `
>    cMenuSetupCropping::cMenuSetupCropping(const char*)':
> setup-softdevice.c:434: error: no matching function for call to `cOsdItem::
>    cOsdItem(const char[2], eOSState, bool)'

compiles fine here.

Ah,whats that :
new cOsdItem(" ", osUnknown, false);

Whats your compiler version ? 
" " not of type const char * 

Does that that help:
new cOsdItem((const char *) " ", osUnknown, false);

try attached patch.
-- 
Stefan Lucke
-------------- next part --------------
A non-text attachment was scrubbed...
Name: const_char.diff
Type: text/x-diff
Size: 1783 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051104/b7ab2aff/attachment.diff>

From marko.makela at hut.fi  Fri Nov  4 23:04:20 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Sat, 5 Nov 2005 00:04:20 +0200
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <200511042255.02965.stefan@lucke.in-berlin.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042144.31031.stefan@lucke.in-berlin.de> <20051104212334.GA13912@seneca.muc.de> <200511042255.02965.stefan@lucke.in-berlin.de>
Message-ID: <20051104220420.GD4070@localhost.localdomain>

On Fri, Nov 04, 2005 at 10:55:02PM +0100, Stefan Lucke wrote:
> > setup-softdevice.c: In constructor `
> >    cMenuSetupCropping::cMenuSetupCropping(const char*)':
> > setup-softdevice.c:434: error: no matching function for call to `cOsdItem::
> >    cOsdItem(const char[2], eOSState, bool)'
> 
> compiles fine here.
> 
> Ah,whats that :
> new cOsdItem(" ", osUnknown, false);
> 
> Whats your compiler version ? 
> " " not of type const char * 

I think it's perfectly fine for the compiler to interpret " " as equivalent
to const char unnamed[2] = " ".  The compiler can make an implicit cast
to const char*.  GCC has done this for a long time, perhaps at least
since 2.95.

I believe that the problem simply is that there is no matching cOsdItem
constructor.  I'd rather drop the third argument, i.e.,
#if VDR_VERSNUM >= xxxxx
new cOsdItem(" ", osUnknown, false);
#else
new cOsdItem(" ", osUnknown);
#endif

(But is there any point in supporting old vdr versions?)

	Marko


From stefan at lucke.in-berlin.de  Fri Nov  4 23:39:19 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Fri, 4 Nov 2005 23:39:19 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <20051104220420.GD4070@localhost.localdomain>
References: <20051104171435.GA6992@seneca.muc.de> <200511042255.02965.stefan@lucke.in-berlin.de> <20051104220420.GD4070@localhost.localdomain>
Message-ID: <200511042339.20029.stefan@lucke.in-berlin.de>

On Freitag, 4. November 2005 23:04, Marko M?kel? wrote:
> On Fri, Nov 04, 2005 at 10:55:02PM +0100, Stefan Lucke wrote:
> > > setup-softdevice.c: In constructor `
> > >    cMenuSetupCropping::cMenuSetupCropping(const char*)':
> > > setup-softdevice.c:434: error: no matching function for call to `cOsdItem::
> > >    cOsdItem(const char[2], eOSState, bool)'
> > 
> > compiles fine here.
> > 
> > Ah,whats that :
> > new cOsdItem(" ", osUnknown, false);
> > 
> > Whats your compiler version ? 
> > " " not of type const char * 
> 
> I think it's perfectly fine for the compiler to interpret " " as equivalent
> to const char unnamed[2] = " ".  The compiler can make an implicit cast
> to const char*.  GCC has done this for a long time, perhaps at least
> since 2.95.
> 
> I believe that the problem simply is that there is no matching cOsdItem
> constructor.  I'd rather drop the third argument, i.e.,
> #if VDR_VERSNUM >= xxxxx
> new cOsdItem(" ", osUnknown, false);
> #else
> new cOsdItem(" ", osUnknown);
> #endif
> 

I guess you are right. The third argument was not in vdr.1.3.32 but
is now in 1.3.34.

> (But is there any point in supporting old vdr versions?)

CVS version of softdevice does compile and work with vdr-1.2.1
again :-) .

-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Sat Nov  5 09:38:08 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 5 Nov 2005 09:38:08 +0100
Subject: Black square with DirectFB cvs + softdevice YUV2 + stretchblit (Was: Re: [Softdevice-devel] vidix with matrox g550 - no osd)
Message-ID: <200511050938.08883.stefan@lucke.in-berlin.de>

On Freitag, 4. November 2005 22:31, Stefan Lucke wrote:
> On Freitag, 4. November 2005 21:48, Andre Neumann wrote:
> > Hi,
> >  
> > i testet my setup today with vidix (before i used dfb). The video is
> > shown, but i get no osd. Is there somethin i must do? with dfb
> > everything is working fine. Anyone can 
> > give me a quick hint ?
> 
> Vidix works fine here.
> 
> Did you use dfb in YUV2 + stretchblit mode before ?
> Try leaving dfb in I420 mode (with color keyed OSD).
> 
> For a couple of days I had a similar situation here and it drove me crazy.
> 
> Normally I start dfb mode within an  X session. When dfb mode was 
> started in YUV2 mode I had a big black sticky rectangle in the upper 
> left corner (about 720x576 ? thats a guess). Leaving dfb mode resulted in
> color keyed OSD with xv out did not work.
> Starting and ending dfb in I420 mode recovered that.
> Starting dfb in YUV2 stretchblit brought the black box again :-((( .
> I tried several versions of softdevice and directfb without any change.
> The black box survived even reboot and soft-poweroff (power disconnect
> was not tested).
> 
> Now my black box has gone and I do not know why.
> Only a small idea. The initial surface size at dfb startup is 720x576.
> I changed that once to 820x576, started in dfb YUV2-stretchblit mode
> and had a very bad behaviour within softdevice.
> A few frames video with sound followed by poll timeouts and codec
> reinitialisation (but no black box).
> Since the following vdr restart very thing is fine and smooth again.

Aiee, switched back to DirectFB cvs version from 2005-10-31,
and the big black rect in upper left corner is back ;-(( , and color keyed
OSD in xv is inoperable.

-- 
Stefan Lucke



From hm at seneca.muc.de  Sat Nov  5 10:25:56 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Sat, 5 Nov 2005 10:25:56 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <20051104214723.GA4070@localhost.localdomain>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104201423.GA11466@seneca.muc.de> <200511042144.31031.stefan@lucke.in-berlin.de> <20051104212334.GA13912@seneca.muc.de> <20051104214723.GA4070@localhost.localdomain>
Message-ID: <20051105092556.GA22035@seneca.muc.de>

On Fri, Nov 04, 2005 at 11:47:23PM +0200, Marko M?kel? wrote:
> It worked for me.  How old is your vdr?  The interface has not changed
> much at least since 1.3.31.

Ouch. 1.3.26. 

-- 
Corrupt, adj.:
	In politics, holding an office of trust or profit.


From hm at seneca.muc.de  Sat Nov  5 22:54:48 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Sat, 5 Nov 2005 22:54:48 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <200511042339.20029.stefan@lucke.in-berlin.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042255.02965.stefan@lucke.in-berlin.de> <20051104220420.GD4070@localhost.localdomain> <200511042339.20029.stefan@lucke.in-berlin.de>
Message-ID: <20051105215448.GA6117@seneca.muc.de>

On Fri, Nov 04, 2005 at 11:39:19PM +0100, Stefan Lucke wrote:
> CVS version of softdevice does compile and work with vdr-1.2.1
> again :-) .

That did the trick, thank you!!!!


-- 
"We had it tough ... I had to get up at 9 o'clock at night, half an
hour before I went to bed, eat a lump of dry poison, work 29 hours down
mill, and when we came home our Dad would kill us, and dance about on
our grave singing Haleleuia ..."
		-- Monty Python


From hm at seneca.muc.de  Sat Nov  5 22:54:48 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Sat, 5 Nov 2005 22:54:48 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <200511042339.20029.stefan@lucke.in-berlin.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042255.02965.stefan@lucke.in-berlin.de> <20051104220420.GD4070@localhost.localdomain> <200511042339.20029.stefan@lucke.in-berlin.de>
Message-ID: <20051105215448.GA6117@seneca.muc.de>

On Fri, Nov 04, 2005 at 11:39:19PM +0100, Stefan Lucke wrote:
> CVS version of softdevice does compile and work with vdr-1.2.1
> again :-) .

That did the trick, thank you!!!!


-- 
"We had it tough ... I had to get up at 9 o'clock at night, half an
hour before I went to bed, eat a lump of dry poison, work 29 hours down
mill, and when we came home our Dad would kill us, and dance about on
our grave singing Haleleuia ..."
		-- Monty Python


From laz at club-burniston.co.uk  Sun Nov  6 12:24:38 2005
From: laz at club-burniston.co.uk (Laz)
Date: Sun, 6 Nov 2005 11:24:38 +0000
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
Message-ID: <200511061124.38533.laz@club-burniston.co.uk>


This patch applied against current CVS of softdevice give a new DirectFB 
output option for Via Unichrome TV-out (works with an Epia MII board with a 
vt1622a encoder: I don't know if the vt1622 encoders work without it or not).

Using the standard '-vo dfb:' driver, I get quite good A-V sync but the field 
parity switches back and forth every few seconds. Using the new '-vo 
dfb:viatv' driver enables triple buffering and enables Field Parity sync, and 
this gives me a much better picture. Every now and then I'm seeing the odd 
blip where the field parity is incorrect but I think that is due to a kernel 
latency issue I need to track down!

I have yet to settle on the best value for the A-V delay and it seems to vary 
somewhat between channels! That could just be my imagination, though!

For this to work, a recent CVS version of DirectFB and viafb (from DirectFB) 
are required and both must be patched with the patches at:
http://mail.directfb.org/pipermail/directfb-users/2005-November/001042.html

Stefan: it will probably need a bit of cleaning up but hopefully you can work 
it out!

Cheers,

Laz
-------------- next part --------------
A non-text attachment was scrubbed...
Name: softdevice_field_parity.diff
Type: text/x-diff
Size: 5668 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051106/ae064d0b/attachment.diff>

From hm at seneca.muc.de  Sun Nov  6 13:09:23 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Sun, 6 Nov 2005 13:09:23 +0100
Subject: [Softdevice-devel] Using hardware MPEG2 decoder?
Message-ID: <20051106120923.GA8443@seneca.muc.de>

Hi,

this idea may sound somethat strange but it may be worth considering. 

For people who have FF cards it may be a good idea to use the FF card's
MPEG2 decoder for standard PAL or NTSC broadcastings. This would reduce the
load of the main CPU and hence reduce noise if you have a thermostatic fan.
For other broadcast formats one would use software decoding. 

This would also have the advantage of using a digital out for everything.
The FF card only has analog outs. I want DVI out. I would assume that
the streamdev code is able to retrieve the decoded data from the card,
right? Softdevice would only rescale if necessary and send everything
to DFB or whatever.

One could probably build a separate plugin to retrieve the TS stream from
the card and send it to DFB but I think it would be better to have a
unified plugin to handle both. 

Or am I off track ? 


-- 
Ask not for whom the telephone bell tolls ... if thou art in the
bathtub, it tolls for thee.


From stefan at lucke.in-berlin.de  Sun Nov  6 14:26:22 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 6 Nov 2005 14:26:22 +0100
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <200511061124.38533.laz@club-burniston.co.uk>
References: <200511061124.38533.laz@club-burniston.co.uk>
Message-ID: <200511061426.22776.stefan@lucke.in-berlin.de>

On Sonntag, 6. November 2005 12:24, Laz wrote:
> 
> This patch applied against current CVS of softdevice give a new DirectFB 
> output option for Via Unichrome TV-out (works with an Epia MII board with a 
> vt1622a encoder: I don't know if the vt1622 encoders work without it or not).
> 
> Using the standard '-vo dfb:' driver, I get quite good A-V sync but the field 
> parity switches back and forth every few seconds. Using the new '-vo 
> dfb:viatv' driver enables triple buffering and enables Field Parity sync, and 
> this gives me a much better picture. Every now and then I'm seeing the odd 
> blip where the field parity is incorrect but I think that is due to a kernel 
> latency issue I need to track down!
> 
> I have yet to settle on the best value for the A-V delay and it seems to vary 
> somewhat between channels! That could just be my imagination, though!
> 
> For this to work, a recent CVS version of DirectFB and viafb (from DirectFB) 
> are required and both must be patched with the patches at:
> http://mail.directfb.org/pipermail/directfb-users/2005-November/001042.html
> 
> Stefan: it will probably need a bit of cleaning up but hopefully you can work 
> it out!

Thanks.

As I learned, Testconfiguration _must_ be protected by try {} catch{}
to take action upon failures. Thats already in my version, so I'll
change that.

Only small things, but with the last hunk I have some questions:
> @@ -1257,7 +1305,10 @@
> ? ? ?}
> ? ? ?else
> ? ? ?{
> - ? ? ?videoSurface->Flip(NULL, DSFLIP_ONSYNC);
> + ? ? ?if (setupStore->useUnichrometv)
> + ? ? ? ? ?videoSurface->Flip();

Did you try ONSYNC in your enviroment ?
If yes whats the impact, if no please try as it would us allow to keep the default.

> + ? ? ?else
> + ? ? ? ? ?videoSurface->Flip(NULL, DSFLIP_WAITFORSYNC);

Here you change the default for others from ONSYNC to WAITFORSYNC.
I guess it's better to keep ONSYNC.

> ? ? ?}
> ? ?}
> ? ?catch (DFBException *ex)

-- 
Stefan Lucke



From laz at club-burniston.co.uk  Sun Nov  6 15:17:47 2005
From: laz at club-burniston.co.uk (Laz)
Date: Sun, 6 Nov 2005 14:17:47 +0000
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <200511061426.22776.stefan@lucke.in-berlin.de>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511061426.22776.stefan@lucke.in-berlin.de>
Message-ID: <200511061417.47174.laz@club-burniston.co.uk>

On Sunday 06 November 2005 13:26, Stefan Lucke wrote:
> On Sonntag, 6. November 2005 12:24, Laz wrote:
> Thanks.
>
> As I learned, Testconfiguration _must_ be protected by try {} catch{}
> to take action upon failures. Thats already in my version, so I'll
> change that.

I added a couple of try {} and catch {} bits after your comments the other 
day.

> Only small things, but with the last hunk I have some questions:
> > @@ -1257,7 +1305,10 @@
> > ? ? ?}
> > ? ? ?else
> > ? ? ?{
> > - ? ? ?videoSurface->Flip(NULL, DSFLIP_ONSYNC);
> > + ? ? ?if (setupStore->useUnichrometv)
> > + ? ? ? ? ?videoSurface->Flip();
>
> Did you try ONSYNC in your enviroment ?
> If yes whats the impact, if no please try as it would us allow to keep the
> default.

I have tried various Flip calls but I think I've only tried the Flip() one 
with the current viafb and DierctFB patches. I'll give it a go in  afew 
minutes. Previously, I didn't see any difference.

> > + ? ? ?else
> > + ? ? ? ? ?videoSurface->Flip(NULL, DSFLIP_WAITFORSYNC);
>
> Here you change the default for others from ONSYNC to WAITFORSYNC.
> I guess it's better to keep ONSYNC.

Probably something hanging over from when I was testing stuff before: I was 
trying not to change anything else. Oops!

After more testing, maybe it isn't yet _quite_ as good as it could be but is a 
big improvement over what I have had. One thing I have noticed is that 
pausing can give a very flickery picture, looking like it is alternating 
between two fields, or frames, or the sync is reversing, or something like 
that.

Cheers,

Laz


From laz at club-burniston.co.uk  Sun Nov  6 15:26:50 2005
From: laz at club-burniston.co.uk (Laz)
Date: Sun, 6 Nov 2005 14:26:50 +0000
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <200511061426.22776.stefan@lucke.in-berlin.de>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511061426.22776.stefan@lucke.in-berlin.de>
Message-ID: <200511061426.50854.laz@club-burniston.co.uk>

On Sunday 06 November 2005 13:26, Stefan Lucke wrote:

> Did you try ONSYNC in your enviroment ?
> If yes whats the impact, if no please try as it would us allow to keep the
> default.
>
> > + ? ? ?else
> > + ? ? ? ? ?videoSurface->Flip(NULL, DSFLIP_WAITFORSYNC);
>
> Here you change the default for others from ONSYNC to WAITFORSYNC.
> I guess it's better to keep ONSYNC.

Just tried and it works for me, i.e. ignore that bit of my patch and leave it 
as DSFLIP_ONSYNC.

Cheers,

Laz


From stefan at lucke.in-berlin.de  Sun Nov  6 15:56:14 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 6 Nov 2005 15:56:14 +0100
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <200511061417.47174.laz@club-burniston.co.uk>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511061426.22776.stefan@lucke.in-berlin.de> <200511061417.47174.laz@club-burniston.co.uk>
Message-ID: <200511061556.14438.stefan@lucke.in-berlin.de>

On Sonntag, 6. November 2005 15:17, Laz wrote:
> On Sunday 06 November 2005 13:26, Stefan Lucke wrote:
> > On Sonntag, 6. November 2005 12:24, Laz wrote:
> > Thanks.
> >
> > As I learned, Testconfiguration _must_ be protected by try {} catch{}
> > to take action upon failures. Thats already in my version, so I'll
> > change that.
> 
> I added a couple of try {} and catch {} bits after your comments the other 
> day.
> 

That's what I was wondering on one directfb lists. Testconfiguration()
throws a exception when one parameter is not supported. I had
that with matrox BES when I tried to display 1920x1080 video. BES has
a limit of 1024 (height) :-(  .

> > Only small things, but with the last hunk I have some questions:
> > > @@ -1257,7 +1305,10 @@
> > > ? ? ?}
> > > ? ? ?else
> > > ? ? ?{
> > > - ? ? ?videoSurface->Flip(NULL, DSFLIP_ONSYNC);
> > > + ? ? ?if (setupStore->useUnichrometv)
> > > + ? ? ? ? ?videoSurface->Flip();
> >
> > Did you try ONSYNC in your enviroment ?
> > If yes whats the impact, if no please try as it would us allow to keep the
> > default.
> 
> I have tried various Flip calls but I think I've only tried the Flip() one 
> with the current viafb and DierctFB patches. I'll give it a go in  afew 
> minutes. Previously, I didn't see any difference.
> 
> > > + ? ? ?else
> > > + ? ? ? ? ?videoSurface->Flip(NULL, DSFLIP_WAITFORSYNC);
> >
> > Here you change the default for others from ONSYNC to WAITFORSYNC.
> > I guess it's better to keep ONSYNC.
> 
> Probably something hanging over from when I was testing stuff before: I was 
> trying not to change anything else. Oops!
> 
> After more testing,

Is that the test you mentioned above ?

> maybe it isn't yet _quite_ as good as it could be but is a 
> big improvement over what I have had. One thing I have noticed is that 
> pausing can give a very flickery picture, looking like it is alternating 
> between two fields, or frames, or the sync is reversing, or something like 
> that.

Thats normal when displaying interlaced still pictures (both fields 
at the same time). 

I think I'll rename 'usUnichrometv' to 'viatv'. That is not hardware
vendor VIA, just a mor general via, as that mode just does:
- enables field parity for primary layer
- changes double buffering from double to triple

Perhaps I have to add a separate option which enables
triple buffering and viatv switches to trple buffering too.

Just unified some actions of setting field parity (mga + via).
-- 
Stefan Lucke



From laz at club-burniston.co.uk  Sun Nov  6 16:52:51 2005
From: laz at club-burniston.co.uk (Laz)
Date: Sun, 6 Nov 2005 15:52:51 +0000
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <200511061556.14438.stefan@lucke.in-berlin.de>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511061417.47174.laz@club-burniston.co.uk> <200511061556.14438.stefan@lucke.in-berlin.de>
Message-ID: <200511061552.51677.laz@club-burniston.co.uk>

On Sunday 06 November 2005 14:56, Stefan Lucke wrote:
> On Sonntag, 6. November 2005 15:17, Laz wrote:
> > I added a couple of try {} and catch {} bits after your comments the
> > other day.
>
> That's what I was wondering on one directfb lists. Testconfiguration()
> throws a exception when one parameter is not supported. I had
> that with matrox BES when I tried to display 1920x1080 video. BES has
> a limit of 1024 (height) :-(  .

I haven't had a seg fault yet but vdr did restart at one point. I think this 
was on an aspect change after stopping playback of a recording.

{snippage}

> > > Here you change the default for others from ONSYNC to WAITFORSYNC.
> > > I guess it's better to keep ONSYNC.
> >
> > Probably something hanging over from when I was testing stuff before: I
> > was trying not to change anything else. Oops!
> >
> > After more testing,
>
> Is that the test you mentioned above ?

No: from a few weeks back when I was testing other stuff trying to get proper 
field sync.

> > maybe it isn't yet _quite_ as good as it could be but is a
> > big improvement over what I have had. One thing I have noticed is that
> > pausing can give a very flickery picture, looking like it is alternating
> > between two fields, or frames, or the sync is reversing, or something
> > like that.
>
> Thats normal when displaying interlaced still pictures (both fields
> at the same time).

I know it'll never be perfect but I'm still convinced that it is worse than it 
should be! I can live with it, though!

:)

> I think I'll rename 'usUnichrometv' to 'viatv'. That is not hardware
> vendor VIA, just a mor general via, as that mode just does:
> - enables field parity for primary layer
> - changes double buffering from double to triple

Go for it: better to keep the code consistent!

> Perhaps I have to add a separate option which enables
> triple buffering and viatv switches to trple buffering too.

Maybe it would be better as s setup option but maybe not one of the ones on 
the new 'front setup menu'. Not sure where it would go, though! Are the 'Use 
StretchBlit', 'OSDalphablend', and 'Pixel format' still on the front page? 
Maybe they could go in a sub-menu with the buffering option.

Cheers,

Laz

> Just unified some actions of setting field parity (mga + via).

Cool.


From stefan at lucke.in-berlin.de  Sun Nov  6 18:28:44 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 6 Nov 2005 18:28:44 +0100
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <200511061552.51677.laz@club-burniston.co.uk>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511061556.14438.stefan@lucke.in-berlin.de> <200511061552.51677.laz@club-burniston.co.uk>
Message-ID: <200511061828.44156.stefan@lucke.in-berlin.de>

On Sonntag, 6. November 2005 16:52, Laz wrote:
> On Sunday 06 November 2005 14:56, Stefan Lucke wrote:
> > On Sonntag, 6. November 2005 15:17, Laz wrote:
> > > I added a couple of try {} and catch {} bits after your comments the
> > > other day.
> >
> > That's what I was wondering on one directfb lists. Testconfiguration()
> > throws a exception when one parameter is not supported. I had
> > that with matrox BES when I tried to display 1920x1080 video. BES has
> > a limit of 1024 (height) :-(  .
> 
> I haven't had a seg fault yet but vdr did restart at one point. I think this 
> was on an aspect change after stopping playback of a recording.
> 
> {snippage}

Segfault at aspect change ? We had that several time. Verify your 
ffmpeg version is new than mid of May.

> 
> > > > Here you change the default for others from ONSYNC to WAITFORSYNC.
> > > > I guess it's better to keep ONSYNC.
> > >
> > > Probably something hanging over from when I was testing stuff before: I
> > > was trying not to change anything else. Oops!
> > >
> > > After more testing,
> >
> > Is that the test you mentioned above ?
> 
> No: from a few weeks back when I was testing other stuff trying to get proper 
> field sync.
> 
> > > maybe it isn't yet _quite_ as good as it could be but is a
> > > big improvement over what I have had. One thing I have noticed is that
> > > pausing can give a very flickery picture, looking like it is alternating
> > > between two fields, or frames, or the sync is reversing, or something
> > > like that.
> >
> > Thats normal when displaying interlaced still pictures (both fields
> > at the same time).
> 
> I know it'll never be perfect but I'm still convinced that it is worse than it 
> should be! I can live with it, though!
> 
> :)

But perhaps we can act on that, if we know that a stillpicture is from
interlaced video and we could display one field only.

> 
> > I think I'll rename 'usUnichrometv' to 'viatv'. That is not hardware
> > vendor VIA, just a mor general via, as that mode just does:
> > - enables field parity for primary layer
> > - changes double buffering from double to triple
> 
> Go for it: better to keep the code consistent!
> 
> > Perhaps I have to add a separate option which enables
> > triple buffering and viatv switches to trple buffering too.

For the moment I'll place that buffering on commandline only
-vo:triple 

I think I know why I commented out the triple buffering mode for BES.
That was originally a patch from Torgeir and I had problems with it.
I see some problems now when I enable triple buffering on matrox
BES. Stuttering video like every 2nd frame is skipped (no '+' chars written).


-- 
Stefan Lucke



From laz at club-burniston.co.uk  Sun Nov  6 18:39:53 2005
From: laz at club-burniston.co.uk (Laz)
Date: Sun, 6 Nov 2005 17:39:53 +0000
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <200511061828.44156.stefan@lucke.in-berlin.de>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511061552.51677.laz@club-burniston.co.uk> <200511061828.44156.stefan@lucke.in-berlin.de>
Message-ID: <200511061739.53910.laz@club-burniston.co.uk>

On Sunday 06 November 2005 17:28, Stefan Lucke wrote:
> On Sonntag, 6. November 2005 16:52, Laz wrote:
> > I haven't had a seg fault yet but vdr did restart at one point. I think
> > this was on an aspect change after stopping playback of a recording.
> >
> Segfault at aspect change ? We had that several time. Verify your
> ffmpeg version is new than mid of May.

Don't worry yet! It may be down to vdr and not softdevice, although sometimes 
it seems to take a few seconds to return to live TV when I stop a recording. 
What I saw was vdr restarting rather than a total bomb-out with a seg fault 
from DirectFB. It may have just been 'one of those odd occasions' but I'll 
get it going through gdb and wait to see if it happens again. On second 
thoughts, I'll modify my startup script so that it appends the tail of the 
output to a log file when it restarts.

My ffmpeg is CVS from a few days back, following a discussion on here last 
week!

> > > Thats normal when displaying interlaced still pictures (both fields
> > > at the same time).
> >
> > I know it'll never be perfect but I'm still convinced that it is worse
> > than it should be! I can live with it, though!
> >
> > :)
>
> But perhaps we can act on that, if we know that a stillpicture is from
> interlaced video and we could display one field only.

Oooo...I like.

> > > I think I'll rename 'usUnichrometv' to 'viatv'. That is not hardware
> > > vendor VIA, just a mor general via, as that mode just does:
> > > - enables field parity for primary layer
> > > - changes double buffering from double to triple
> >
> > Go for it: better to keep the code consistent!
> >
> > > Perhaps I have to add a separate option which enables
> > > triple buffering and viatv switches to trple buffering too.
>
> For the moment I'll place that buffering on commandline only
> -vo:triple
>
> I think I know why I commented out the triple buffering mode for BES.
> That was originally a patch from Torgeir and I had problems with it.
> I see some problems now when I enable triple buffering on matrox
> BES. Stuttering video like every 2nd frame is skipped (no '+' chars
> written).

Fair enough. So will this become a case of '-vo viatv,triple'?

Cheers,

Laz


From stefan at lucke.in-berlin.de  Sun Nov  6 19:07:33 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 6 Nov 2005 19:07:33 +0100
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <200511061739.53910.laz@club-burniston.co.uk>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511061828.44156.stefan@lucke.in-berlin.de> <200511061739.53910.laz@club-burniston.co.uk>
Message-ID: <200511061907.33443.stefan@lucke.in-berlin.de>

On Sonntag, 6. November 2005 18:39, Laz wrote:
> On Sunday 06 November 2005 17:28, Stefan Lucke wrote:
> > On Sonntag, 6. November 2005 16:52, Laz wrote:

> 
> > > > Thats normal when displaying interlaced still pictures (both fields
> > > > at the same time).
> > >
> > > I know it'll never be perfect but I'm still convinced that it is worse
> > > than it should be! I can live with it, though!
> > >
> > > :)
> >
> > But perhaps we can act on that, if we know that a stillpicture is from
> > interlaced video and we could display one field only.
> 
> Oooo...I like.
> 

Hopefully the interlaced flag is set correct by the TV stations.
One flag I tested (guess it was the field parity flag) had a high 
alteration frequency, and is therefor unrelaiable.

> > For the moment I'll place that buffering on commandline only
> > -vo:triple
> >
> > I think I know why I commented out the triple buffering mode for BES.
> > That was originally a patch from Torgeir and I had problems with it.
> > I see some problems now when I enable triple buffering on matrox
> > BES. Stuttering video like every 2nd frame is skipped (no '+' chars
> > written).
> 
> Fair enough. So will this become a case of '-vo viatv,triple'?
> 

-vo dfb:viatv  internal enables triple
-vo dfb:triple thats triple buffering only

Thats in cvs now.

-- 
Stefan Lucke



From torgeir at pobox.com  Sun Nov  6 21:45:02 2005
From: torgeir at pobox.com (Torgeir Veimo)
Date: Mon, 07 Nov 2005 06:45:02 +1000
Subject: [Softdevice-devel] Using hardware MPEG2 decoder?
In-Reply-To: <20051106120923.GA8443@seneca.muc.de>
References: <20051106120923.GA8443@seneca.muc.de>
Message-ID: <1131309902.2979.8.camel@localhost.localdomain>

On Sun, 2005-11-06 at 13:09 +0100, Harald Milz wrote:
> I would assume that the streamdev code is able to retrieve the decoded
> data from the card, right?  

No, it's not possible to retrieve data from the framebuffer of any FF
card, sorry. 

-- 
Torgeir Veimo <torgeir at pobox.com>



From hm at seneca.muc.de  Sun Nov  6 21:56:11 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Sun, 6 Nov 2005 21:56:11 +0100
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <200511061556.14438.stefan@lucke.in-berlin.de>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511061426.22776.stefan@lucke.in-berlin.de> <200511061417.47174.laz@club-burniston.co.uk> <200511061556.14438.stefan@lucke.in-berlin.de>
Message-ID: <20051106205611.GD19593@seneca.muc.de>

On Sun, Nov 06, 2005 at 03:56:14PM +0100, Stefan Lucke wrote:
> that with matrox BES when I tried to display 1920x1080 video. BES has
> a limit of 1024 (height) :-(  .

Matrox problem :-(( Are there cards that support 1980x1080 natively on DVI
out?  Just in case somebody in DE comes up with 1080i broadcastings... 

-- 
"I'd love to go out with you, but I never go out on days that end in
`Y.'"


From hm at seneca.muc.de  Sun Nov  6 21:56:11 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Sun, 6 Nov 2005 21:56:11 +0100
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <200511061556.14438.stefan@lucke.in-berlin.de>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511061426.22776.stefan@lucke.in-berlin.de> <200511061417.47174.laz@club-burniston.co.uk> <200511061556.14438.stefan@lucke.in-berlin.de>
Message-ID: <20051106205611.GD19593@seneca.muc.de>

On Sun, Nov 06, 2005 at 03:56:14PM +0100, Stefan Lucke wrote:
> that with matrox BES when I tried to display 1920x1080 video. BES has
> a limit of 1024 (height) :-(  .

Matrox problem :-(( Are there cards that support 1980x1080 natively on DVI
out?  Just in case somebody in DE comes up with 1080i broadcastings... 

-- 
"I'd love to go out with you, but I never go out on days that end in
`Y.'"


From stefan at lucke.in-berlin.de  Sun Nov  6 23:13:21 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 6 Nov 2005 23:13:21 +0100
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <20051106205611.GD19593@seneca.muc.de>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511061556.14438.stefan@lucke.in-berlin.de> <20051106205611.GD19593@seneca.muc.de>
Message-ID: <200511062313.21562.stefan@lucke.in-berlin.de>

On Sonntag, 6. November 2005 21:56, Harald Milz wrote:
> On Sun, Nov 06, 2005 at 03:56:14PM +0100, Stefan Lucke wrote:
> > that with matrox BES when I tried to display 1920x1080 video. BES has
> > a limit of 1024 (height) :-(  .
> 
> Matrox problem :-(( Are there cards that support 1980x1080 natively on DVI
> out?  Just in case somebody in DE comes up with 1080i broadcastings... 

Oh, that limitation applies only using the back end scaler. Using YUY2
and stretchbilt :-) I had no problem except cpu power [limit is 2048x2048].


-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Sun Nov  6 23:19:04 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 6 Nov 2005 23:19:04 +0100
Subject: [Softdevice-devel] Using hardware MPEG2 decoder?
In-Reply-To: <1131309902.2979.8.camel@localhost.localdomain>
References: <20051106120923.GA8443@seneca.muc.de> <1131309902.2979.8.camel@localhost.localdomain>
Message-ID: <200511062319.04393.stefan@lucke.in-berlin.de>

On Sonntag, 6. November 2005 21:45, Torgeir Veimo wrote:
> On Sun, 2005-11-06 at 13:09 +0100, Harald Milz wrote:
> > I would assume that the streamdev code is able to retrieve the decoded
> > data from the card, right?  
> 
> No, it's not possible to retrieve data from the framebuffer of any FF
> card, sorry. 

A while ago I though something similar on vdr-list, but was told
that reading decoded data, is the normal way screen shots work.
I guess there is already a plugin, that takes decoded data from
FF cards and draws to an X window.

-- 
Stefan Lucke



From nhuillard at e-dition.fr  Mon Nov  7 13:06:10 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Mon, 07 Nov 2005 13:06:10 +0100
Subject: [Softdevice-devel] Using hardware MPEG2 decoder?
In-Reply-To: <200511062319.04393.stefan@lucke.in-berlin.de>
References: <20051106120923.GA8443@seneca.muc.de> <1131309902.2979.8.camel@localhost.localdomain> <200511062319.04393.stefan@lucke.in-berlin.de>
Message-ID: <436F4332.4010505@e-dition.fr>

Stefan Lucke a ?crit :
> On Sonntag, 6. November 2005 21:45, Torgeir Veimo wrote:
> 
>>On Sun, 2005-11-06 at 13:09 +0100, Harald Milz wrote:
>>
>>>I would assume that the streamdev code is able to retrieve the decoded
>>>data from the card, right?  
>>
>>No, it's not possible to retrieve data from the framebuffer of any FF
>>card, sorry. 
> 
> A while ago I though something similar on vdr-list, but was told
> that reading decoded data, is the normal way screen shots work.
> I guess there is already a plugin, that takes decoded data from
> FF cards and draws to an X window.

That's how kvdr works, using DMA transfers : the FF card transfers
decoded frames to the video buffer, without application work.
I think the interface is simply v4l

Hardware decoding with softdevice is a hot subject, covering :
* using MPEG2 decoder on many video cards (CLE266, nVidia)
* using DXR3 (doubling the dxr3 plugin)
* using FF-cards
* using MPEG4 decoders when available (CN400)
* either through DirectFB video providers, XvMC, v4l, ffmepgs, etc...

That's a lot of brainstorming...

-- 
NH


From laz at club-burniston.co.uk  Tue Nov  8 10:41:58 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Tue, 08 Nov 2005 09:41:58 +0000
Subject: [Softdevice-devel] Seg fault in dfb_gfxcard_state_check with softdevice...
Message-ID: <1131442918.14296.12.camel@laser2.york.ac.uk>

I've got vdr + softdevice + DirectFB running quite nicely now (using
patches supplied by Mark Adams) but it sometimes throws a seg fault
during initialisation (starting vdr from my init scripts). Here is the
output from softdevice:

Starting program: /usr/local/bin/vdr-1.3.36 -v /video -w 20
-L/home/vdr/plugins-c/home/vdr/vdrconf -P'softdevice -vo dfb:viatv'
[Thread debugging using libthread_db enabled]
[New Thread 16384 (LWP 4611)]
[softdevice] processing args
[softdevice]   argv [0] = softdevice
[softdevice]   argv [1] = -vo
vo_argv: dfb:viatv
[softdevice] Enabling Unichrome Field Parity
[setup-softdevice] alsa ac3Mode set to: 0
[setup-softdevice] alsa AC3 device set to: hw:0,1
[setup-softdevice] alsa device set to: default
[setup-softdevice] A/V Offset set to (-2)
[setup-softdevice] Cropping 0 lines from bottom
[setup-softdevice] Cropping 0 columns from left
[setup-softdevice] cropping mode set to 0 (none)
[setup-softdevice] cropping mode toggle key set to 0 (none)
[setup-softdevice] Cropping 0 columns from right
[setup-softdevice] Cropping 0 lines from top
[setup-softdevice] deinterlace method set to 0 none
[setup-softdevice] mainMenu: 1
[setup-softdevice] setting alpha blend mode to pseudo
[softdevice] picture mirroring set to 0 (off)
[setup-softdevice] pixel format set to (I420)
[setup-softdevice] shouldSuspend to: 0
[setup-softdevice] syncTimerMode: sig
[softdevice] UseStretchBlitset to off
[setup-softdevice] vidBrightness: 50
[setup-softdevice] vidContrast: 50
[setup-softdevice] vidHue: 50
[setup-softdevice] vidSaturation: 50
[setup-softdevice] startup aspect set to (4:3 normal)
[New Thread 32769 (LWP 4614)]
[New Thread 16386 (LWP 4615)]
[Thread 16386 (LWP 4615) exited]
[New Thread 32771 (LWP 4616)]
[softdevice] initializing Plugin
[softdevice] Initializing Video Out
[softdevice] ffmpeg version(CVS) build(3277056)
[New Thread 49154 (LWP 4617)]
[dfb] init
(*) DirectFB/Config: Parsing config file '/etc/directfbrc'.

       ---------------------- DirectFB v0.9.24 ---------------------
             (c) 2000-2002  convergence integrated media GmbH
             (c) 2002-2004  convergence GmbH
        -----------------------------------------------------------

(*) DirectFB/Core: Single Application Core. (2005-11-04 18:37)
(*) Direct/Memcpy: Using SSE optimized memcpy()
(*) Direct/Modules: suppress module 'joystick'
(*) Direct/Modules: suppress module 'lirc'
(*) DirectFB/Genefx: MMX detected and enabled
(!) DirectFB/Unichrome: Failed to determine hardware revision, assuming
17.
(*) DirectFB/Graphics: VIA/S3G CLE266/UniChrome 0.4 (-)
(*) DirectFB/Core/WM: Default 0.2 (Convergence GmbH)
 (!!!)  *** UNIMPLEMENTED [fusion_reactor_set_lock] ***
[../../../lib/fusion/reactor.c:797]
[dfb] RAM: 66842624 bytes
[dfb] Accellerated Functions: FillRectange DrawRectange DrawLine
FillTriangle Blit StretchBlit All
[dfb] Drawing Flags: Blend Xor
[dfb] Surface Blitting Flags: BlendAlpha BlendColorAlpha Colorize
SrcColorkey DstColorkey Deinterlace
[dfb] Supported video Modes are: 720x576 at 32
[dfb] Enumerating display Layers
Layer 0 FBDev Primary Layer  Type: graphics
  Caps: brightness contrast saturation surface
Layer 1 VIA Unichrome Video  Type: graphics picture video
  Caps: deinterlacing dst_colorkey levels field_parity opacity
screen_location surface
[dfb]: Set unichrome DLBM_TRIPLE
[dfb]: enabling unichrome DLOP_FIELD_PARITY
[surface capabilities] scrSurface: primary videoonly double-buffered
flipping
[dfb] width = 720, height = 576
[dfb] got fmt = 0x00418c04 bpp = 32
[dfb] Using this layer for OSD: (FBDev Primary Layer - [720x576])
[surface capabilities] osdSurface: videoonly double-buffered flipping
[surface capabilities] videoSurface: videoonly flipping triple-buffered
[dfb] Configuring CooperativeLevel for Overlay
[dfb] Configuring CooperativeLevel for OSD
[dfb] Using this layer for OSD: FBDev Primary Layer
[dfb] Using this layer for Video out: VIA Unichrome Video
[dfb] Display frame time is 19998 microseconds
[dfb] (re)configuring Videolayer to 736 x 576 (720x576)
[dfb] SetParams: Enabling DLOP_FIELD_PARITY
[dfb]: SetParms (): Setting DLBM_TRIPLE for Unichrome
[surface capabilities] videoSurface: videoonly flipping triple-buffered
[dfb] (re)configured 0x08100609
[dfb] (re)configured 0x08100609
[New Thread 65540 (LWP 4618)]
[softdevice] Video Out seems to be OK
[softdevice] Initializing Audio Out
[softdevice] Audio out seems to be OK
[softdevice] A/V devices initialized, now initializing MPEG2 Decoder
cSoftDevice::MakePrimaryDevice
[New Thread 81925 (LWP 4619)]
[New Thread 98310 (LWP 4620)]
[dfb] (re)configuring Videolayer to 736 x 576 (720x576)
[dfb] SetParams: Enabling DLOP_FIELD_PARITY
[dfb]: SetParms (): Setting DLBM_TRIPLE for Unichrome
[surface capabilities] videoSurface: videoonly flipping triple-buffered
[dfb] (re)configured 0x08100609

(and the reconfiguring bit about a further 5 times)

[dfb] (re)configured 0x08100609
 (!!!)  *** WARNING [Application exited without deinitialization of
DirectFB!] *** [../../../src/core/core.c:630 in dfb_core_deinit_check()]

And here's the backtrace:
#0  0xb751cec1 in dfb_gfxcard_state_check ()
   from /usr/lib/libdirectfb-0.9.so.24
#1  0xb751e22b in dfb_gfxcard_fillrectangles ()
   from /usr/lib/libdirectfb-0.9.so.24
#2  0xb74f8e0e in IDirectFBSurface_Construct ()
   from /usr/lib/libdirectfb-0.9.so.24
#3  0xb75475c9 in IDirectFBSurface::Clear () from /usr/lib/libdfb
++-0.9.so.23
#4  0xb7ccef15 in cDFBVideoOut::CloseOSD (this=0x859c6f8) at
video-dfb.c:1095
#5  0xb7cbabf4 in ~cSoftOsd (this=0x860f718) at softdevice.c:121
#6  0x080f7e97 in ~cSkinSTTNGDisplayMessage (this=0x85ef4d0)
    at skinsttng.c:1064
#7  0x080eef47 in ~cSkins (this=0x81e0bc4) at skins.c:152
#8  0x080ef312 in __tcf_0 () at skins.c:143
#9  0xb7d08ade in exit () from /lib/libc.so.6
#10 0x0810a3f2 in Watchdog (signum=14) at vdr.c:89
#11 0xb7ef3fe1 in __pthread_sighandler () from /lib/libpthread.so.0
#12 <signal handler called>
#13 0xb7ef4b36 in nanosleep () from /lib/libpthread.so.0
#14 0x00000000 in ?? ()
#15 0xb7eef1a5 in __pthread_timedsuspend_new ()
from /lib/libpthread.so.0
#16 0xb7eec1d7 in pthread_cond_timedwait at GLIBC_2.0 ()
from /lib/libpthread.so.0
#17 0x081013f6 in cCondVar::TimedWait (this=0xfffffffc,
Mutex=@0x81e0610,
    TimeoutMs=-4) at thread.c:122
#18 0x080e059b in cRemote::Get (WaitMs=1000, UnknownCode=0x0) at
remote.c:168
#19 0x080abad7 in cInterface::GetKey (this=0x8604c50, Wait=true)
    at interface.c:47
#20 0x080abbd4 in cInterface::Wait (this=0x8604c50, Seconds=49,
KeepChar=false)
    at interface.c:58
#21 0x080ef17d in cSkins::Message (this=0x81e0bc4, Type=mtError,
    s=0x811f98a "Channel not available!", Seconds=-4) at skins.c:186
#22 0x080949a7 in cDevice::SwitchChannel (Direction=1) at device.c:564
#23 0x0810cff1 in main (argc=8, argv=0xbf874284) at device.h:235

I've not seen this one before in my tinkering! I'm, not sure whether it
is down to DirectFB or whether softdevice is triggering it, somehow.

If I try to run it again after this, it will fail with the same message.
It needs a reboot before it will initialise properly. This makes me
wonder if it's down to the initialisation of viafb. Once it is up and
running, it seems quite solid. I've just moved vdr to later on in my
boot sequence: maybe it is trying to access the framebuffer before the
module has fully initialised, or something like that?!

This is with vdr-1.3.36, softdevice cvs and DirectFB cvs both from about
4 days back, with viafb and DirectFB patched for FIELD_PARITY and
softdevice patched to use this, on an Epia MII board.

Cheers,

Laz



From Neumann at do-net.de  Tue Nov  8 10:48:55 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Tue, 8 Nov 2005 10:48:55 +0100
Subject: [Softdevice-devel] Seg fault in dfb_gfxcard_state_check with softdevice...
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B8C@sbs2003.do-net.de>

Hi,

I notice the same "feature" with my matrox g550 setup. Sometimes
softdevice hangs with "[dfb] (re)configured 0x08100609" and only a
reboot fixes it.

Dont know if thats related to softdevice or DirectFB.

-------------
Andre Neumann
 

> -----Original Message-----
> From: softdevice-devel-admin at berlios.de 
> [mailto:softdevice-devel-admin at berlios.de] On Behalf Of 
> Laurence Abbott
> Sent: Tuesday, November 08, 2005 10:42 AM
> To: Softdevice list; directfb list
> Subject: [Softdevice-devel] Seg fault in 
> dfb_gfxcard_state_check with softdevice...
> 
> 
> I've got vdr + softdevice + DirectFB running quite nicely now (using
> patches supplied by Mark Adams) but it sometimes throws a seg fault
> during initialisation (starting vdr from my init scripts). Here is the
> output from softdevice:
> 
> Starting program: /usr/local/bin/vdr-1.3.36 -v /video -w 20
> -L/home/vdr/plugins-c/home/vdr/vdrconf -P'softdevice -vo dfb:viatv'
> [Thread debugging using libthread_db enabled]
> [New Thread 16384 (LWP 4611)]
> [softdevice] processing args
> [softdevice]   argv [0] = softdevice
> [softdevice]   argv [1] = -vo
> vo_argv: dfb:viatv
> [softdevice] Enabling Unichrome Field Parity
> [setup-softdevice] alsa ac3Mode set to: 0
> [setup-softdevice] alsa AC3 device set to: hw:0,1
> [setup-softdevice] alsa device set to: default
> [setup-softdevice] A/V Offset set to (-2)
> [setup-softdevice] Cropping 0 lines from bottom
> [setup-softdevice] Cropping 0 columns from left
> [setup-softdevice] cropping mode set to 0 (none)
> [setup-softdevice] cropping mode toggle key set to 0 (none)
> [setup-softdevice] Cropping 0 columns from right
> [setup-softdevice] Cropping 0 lines from top
> [setup-softdevice] deinterlace method set to 0 none
> [setup-softdevice] mainMenu: 1
> [setup-softdevice] setting alpha blend mode to pseudo
> [softdevice] picture mirroring set to 0 (off)
> [setup-softdevice] pixel format set to (I420)
> [setup-softdevice] shouldSuspend to: 0
> [setup-softdevice] syncTimerMode: sig
> [softdevice] UseStretchBlitset to off
> [setup-softdevice] vidBrightness: 50
> [setup-softdevice] vidContrast: 50
> [setup-softdevice] vidHue: 50
> [setup-softdevice] vidSaturation: 50
> [setup-softdevice] startup aspect set to (4:3 normal)
> [New Thread 32769 (LWP 4614)]
> [New Thread 16386 (LWP 4615)]
> [Thread 16386 (LWP 4615) exited]
> [New Thread 32771 (LWP 4616)]
> [softdevice] initializing Plugin
> [softdevice] Initializing Video Out
> [softdevice] ffmpeg version(CVS) build(3277056)
> [New Thread 49154 (LWP 4617)]
> [dfb] init
> (*) DirectFB/Config: Parsing config file '/etc/directfbrc'.
> 
>        ---------------------- DirectFB v0.9.24 ---------------------
>              (c) 2000-2002  convergence integrated media GmbH
>              (c) 2002-2004  convergence GmbH
>         -----------------------------------------------------------
> 
> (*) DirectFB/Core: Single Application Core. (2005-11-04 18:37)
> (*) Direct/Memcpy: Using SSE optimized memcpy()
> (*) Direct/Modules: suppress module 'joystick'
> (*) Direct/Modules: suppress module 'lirc'
> (*) DirectFB/Genefx: MMX detected and enabled
> (!) DirectFB/Unichrome: Failed to determine hardware 
> revision, assuming
> 17.
> (*) DirectFB/Graphics: VIA/S3G CLE266/UniChrome 0.4 (-)
> (*) DirectFB/Core/WM: Default 0.2 (Convergence GmbH)
>  (!!!)  *** UNIMPLEMENTED [fusion_reactor_set_lock] ***
> [../../../lib/fusion/reactor.c:797]
> [dfb] RAM: 66842624 bytes
> [dfb] Accellerated Functions: FillRectange DrawRectange DrawLine
> FillTriangle Blit StretchBlit All
> [dfb] Drawing Flags: Blend Xor
> [dfb] Surface Blitting Flags: BlendAlpha BlendColorAlpha Colorize
> SrcColorkey DstColorkey Deinterlace
> [dfb] Supported video Modes are: 720x576 at 32
> [dfb] Enumerating display Layers
> Layer 0 FBDev Primary Layer  Type: graphics
>   Caps: brightness contrast saturation surface
> Layer 1 VIA Unichrome Video  Type: graphics picture video
>   Caps: deinterlacing dst_colorkey levels field_parity opacity
> screen_location surface
> [dfb]: Set unichrome DLBM_TRIPLE
> [dfb]: enabling unichrome DLOP_FIELD_PARITY
> [surface capabilities] scrSurface: primary videoonly double-buffered
> flipping
> [dfb] width = 720, height = 576
> [dfb] got fmt = 0x00418c04 bpp = 32
> [dfb] Using this layer for OSD: (FBDev Primary Layer - [720x576])
> [surface capabilities] osdSurface: videoonly double-buffered flipping
> [surface capabilities] videoSurface: videoonly flipping 
> triple-buffered
> [dfb] Configuring CooperativeLevel for Overlay
> [dfb] Configuring CooperativeLevel for OSD
> [dfb] Using this layer for OSD: FBDev Primary Layer
> [dfb] Using this layer for Video out: VIA Unichrome Video
> [dfb] Display frame time is 19998 microseconds
> [dfb] (re)configuring Videolayer to 736 x 576 (720x576)
> [dfb] SetParams: Enabling DLOP_FIELD_PARITY
> [dfb]: SetParms (): Setting DLBM_TRIPLE for Unichrome
> [surface capabilities] videoSurface: videoonly flipping 
> triple-buffered
> [dfb] (re)configured 0x08100609
> [dfb] (re)configured 0x08100609
> [New Thread 65540 (LWP 4618)]
> [softdevice] Video Out seems to be OK
> [softdevice] Initializing Audio Out
> [softdevice] Audio out seems to be OK
> [softdevice] A/V devices initialized, now initializing MPEG2 Decoder
> cSoftDevice::MakePrimaryDevice
> [New Thread 81925 (LWP 4619)]
> [New Thread 98310 (LWP 4620)]
> [dfb] (re)configuring Videolayer to 736 x 576 (720x576)
> [dfb] SetParams: Enabling DLOP_FIELD_PARITY
> [dfb]: SetParms (): Setting DLBM_TRIPLE for Unichrome
> [surface capabilities] videoSurface: videoonly flipping 
> triple-buffered
> [dfb] (re)configured 0x08100609
> 
> (and the reconfiguring bit about a further 5 times)
> 
> [dfb] (re)configured 0x08100609
>  (!!!)  *** WARNING [Application exited without deinitialization of
> DirectFB!] *** [../../../src/core/core.c:630 in 
> dfb_core_deinit_check()]
> 
> And here's the backtrace:
> #0  0xb751cec1 in dfb_gfxcard_state_check ()
>    from /usr/lib/libdirectfb-0.9.so.24
> #1  0xb751e22b in dfb_gfxcard_fillrectangles ()
>    from /usr/lib/libdirectfb-0.9.so.24
> #2  0xb74f8e0e in IDirectFBSurface_Construct ()
>    from /usr/lib/libdirectfb-0.9.so.24
> #3  0xb75475c9 in IDirectFBSurface::Clear () from /usr/lib/libdfb
> ++-0.9.so.23
> #4  0xb7ccef15 in cDFBVideoOut::CloseOSD (this=0x859c6f8) at
> video-dfb.c:1095
> #5  0xb7cbabf4 in ~cSoftOsd (this=0x860f718) at softdevice.c:121
> #6  0x080f7e97 in ~cSkinSTTNGDisplayMessage (this=0x85ef4d0)
>     at skinsttng.c:1064
> #7  0x080eef47 in ~cSkins (this=0x81e0bc4) at skins.c:152
> #8  0x080ef312 in __tcf_0 () at skins.c:143
> #9  0xb7d08ade in exit () from /lib/libc.so.6
> #10 0x0810a3f2 in Watchdog (signum=14) at vdr.c:89
> #11 0xb7ef3fe1 in __pthread_sighandler () from /lib/libpthread.so.0
> #12 <signal handler called>
> #13 0xb7ef4b36 in nanosleep () from /lib/libpthread.so.0
> #14 0x00000000 in ?? ()
> #15 0xb7eef1a5 in __pthread_timedsuspend_new ()
> from /lib/libpthread.so.0
> #16 0xb7eec1d7 in pthread_cond_timedwait at GLIBC_2.0 ()
> from /lib/libpthread.so.0
> #17 0x081013f6 in cCondVar::TimedWait (this=0xfffffffc,
> Mutex=@0x81e0610,
>     TimeoutMs=-4) at thread.c:122
> #18 0x080e059b in cRemote::Get (WaitMs=1000, UnknownCode=0x0) at
> remote.c:168
> #19 0x080abad7 in cInterface::GetKey (this=0x8604c50, Wait=true)
>     at interface.c:47
> #20 0x080abbd4 in cInterface::Wait (this=0x8604c50, Seconds=49,
> KeepChar=false)
>     at interface.c:58
> #21 0x080ef17d in cSkins::Message (this=0x81e0bc4, Type=mtError,
>     s=0x811f98a "Channel not available!", Seconds=-4) at skins.c:186
> #22 0x080949a7 in cDevice::SwitchChannel (Direction=1) at device.c:564
> #23 0x0810cff1 in main (argc=8, argv=0xbf874284) at device.h:235
> 
> I've not seen this one before in my tinkering! I'm, not sure 
> whether it
> is down to DirectFB or whether softdevice is triggering it, somehow.
> 
> If I try to run it again after this, it will fail with the 
> same message.
> It needs a reboot before it will initialise properly. This makes me
> wonder if it's down to the initialisation of viafb. Once it is up and
> running, it seems quite solid. I've just moved vdr to later on in my
> boot sequence: maybe it is trying to access the framebuffer before the
> module has fully initialised, or something like that?!
> 
> This is with vdr-1.3.36, softdevice cvs and DirectFB cvs both 
> from about
> 4 days back, with viafb and DirectFB patched for FIELD_PARITY and
> softdevice patched to use this, on an Epia MII board.
> 
> Cheers,
> 
> Laz
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 
> 



From Neumann at do-net.de  Tue Nov  8 10:51:05 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Tue, 8 Nov 2005 10:51:05 +0100
Subject: [Softdevice-devel] dvd-plugin and wrong menus
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B8D@sbs2003.do-net.de>

Hi,
 
when using the dvd-plugin (from cvs) the menus dont get displayed
correct. The Buttons are not correct displayed, i mean they are on the
wrong position. Only want to know if anyone else has this problem and if
it can be fixed.
 
--------------------
Andre Neumann
 





From mimakine at cc.hut.fi  Tue Nov  8 11:28:36 2005
From: mimakine at cc.hut.fi (=?ISO-8859-1?Q?Mikko_M=E4kinen?=)
Date: Tue, 08 Nov 2005 12:28:36 +0200
Subject: [Softdevice-devel] dvd-plugin and wrong menus
In-Reply-To: <FB3B5DB3197CEA429E5FB8E83D01D039056B8D@sbs2003.do-net.de>
References: <FB3B5DB3197CEA429E5FB8E83D01D039056B8D@sbs2003.do-net.de>
Message-ID: <43707DD4.6020104@cc.hut.fi>

Andre Neumann wrote:
> when using the dvd-plugin (from cvs) the menus dont get displayed
> correct. The Buttons are not correct displayed, i mean they are on the
> wrong position. Only want to know if anyone else has this problem and if
> it can be fixed.

I have exactly the same problem. The "selection indicator" is drawn to 
the wrong place, a little too high and left if I remember correctly. I 
also have problems with subtitle-synchronization; the subtitles are 
shown too early.

Both of these problems are present only with softdevice, not with a FF-card.

br,
  mikko


From laz at club-burniston.co.uk  Tue Nov  8 12:03:15 2005
From: laz at club-burniston.co.uk (Laurence Abbott)
Date: Tue, 08 Nov 2005 11:03:15 +0000
Subject: [Softdevice-devel] Re: [directfb-users] Seg fault in dfb_gfxcard_state_check with
 softdevice...
In-Reply-To: <b7f6d7370511080239s6205f350w@mail.gmail.com>
References: <1131442918.14296.12.camel@laser2.york.ac.uk>
	 <b7f6d7370511080239s6205f350w@mail.gmail.com>
Message-ID: <1131447795.14296.15.camel@laser2.york.ac.uk>

On Tue, 2005-11-08 at 10:39 +0000, Mark Adams wrote:
> > #0  0xb751cec1 in dfb_gfxcard_state_check ()
> >   from /usr/lib/libdirectfb-0.9.so.24
> 
> [...]
> 
> > #9  0xb7d08ade in exit () from /lib/libc.so.6
> > #10 0x0810a3f2 in Watchdog (signum=14) at vdr.c:89
> 
> Signal SIGALRM was caught by a function 'Watchdog' which called exit. 
> The crash happened later, as a result of a number of destructors
> getting called.  Presumably, the 'Watchdog' is designed to kill the
> app if it gets stuck somewhere.  Presumably that somewhere was:
> 
> > #16 0xb7eec1d7 in pthread_cond_timedwait at GLIBC_2.0 ()
> > from /lib/libpthread.so.0
> > #17 0x081013f6 in cCondVar::TimedWait (this=0xfffffffc,
> > Mutex=@0x81e0610,
> >    TimeoutMs=-4) at thread.c:122
> 
> Doesn't seem very much to do with DirectFB, this one.

DOH! Didn't look that far down!

:-$

That should kick in when something gets 'stuck'. There is still the
question of why it takes longer to sort itself out sometimes.

Cheers,

Laz



From marko.makela at hut.fi  Tue Nov  8 23:42:26 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Wed, 9 Nov 2005 00:42:26 +0200
Subject: [Softdevice-devel] PATCH: i18n german translations
In-Reply-To: <200511012023.52417.stefan@lucke.in-berlin.de>
References: <FB3B5DB3197CEA429E5FB8E83D01D039D13B@sbs2003.do-net.de> <20051101150932.GB3850@localhost.localdomain> <200511012023.52417.stefan@lucke.in-berlin.de>
Message-ID: <20051108224226.GB19925@localhost.localdomain>

On Tue, Nov 01, 2005 at 08:23:52PM +0100, Stefan Lucke wrote:
> > @@ -516,7 +516,7 @@
> >  #endif
> >    },
> >    { "Use StretchBlit", //  1
> > -    "",             //  2 TODO
> > +    "Transparentes OSD benutzen",             //  2 TODO
> >      "",             //  3 TODO
> >      "",             //  4 TODO
> >      "",             //  5 TODO
> > 
> > StretchBlit is something for the video overlay, isn't it?
> > OSD transparency is something else.
> 
> StretchBlit is a way video is scaled. For some cards its the olny way
> to mix video and a alpha-blended (semi transparent) OSD.
> 
> So StretchBlit is the technical term for doing a pixel transfer operation.
> Normal user shouldn't take care of that. But I won't separate into
> enduser and developer options (now). For developers it's essential
> to have a fast way to switch between several options. Perhaps
> we should mark some of them with "(dev)" .

Or perhaps use both the technical term and a short explanation (if possible).
I find it annoying to use dumbed-down terms that say nothing to the expert
nor the novice.  You can find that in some Microsoft software products.

> > @@ -700,7 +700,7 @@
> >  #endif
> >    },
> >    { "save",         //  1
> > -    "",             //  2 TODO
> > +    "Sicher",             //  2 TODO
> >      "",             //  3 TODO
> >      "",             //  4 TODO
> >      "",             //  5 TODO
> > 
> > Hmm, I think the Finnish translation says something about
> > "recordings".  What is the exact meaning of these buffer size
> > settings?
> > 
> 
> They result in using different packet buffer size (64K, 32K, 64K).
> Perhaps we should find another useful name for this option.

I assume that you mean 16k, 32k, 64k.  What about calling the option
"Packet buffer size" (if it is not already) and offering choices like
"16 KiB (live)", "32 KiB (playback)" and "64 KiB (HDTV)"?  That would
convey both the exact technical term and a short explanation to the user.

	Marko


From per at mellander.org  Wed Nov  9 08:37:44 2005
From: per at mellander.org (Per Mellander)
Date: Wed, 9 Nov 2005 08:37:44 +0100
Subject: [Softdevice-devel] EPIA M10000 hardware mpeg decoding
Message-ID: <20051109072847.M11339@mellander.org>

I know this might not be the correct forum but I'll ask anyway.

I have an EPIA M10000 with CLE266 chip onboard. I have read numerous of pages on the net
concerning getting the hardware mpeg encoder supported. I have a small dist ( Core Linux
2.4.x ) running on my machine where I've been running VDR + softdevice ( framebuffer
DirectFB ).

Is there anyone here that can point me in the direction where I'll be able to get use of
the hardware mpeg decoder? ( As I understand it. It's most likely to get it working by
using Xv(MC) )

How much of the decoding is actually done by the hardware?

Mel



From M.Wache at gmx.net  Wed Nov  9 18:20:48 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Wed, 09 Nov 2005 18:20:48 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <20051104201423.GA11466@seneca.muc.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104201423.GA11466@seneca.muc.de>
Message-ID: <43722FF0.3010705@gmx.net>

Harald Milz schrieb:
> On Fri, Nov 04, 2005 at 08:11:59PM +0100, Stefan Lucke wrote:
> 
>>But as usual there is a workaround. Sync timer mode is selectable via OSD
>>(since a few minutes :-) ).
> 
> 
> Guess that means using the CVS version? 
> 
> Are there any drawbacks when deselecting RTC? 
> 
RTC has the best time resolution of about 1ms. The time resolution of
the other methods depend on the kerner timer resolution which is for
kernels >2.6.13 4ms and older 2.6 kernels 1ms.
2.4 kernels have a resolution of 10ms (if I'm not mistaken).
The only way to increase the resolution is burning cpu time, but this is
currently disabled in the softdevice.

So if you want to have a perfect A-V sync RTC timing is the best, but
for DFB this doesn't matter so much, since it syncs to the video retrace
rather than to the audio.

Martin


From M.Wache at gmx.net  Wed Nov  9 18:20:54 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Wed, 09 Nov 2005 18:20:54 +0100
Subject: [Softdevice-devel] PATCH: i18n german translations
In-Reply-To: <20051108224226.GB19925@localhost.localdomain>
References: <FB3B5DB3197CEA429E5FB8E83D01D039D13B@sbs2003.do-net.de> <20051101150932.GB3850@localhost.localdomain> <200511012023.52417.stefan@lucke.in-berlin.de> <20051108224226.GB19925@localhost.localdomain>
Message-ID: <43722FF6.4060002@gmx.net>

Marko M?kel? schrieb:

>>>@@ -700,7 +700,7 @@
>>> #endif
>>>   },
>>>   { "save",         //  1
>>>-    "",             //  2 TODO
>>>+    "Sicher",             //  2 TODO
>>>     "",             //  3 TODO
>>>     "",             //  4 TODO
>>>     "",             //  5 TODO
>>>
>>>Hmm, I think the Finnish translation says something about
>>>"recordings".  What is the exact meaning of these buffer size
>>>settings?
>>>
>>
>>They result in using different packet buffer size (64K, 32K, 64K).
>>Perhaps we should find another useful name for this option.
> 
> 
> I assume that you mean 16k, 32k, 64k.  What about calling the option
> "Packet buffer size" (if it is not already) and offering choices like
> "16 KiB (live)", "32 KiB (playback)" and "64 KiB (HDTV)"?  That would
> convey both the exact technical term and a short explanation to the user.
> 
The numbers Stefan quoted are correct, but they are not the relevant
ones. The relevant buffer size is 300, 150, 2000 packets.
There are three options, when I introduced them I called them "save",
"good seeking" and "HDTV". "Save" is the traditional setting and means
the buffer setup up is save enough that very likely there won't be any
audio buffer underuns. "good seeking" is a very small buffer, almost as
small as the buffer of the FF cards. That means that VDR will guess the
current position while seeking correctly (Did you notice that when
useing fast rew and the play again, vdr starts at a different position?
If you use "good seeking" vdr will start almost at the correct
position). On the other hand the risk of audio buffer underuns is
higher. "HDTV" is a very large buffer which is necessary for HDTV streams.

So if anyone has good names for the menu entry and the options we can
use them. But I guess this option needs a longer explanation...


Bye,

Martin


From marko.makela at hut.fi  Wed Nov  9 20:31:55 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Wed, 9 Nov 2005 21:31:55 +0200
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <43722FF0.3010705@gmx.net>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104201423.GA11466@seneca.muc.de> <43722FF0.3010705@gmx.net>
Message-ID: <20051109193155.GA3721@localhost.localdomain>

On Wed, Nov 09, 2005 at 06:20:48PM +0100, Martin Wache wrote:
> RTC has the best time resolution of about 1ms. The time resolution of
> the other methods depend on the kerner timer resolution which is for
> kernels >2.6.13 4ms and older 2.6 kernels 1ms.

In 2.6.13.4, there are three possible choices (100 Hz, 250 Hz, and 1000 Hz)
for the timer resolution in "make menuconfig".

> So if you want to have a perfect A-V sync RTC timing is the best, but
> for DFB this doesn't matter so much, since it syncs to the video retrace
> rather than to the audio.

Does video-dfb.c drop or duplicate audio frames to adjust the A-V sync, or
does it perhaps fine-tune the audio sample rate (if it is at all possible)?
I haven't experienced any A-V sync issues on DFB output lately.

I have the impression that improving the kernel timer resolution will cause
more context switches per time unit.  It'd be better to use a very low
kernel timer resolution and to use the RTC timer, as it will generate
interrupt events.  Am I correct about this?

Some day, I might figure out if there is a way to use softdevice RTC timing
and nvram-wakeup simultaneously.  Perhaps softdevice could release the
timer device when the output is suspended, so that the wakeup timer can be
programmed.

	Marko


From malcolm.caldwell at cdu.edu.au  Thu Nov 10 01:11:08 2005
From: malcolm.caldwell at cdu.edu.au (Malcolm Caldwell)
Date: Thu, 10 Nov 2005 09:41:08 +0930
Subject: [Softdevice-devel] PATCH: i18n german translations
In-Reply-To: <43722FF6.4060002@gmx.net>
References: <FB3B5DB3197CEA429E5FB8E83D01D039D13B@sbs2003.do-net.de>
	 <20051101150932.GB3850@localhost.localdomain>
	 <200511012023.52417.stefan@lucke.in-berlin.de>
	 <20051108224226.GB19925@localhost.localdomain>  <43722FF6.4060002@gmx.net>
Message-ID: <1131581468.4511.9.camel@localhost.localdomain>

On Wed, 2005-11-09 at 18:20 +0100, Martin Wache wrote:
> Marko M?kel? schrieb:
> 
> >>>@@ -700,7 +700,7 @@
> >>> #endif
> >>>   },
> >>>   { "save",         //  1
> >>>-    "",             //  2 TODO
> >>>+    "Sicher",             //  2 TODO
> >>>     "",             //  3 TODO
> >>>     "",             //  4 TODO
> >>>     "",             //  5 TODO
> >>>
> >>>Hmm, I think the Finnish translation says something about
> >>>"recordings".  What is the exact meaning of these buffer size
> >>>settings?
> >>>
> >>
> >>They result in using different packet buffer size (64K, 32K, 64K).
> >>Perhaps we should find another useful name for this option.
> > 
> > 
> > I assume that you mean 16k, 32k, 64k.  What about calling the option
> > "Packet buffer size" (if it is not already) and offering choices like
> > "16 KiB (live)", "32 KiB (playback)" and "64 KiB (HDTV)"?  That would
> > convey both the exact technical term and a short explanation to the user.
> > 
> The numbers Stefan quoted are correct, but they are not the relevant
> ones. The relevant buffer size is 300, 150, 2000 packets.
> There are three options, when I introduced them I called them "save",
> "good seeking" and "HDTV". "Save" is the traditional setting and means
> the buffer setup up is save enough that very likely there won't be any
> audio buffer underuns.

In that case the English word you want is 'safe'  note 'save'.

(It has been on my mind for a while to comment that the word 'save' did
not make sense here)

>  "good seeking" is a very small buffer, almost as
> small as the buffer of the FF cards. That means that VDR will guess the
> current position while seeking correctly (Did you notice that when
> useing fast rew and the play again, vdr starts at a different position?
> If you use "good seeking" vdr will start almost at the correct
> position). On the other hand the risk of audio buffer underuns is
> higher. "HDTV" is a very large buffer which is necessary for HDTV streams.
> 
> So if anyone has good names for the menu entry and the options we can
> use them. But I guess this option needs a longer explanation...
> 
> 
> Bye,
> 
> Martin
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel



From stefan at lucke.in-berlin.de  Thu Nov 10 07:57:51 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Thu, 10 Nov 2005 07:57:51 +0100
Subject: [Softdevice-devel] PATCH: i18n german translations
In-Reply-To: <1131581468.4511.9.camel@localhost.localdomain>
References: <FB3B5DB3197CEA429E5FB8E83D01D039D13B@sbs2003.do-net.de> <43722FF6.4060002@gmx.net> <1131581468.4511.9.camel@localhost.localdomain>
Message-ID: <200511100757.51151.stefan@lucke.in-berlin.de>

On Donnerstag, 10. November 2005 01:11, Malcolm Caldwell wrote:
> On Wed, 2005-11-09 at 18:20 +0100, Martin Wache wrote:
> > Marko M?kel? schrieb:
> > 
> > >>>@@ -700,7 +700,7 @@
> > >>> #endif
> > >>>   },
> > >>>   { "save",         //  1
> > >>>-    "",             //  2 TODO
> > >>>+    "Sicher",             //  2 TODO
> > >>>     "",             //  3 TODO
> > >>>     "",             //  4 TODO
> > >>>     "",             //  5 TODO
> > >>>

> > There are three options, when I introduced them I called them "save",
> > "good seeking" and "HDTV". "Save" is the traditional setting and means
> > the buffer setup up is save enough that very likely there won't be any
> > audio buffer underuns.
> 
> In that case the English word you want is 'safe'  note 'save'.

Thanks, changed save -> safe.

-- 
Stefan Lucke



From M.Wache at gmx.net  Thu Nov 10 18:35:14 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Thu, 10 Nov 2005 18:35:14 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <20051109193155.GA3721@localhost.localdomain>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104201423.GA11466@seneca.muc.de> <43722FF0.3010705@gmx.net> <20051109193155.GA3721@localhost.localdomain>
Message-ID: <437384D2.2010108@gmx.net>

Marko M?kel? schrieb:
> On Wed, Nov 09, 2005 at 06:20:48PM +0100, Martin Wache wrote:
> 
>>RTC has the best time resolution of about 1ms. The time resolution of
>>the other methods depend on the kerner timer resolution which is for
>>kernels >2.6.13 4ms and older 2.6 kernels 1ms.
> 
> 
> In 2.6.13.4, there are three possible choices (100 Hz, 250 Hz, and 1000 Hz)
> for the timer resolution in "make menuconfig".
> 
yes, that's true. 4ms = 250Hz is the default

> 
>>So if you want to have a perfect A-V sync RTC timing is the best, but
>>for DFB this doesn't matter so much, since it syncs to the video retrace
>>rather than to the audio.
> 
> 
> Does video-dfb.c drop or duplicate audio frames to adjust the A-V sync, or
> does it perhaps fine-tune the audio sample rate (if it is at all possible)?
> I haven't experienced any A-V sync issues on DFB output lately.
> 
No, the audio is not synced at all, only the video is synced to the
audio. But DFB uses on top the video retrace (don't ask me how this
works in detail - I only use Xv out ;-)
I started working on a resampler which would make it possible to fine
tune the audio sample rate, but I stopped at some point... In fact the
resampler is finished, but the syncing code is still missing.

> I have the impression that improving the kernel timer resolution will cause
> more context switches per time unit.  It'd be better to use a very low
> kernel timer resolution and to use the RTC timer, as it will generate
> interrupt events.  Am I correct about this?
> 
I would not call me an expert on this, but I think you will get context
switches no matter what method you use. Well maybe only as long as the
softdevice is reading from /dev/rtc, but I'm not sure. I prefer RTC
because it doesn't depend on the kernel timer and from some tests I did
I found that the RTC is more reliable and precise.

> Some day, I might figure out if there is a way to use softdevice RTC timing
> and nvram-wakeup simultaneously.  Perhaps softdevice could release the
> timer device when the output is suspended, so that the wakeup timer can be
> programmed.
> 

I didn't check but I think just calling cmpeg2decoder::Stop() in
Suspend() and Start() in Resume() should be enough to do that.

Martin



From marko.makela at hut.fi  Thu Nov 10 20:43:21 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Thu, 10 Nov 2005 21:43:21 +0200
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <437384D2.2010108@gmx.net>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104201423.GA11466@seneca.muc.de> <43722FF0.3010705@gmx.net> <20051109193155.GA3721@localhost.localdomain> <437384D2.2010108@gmx.net>
Message-ID: <20051110194321.GA3785@localhost.localdomain>

On Thu, Nov 10, 2005 at 06:35:14PM +0100, Martin Wache wrote:
> No, the audio is not synced at all, only the video is synced to the
> audio. But DFB uses on top the video retrace (don't ask me how this
> works in detail - I only use Xv out ;-)

After switching streams, in DFB the audio is off sync for a few seconds.
I wonder if the off-sync time is shorter in Xv out.

> > I have the impression that improving the kernel timer resolution will cause
> > more context switches per time unit.  It'd be better to use a very low
> > kernel timer resolution and to use the RTC timer, as it will generate
> > interrupt events.  Am I correct about this?
> > 
> I would not call me an expert on this, but I think you will get context
> switches no matter what method you use. Well maybe only as long as the
> softdevice is reading from /dev/rtc, but I'm not sure. I prefer RTC
> because it doesn't depend on the kernel timer and from some tests I did
> I found that the RTC is more reliable and precise.

Sure, you can't avoid all context switches.  For instance, at 75 Hz frame
rate and no RTC timer, you'd be better off using the 1000 Hz kernel timer.
You'll get 13 context switches per frame, although you only need one.  If
you used the RTC timer, you could set the kernel timer to 100 Hz.  Then,
you'd get 2.3 context switches per frame (one for the RTC timer interrupt
and 1.3 for the kernel scheduling interrupt).

> > Some day, I might figure out if there is a way to use softdevice RTC timing
> > and nvram-wakeup simultaneously.  Perhaps softdevice could release the
> > timer device when the output is suspended, so that the wakeup timer can be
> > programmed.
> > 
> 
> I didn't check but I think just calling cmpeg2decoder::Stop() in
> Suspend() and Start() in Resume() should be enough to do that.

Thanks, I'll try that when I get around to it.

On a related note?, this week I rebuilt my wake-on-remote circuit
(http://www.iki.fi/~msmakela/electronics/worc5/) on a circuit board.
I'll publish the Eagle files and a photo as soon as I get the second
version of the circuit board (with improved layout) manufactured and
assembled and figure out a good way to mechanically attach the
circuit board on the tuner card.

? Users of nvram-wakeup would probably like to power their system up
  by remote control.

The circuit has only been tested with the Hauppauge Nova-T PCI 90002,
but I believe that it can be hooked to any circuit that uses a three-wire
infrared receiver module.  My firmware only understands RC5 code.
Does anyone know if there is a DVB-C budget card with a bundled remote
control unit?  A friend of mine is interested in building a vdr box,
and he has DVB-C.

	Marko


From malcolm.caldwell at cdu.edu.au  Fri Nov 11 09:02:22 2005
From: malcolm.caldwell at cdu.edu.au (Malcolm Caldwell)
Date: Fri, 11 Nov 2005 17:32:22 +0930
Subject: [Softdevice-devel] 4:3 16:9 stretchblit crop problem
Message-ID: <1131696142.4704.98.camel@localhost.localdomain>

Hello,

I think I might be about display my lack of understanding...

I have been thinking about the problems surrounding the croping under
matrox tv out using directfb.  The current code produces weird field
based artifacts when you crop so a 16:9 image gets displayed letterboxed
on a 4:3 television.

>From what I understand, The problem occurs because stretchblit is not
field aware, so in various bands there are sections where the fields are
correctly displayed and other where they are not.

Now, I maybe off the planet here, but, maybe there is a workaround.  Can
we pretend that the image is just twice as wide as it really is?

Say our image is 720x576

Line
1    1111111111111111111111
2    2222222222222222222222
3    3333333333333333333333
4    4444444444444444444444
5    5555555555555555555555
6    6666666666666666666666
7    7777777777777777777777
8    8888888888888888888888
9    9999999999999999999999
10   0000000000000000000000
...
575  YYYYYYYYYYYYYYYYYYYYYY
566  ZZZZZZZZZZZZZZZZZZZZZZ

If we use the same image data, but lets just say our image is 1440x288.

Line
1   11111111111111111111112222222222222222222222
2   33333333333333333333334444444444444444444444
3   55555555555555555555556666666666666666666666
4   77777777777777777777778888888888888888888888
5   99999999999999999999990000000000000000000000
...
288 YYYYYYYYYYYYYYYYYYYYYYZZZZZZZZZZZZZZZZZZZZZZ

Now since we only crop in the vertical dimension we can crop this image
down to 1140xY, (is this value 288*(3/4)=216?)

1   11111111111111111111112222222222222222222222
2   33333333333333333333334444444444444444444444
3   55555555555555555555556666666666666666666666
4   99999999999999999999990000000000000000000000
...
216 YYYYYYYYYYYYYYYYYYYYYYZZZZZZZZZZZZZZZZZZZZZZ

And then re-cast it to its original horizontal size making 720x432.
(Again, this is if my calculation for the vertical scale factor is
correct).

1   1111111111111111111111
2   2222222222222222222222
3   3333333333333333333333
4   4444444444444444444444
5   5555555555555555555555
6   6666666666666666666666
7   9999999999999999999999
8   0000000000000000000000
...
431 YYYYYYYYYYYYYYYYYYYYYY
432 ZZZZZZZZZZZZZZZZZZZZZZ

So, we can still use stretchblit, our fields are still in the currect
place and our image is now scaled.  Or Have I missed something
fundamental.  I *think* this will work with the image formats in
question.

Or am I completely wrong?



From lucianm at users.sourceforge.net  Fri Nov 11 10:27:37 2005
From: lucianm at users.sourceforge.net (Lucian Muresan)
Date: Fri, 11 Nov 2005 10:27:37 +0100
Subject: [Softdevice-devel] 4:3 16:9 stretchblit crop problem
In-Reply-To: <1131696142.4704.98.camel@localhost.localdomain>
References: <1131696142.4704.98.camel@localhost.localdomain>
Message-ID: <43746409.3030104@users.sourceforge.net>

Sorry for cross-posting, but I think this might be interesting to
DirectFB folks too (maybe even more than just for vdr-softdevice).

Malcolm Caldwell wrote:
> Hello,
> 
> I think I might be about display my lack of understanding...
> 
> I have been thinking about the problems surrounding the croping under
> matrox tv out using directfb.  The current code produces weird field
> based artifacts when you crop so a 16:9 image gets displayed letterboxed
> on a 4:3 television.
> 
>>From what I understand, The problem occurs because stretchblit is not
> field aware, so in various bands there are sections where the fields are
> correctly displayed and other where they are not.
> 
> Now, I maybe off the planet here, but, maybe there is a workaround.  Can
> we pretend that the image is just twice as wide as it really is?
> 
> Say our image is 720x576
> 
> Line
> 1    1111111111111111111111
> 2    2222222222222222222222
> 3    3333333333333333333333
> 4    4444444444444444444444
> 5    5555555555555555555555
> 6    6666666666666666666666
> 7    7777777777777777777777
> 8    8888888888888888888888
> 9    9999999999999999999999
> 10   0000000000000000000000
> ...
> 575  YYYYYYYYYYYYYYYYYYYYYY
> 566  ZZZZZZZZZZZZZZZZZZZZZZ
> 
> If we use the same image data, but lets just say our image is 1440x288.
> 
> Line
> 1   11111111111111111111112222222222222222222222
> 2   33333333333333333333334444444444444444444444
> 3   55555555555555555555556666666666666666666666
> 4   77777777777777777777778888888888888888888888
> 5   99999999999999999999990000000000000000000000
> ...
> 288 YYYYYYYYYYYYYYYYYYYYYYZZZZZZZZZZZZZZZZZZZZZZ
> 
> Now since we only crop in the vertical dimension we can crop this image
> down to 1140xY, (is this value 288*(3/4)=216?)
> 
> 1   11111111111111111111112222222222222222222222
> 2   33333333333333333333334444444444444444444444
> 3   55555555555555555555556666666666666666666666
> 4   99999999999999999999990000000000000000000000
> ...
> 216 YYYYYYYYYYYYYYYYYYYYYYZZZZZZZZZZZZZZZZZZZZZZ
> 
> And then re-cast it to its original horizontal size making 720x432.
> (Again, this is if my calculation for the vertical scale factor is
> correct).
> 
> 1   1111111111111111111111
> 2   2222222222222222222222
> 3   3333333333333333333333
> 4   4444444444444444444444
> 5   5555555555555555555555
> 6   6666666666666666666666
> 7   9999999999999999999999
> 8   0000000000000000000000
> ...
> 431 YYYYYYYYYYYYYYYYYYYYYY
> 432 ZZZZZZZZZZZZZZZZZZZZZZ
> 
> So, we can still use stretchblit, our fields are still in the currect
> place and our image is now scaled.  Or Have I missed something
> fundamental.  I *think* this will work with the image formats in
> question.
> 
> Or am I completely wrong?

I don't know for sure if you're wrong, but that's an interesting idea,
the devs should maybe think about it. I too have the same problems on
*some* 720x576 content which has to be displayed letterboxed 16:9, whith
any of the following DirectFB software decoders/players on my Matrox
G400 TV-out: vdr/softdevice, df_xine, mplayer....

Any thoughts?



From hm at seneca.muc.de  Fri Nov 11 17:45:52 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Fri, 11 Nov 2005 17:45:52 +0100
Subject: [Softdevice-devel] cropmode toggle key
In-Reply-To: <200510270732.31636.stefan@lucke.in-berlin.de>
References: <435EB27E.1040402@e-dition.fr> <200510270732.31636.stefan@lucke.in-berlin.de>
Message-ID: <20051111164552.GA2460@seneca.muc.de>

Hi,

if I understand the sourcecode right, the toggle button should cycle
through the 4 crop modes (softdevice-0.2.0), right? 

Unfortunately, nothing happens on my system. I use the "User3" button with
LIRC. irw displays "user3" right

         user3                    0x3E00

and it's in remote.conf

LIRC.User3      user3

and in setup.conf

softdevice.CropModeToggleKey = 3

but nothing happens... everything else on the remote control works fine.
What am I missing? 

I'd like to work around the crappy broadcasts of all the Pro7s and RTLs of
the world who don't understand anamorphic encoding :-(  Is it just me or
do only ARD, ZDF and their third and daughter programs use it correctly? I
can't remember seeing it elsewhere. 

-- 
I predict that today will be remembered until tomorrow!


From hm at seneca.muc.de  Fri Nov 11 17:45:52 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Fri, 11 Nov 2005 17:45:52 +0100
Subject: [Softdevice-devel] cropmode toggle key
In-Reply-To: <200510270732.31636.stefan@lucke.in-berlin.de>
References: <435EB27E.1040402@e-dition.fr> <200510270732.31636.stefan@lucke.in-berlin.de>
Message-ID: <20051111164552.GA2460@seneca.muc.de>

Hi,

if I understand the sourcecode right, the toggle button should cycle
through the 4 crop modes (softdevice-0.2.0), right? 

Unfortunately, nothing happens on my system. I use the "User3" button with
LIRC. irw displays "user3" right

         user3                    0x3E00

and it's in remote.conf

LIRC.User3      user3

and in setup.conf

softdevice.CropModeToggleKey = 3

but nothing happens... everything else on the remote control works fine.
What am I missing? 

I'd like to work around the crappy broadcasts of all the Pro7s and RTLs of
the world who don't understand anamorphic encoding :-(  Is it just me or
do only ARD, ZDF and their third and daughter programs use it correctly? I
can't remember seeing it elsewhere. 

-- 
I predict that today will be remembered until tomorrow!


From stefan at lucke.in-berlin.de  Sat Nov 12 09:12:32 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 12 Nov 2005 09:12:32 +0100
Subject: [Softdevice-devel] cropmode toggle key
In-Reply-To: <20051111164552.GA2460@seneca.muc.de>
References: <435EB27E.1040402@e-dition.fr> <200510270732.31636.stefan@lucke.in-berlin.de> <20051111164552.GA2460@seneca.muc.de>
Message-ID: <200511120912.33120.stefan@lucke.in-berlin.de>

On Freitag, 11. November 2005 17:45, Harald Milz wrote:
> Hi,
> 
> if I understand the sourcecode right, the toggle button should cycle
> through the 4 crop modes (softdevice-0.2.0), right? 
> 
> Unfortunately, nothing happens on my system. I use the "User3" button with
> LIRC. irw displays "user3" right
> 
>          user3                    0x3E00
> 
> and it's in remote.conf
> 
> LIRC.User3      user3


From nhuillard at e-dition.fr  Sat Nov 12 14:39:12 2005
From: nhuillard at e-dition.fr (Nicolas Huillard)
Date: Sat, 12 Nov 2005 14:39:12 +0100
Subject: [Softdevice-devel] cropmode toggle key
In-Reply-To: <200511120912.33120.stefan@lucke.in-berlin.de>
References: <435EB27E.1040402@e-dition.fr> <200510270732.31636.stefan@lucke.in-berlin.de> <20051111164552.GA2460@seneca.muc.de> <200511120912.33120.stefan@lucke.in-berlin.de>
Message-ID: <4375F080.5020500@e-dition.fr>

Stefan Lucke a ?crit :
> On Freitag, 11. November 2005 17:45, Harald Milz wrote:
> 
>>Hi,
>>
>>if I understand the sourcecode right, the toggle button should cycle
>>through the 4 crop modes (softdevice-0.2.0), right? 
>>
>>Unfortunately, nothing happens on my system. I use the "User3" button with
>>LIRC. irw displays "user3" right
>>
>>         user3                    0x3E00
>>
>>and it's in remote.conf
>>
>>LIRC.User3      user3
> 
> From my remote.conf:
> softdevice-dfb.User3 	some_key_value

To be more precise, what I've got in my remote.conf :

LIRC.User2      AB
softdevice-dfb.User2      000000000000F04F

"LIRC.User2" has teh value you have configured in LIRC, whereas
"softdevice-dfb.User2" has a hardcoded value, which you can retreive in
the DirectFB code. You will get this value if you activate DirectFB's
LIRC input module (no disable-module=lirc in /etc/directfbrc) AND the
remote code configured in LIRC is recognized by DirectFB.
I had the problem that the remote key labelled "A/B" was configured
as... "A/B" in /etc/lirc/lircd.conf... which is not in the list of valid
DirectFB keys...
Once I changed the LIRC conf to send "AB" instead of "A/B", the remote
key went up from LIRC to DirectFB, then softdevice, and everything was OK...

All that is not really simple. What I would have expected is that the
running remote thread in VDR just send keystrokes to subscribed listener
plugins, and that softdevice would use the VDR remotes, whatever they are.
Instead, softdevice runs another VDR remote thread, which listens to
another input source, leading to 2 LIRCD connected clients, the fact
that only DirectFB remotes will be recognized (no VDR-specific remote
plugins or so), and that key-codes are not the same...

>>and in setup.conf
>>
>>softdevice.CropModeToggleKey = 3
>>
>>but nothing happens... everything else on the remote control works fine.
>>What am I missing? 
> 
> Unfortunately this works only, if you use directfb's remote .

-- 
NH


From stefan at lucke.in-berlin.de  Sat Nov 12 17:35:56 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sat, 12 Nov 2005 17:35:56 +0100
Subject: [Softdevice-devel] [ANNOUNCE] vdr-softdevice-0.2.1
Message-ID: <200511121735.56183.stefan@lucke.in-berlin.de>

Hello,

softdevice team (Torgeir Veimo, Martin Wache and me, Stefan Lucke)
with help from softdevice users, is pleased to announce a 
new release of vdr softdevice plugin.

General info:
  Softdevice plugin enables vdr to run on your desktop with
  so called budget cards. You'll get vdr output via framebuffer or X11-Xv or
  DirectFB or vidix to your screen. Decoding is done via ffmpeg.

Plugin's homepage is located at: http://softdevice.berlios.de/

Changelog since last release:
2005-11-12: softdevice-0.2.1
    - speed up moving of cutmarks by a factor of about 100. I forgot to signal
      that new data is available in StillPicture() :-/
    - new packet mode: make some softdevice functions available to other
      plugins like softplay useing the new service interface
2005-11-06:
    - video-xv: some of X11 atoms could be set via OSD too. So using hardcoded
      hotkeys for brightness, contrast, hue and saturation is obsolete and
      may be removed soon.
    - video-dfb: (by Laurence Abbott) selecting field parity and triple buffering
      on via epia boards. That could be used for others too if primary head
      is connected to TV. Triple buffering is independently available as a
      separate option now.
        "-vo dfb:viatv"
        "-vo dfb:triple"
2005-11-04:
    - some more finnish translations (by Rolf Ahrenberg)
    - sync timer mode selectable via OSD
    - removed translations of empty lines (by Rolf Ahrenberg)
    - made sig timer the default one for new users
2005-11-02:
    - restructured OSD setup
2005-11-01:
    - some some german translations (with help from Andre Neumann)
    - hide main menu entry via OSD
2005-10-29:
    - french translations (by Nicolas Huillard)
    - packet playback: assume we get complete frames via packet interface.
                       This fixes playing divx via softplay.
    - fix frame dropping with IEEE1394 read.
2005-10-26:
    - fix cropmode handling via OSD
    - set some vars for aspect calculation to reasonable defaults
2005-10-25:
    - video-xv: fix aspectratio recalculation upon ConfigureNotify events
    - minor cleanup: moved static floats to member double (cVideoOut)
2005-10-14:
    - reverted change from 2005-01-12 as effect it not reproducable and delivers
      now wrong results for some streams.

-- 
Stefan Lucke



From marko.makela at hut.fi  Sat Nov 12 21:42:39 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Sat, 12 Nov 2005 22:42:39 +0200
Subject: [Softdevice-devel] cropmode toggle key
In-Reply-To: <20051111164552.GA2460@seneca.muc.de>
References: <435EB27E.1040402@e-dition.fr> <200510270732.31636.stefan@lucke.in-berlin.de> <20051111164552.GA2460@seneca.muc.de>
Message-ID: <20051112204239.GA5776@localhost.localdomain>

My two cents: It appears that softdevice does not properly write the
CropModeToggleKey setting to setup.conf if the key has been defined
for the first time in the menu.

Only after I killed vdr and edited setup.conf by hand, was I able to
get the toggle key work from the start.  I'm using User1 as the toggle
key, and I'm using DirectFB output.

	Marko


From M.Wache at gmx.net  Sun Nov 13 12:13:03 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Sun, 13 Nov 2005 12:13:03 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <20051110194321.GA3785@localhost.localdomain>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104201423.GA11466@seneca.muc.de> <43722FF0.3010705@gmx.net> <20051109193155.GA3721@localhost.localdomain> <437384D2.2010108@gmx.net> <20051110194321.GA3785@localhost.localdomain>
Message-ID: <43771FBF.6040608@gmx.net>

Marko M?kel? schrieb:
> On Thu, Nov 10, 2005 at 06:35:14PM +0100, Martin Wache wrote:
> 
>>No, the audio is not synced at all, only the video is synced to the
>>audio. But DFB uses on top the video retrace (don't ask me how this
>>works in detail - I only use Xv out ;-)
> 
> 
> After switching streams, in DFB the audio is off sync for a few seconds.
> I wonder if the off-sync time is shorter in Xv out.
>
I guess no. The reason for this initial off sync is that the video
stream is ahead of the audio stream (to give some time for the
decoding). The softdevice starts displaying the video as soon as it has
the first frame, which is before it has the corresponding audio.
The video is then played slower until audio and video is in sync again.
I changed this once so that the video waits for the audio, but I got
some complaints about slower channel switching times. I took that change
back soon since I too like the faster channel switching.

> 
>>>I have the impression that improving the kernel timer resolution will cause
>>>more context switches per time unit.  It'd be better to use a very low
>>>kernel timer resolution and to use the RTC timer, as it will generate
>>>interrupt events.  Am I correct about this?
>>>
>>
>>I would not call me an expert on this, but I think you will get context
>>switches no matter what method you use. Well maybe only as long as the
>>softdevice is reading from /dev/rtc, but I'm not sure. I prefer RTC
>>because it doesn't depend on the kernel timer and from some tests I did
>>I found that the RTC is more reliable and precise.
> 
> 
> Sure, you can't avoid all context switches.  For instance, at 75 Hz frame
> rate and no RTC timer, you'd be better off using the 1000 Hz kernel timer.
> You'll get 13 context switches per frame, although you only need one.  If
> you used the RTC timer, you could set the kernel timer to 100 Hz.  Then,
> you'd get 2.3 context switches per frame (one for the RTC timer interrupt
> and 1.3 for the kernel scheduling interrupt).
> 
I fear the RTC timing in the softdevice is not that sophisticated. The
softdevice programs the RTC to send something every 1ms and then reads
from /dev/RTC until the waiting time has passed. So there is a context
switch every 1ms.
Your description matches more the signal timing, there we actually have
only one context switch per wait, but it depends on the kernel timer
resolution.

Martin


From M.Wache at gmx.net  Sun Nov 13 12:20:00 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Sun, 13 Nov 2005 12:20:00 +0100
Subject: [Softdevice-devel] EPIA M10000 hardware mpeg decoding
In-Reply-To: <20051109072847.M11339@mellander.org>
References: <20051109072847.M11339@mellander.org>
Message-ID: <43772160.4070001@gmx.net>

Per Mellander schrieb:
> I know this might not be the correct forum but I'll ask anyway.
> 
> I have an EPIA M10000 with CLE266 chip onboard. I have read numerous of pages on the net
> concerning getting the hardware mpeg encoder supported. I have a small dist ( Core Linux
> 2.4.x ) running on my machine where I've been running VDR + softdevice ( framebuffer
> DirectFB ).
> 
> Is there anyone here that can point me in the direction where I'll be able to get use of
> the hardware mpeg decoder? ( As I understand it. It's most likely to get it working by
> using Xv(MC) )
> 
> How much of the decoding is actually done by the hardware?
> 
The CLE266 does almost the complete decoding of the video in hardware,
not like nVidea which does only the motion compensation and the inverse
cosine transformation in hardware.

Currently the softdevice doesn't support hardware accelerated mpeg2
decoding. This might change in the future, I have now my Unichrome
XServer working with mplayer and xvmc. So once I have some time to play
around I will try to get Xvmc working for the Unichrome and the softdevice.
For the Unichrome Xserver have a look at unichrome.sourceforge.net. I
think also the comming X.org release will support Unichrome Xvmc.
About DirectFB I don't know....

Martin


From M.Wache at gmx.net  Sun Nov 13 12:27:25 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Sun, 13 Nov 2005 12:27:25 +0100
Subject: [Softdevice-devel] dvd-plugin and wrong menus
In-Reply-To: <43707DD4.6020104@cc.hut.fi>
References: <FB3B5DB3197CEA429E5FB8E83D01D039056B8D@sbs2003.do-net.de> <43707DD4.6020104@cc.hut.fi>
Message-ID: <4377231D.7080507@gmx.net>

Mikko M?kinen schrieb:
> Andre Neumann wrote:
> 
>> when using the dvd-plugin (from cvs) the menus dont get displayed
>> correct. The Buttons are not correct displayed, i mean they are on the
>> wrong position. Only want to know if anyone else has this problem and if
>> it can be fixed.
> 
> 
> I have exactly the same problem. The "selection indicator" is drawn to
> the wrong place, a little too high and left if I remember correctly. I
> also have problems with subtitle-synchronization; the subtitles are
> shown too early.
> 
> Both of these problems are present only with softdevice, not with a
> FF-card.
> 

Hmm, I guess the reason for this is that the SPU-decoder is used for the
menus...
I guess you are both not the original screen resolution of 736x576?
Some dvds just display the background of the menu via mpeg2 and the
selections are displayed via SPU (which uses the OSD of the softdevice).
Since the OSD is not scaled up to the screen resolution while the mpeg2
is, the OSD and the mpeg2 doesn't match anymore.
I'm working on a complete rewrite of the softdevice's osd, but the
progress is slow. I think I will include upscaling of the OSD in that
version.


Bye,
Martin


From M.Wache at gmx.net  Sun Nov 13 13:00:20 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Sun, 13 Nov 2005 13:00:20 +0100
Subject: [Softdevice-devel] FR translation for softplay CVS 20051014 (0.0.2)
In-Reply-To: <4361434C.6050605@e-dition.fr>
References: <4361434C.6050605@e-dition.fr>
Message-ID: <43772AD4.2040201@gmx.net>

Nicolas Huillard schrieb:
> Attached. Yo. (take care : same name as the softdevice i18n patch)
> 
> (This appears to also be a Debian packaging patch, to put in
> debian/patches, if anyone is interested before Martin commits it)
> 
> (BTW, @Martin : when do you plan to release next version ?)
> 
> (why am I writing between brackets ?)
> 

Hi Nicolas,

I finally found some time to work on softplay and commited your patch.
Thank you very much!

And I remeber now why I didn't commited my softplay changes: they depend
on the new service interface, which wasn't present in the softdevice
until yersterday.
The next release is already overdue, I will see what I have now and how
stable it really is...

Bye,
Martin


From hm at seneca.muc.de  Sun Nov 13 13:02:23 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Sun, 13 Nov 2005 13:02:23 +0100
Subject: [Softdevice-devel] cropmode toggle key
In-Reply-To: <4375F080.5020500@e-dition.fr>
References: <435EB27E.1040402@e-dition.fr> <200510270732.31636.stefan@lucke.in-berlin.de> <20051111164552.GA2460@seneca.muc.de> <200511120912.33120.stefan@lucke.in-berlin.de> <4375F080.5020500@e-dition.fr>
Message-ID: <20051113120223.GA11816@seneca.muc.de>

On Sat, Nov 12, 2005 at 02:39:12PM +0100, Nicolas Huillard wrote:
> "LIRC.User2" has teh value you have configured in LIRC, whereas
> "softdevice-dfb.User2" has a hardcoded value, which you can retreive in
> the DirectFB code. You will get this value if you activate DirectFB's
> LIRC input module (no disable-module=lirc in /etc/directfbrc) AND the
> remote code configured in LIRC is recognized by DirectFB.

I wish it had been documented somewhere that you need to use the keysymbols
from directfb. It took me more than an hour to figure this out last night.
I think I'll add this to the softdevice Wiki entry. 

I was also puzzled by the softdevice module writing the numerical values to
remote.conf. How about just using the directfb names, like the "remote"
plugin with Lirc? 

-- 
Weinberg's First Law:
	Progress is made on alternate Fridays.


From hm at seneca.muc.de  Sun Nov 13 14:09:10 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Sun, 13 Nov 2005 14:09:10 +0100
Subject: [Softdevice-devel] cropmode toggle key
In-Reply-To: <20051113120223.GA11816@seneca.muc.de>
References: <435EB27E.1040402@e-dition.fr> <200510270732.31636.stefan@lucke.in-berlin.de> <20051111164552.GA2460@seneca.muc.de> <200511120912.33120.stefan@lucke.in-berlin.de> <4375F080.5020500@e-dition.fr> <20051113120223.GA11816@seneca.muc.de>
Message-ID: <20051113130910.GA14471@seneca.muc.de>

On Sun, Nov 13, 2005 at 01:02:23PM +0100, Harald Milz wrote:
> I wish it had been documented somewhere that you need to use the keysymbols
> from directfb. It took me more than an hour to figure this out last night.
> I think I'll add this to the softdevice Wiki entry. 

It's now in http://www.vdr-wiki.de/wiki/index.php/Softdevice-plugin, albeit
in German because the English page lags a bit. 

-- 
Be security conscious -- National defense is at stake.


From hm at seneca.muc.de  Sun Nov 13 15:00:25 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Sun, 13 Nov 2005 15:00:25 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <200511042339.20029.stefan@lucke.in-berlin.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042255.02965.stefan@lucke.in-berlin.de> <20051104220420.GD4070@localhost.localdomain> <200511042339.20029.stefan@lucke.in-berlin.de>
Message-ID: <20051113140025.GB15732@seneca.muc.de>

On Fri, Nov 04, 2005 at 11:39:19PM +0100, Stefan Lucke wrote:
> CVS version of softdevice does compile and work with vdr-1.2.1
> again :-) .

Is the patch in 0.2.1? 

-- 
"On two occasions I have been asked [by members of Parliament!], `Pray,
Mr.  Babbage, if you put into the machine wrong figures, will the right
answers come out?'  I am not able rightly to apprehend the kind of
confusion of ideas that could provoke such a question."
		-- Charles Babbage


From hm at seneca.muc.de  Sun Nov 13 14:57:30 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Sun, 13 Nov 2005 14:57:30 +0100
Subject: [Softdevice-devel] VGA card for Xvmc
Message-ID: <20051113135730.GA15732@seneca.muc.de>

Hi,

now that my Matrox G550 w/ DVI out is configured nicely and works fine
w/ softdevice, it's time to rip everything apart and try something new
;-) Just kidding - IMHO the CPU load with an Athlon XP 3000+ is still
too high at 60% average (when rescaling to 1280x720p-60). There is no
serious reserve for osdpip or HD-TV, and osdpip does jerk when active.

I am now looking into getting an nVidia card. What I hear from the list
and various wikis, a fanless FX5200 card may be the correct choice,
for example an Aopen Aeolus FX5200-DV128. It is specified at 2048x1536
output - does this also hold true for the DVI out (not as the Matrox
cards that can't do 1080i on DVI)?

Am I on the right track? Any other card worth looking into?

-- 
Does the name Pavlov ring a bell?


From stefan at lucke.in-berlin.de  Sun Nov 13 15:29:39 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 13 Nov 2005 15:29:39 +0100
Subject: [Softdevice-devel] softdevice and nvram-wakeup
In-Reply-To: <20051113140025.GB15732@seneca.muc.de>
References: <20051104171435.GA6992@seneca.muc.de> <200511042339.20029.stefan@lucke.in-berlin.de> <20051113140025.GB15732@seneca.muc.de>
Message-ID: <200511131529.39763.stefan@lucke.in-berlin.de>

On Sonntag, 13. November 2005 15:00, Harald Milz wrote:
> On Fri, Nov 04, 2005 at 11:39:19PM +0100, Stefan Lucke wrote:
> > CVS version of softdevice does compile and work with vdr-1.2.1
> > again :-) .
> 
> Is the patch in 0.2.1? 

I guess yes. Softdevice-0.2.1(cvs) still compiles and works with vdr-1.2.1 .

-- 
Stefan Lucke



From seppo.ingalsuo at iki.fi  Sun Nov 13 16:10:32 2005
From: seppo.ingalsuo at iki.fi (Seppo Ingalsuo)
Date: Sun, 13 Nov 2005 17:10:32 +0200
Subject: [Softdevice-devel] VGA card for Xvmc
In-Reply-To: <20051113135730.GA15732@seneca.muc.de>
References: <20051113135730.GA15732@seneca.muc.de>
Message-ID: <43775768.4060605@iki.fi>

Harald Milz wrote:

>
>I am now looking into getting an nVidia card. What I hear from the list
>and various wikis, a fanless FX5200 card may be the correct choice,
>for example an Aopen Aeolus FX5200-DV128. It is specified at 2048x1536
>output - does this also hold true for the DVI out (not as the Matrox
>cards that can't do 1080i on DVI)?
>  
>
I have a Gainward FX5200 that works well with NVidia's closed source 
XF86 drivers. The s-video out is not that good quality, it is worse than 
dxr3, but I've ordered a LCD display with HDMI input so I expect to get 
improvement :^) My FX5200 has smaller available resolution from DVI 
compared to VGA but I checked that at least 720p works trough DVI. 1080p 
wouldn't work trough DVI. I'm not sure about 1080i, but I don't want any 
more nasty de-interlacing and re-interlacing effects I suffer from now 
with s-video.

I remember reading from somewhere that there is an upper limit for DVI 
resolution that is not card specific. Hires DVI monitors are fed with 
two DVI cables and the driver card must be dual-head like. Is that true?

>Am I on the right track? Any other card worth looking into?
>  
>
Probably, I have been happy so far. The next challenge will be to try to 
match the panel native resolution (1368x768) with DVI. I have heard 
rumours that something like 1366x768 or 1360x768 could work with Nvidia 
if 1368 is not possible. 720p should at least work.

With current Softdevice CVS I have a problem with new XV color 
adjustments. In default 50 value I get almost black and white picture. I 
must adjust after each vdr restart the controls to about 90 as 
softdevice doesn't store the setttings currently.

The subject line is about Xvmx. I tried that with vdr-xine but I got 
occasional crashes so I used also with vdr-xine just Xv. AFAIK 
softdevice doesn't support Xvmc.

BR,
Seppo



From hm at seneca.muc.de  Sun Nov 13 18:26:33 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Sun, 13 Nov 2005 18:26:33 +0100
Subject: [Softdevice-devel] Small cosmetic error in 0.2.0
Message-ID: <20051113172633.GA23960@seneca.muc.de>

Hi,

I always get these lines in the syslog: 

Nov 13 18:09:41 linvdr vdr[3738]: ERROR: unknown config parameter: softdevice.AlsaAC3Device = plug:spdif
Nov 13 18:09:41 linvdr vdr[3738]: ERROR: unknown config parameter: softdevice.AlsaDevice = plug:spdif

I deleted these lines earlier but apparently softdevice sets them itself
from the command line, and then doesn't grok them at the next start... 

-- 
Your fault: core dumped


From hm at seneca.muc.de  Sun Nov 13 19:20:51 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Sun, 13 Nov 2005 19:20:51 +0100
Subject: [Softdevice-devel] EPIA M10000 hardware mpeg decoding
In-Reply-To: <43772160.4070001@gmx.net>
References: <20051109072847.M11339@mellander.org> <43772160.4070001@gmx.net>
Message-ID: <20051113182051.GA25203@seneca.muc.de>

On Sun, Nov 13, 2005 at 12:20:00PM +0100, Martin Wache wrote:
> The CLE266 does almost the complete decoding of the video in hardware,
> not like nVidea which does only the motion compensation and the inverse
> cosine transformation in hardware.

Would the XX10000 boards be able to decode / display HDTV? 

The SP seems to support HDTV with the DVI-02 adapter. The other 10000
boards support only the DVI-01 adapter which does not seem to. 

Question is - does the combo have enough horsepower for HDTV w/ CLE266 
MPEG2 decoding? 


-- 
Mophobia, n.:
	Fear of being verbally abused by a Mississippian.


From Neumann at do-net.de  Mon Nov 14 08:26:43 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Mon, 14 Nov 2005 08:26:43 +0100
Subject: [Softdevice-devel] dvd-plugin and wrong menus
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B9E@sbs2003.do-net.de>

Yes, this is the reason. Im using softdevice with 1280x720 resolution. 

> -----Original Message-----
> From: softdevice-devel-admin at berlios.de 
> [mailto:softdevice-devel-admin at berlios.de] On Behalf Of Martin Wache
> Sent: Sunday, November 13, 2005 12:27 PM
> To: softdevice-devel at berlios.de
> Subject: Re: [Softdevice-devel] dvd-plugin and wrong menus
> 
> Mikko M?kinen schrieb:
> > Andre Neumann wrote:
> > 
> >> when using the dvd-plugin (from cvs) the menus dont get displayed
> >> correct. The Buttons are not correct displayed, i mean 
> they are on the
> >> wrong position. Only want to know if anyone else has this 
> problem and if
> >> it can be fixed.
> > 
> > 
> > I have exactly the same problem. The "selection indicator" 
> is drawn to
> > the wrong place, a little too high and left if I remember 
> correctly. I
> > also have problems with subtitle-synchronization; the subtitles are
> > shown too early.
> > 
> > Both of these problems are present only with softdevice, not with a
> > FF-card.
> > 
> 
> Hmm, I guess the reason for this is that the SPU-decoder is 
> used for the
> menus...
> I guess you are both not the original screen resolution of 736x576?
> Some dvds just display the background of the menu via mpeg2 and the
> selections are displayed via SPU (which uses the OSD of the 
> softdevice).
> Since the OSD is not scaled up to the screen resolution while 
> the mpeg2
> is, the OSD and the mpeg2 doesn't match anymore.
> I'm working on a complete rewrite of the softdevice's osd, but the
> progress is slow. I think I will include upscaling of the OSD in that
> version.
> 
> 
> Bye,
> Martin
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 
> 



From Neumann at do-net.de  Mon Nov 14 11:52:42 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Mon, 14 Nov 2005 11:52:42 +0100
Subject: [Softdevice-devel] Softplay does deinterlacing with 720p clips, too
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056B9F@sbs2003.do-net.de>

Hi,

When using softplay to display 720p hdtv trailers (eg. divx,mpeg2) it
uses the deinterlacing method which i specified in the
softdevice setup. That is not right, i think. When playing progressive
material, the deinterlacer must be switched off.

I'm doing this manualy now, since the deinterlacer uses too much
cpu-power. It would be nice, if softplay detects a progressive
video and deativate the deinterlacer.

-------------
Andre Neumann



From hm at seneca.muc.de  Mon Nov 14 07:55:10 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Mon, 14 Nov 2005 07:55:10 +0100
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <200511062313.21562.stefan@lucke.in-berlin.de>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511061556.14438.stefan@lucke.in-berlin.de> <20051106205611.GD19593@seneca.muc.de> <200511062313.21562.stefan@lucke.in-berlin.de>
Message-ID: <20051114065510.GC1562@seneca.muc.de>

On Sun, Nov 06, 2005 at 11:13:21PM +0100, Stefan Lucke wrote:
> > Matrox problem :-(( Are there cards that support 1980x1080 natively on DVI
> > out?  Just in case somebody in DE comes up with 1080i broadcastings... 
> 
> Oh, that limitation applies only using the back end scaler. Using YUY2
> and stretchbilt :-) I had no problem except cpu power [limit is 2048x2048].

Sure but this spoils the purpose of using a Matrox card somehow. It's
the BES that makes it interesting ;-) I don't want a living room machine
that's even louder for cooling... 

-- 
Forms follow function, and often obliterate it.


From hm at seneca.muc.de  Mon Nov 14 07:55:10 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Mon, 14 Nov 2005 07:55:10 +0100
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <200511062313.21562.stefan@lucke.in-berlin.de>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511061556.14438.stefan@lucke.in-berlin.de> <20051106205611.GD19593@seneca.muc.de> <200511062313.21562.stefan@lucke.in-berlin.de>
Message-ID: <20051114065510.GC1562@seneca.muc.de>

On Sun, Nov 06, 2005 at 11:13:21PM +0100, Stefan Lucke wrote:
> > Matrox problem :-(( Are there cards that support 1980x1080 natively on DVI
> > out?  Just in case somebody in DE comes up with 1080i broadcastings... 
> 
> Oh, that limitation applies only using the back end scaler. Using YUY2
> and stretchbilt :-) I had no problem except cpu power [limit is 2048x2048].

Sure but this spoils the purpose of using a Matrox card somehow. It's
the BES that makes it interesting ;-) I don't want a living room machine
that's even louder for cooling... 

-- 
Forms follow function, and often obliterate it.


From M.Wache at gmx.net  Mon Nov 14 18:31:33 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Mon, 14 Nov 2005 18:31:33 +0100
Subject: [Softdevice-devel] EPIA M10000 hardware mpeg decoding
In-Reply-To: <20051113182051.GA25203@seneca.muc.de>
References: <20051109072847.M11339@mellander.org> <43772160.4070001@gmx.net> <20051113182051.GA25203@seneca.muc.de>
Message-ID: <4378C9F5.6000806@gmx.net>

Harald Milz schrieb:
> On Sun, Nov 13, 2005 at 12:20:00PM +0100, Martin Wache wrote:
> 
>>The CLE266 does almost the complete decoding of the video in hardware,
>>not like nVidea which does only the motion compensation and the inverse
>>cosine transformation in hardware.
> 
> 
> Would the XX10000 boards be able to decode / display HDTV? 
> 
The CLE266 not, there is a limitation in the size, I don't remember what
it was but it was not much bigger than the PAL resolution. As far as I
know the CN400 is supposed to be able to decode HDTV.

> The SP seems to support HDTV with the DVI-02 adapter. The other 10000
> boards support only the DVI-01 adapter which does not seem to. 
> 
> Question is - does the combo have enough horsepower for HDTV w/ CLE266 
> MPEG2 decoding? 
> 
Probably the CN400 with hardware decoding, but certainly not a Via C3
with a CLE266 and software decoding ;-)

Martin



From stefan at lucke.in-berlin.de  Mon Nov 14 21:00:36 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Mon, 14 Nov 2005 21:00:36 +0100
Subject: [Softdevice-devel] Patch: Via Unichrome TV-out
In-Reply-To: <20051114065510.GC1562@seneca.muc.de>
References: <200511061124.38533.laz@club-burniston.co.uk> <200511062313.21562.stefan@lucke.in-berlin.de> <20051114065510.GC1562@seneca.muc.de>
Message-ID: <200511142100.36532.stefan@lucke.in-berlin.de>

On Montag, 14. November 2005 07:55, Harald Milz wrote:
> On Sun, Nov 06, 2005 at 11:13:21PM +0100, Stefan Lucke wrote:
> > > Matrox problem :-(( Are there cards that support 1980x1080 natively on DVI
> > > out?  Just in case somebody in DE comes up with 1080i broadcastings... 
> > 
> > Oh, that limitation applies only using the back end scaler. Using YUY2
> > and stretchbilt :-) I had no problem except cpu power [limit is 2048x2048].
> 
> Sure but this spoils the purpose of using a Matrox card somehow. It's
> the BES that makes it interesting ;-)

No, as BES cannot be used for TV-out.
Matrox BES cannot do pixel based alpha blending.

TV-out and pixel based alpha can be done via stretchblit() up to
above limit.

> I don't want a living room machine
> that's even louder for cooling... 


-- 
Stefan Lucke



From stefan at lucke.in-berlin.de  Mon Nov 14 21:06:04 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Mon, 14 Nov 2005 21:06:04 +0100
Subject: [Softdevice-devel] EPIA M10000 hardware mpeg decoding
In-Reply-To: <4378C9F5.6000806@gmx.net>
References: <20051109072847.M11339@mellander.org> <20051113182051.GA25203@seneca.muc.de> <4378C9F5.6000806@gmx.net>
Message-ID: <200511142106.04649.stefan@lucke.in-berlin.de>

On Montag, 14. November 2005 18:31, Martin Wache wrote:
> Harald Milz schrieb:
> > On Sun, Nov 13, 2005 at 12:20:00PM +0100, Martin Wache wrote:
> > 
> >>The CLE266 does almost the complete decoding of the video in hardware,
> >>not like nVidea which does only the motion compensation and the inverse
> >>cosine transformation in hardware.
> > 
> > 
> > Would the XX10000 boards be able to decode / display HDTV? 
> > 
> The CLE266 not, there is a limitation in the size, I don't remember what
> it was but it was not much bigger than the PAL resolution. As far as I
> know the CN400 is supposed to be able to decode HDTV.

HDTV != HDTV :-) previously Pro7 send mpeg2 HDTV test films like
spider men. Currently they send H264 which no-one can receive due to
DVB-S2 transmissions. Epia HW decode support, does not include H264
decoding (correct me if I'm wrong, only mpeg2 + mpeg4 [aka divx]).

> 
> > The SP seems to support HDTV with the DVI-02 adapter. The other 10000
> > boards support only the DVI-01 adapter which does not seem to. 
> > 
> > Question is - does the combo have enough horsepower for HDTV w/ CLE266 
> > MPEG2 decoding? 
> > 
> Probably the CN400 with hardware decoding, but certainly not a Via C3
> with a CLE266 and software decoding ;-)
> 
> Martin
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 

-- 
Stefan Lucke



From hm at seneca.muc.de  Mon Nov 14 20:41:30 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Mon, 14 Nov 2005 20:41:30 +0100
Subject: [Softdevice-devel] Testing the handful of Astra HDTV channels
Message-ID: <20051114194130.GA12076@seneca.muc.de>

Hi,

did some testing today with the handful of channels that are on Astra:

Astra HDTV promo:12168:vC56:S19.2E:27500:133:134:0:0:21101:0:0:0
Euro1080/HD1 HDTV:12168:vC56:S19.2E:27500:308:256=eng:0:0:21100:1:1088:0
Pioneer HDTV:12441:V:S19.2E:27500:133+80:134=eng:0:0:29700:1:1102:0
Pro7 HDTV:11914:h:S19.2E:27500:255:0;259:0:0:658:133:6:0
Canal+ DEMO HD;CSAT:12581:vC56:S19.2E:22000:165:100=fra;101=fra:0:0:9306:1:1110:0

In short: Mixed results, no picture.

Hardware: FuSi Activy SAA7146 budget card, Athlon XP-M 2400+ running at
2167 MHz, Matrox G550

Software: vdr-1.3.26, softdevice-cvs from Nov 05 21:15, ffmpeg-0.4.9,
directfb-0.9.22, SL 9.3 

native resolution: 1280x720p, 60 Hz. 

none of the channels produced a visible image

channel			resolution i.a.w.	crashes
			softdevice [VideoOut]
Astra HDTV promo	1920x1088 (!)		yes
Euro1080/HD1 HDTV 	didn't even try... 
Pioneer HDTV		?			no
Pro7 HDTV		?			no
Canal+ DEMO HD		1440x1080		yes

Pioneer and Pro7 may have been offline, don't know. This may be why
softdevice reported no [VideoOut] resolution changed message. 

I will try another run with 0.2.1 later (currently, I am recording ...) 


It that a bug or a feature? 

-- 
If I could drop dead right now, I'd be the happiest man alive!
		-- Samuel Goldwyn


From M.Wache at gmx.net  Mon Nov 14 22:15:10 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Mon, 14 Nov 2005 22:15:10 +0100
Subject: [Softdevice-devel] EPIA M10000 hardware mpeg decoding
In-Reply-To: <200511142106.04649.stefan@lucke.in-berlin.de>
References: <20051109072847.M11339@mellander.org> <20051113182051.GA25203@seneca.muc.de> <4378C9F5.6000806@gmx.net> <200511142106.04649.stefan@lucke.in-berlin.de>
Message-ID: <4378FE5E.7040406@gmx.net>

Stefan Lucke schrieb:
> On Montag, 14. November 2005 18:31, Martin Wache wrote:
> 
>>Harald Milz schrieb:
>>
>>>On Sun, Nov 13, 2005 at 12:20:00PM +0100, Martin Wache wrote:
>>>
>>>
>>>>The CLE266 does almost the complete decoding of the video in hardware,
>>>>not like nVidea which does only the motion compensation and the inverse
>>>>cosine transformation in hardware.
>>>
>>>
>>>Would the XX10000 boards be able to decode / display HDTV? 
>>>
>>
>>The CLE266 not, there is a limitation in the size, I don't remember what
>>it was but it was not much bigger than the PAL resolution. As far as I
>>know the CN400 is supposed to be able to decode HDTV.
> 
> 
> HDTV != HDTV :-) previously Pro7 send mpeg2 HDTV test films like
> spider men. Currently they send H264 which no-one can receive due to
> DVB-S2 transmissions. Epia HW decode support, does not include H264
> decoding (correct me if I'm wrong, only mpeg2 + mpeg4 [aka divx]).
> 
> 
H264 is MPEG-4, Part 10.
But you are right, there are different mpeg4 codecs, but they have all
similar features (I don't know the exact differences - I'm not an expert
on this). Since the mpeg4 hardware acceleration of the CN400 is on a
much lower level than the mpeg2 decoding ( as far as I know it does only
the MC) the probability is good that h264 will be supported. At least
Ivor states that somewhere.

Martin



From M.Wache at gmx.net  Mon Nov 14 22:23:39 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Mon, 14 Nov 2005 22:23:39 +0100
Subject: [Softdevice-devel] Softplay does deinterlacing with 720p clips,
 too
In-Reply-To: <FB3B5DB3197CEA429E5FB8E83D01D039056B9F@sbs2003.do-net.de>
References: <FB3B5DB3197CEA429E5FB8E83D01D039056B9F@sbs2003.do-net.de>
Message-ID: <4379005B.2060905@gmx.net>

Andre Neumann schrieb:
> Hi,
> 
> When using softplay to display 720p hdtv trailers (eg. divx,mpeg2) it
> uses the deinterlacing method which i specified in the
> softdevice setup. That is not right, i think. When playing progressive
> material, the deinterlacer must be switched off.
> 
> I'm doing this manualy now, since the deinterlacer uses too much
> cpu-power. It would be nice, if softplay detects a progressive
> video and deativate the deinterlacer.
> 

I would like to implement that, but I don't know how to detect
progressive or interlaced videos :-(
I just tried to use interlaced_frame which should report interlaced
frames but it is alway zero. I also remember that a ffmpeg developer
once said that the detection of interlaced video and field order is
broken in ffmpeg.

If there is a simple and reliable way to detect progressive videos it is
no problem to disable the deinterlacer, but sorry I don't know how to
detect it...

Martin



From M.Wache at gmx.net  Mon Nov 14 22:45:32 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Mon, 14 Nov 2005 22:45:32 +0100
Subject: [Softdevice-devel] Softplay does deinterlacing with 720p clips,
 too
In-Reply-To: <4379005B.2060905@gmx.net>
References: <FB3B5DB3197CEA429E5FB8E83D01D039056B9F@sbs2003.do-net.de> <4379005B.2060905@gmx.net>
Message-ID: <4379057C.9050002@gmx.net>

Martin Wache schrieb:
> Andre Neumann schrieb:
> 
>>Hi,
>>
>>When using softplay to display 720p hdtv trailers (eg. divx,mpeg2) it
>>uses the deinterlacing method which i specified in the
>>softdevice setup. That is not right, i think. When playing progressive
>>material, the deinterlacer must be switched off.
>>
>>I'm doing this manualy now, since the deinterlacer uses too much
>>cpu-power. It would be nice, if softplay detects a progressive
>>video and deativate the deinterlacer.
>>
> 
> 
> I would like to implement that, but I don't know how to detect
> progressive or interlaced videos :-(
> I just tried to use interlaced_frame which should report interlaced
> frames but it is alway zero. I also remember that a ffmpeg developer
> once said that the detection of interlaced video and field order is
> broken in ffmpeg.
> 
> If there is a simple and reliable way to detect progressive videos it is
> no problem to disable the deinterlacer, but sorry I don't know how to
> detect it...
> 
Correction - interlaced_frame seems to work. Don't know what I did wrong
just a few moments ago...
Please try the attached patch against softdevice cvs if it works for you.

Martin
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: interlaced.diff
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051114/955f6719/attachment.ksh>

From Neumann at do-net.de  Tue Nov 15 09:35:36 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Tue, 15 Nov 2005 09:35:36 +0100
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056BA3@sbs2003.do-net.de>

Did you take a look at it? Would it be possible to use it with
softdevice?

-------------
Andre Neumann
 

> -----Original Message-----
> From: softdevice-devel-admin at berlios.de 
> [mailto:softdevice-devel-admin at berlios.de] On Behalf Of Andre Neumann
> Sent: Thursday, November 03, 2005 2:36 PM
> To: softdevice-devel at berlios.de
> Subject: RE: [Softdevice-devel] Softplay and divx/xvid artefacts
> 
> http://prdownloads.sourceforge.net/deinterlace/Deinterlace120src.zip
> 
> Main Code is in DeinterlaceFiler.cpp
> 
> -------------
> Andre Neumann 
> 
> > -----Original Message-----
> > From: softdevice-devel-admin at berlios.de 
> > [mailto:softdevice-devel-admin at berlios.de] On Behalf Of Stefan Lucke
> > Sent: Thursday, November 03, 2005 2:40 PM
> > To: softdevice-devel at berlios.de
> > Subject: RE: [Softdevice-devel] Softplay and divx/xvid artefacts
> > 
> > Quoting Andre Neumann <Neumann at do-net.de>:
> > 
> > > Maybe it is possible to integrate the deinterlace code from 
> > the Dscaler? It is the best open source deinterlace code found, i
> > > think. I do not know
> > > much about coding, but maybe it is possible to integrate 
> it. Stefan?
> > 
> > Do you have a link ?
> > 
> > Stefan Lucke
> > 
> > 
> > _______________________________________________
> > Softdevice-devel mailing list
> > Softdevice-devel at lists.berlios.de
> > http://lists.berlios.de/mailman/listinfo/softdevice-devel
> > 
> > 
> > 
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 
> 



From marko.makela at hut.fi  Tue Nov 15 10:57:49 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Tue, 15 Nov 2005 11:57:49 +0200
Subject: [Softdevice-devel] Avoiding off-sync audio at the start of a clip
In-Reply-To: <43771FBF.6040608@gmx.net>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104201423.GA11466@seneca.muc.de> <43722FF0.3010705@gmx.net> <20051109193155.GA3721@localhost.localdomain> <437384D2.2010108@gmx.net> <20051110194321.GA3785@localhost.localdomain> <43771FBF.6040608@gmx.net>
Message-ID: <20051115095749.GB3794@localhost.localdomain>

On Sun, Nov 13, 2005 at 12:13:03PM +0100, Martin Wache wrote:
> > After switching streams, in DFB the audio is off sync for a few seconds.
> > I wonder if the off-sync time is shorter in Xv out.
> >
> I guess no. The reason for this initial off sync is that the video
> stream is ahead of the audio stream (to give some time for the
> decoding). The softdevice starts displaying the video as soon as it has
> the first frame, which is before it has the corresponding audio.
> The video is then played slower until audio and video is in sync again.
> I changed this once so that the video waits for the audio, but I got
> some complaints about slower channel switching times. I took that change
> back soon since I too like the faster channel switching.

How hard would it be to play video only until the first up-to-date audio
frame arrives?  Even some analog TV sets mute the audio during channel
zapping.

The current behaviour is a bit irritating when you play recordings that
start with a program announcement showing a live picture of the announcer's
head.  The lip-sync will be lost for a few seconds.

> I fear the RTC timing in the softdevice is not that sophisticated. The
> softdevice programs the RTC to send something every 1ms and then reads
> from /dev/RTC until the waiting time has passed. So there is a context
> switch every 1ms.

I see, it uses the RTC as a source of 1ms time quantums.  I assumed that
you would constantly reprogram the RTC timer to expire at the next deadline,
but I guess it would be very hard to avoid jitter, as you'd need two context
switches per cycle: one to read the timer and another one to reprogram it.

	Marko


From stefan at lucke.in-berlin.de  Tue Nov 15 12:16:44 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Tue, 15 Nov 2005 12:16:44 +0100
Subject: [Softdevice-devel] Avoiding off-sync audio at the start of a clip
In-Reply-To: <20051115095749.GB3794@localhost.localdomain>
References: <20051104171435.GA6992@seneca.muc.de> <200511042011.59286.stefan@lucke.in-berlin.de> <20051104201423.GA11466@seneca.muc.de> <43722FF0.3010705@gmx.net> <20051109193155.GA3721@localhost.localdomain> <437384D2.2010108@gmx.net> <20051110194321.GA3785@localhost.localdomain> <43771FBF.6040608@gmx.net> <20051115095749.GB3794@localhost.localdomain>
Message-ID: <1132053404.4379c39cc6870@webmail.in-berlin.de>

Quoting Marko M?kel? <marko.makela at hut.fi>:

> On Sun, Nov 13, 2005 at 12:13:03PM +0100, Martin Wache wrote:
> > > After switching streams, in DFB the audio is off sync for a few seconds.
> > > I wonder if the off-sync time is shorter in Xv out.
> > >
> > I guess no. The reason for this initial off sync is that the video
> > stream is ahead of the audio stream (to give some time for the
> > decoding). The softdevice starts displaying the video as soon as it has
> > the first frame, which is before it has the corresponding audio.
> > The video is then played slower until audio and video is in sync again.
> > I changed this once so that the video waits for the audio, but I got
> > some complaints about slower channel switching times. I took that change
> > back soon since I too like the faster channel switching.

I got the impression that something has changed inside vdr.

Now:
I noticed that upon channel switch, audio seems to be ahead of video,
and after channel switch I get a few video frames dropped (+ chars written)

Previous:
Video was ahead of audio and after switching channels, some video frames
got an extra delay (slow motion).

A few days ago I did some vdr-1.2.1 tests with a streamdev connection
to my DVB-S server. Channel switching times were rather impressive
compared to my DVB-T vdr-1.3.34 development system.

Have to check since which vdr version this behavior changed.

>
> How hard would it be to play video only until the first up-to-date audio
> frame arrives?  Even some analog TV sets mute the audio during channel
> zapping.

I would prefer not to change this adhoc (without user preferrences,
yet another option :-( ).

>
> The current behaviour is a bit irritating when you play recordings that
> start with a program announcement showing a live picture of the announcer's
> head.  The lip-sync will be lost for a few seconds.
>
> > I fear the RTC timing in the softdevice is not that sophisticated. The
> > softdevice programs the RTC to send something every 1ms and then reads
> > from /dev/RTC until the waiting time has passed. So there is a context
> > switch every 1ms.
>
> I see, it uses the RTC as a source of 1ms time quantums.  I assumed that
> you would constantly reprogram the RTC timer to expire at the next deadline,
> but I guess it would be very hard to avoid jitter, as you'd need two context
> switches per cycle: one to read the timer and another one to reprogram it.
>

Stefan Lucke


From hm at seneca.muc.de  Tue Nov 15 22:47:45 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Tue, 15 Nov 2005 22:47:45 +0100
Subject: [Softdevice-devel] EPIA M10000 hardware mpeg decoding
In-Reply-To: <200511142106.04649.stefan@lucke.in-berlin.de>
References: <20051109072847.M11339@mellander.org> <20051113182051.GA25203@seneca.muc.de> <4378C9F5.6000806@gmx.net> <200511142106.04649.stefan@lucke.in-berlin.de>
Message-ID: <20051115214745.GA12576@seneca.muc.de>

On Mon, Nov 14, 2005 at 09:06:04PM +0100, Stefan Lucke wrote:
> HDTV != HDTV :-) previously Pro7 send mpeg2 HDTV test films like
  ^^^^^^^^^^^^^^^
:-(

> spider men. Currently they send H264 which no-one can receive due to
> DVB-S2 transmissions. Epia HW decode support, does not include H264

OK I get it that one needs a DVB-S2 card, right?

> decoding (correct me if I'm wrong, only mpeg2 + mpeg4 [aka divx]).

Sure - I was more thinking about having a fast server convert the HDTV stuff
to MPEG2 if that is possible at all and then use a fanless Xine client in
the living room to do the rest. 

Too early I suppose. It's hard to be on the bleeding edge ;-) 

-- 
"Cable is not a luxury, since many areas have poor TV reception."
		-- The mayor of Tucson, Arizona, 1989


From hm at seneca.muc.de  Tue Nov 15 22:47:45 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Tue, 15 Nov 2005 22:47:45 +0100
Subject: [Softdevice-devel] EPIA M10000 hardware mpeg decoding
In-Reply-To: <200511142106.04649.stefan@lucke.in-berlin.de>
References: <20051109072847.M11339@mellander.org> <20051113182051.GA25203@seneca.muc.de> <4378C9F5.6000806@gmx.net> <200511142106.04649.stefan@lucke.in-berlin.de>
Message-ID: <20051115214745.GA12576@seneca.muc.de>

On Mon, Nov 14, 2005 at 09:06:04PM +0100, Stefan Lucke wrote:
> HDTV != HDTV :-) previously Pro7 send mpeg2 HDTV test films like
  ^^^^^^^^^^^^^^^
:-(

> spider men. Currently they send H264 which no-one can receive due to
> DVB-S2 transmissions. Epia HW decode support, does not include H264

OK I get it that one needs a DVB-S2 card, right?

> decoding (correct me if I'm wrong, only mpeg2 + mpeg4 [aka divx]).

Sure - I was more thinking about having a fast server convert the HDTV stuff
to MPEG2 if that is possible at all and then use a fanless Xine client in
the living room to do the rest. 

Too early I suppose. It's hard to be on the bleeding edge ;-) 

-- 
"Cable is not a luxury, since many areas have poor TV reception."
		-- The mayor of Tucson, Arizona, 1989


From stefan at lucke.in-berlin.de  Tue Nov 15 23:55:16 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Tue, 15 Nov 2005 23:55:16 +0100
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
In-Reply-To: <FB3B5DB3197CEA429E5FB8E83D01D039056BA3@sbs2003.do-net.de>
References: <FB3B5DB3197CEA429E5FB8E83D01D039056BA3@sbs2003.do-net.de>
Message-ID: <200511152355.16615.stefan@lucke.in-berlin.de>

On Dienstag, 15. November 2005 09:35, Andre Neumann wrote:
> Did you take a look at it? Would it be possible to use it with
> softdevice?

Only a very short look. At the moment my spare time does not allow
such big changes. If you volunteer ...

Stefan Lucke



From Neumann at do-net.de  Wed Nov 16 09:44:01 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Wed, 16 Nov 2005 09:44:01 +0100
Subject: [Softdevice-devel] Softplay and divx/xvid artefacts
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056BA8@sbs2003.do-net.de>

If i would be programmer, no problem :)

He, sorry, dont want to nerv you. Mainly i only wanted to know if thats
even possible.

Btw. the tvtime project uses the dscaler deinterlace, too. Project page
is
http://tvtime.sf.net

Only for the records :)

-------------
Andre Neumann

> -----Original Message-----
> From: softdevice-devel-admin at berlios.de 
> [mailto:softdevice-devel-admin at berlios.de] On Behalf Of Stefan Lucke
> Sent: Tuesday, November 15, 2005 11:55 PM
> To: softdevice-devel at lists.berlios.de
> Subject: Re: [Softdevice-devel] Softplay and divx/xvid artefacts
> 
> On Dienstag, 15. November 2005 09:35, Andre Neumann wrote:
> > Did you take a look at it? Would it be possible to use it with
> > softdevice?
> 
> Only a very short look. At the moment my spare time does not allow
> such big changes. If you volunteer ...
> 
> Stefan Lucke
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 
> 



From Neumann at do-net.de  Fri Nov 18 10:11:47 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Fri, 18 Nov 2005 10:11:47 +0100
Subject: [Softdevice-devel] Softplay does deinterlacing with 720p clips, too
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039056BB5@sbs2003.do-net.de>

Works fine here. Should be added to CVS.

-------------
Andre Neumann

> -----Original Message-----
> From: softdevice-devel-admin at berlios.de 
> [mailto:softdevice-devel-admin at berlios.de] On Behalf Of Martin Wache
> Sent: Monday, November 14, 2005 10:46 PM
> To: softdevice-devel at berlios.de
> Subject: Re: [Softdevice-devel] Softplay does deinterlacing 
> with 720p clips, too
> 
> Martin Wache schrieb:
> > Andre Neumann schrieb:
> > 
> >>Hi,
> >>
> >>When using softplay to display 720p hdtv trailers (eg. 
> divx,mpeg2) it
> >>uses the deinterlacing method which i specified in the
> >>softdevice setup. That is not right, i think. When playing 
> progressive
> >>material, the deinterlacer must be switched off.
> >>
> >>I'm doing this manualy now, since the deinterlacer uses too much
> >>cpu-power. It would be nice, if softplay detects a progressive
> >>video and deativate the deinterlacer.
> >>
> > 
> > 
> > I would like to implement that, but I don't know how to detect
> > progressive or interlaced videos :-(
> > I just tried to use interlaced_frame which should report interlaced
> > frames but it is alway zero. I also remember that a ffmpeg developer
> > once said that the detection of interlaced video and field order is
> > broken in ffmpeg.
> > 
> > If there is a simple and reliable way to detect progressive 
> videos it is
> > no problem to disable the deinterlacer, but sorry I don't 
> know how to
> > detect it...
> > 
> Correction - interlaced_frame seems to work. Don't know what 
> I did wrong
> just a few moments ago...
> Please try the attached patch against softdevice cvs if it 
> works for you.
> 
> Martin
> 
> 



From Neumann at do-net.de  Sun Nov 20 12:09:49 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Sun, 20 Nov 2005 12:09:49 +0100
Subject: [Softdevice-devel] Speeding up softdevice?
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039D13F@sbs2003.do-net.de>

Hi,
 
yesterday i've done some performance tests with softdevice and mplayer.
I played some HD mpeg files (1080i) and noticed, that with softdevice
(softplay) i get much slower playback. 
 
CPU is about 90%, but the playback is not smooth. When using mplayer
with -vo directfb the playback is excellent, no skipped frames,
everything ok.
 
Are there any options to speed up the decoding done by
softdevice/ffmpeg, because mplayer uses ffmpeg, too i think.
 
My setup is: Matrox G550 with DirectFB, P4 2,8GHz, 512MB.
 
-------------
Andre Neumann




From zdzisekg at yahoo.com  Mon Nov 21 21:29:37 2005
From: zdzisekg at yahoo.com (Zdzislaw Gorlicki)
Date: Mon, 21 Nov 2005 12:29:37 -0800 (PST)
Subject: [Softdevice-devel] Nvidia card - fb.modes anyone?
Message-ID: <20051121202937.54305.qmail@web53209.mail.yahoo.com>

 As it is my first post to this list, I just wanted to say thanx to all who contribute to this fine piece of software, so thanx!

on to my question.

I recently started using softdevice with directfb. I was succesfull in setting up a 1280x720 resolution on my old system with a PCI version of ATI 9200SE using radeonfb driver connected to my 50"DLP using a DVI. However, after upgrading to a new system, with a Nvidia GforceFX 5200, the same mode does not work anymore. As a matter of fact, no modes are displayed correctly using the nvidiafb driver. I thought that the correct mode matter to a TV set and not the card, so shouldn't the same mode work on both cards?

Does anyone have a working setup using the nvididafb driver? If so, can you post your working fb,modes? I'm especially interested in the 1280x720 mode, but for now any working modes would be nic.

Note: Yes, I am aware of the conflict between nvidia drivers and directfb drivers so i'm running the system in console mode.

Any help greatly appriciated.
Thanx.
 

		
---------------------------------
 Yahoo! FareChase - Search multiple travel sites in one click.  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051121/2bdc5a57/attachment.html>

From stefan at lucke.in-berlin.de  Mon Nov 21 23:45:08 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Mon, 21 Nov 2005 23:45:08 +0100
Subject: [Softdevice-devel] Nvidia card - fb.modes anyone?
In-Reply-To: <20051121202937.54305.qmail@web53209.mail.yahoo.com>
References: <20051121202937.54305.qmail@web53209.mail.yahoo.com>
Message-ID: <200511212345.08709.stefan@lucke.in-berlin.de>

On Montag, 21. November 2005 21:29, Zdzislaw Gorlicki wrote:
>  As it is my first post to this list, I just wanted to say thanx to all who contribute to this fine piece of software, so thanx!
> 
> on to my question.
> 
> I recently started using softdevice with directfb. I was succesfull in setting up a 1280x720 resolution on my old system with a PCI version of ATI 9200SE using radeonfb driver connected to my 50"DLP using a DVI. However, after upgrading to a new system, with a Nvidia GforceFX 5200, the same mode does not work anymore. As a matter of fact, no modes are displayed correctly using the nvidiafb driver. I thought that the correct mode matter to a TV set and not the card, so shouldn't the same mode work on both cards?
> 
> Does anyone have a working setup using the nvididafb driver? If so, can you post your working fb,modes? I'm especially interested in the 1280x720 mode, but for now any working modes would be nic.
> 
> Note: Yes, I am aware of the conflict between nvidia drivers and directfb drivers so i'm running the system in console mode.

So you are trying with "-vo fb:" ?

Plain framebuffer mode is not well supported.
Only 16/15 bit modes work. 
Some month's ago I tried nvidia with someone from vdr-portal and
vidix-out "-vo vidix:"  drivers, but we were not succesful. I don't know
if that changed in between.

Only X11 with xv-out worked for him.

You should ask on directfb lists for state of nvidia drivers.

-- 
Stefan Lucke



From M.Wache at gmx.net  Tue Nov 22 18:11:26 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Tue, 22 Nov 2005 18:11:26 +0100
Subject: [Softdevice-devel] Speeding up softdevice?
In-Reply-To: <FB3B5DB3197CEA429E5FB8E83D01D039D13F@sbs2003.do-net.de>
References: <FB3B5DB3197CEA429E5FB8E83D01D039D13F@sbs2003.do-net.de>
Message-ID: <4383513E.4070309@gmx.net>

Andre Neumann schrieb:
> Hi,
>  
> yesterday i've done some performance tests with softdevice and mplayer.
> I played some HD mpeg files (1080i) and noticed, that with softdevice
> (softplay) i get much slower playback. 
>  
> CPU is about 90%, but the playback is not smooth. When using mplayer
> with -vo directfb the playback is excellent, no skipped frames,
> everything ok.
>  
> Are there any options to speed up the decoding done by
> softdevice/ffmpeg, because mplayer uses ffmpeg, too i think.
>  
> My setup is: Matrox G550 with DirectFB, P4 2,8GHz, 512MB.
>  
In DirectFB fast_memcpy is not used, this could make a difference
especially for high resolution videos.

You could try the comparison again with Xv or try to replace the memcpy
in DirectFB with fast_memcpy.

Bye,
Martin


From M.Wache at gmx.net  Tue Nov 22 18:13:47 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Tue, 22 Nov 2005 18:13:47 +0100
Subject: [Softdevice-devel] Softplay does deinterlacing with 720p clips,
 too
In-Reply-To: <FB3B5DB3197CEA429E5FB8E83D01D039056BB5@sbs2003.do-net.de>
References: <FB3B5DB3197CEA429E5FB8E83D01D039056BB5@sbs2003.do-net.de>
Message-ID: <438351CB.20502@gmx.net>

Andre Neumann schrieb:
> Works fine here. Should be added to CVS.
> 

Unfortunatly my experiences are not so good. There seem to be some
stations on which the auto detection doesn't work, and they are not
deinterlaced any more. So I don't want to make it the default. Maybe we
can add a switch for interlace autodetection?

Martin

> -------------
> Andre Neumann
> 
> 
>>-----Original Message-----
>>From: softdevice-devel-admin at berlios.de 
>>[mailto:softdevice-devel-admin at berlios.de] On Behalf Of Martin Wache
>>Sent: Monday, November 14, 2005 10:46 PM
>>To: softdevice-devel at berlios.de
>>Subject: Re: [Softdevice-devel] Softplay does deinterlacing 
>>with 720p clips, too
>>
>>Martin Wache schrieb:
>>
>>>Andre Neumann schrieb:
>>>
>>>
>>>>Hi,
>>>>
>>>>When using softplay to display 720p hdtv trailers (eg. 
>>
>>divx,mpeg2) it
>>
>>>>uses the deinterlacing method which i specified in the
>>>>softdevice setup. That is not right, i think. When playing 
>>
>>progressive
>>
>>>>material, the deinterlacer must be switched off.
>>>>
>>>>I'm doing this manualy now, since the deinterlacer uses too much
>>>>cpu-power. It would be nice, if softplay detects a progressive
>>>>video and deativate the deinterlacer.
>>>>
>>>
>>>
>>>I would like to implement that, but I don't know how to detect
>>>progressive or interlaced videos :-(
>>>I just tried to use interlaced_frame which should report interlaced
>>>frames but it is alway zero. I also remember that a ffmpeg developer
>>>once said that the detection of interlaced video and field order is
>>>broken in ffmpeg.
>>>
>>>If there is a simple and reliable way to detect progressive 
>>
>>videos it is
>>
>>>no problem to disable the deinterlacer, but sorry I don't 
>>
>>know how to
>>
>>>detect it...
>>>
>>
>>Correction - interlaced_frame seems to work. Don't know what 
>>I did wrong
>>just a few moments ago...
>>Please try the attached patch against softdevice cvs if it 
>>works for you.
>>
>>Martin
>>
>>
> 
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 



From zdzisekg at yahoo.com  Tue Nov 22 18:16:59 2005
From: zdzisekg at yahoo.com (Zdzislaw Gorlicki)
Date: Tue, 22 Nov 2005 09:16:59 -0800 (PST)
Subject: [Softdevice-devel] Nvidia card - fb.modes anyone?
In-Reply-To: <200511212345.08709.stefan@lucke.in-berlin.de>
Message-ID: <20051122171659.63036.qmail@web53213.mail.yahoo.com>

thanx for the reply.

I'm running with "-vo dfb:"

I've read directfb mailing list archives for days, but suprisingly it looks like very few people use nvidia cards with the eccalerated framebuffer. few messages show up when searching for nvidia or nvidiafb

Stefan Lucke <stefan at lucke.in-berlin.de> wrote: On Montag, 21. November 2005 21:29, Zdzislaw Gorlicki wrote:
>  As it is my first post to this list, I just wanted to say thanx to all who contribute to this fine piece of software, so thanx!
> 
> on to my question.
> 
> I recently started using softdevice with directfb. I was succesfull in setting up a 1280x720 resolution on my old system with a PCI version of ATI 9200SE using radeonfb driver connected to my 50"DLP using a DVI. However, after upgrading to a new system, with a Nvidia GforceFX 5200, the same mode does not work anymore. As a matter of fact, no modes are displayed correctly using the nvidiafb driver. I thought that the correct mode matter to a TV set and not the card, so shouldn't the same mode work on both cards?
> 
> Does anyone have a working setup using the nvididafb driver? If so, can you post your working fb,modes? I'm especially interested in the 1280x720 mode, but for now any working modes would be nic.
> 
> Note: Yes, I am aware of the conflict between nvidia drivers and directfb drivers so i'm running the system in console mode.

So you are trying with "-vo fb:" ?

Plain framebuffer mode is not well supported.
Only 16/15 bit modes work. 
Some month's ago I tried nvidia with someone from vdr-portal and
vidix-out "-vo vidix:"  drivers, but we were not succesful. I don't know
if that changed in between.

Only X11 with xv-out worked for him.

You should ask on directfb lists for state of nvidia drivers.

-- 
Stefan Lucke

_______________________________________________
Softdevice-devel mailing list
Softdevice-devel at lists.berlios.de
http://lists.berlios.de/mailman/listinfo/softdevice-devel



		
---------------------------------
 Yahoo! FareChase - Search multiple travel sites in one click.  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051122/d1e1e591/attachment.html>

From marko.makela at hut.fi  Tue Nov 22 22:08:35 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Tue, 22 Nov 2005 23:08:35 +0200
Subject: [Softdevice-devel] Softplay does deinterlacing with 720p clips, too
In-Reply-To: <438351CB.20502@gmx.net>
References: <FB3B5DB3197CEA429E5FB8E83D01D039056BB5@sbs2003.do-net.de> <438351CB.20502@gmx.net>
Message-ID: <20051122210835.GD3400@localhost.localdomain>

On Tue, Nov 22, 2005 at 06:13:47PM +0100, Martin Wache wrote:
> Maybe we can add a switch for interlace autodetection?

Maybe a tri-state option "deinterlace" (off, on, auto).  The current
deinterlace option could be renamed to "deinterlacing method" (if it is
not already called so).

	Marko


From laz at club-burniston.co.uk  Sat Nov 26 13:26:13 2005
From: laz at club-burniston.co.uk (Laz)
Date: Sat, 26 Nov 2005 12:26:13 +0000
Subject: [Softdevice-devel] "Out of video memory" error with Matrox G450...
Message-ID: <200511261226.14093.laz@club-burniston.co.uk>

After a few weeks of doing other stuff, I've started trying to set up a 
further vdr system with a Matrox G450 and softdevice using DirectFB.

I have got df_xine to output a perfect picture to my TV using a home-made 
RGB-SCART cable on the second head, so I know that the DirectFB part is 
working.

However, when I run vdr with softdevice (cvs from today), I get the following 
output:

LD_ASSUME_KERNEL=2.4.1 vdr-1.3.36 --video=/video --config=/home/vdr/vdrconf 
--lib=/home/vdr/plugins -Pstreamdev-client -P'softdevice -vo dfb:mgatv'
[softdevice] processing args
[softdevice]   argv [0] = softdevice
[softdevice]   argv [1] = -vo
vo_argv: dfb:mgatv
[setup-softdevice] pixel format set to (YUY2)
[softdevice] initializing Plugin
[softdevice] Initializing Video Out
[softdevice] ffmpeg version(CVS) build(3277056)
[dfb] init
(*) DirectFB/Config: Parsing config file '/etc/directfbrc'.

       ---------------------- DirectFB v0.9.25 ---------------------
             (c) 2000-2002  convergence integrated media GmbH
             (c) 2002-2004  convergence GmbH
        -----------------------------------------------------------

(*) DirectFB/Core: Single Application Core. (2005-11-26 09:55)
(*) Direct/Memcpy: Using MMXEXT optimized memcpy()
(*) Direct/Modules: suppress module 'joystick'
(*) Direct/Modules: suppress module 'keyboard'
(*) Direct/Modules: suppress module 'lirc'
(*) DirectFB/Genefx: MMX detected and enabled
(*) DirectFB/Graphics: Matrox G450 0.7 (directfb.org)
(*) DirectFB/Core/WM: Default 0.2 (Convergence GmbH)
 (!!!)  *** UNIMPLEMENTED [fusion_reactor_set_lock] *** [reactor.c:837]
[dfb] RAM: 8384512 bytes
[dfb] Accellerated Functions: FillRectange DrawRectange DrawLine FillTriangle 
Blit StretchBlit All
[dfb] Drawing Flags: Blend
[dfb] Surface Blitting Flags: BlendAlpha BlendColorAlpha Colorize SrcColorkey 
Deinterlace
[dfb] Supported video Modes are: 720x576 at 32 720x576 at 16 768x576 at 32 640x480 at 8
[dfb] Enumerating display Layers
Layer 2 FBDev Primary Layer  Type: graphics
  Caps: brightness contrast saturation surface
Layer 1 Matrox Backend Scaler  Type: graphics picture video
  Caps: brightness contrast deinterlacing dst_colorkey screen_location surface
Layer 0 Matrox CRTC2 Layer  Type: graphics picture video
  Caps: brightness contrast hue field_parity saturation surface
[dfb] Set DLBM_TRIPLE for layer [Matrox CRTC2 Layer]
[dfb] DLOP_FIELD_PARITY supported by layer [Matrox CRTC2 Layer]
[surface capabilities] scrSurface: videoonly flipping interlaced 
triple-buffered
[dfb] width = 720, height = 576
[dfb] got fmt = 0x00418c04 bpp = 32
[dfb] init EXITING:action=IDirectFB::CreateSurface(DFBSurfaceDescription&), 
result=Out of video memory!
 (!!!)  *** WARNING [Application exited without deinitialization of DirectFB!] 
*** [core.c:727 in dfb_core_deinit_check()]

(I'm using the stream-dev client because there is no DVB device in this 
machine at present.)

I'm a bit concerned by the "[dfb] RAM: 8384512 bytes" line! I'm sure the thing 
has either 16 or 32 MB on it. Can I really have not enough memory for 
softdevice? Should I try softdevice with double-buffering rather than 
triple-buffering? Or is my problem something else?

/etc/directfbrc contains:

no-debug
matrox-crtc2
matrox-tv-standard=pal
primary-layer=2
mode=720x576
depth=32

matrox-cable-type=scart-rgb
disable-module=lirc
disable-module=joystick
disable-module=keyboard
no-vt

Cheers,

Laz


From juniper81 at gmail.com  Sat Nov 26 14:07:35 2005
From: juniper81 at gmail.com (Ari Koponen)
Date: Sat, 26 Nov 2005 15:07:35 +0200
Subject: [Softdevice-devel] "Out of video memory" error with Matrox G450...
In-Reply-To: <200511261226.14093.laz@club-burniston.co.uk>
References: <200511261226.14093.laz@club-burniston.co.uk>
Message-ID: <b7bb36410511260507j4dcf31b0sd43ab734b1c49da9@mail.gmail.com>

> I'm a bit concerned by the "[dfb] RAM: 8384512 bytes" line! I'm sure the thing
> has either 16 or 32 MB on it. Can I really have not enough memory for
> softdevice? Should I try softdevice with double-buffering rather than
> triple-buffering? Or is my problem something else?
>

Have you patched your kernel with the Matrox full memory patch that
comes with DirectFB? That might help if you haven't.


From laz at club-burniston.co.uk  Sat Nov 26 16:31:56 2005
From: laz at club-burniston.co.uk (Laz)
Date: Sat, 26 Nov 2005 15:31:56 +0000
Subject: [Softdevice-devel] "Out of video memory" error with Matrox G450...
In-Reply-To: <b7bb36410511260507j4dcf31b0sd43ab734b1c49da9@mail.gmail.com>
References: <200511261226.14093.laz@club-burniston.co.uk> <b7bb36410511260507j4dcf31b0sd43ab734b1c49da9@mail.gmail.com>
Message-ID: <200511261531.57107.laz@club-burniston.co.uk>

On Saturday 26 November 2005 13:07, Ari Koponen wrote:
> > I'm a bit concerned by the "[dfb] RAM: 8384512 bytes" line! I'm sure the
> > thing has either 16 or 32 MB on it. Can I really have not enough memory
> > for softdevice? Should I try softdevice with double-buffering rather than
> > triple-buffering? Or is my problem something else?
>
> Have you patched your kernel with the Matrox full memory patch that
> comes with DirectFB? That might help if you haven't.

DOH! Yes, I managed to miss that patch.

Works fine now!

:-)

Apart form some nasty interlacing effects.

:-s

Not fiddled with any settings yet, mind.

Cheers,

Laz


From zdzisekg at yahoo.com  Mon Dec  5 18:40:48 2005
From: zdzisekg at yahoo.com (Zdzislaw Gorlicki)
Date: Mon, 5 Dec 2005 09:40:48 -0800 (PST)
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio problem
Message-ID: <20051205174049.59483.qmail@web53208.mail.yahoo.com>

Hello,

My Config:
Athlon64 3700+
1GB RAM
Nexus-s 2.2 (drivers load with budget patch)
ATI Radeon 9200SE 128MB (standard PCI)
vdr-1.3.36
softdevice-0.2.2.1
output via DVI @ 1280x720
using radeonfb driver
CPU utilization 50% for 720p, 80%~90% for 1080i

I've been unsuccesfully trying to get a smooth
playback of HD content with softdevice using directfb.
Video seems to be dropping a lot of frames and out of
sync with audio. In addition video and audio freezes
for a split secend, every few seconds. So far I've
been able to determine this:

When I play HD contant, in vdr log I start to see
message "allocating picture buffer for resolution
1280x720" then asterisk (*) start going up. as soon as
I start seeing *, audio gets choppy. when * gets to
the end, video & audio freezes for a split second,
then the process starts again with "allocating picture
buffer for resolution 1280x720". audio is good for 2
or 3 sec, then I start seeing the * again, and audio
gets choppy. at the same time it looks like video is
skipping a lot of frames, and it gets worse when I
start seeing * in the log. I assume the * shows the
buffer status.

Monitoring syslog output, I see notices that the
buffer is 70%, 80%, 90% full, at that point the buffer
gets cleared, audio & video freezes for a sec. I also
get alot of [softdevice-audio] xrun errors. so I tried
-ao dummy: but it made no difference.

can someone please help. I've been trying to resolve
this for over a week now with no success. I'me not
sure where to look for the problem anymore.




		
__________________________________ 
Start your day with Yahoo! - Make it your home page! 
http://www.yahoo.com/r/hs


From Neumann at do-net.de  Tue Dec  6 11:13:45 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Tue, 6 Dec 2005 11:13:45 +0100
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio problem
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D0390B06DD@sbs2003.do-net.de>

Hi,

i noticed performance problems with my setup, too. I'm using DirectFB,
too.
Can you please test mplayer playback with one of your HD files ?
(mplayer -vo directfb file.mpg)

Does it play smooth ?

-------------
Andre Neumann
 

> -----Original Message-----
> From: softdevice-devel-admin at berlios.de 
> [mailto:softdevice-devel-admin at berlios.de] On Behalf Of 
> Zdzislaw Gorlicki
> Sent: Monday, December 05, 2005 6:41 PM
> To: softdevice-devel at berlios.de
> Subject: [Softdevice-devel] softdevice & HDTV 
> choppy/out-of-sync video/audio problem
> 
> Hello,
> 
> My Config:
> Athlon64 3700+
> 1GB RAM
> Nexus-s 2.2 (drivers load with budget patch)
> ATI Radeon 9200SE 128MB (standard PCI)
> vdr-1.3.36
> softdevice-0.2.2.1
> output via DVI @ 1280x720
> using radeonfb driver
> CPU utilization 50% for 720p, 80%~90% for 1080i
> 
> I've been unsuccesfully trying to get a smooth
> playback of HD content with softdevice using directfb.
> Video seems to be dropping a lot of frames and out of
> sync with audio. In addition video and audio freezes
> for a split secend, every few seconds. So far I've
> been able to determine this:
> 
> When I play HD contant, in vdr log I start to see
> message "allocating picture buffer for resolution
> 1280x720" then asterisk (*) start going up. as soon as
> I start seeing *, audio gets choppy. when * gets to
> the end, video & audio freezes for a split second,
> then the process starts again with "allocating picture
> buffer for resolution 1280x720". audio is good for 2
> or 3 sec, then I start seeing the * again, and audio
> gets choppy. at the same time it looks like video is
> skipping a lot of frames, and it gets worse when I
> start seeing * in the log. I assume the * shows the
> buffer status.
> 
> Monitoring syslog output, I see notices that the
> buffer is 70%, 80%, 90% full, at that point the buffer
> gets cleared, audio & video freezes for a sec. I also
> get alot of [softdevice-audio] xrun errors. so I tried
> -ao dummy: but it made no difference.
> 
> can someone please help. I've been trying to resolve
> this for over a week now with no success. I'me not
> sure where to look for the problem anymore.
> 
> 
> 
> 
> 		
> __________________________________ 
> Start your day with Yahoo! - Make it your home page! 
> http://www.yahoo.com/r/hs
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 
> 



From M.Wache at gmx.net  Wed Dec  7 17:41:50 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Wed, 07 Dec 2005 17:41:50 +0100
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio
 problem
In-Reply-To: <20051205174049.59483.qmail@web53208.mail.yahoo.com>
References: <20051205174049.59483.qmail@web53208.mail.yahoo.com>
Message-ID: <439710CE.6030009@gmx.net>

Zdzislaw Gorlicki schrieb:
> Hello,
> 
> My Config:
> Athlon64 3700+
> 1GB RAM
> Nexus-s 2.2 (drivers load with budget patch)
> ATI Radeon 9200SE 128MB (standard PCI)
> vdr-1.3.36
> softdevice-0.2.2.1
> output via DVI @ 1280x720
> using radeonfb driver
> CPU utilization 50% for 720p, 80%~90% for 1080i
> 
> I've been unsuccesfully trying to get a smooth
> playback of HD content with softdevice using directfb.
> Video seems to be dropping a lot of frames and out of
> sync with audio. In addition video and audio freezes
> for a split secend, every few seconds. So far I've
> been able to determine this:
> 
> When I play HD contant, in vdr log I start to see
> message "allocating picture buffer for resolution
> 1280x720" then asterisk (*) start going up. as soon as
> I start seeing *, audio gets choppy. when * gets to
> the end, video & audio freezes for a split second,
> then the process starts again with "allocating picture
> buffer for resolution 1280x720". audio is good for 2
> or 3 sec, then I start seeing the * again, and audio
> gets choppy. at the same time it looks like video is
> skipping a lot of frames, and it gets worse when I
> start seeing * in the log. I assume the * shows the
> buffer status.
> 
> Monitoring syslog output, I see notices that the
> buffer is 70%, 80%, 90% full, at that point the buffer
> gets cleared, audio & video freezes for a sec. I also
> get alot of [softdevice-audio] xrun errors. so I tried
> -ao dummy: but it made no difference.
> 
> can someone please help. I've been trying to resolve
> this for over a week now with no success. I'me not
> sure where to look for the problem anymore.
> 

Did you switch the buffer size to HDTV? You can do that in the
setup-menu of the softdevice. After changeing the buffer size you will
have to switch the channel to let the change take effect.

Bye,
Martin



From zdzisekg at yahoo.com  Wed Dec  7 18:10:48 2005
From: zdzisekg at yahoo.com (Zdzislaw Gorlicki)
Date: Wed, 7 Dec 2005 09:10:48 -0800 (PST)
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio problem
In-Reply-To: <439710CE.6030009@gmx.net>
Message-ID: <20051207171048.49567.qmail@web53201.mail.yahoo.com>


--- Martin Wache <M.Wache at gmx.net> wrote:

> Did you switch the buffer size to HDTV? You can do
> that in the
> setup-menu of the softdevice. After changeing the
> buffer size you will
> have to switch the channel to let the change take
> effect.
> 
> Bye,
> Martin

yes, of course.



		
__________________________________________ 
Yahoo! DSL ? Something to write home about. 
Just $16.99/mo. or less. 
dsl.yahoo.com 



From M.Wache at gmx.net  Wed Dec  7 20:16:06 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Wed, 7 Dec 2005 20:16:06 +0100 (MET)
Subject: [Softdevice-devel] =?ISO-8859-1?Q?Re:_[Softdevice-devel]_softdevice_&_HDTV_choppy/out-of-syn?=
 =?ISO-8859-1?Q?c_video/audio_problem?=
References: <20051207171048.49567.qmail@web53201.mail.yahoo.com>
Message-ID: <6395.1133982966@www69.gmx.net>

> > Did you switch the buffer size to HDTV? You can do
> > that in the
> > setup-menu of the softdevice. After changeing the
> > buffer size you will
> > have to switch the channel to let the change take
> > effect.
> > 
> > Bye,
> > Martin
> 
> yes, of course.
> 

Hmm, the symptons sound like a too small demuxing buffer, I would have
betted that you forgot to switch the buffer size ;-).
If you want you can try to increase the buffer size further, in the file
mpeg2decoder, around line 40:

int dvb_buf_size[] = {64*1024,32*1024,64*1024};
int packet_buf_size[] = {300,150,2000};

The first ist the default, the second the one for the good seeking and
the last one is HDTV. The packet_buf_size should be the relevant size,
but you can play around also with dvb_buf_size.
Please tell me when you find a working buffersize. I'm not sure what
else could cause that... It really sounds like the buffer. Normal streams
play fine? What about recorded HDTV/normal streams?

Bye,
Martin

-- 
10 GB Mailbox, 100 FreeSMS/Monat http://www.gmx.net/de/go/topmail
+++ GMX - die erste Adresse f?r Mail, Message, More +++


From zdzisekg at yahoo.com  Wed Dec  7 21:24:50 2005
From: zdzisekg at yahoo.com (Zdzislaw Gorlicki)
Date: Wed, 7 Dec 2005 12:24:50 -0800 (PST)
Subject: [Softdevice-devel] Re: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio problem
In-Reply-To: <6395.1133982966@www69.gmx.net>
Message-ID: <20051207202450.73023.qmail@web53210.mail.yahoo.com>

thanx for the reply,

actually, I already tried that few days ago. I wasn't
sure what else is involved with the buffer so I
reverted the changes. I've had -- int
packet_buf_size[] = {300,150,10000};--. All it did, is
delayed the time that it took before the buffer
started getting filled (astrisk going up). So the
audio was smooth longer, but video was still dropping
the frames, and eventually, audio would get choppy.
video and audio would still be out of sync. so
basically the same behavior, it would just take longer
to repeat.

By now, I'm thinking it's something with the nexus
card. I was experiencing similiar problems with MythTV
when I was testing PBS HD on AMC3.

SD channels are fine regardless of what I set the
buffer to, save, good seeking or HD. i'm not seeing
anything in the log about buffers. audio and video are
just slightly out of sync, but that can be adjusted in
the plugins menu.

Is there anything else that needs to be done to
disable the onboard MPEG decoder of the nexus card?

what is the maximum value for the buffer? are there
negitive aspects if you set it too large?

By now, I'm so frustrated, that I decided to get a
budget card. I'll report the results, but I'd still
like to get the nexus going as I really like that card
and perhaps would help few people in the future.

Again, thanx for all your help.

--- Martin Wache <M.Wache at gmx.net> wrote:

> 
> > > Did you switch the buffer size to HDTV? You can
> do
> > > that in the
> > > setup-menu of the softdevice. After changeing
> the
> > > buffer size you will
> > > have to switch the channel to let the change
> take
> > > effect.
> > > 
> > > Bye,
> > > Martin
> > 
> > yes, of course.
> > 
> 
> Hmm, the symptons sound like a too small demuxing
> buffer, I would have
> betted that you forgot to switch the buffer size
> ;-).
> If you want you can try to increase the buffer size
> further, in the file
> mpeg2decoder, around line 40:
> 
> int dvb_buf_size[] = {64*1024,32*1024,64*1024};
> int packet_buf_size[] = {300,150,2000};
> 
> The first ist the default, the second the one for
> the good seeking and
> the last one is HDTV. The packet_buf_size should be
> the relevant size,
> but you can play around also with dvb_buf_size.
> Please tell me when you find a working buffersize.
> I'm not sure what
> else could cause that... It really sounds like the
> buffer. Normal streams
> play fine? What about recorded HDTV/normal streams?
> 
> Bye,
> Martin
> 
> -- 
> 10 GB Mailbox, 100 FreeSMS/Monat
> http://www.gmx.net/de/go/topmail
> +++ GMX - die erste Adresse f?r Mail, Message, More
> +++
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
>
http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 


__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 


From zdzisekg at yahoo.com  Wed Dec  7 21:30:14 2005
From: zdzisekg at yahoo.com (Zdzislaw Gorlicki)
Date: Wed, 7 Dec 2005 12:30:14 -0800 (PST)
Subject: [Softdevice-devel] Re: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio problem
In-Reply-To: <6395.1133982966@www69.gmx.net>
Message-ID: <20051207203014.653.qmail@web53213.mail.yahoo.com>

--- Martin Wache <M.Wache at gmx.net> wrote:
Normal streams
> play fine? What about recorded HDTV/normal streams?
> 
> Bye,
> Martin

oops, I forgot. Anything SD plays fine, recorded or
live. HD has the same problem on both, live and
recorded content, however the only recorded HD content
I have is what I recorded.


		
__________________________________________ 
Yahoo! DSL ? Something to write home about. 
Just $16.99/mo. or less. 
dsl.yahoo.com 



From Neumann at do-net.de  Wed Dec  7 22:00:40 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Wed, 7 Dec 2005 22:00:40 +0100
Subject: AW: [Softdevice-devel] Speeding up softdevice?
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039D140@sbs2003.do-net.de>

I've replaced all memcpy calls to fast_memcpy in video-dfb.c and mpeg2decoder.c and now
its a lot better. Still not perfect, but better.

Are there any other things i could do to speed up decoding ?

-------------
Andre Neumann 

-----Urspr?ngliche Nachricht-----
Von: softdevice-devel-admin at berlios.de [mailto:softdevice-devel-admin at berlios.de] Im Auftrag von Martin Wache
Gesendet: Dienstag, 22. November 2005 18:11
An: softdevice-devel at berlios.de
Betreff: Re: [Softdevice-devel] Speeding up softdevice?

Andre Neumann schrieb:
> Hi,
>  
> yesterday i've done some performance tests with softdevice and mplayer.
> I played some HD mpeg files (1080i) and noticed, that with softdevice
> (softplay) i get much slower playback. 
>  
> CPU is about 90%, but the playback is not smooth. When using mplayer 
> with -vo directfb the playback is excellent, no skipped frames, 
> everything ok.
>  
> Are there any options to speed up the decoding done by 
> softdevice/ffmpeg, because mplayer uses ffmpeg, too i think.
>  
> My setup is: Matrox G550 with DirectFB, P4 2,8GHz, 512MB.
>  
In DirectFB fast_memcpy is not used, this could make a difference especially for high resolution videos.

You could try the comparison again with Xv or try to replace the memcpy in DirectFB with fast_memcpy.

Bye,
Martin
_______________________________________________
Softdevice-devel mailing list
Softdevice-devel at lists.berlios.de
http://lists.berlios.de/mailman/listinfo/softdevice-devel






From M.Wache at gmx.net  Wed Dec  7 23:52:18 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Wed, 7 Dec 2005 23:52:18 +0100 (MET)
Subject: AW: [Softdevice-devel] Speeding up softdevice?
References: <FB3B5DB3197CEA429E5FB8E83D01D039D140@sbs2003.do-net.de>
Message-ID: <5940.1133995938@www68.gmx.net>

> --- Urspr?ngliche Nachricht ---
> Von: "Andre Neumann" <Neumann at do-net.de>
> An: <softdevice-devel at berlios.de>
> Betreff: AW: [Softdevice-devel] Speeding up softdevice?
> Datum: Wed, 7 Dec 2005 22:00:40 +0100
> 
> I've replaced all memcpy calls to fast_memcpy in video-dfb.c and
> mpeg2decoder.c and now
> its a lot better. Still not perfect, but better.
> 
> Are there any other things i could do to speed up decoding ?
> 
One could try to convince ffmpeg to decode the video directly into 
the buffer the softdevice uses to display the video, that would save us
the time we spend copying. I'm not really sure if this would work for
DirectFB, but for Xv out should improve the situation. Unfortunatly doing
this is not that simple. But it is on the list of things that I wanted to
try once I have the time...

By the way, I'm not sure if I explained that correctly, but fast_memcpy is 
not always faster than memcpy. Only when a large amount of data has to
be transfered which don't fit into the cache fast_memcpy is faster.
So it is not the best to change all memcpy calls to fast_memcpy, I think
only the ones in the YUV() method should be replaced.

Bye,
Martin

-- 
10 GB Mailbox, 100 FreeSMS/Monat http://www.gmx.net/de/go/topmail
+++ GMX - die erste Adresse f?r Mail, Message, More +++


From M.Wache at gmx.net  Thu Dec  8 00:01:28 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Thu, 8 Dec 2005 00:01:28 +0100 (MET)
Subject: [Softdevice-devel] =?ISO-8859-1?Q?Re:_[Softdevice-devel]_Re:_[Softdevice-devel]_softdevice_&?=
 =?ISO-8859-1?Q?_HDTV_choppy/out-of-sync_video/audio_problem?=
References: <20051207202450.73023.qmail@web53210.mail.yahoo.com>
Message-ID: <15245.1133996488@www68.gmx.net>

> --- Urspr?ngliche Nachricht ---
> Von: Zdzislaw Gorlicki <zdzisekg at yahoo.com>

> By now, I'm thinking it's something with the nexus
> card. I was experiencing similiar problems with MythTV
> when I was testing PBS HD on AMC3.
> 
You could try to play a stream with mplayer or xine.
If they play the stream without problems it should not be a problem
of the card. But wait, doesn't MythTV use xine to display sreams? So
you maybe you tried that already

> Is there anything else that needs to be done to
> disable the onboard MPEG decoder of the nexus card?
>
Sorry, I don't know anything about that :-( 
 
> what is the maximum value for the buffer? are there
> negitive aspects if you set it too large?
> 
The seeking will be totally crazy. If you select fast forward/backward
and then normal play again the video will continue at a totaly different
point. Apart from that there should be no other problems :-)

Martin

-- 
Telefonieren Sie schon oder sparen Sie noch?
NEU: GMX Phone_Flat http://www.gmx.net/de/go/telefonie


From marko.makela at hut.fi  Thu Dec  8 18:03:48 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Thu, 8 Dec 2005 19:03:48 +0200
Subject: [Softdevice-devel] Trouble and crash with vdr-dvd plugin on DirectFB
Message-ID: <20051208170348.GA28319@localhost.localdomain>

Hi all!

vdr and softdevice have worked very well for me since I last posted here...
until my wife asked me about the possibility to play back DVDs.  First,
the Plextor PX-712A would fail to recognize any DVD media.  I got the
warranty replacement drive today.  I was able to play some of one DVD movie,
but I have trouble with the navigation.  Sometimes, also the drive would
hang, and I would have to eject and reinsert the disk or even reset the
whole computer to recover from the situation.  I didn't see any relevant
log messages in the normal case (after selecting a track, the screen remains
black, the CPU is idle, and most keys except Stop are ignored).

Often, there is several seconds of delay between pressing a key on the remote
control and any effect on the screen.  The menu cursor is drawn at a
slightly wrong place, and sometimes it is not drawn at all, but the
arrow keys and the OK key work nevertheless.

I even got one crash, in softdevice-dfb:

#0  0xb77cf287 in dfb_layer_context_test_configuration ()
   from /usr/local/lib/libdirectfb-0.9.so.23
No symbol table info available.
#1  0xb77a84ef in IDirectFBDisplayLayer_TestConfiguration ()
   from /usr/local/lib/libdirectfb-0.9.so.23
No symbol table info available.
#2  0xb77ebaf7 in IDirectFBDisplayLayer::TestConfiguration ()
   from /usr/local/lib/libdfb++-0.9.so.23
No symbol table info available.
#3  0xb7939ace in cDFBVideoOut::SetParams (this=0x82858f8) at video-dfb.c:847
	dlc = {flags = 95, width = 736, height = 576, pixelformat = DSPF_I420, 
  buffermode = DLBM_BACKVIDEO, options = DLOP_DST_COLORKEY, 
  source = 3052512116, surface_caps = DSCAPS_DOUBLE}
	desc = {type = 7, caps = 3146665, 
  name = "Matrox Backend Scaler\000\000\000\000\000\000\000\000\000\000", 
  level = 0, regions = 0, sources = 0}
	failed = DLCONF_NONE
#4  0xb793a785 in cDFBVideoOut::YUV (this=0x82858f8, Py=0xb56b2008 "", 
    Pu=0x8285d80 '\177' <repeats 200 times>..., 
    Pv=0x829fb90 '\177' <repeats 200 times>..., Width=736, Height=576, 
    Ystride=736, UVstride=368) at video-dfb.c:1222
	dst = <value optimized out>
	pitch = <value optimized out>
	hi = <value optimized out>
#5  0xb792a056 in cVideoOut::DrawStill_420pl (this=0x82858f8, 
    pY=0xb56b2008 "", pU=0x8285d80 '\177' <repeats 200 times>..., 
    pV=0x829fb90 '\177' <repeats 200 times>..., w=136863104, h=-1251270648, 
    yPitch=736, uvPitch=368) at video.c:451
No locals.
#6  0xb7929731 in cVideoOut::Action (this=0x82858f8) at video.c:113
	newOsdWidth = 736
	newOsdHeight = 576
	changeMode = false
#7  0x080f6772 in cThread::StartThread (Thread=0x82858f8) at thread.c:235
No locals.
#8  0xb7f36cfd in start_thread () from /lib/tls/libpthread.so.0
No symbol table info available.
#9  0xb7dbbf1e in recvfrom () from /lib/tls/libc.so.6
No symbol table info available.
  5 process 528  0x00000246 in ?? ()
  4 process 565  0x00000206 in ?? ()
  3 process 566  0x00000246 in ?? ()
  2 process 1644  0x00000202 in ?? ()
* 1 process 568  0xb77cf287 in dfb_layer_context_test_configuration ()
   from /usr/local/lib/libdirectfb-0.9.so.23

Is anyone actively using the dvd-plugin on softdevice?  I would prefer
the vdr box to be the only dvd player in our household.

	Marko


From juniper81 at gmail.com  Thu Dec  8 18:34:13 2005
From: juniper81 at gmail.com (Ari Koponen)
Date: Thu, 8 Dec 2005 19:34:13 +0200
Subject: [Softdevice-devel] Trouble and crash with vdr-dvd plugin on DirectFB
In-Reply-To: <20051208170348.GA28319@localhost.localdomain>
References: <20051208170348.GA28319@localhost.localdomain>
Message-ID: <b7bb36410512080934g7f941cfeo5c1ce6b163976abf@mail.gmail.com>

Hi Marko,

I'm also using softdevice with DirectFB output method.

> Often, there is several seconds of delay between pressing a key on the remote
> control and any effect on the screen.  The menu cursor is drawn at a
> slightly wrong place, and sometimes it is not drawn at all, but the
> arrow keys and the OK key work nevertheless.

I don't know if I'm using the dvd plugin actively but atleast that's
the only DVD player that I use. I haven't experienced any crashes but
some of your symptoms sound familiar. The user interface is not very
responsive to remote control buttons for me either. I use LIRC as
input method. Sometimes in the past the menus turned suddenly
completely black and I had to navigate blindly but I think that has
been fixed because I haven't experienced that lately. I remember also
one hangup situation when the drive wouldn't eject the disc out
without first booting the computer. Otherwise the combination has
worked pretty well.


From marko.makela at hut.fi  Thu Dec  8 23:24:14 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Fri, 9 Dec 2005 00:24:14 +0200
Subject: [Softdevice-devel] Trouble and crash with vdr-dvd plugin on DirectFB
In-Reply-To: <b7bb36410512080934g7f941cfeo5c1ce6b163976abf@mail.gmail.com>
References: <20051208170348.GA28319@localhost.localdomain> <b7bb36410512080934g7f941cfeo5c1ce6b163976abf@mail.gmail.com>
Message-ID: <20051208222414.GC3778@localhost.localdomain>

Hi Ari,

> > Often, there is several seconds of delay between pressing a key on the remote
> > control and any effect on the screen.  The menu cursor is drawn at a
> > slightly wrong place, and sometimes it is not drawn at all, but the
> > arrow keys and the OK key work nevertheless.
> 
> I don't know if I'm using the dvd plugin actively but atleast that's
> the only DVD player that I use. I haven't experienced any crashes but
> some of your symptoms sound familiar. The user interface is not very
> responsive to remote control buttons for me either.

A little update, after testing 80% of my DVD collection, consisting of
3 disks and two borrowed ones. :-)  The disks played fine on a different
computer on vlc using the wxvlc frontend packaged for Debian.

There's an annoying bug in fast-forward: it will sometimes stuck, especially
if a clip is fast-forwarded to the end (in which case the clip will usually
restart from the beginning).  I guess this is a bug in the dvd plugin itself.

In menus, the navigation cursor was never shown at the correct place,
no matter which crop mode or screen aspect ratio I selected.  In some
crop mode setting, the displacement was small - a couple of pixels near
the top or left of the screen, and maybe 20 pixels when the cursor
position was closer to the right or bottom of the picture.

In some menus, the cursor will not appear at all, or the position will
not be updated.

By the way, the crop mode setting will not take effect in menus until
you change menu screens.  I only investigated this on a disk that had
static menu background, so this might not apply to animated menus.

> I use LIRC as input method.

I'm using the linuxinput driver of DirectFB (version 0.9.23 if I remember
correctly) and the Linux 2.6.13.4 cx88 driver for the remote control unit
of the Hauppauge Nova-T PCI 90002.
as follows:
> I remember also one hangup situation when the drive wouldn't eject the
> disc out without first booting the computer.

The dvd plugin doesn't seem to handle read errors gracefully.  I got a
bad hang when playing one home-burned DVD at 9? speed until a read error
occurred.  The kernel kept spitting some read error messages, and vdr
could not be killed for a long time.  It might even have been that the
disk wouldn't eject until I pressed the reset button.

I also got hangs when trying to play the non-existent track 14
of "El?imellist? menoa" (Aardman Animations' Creature Comforts in Finnish
and Swedish "Livets N?dtorft" or something like that).  The payload tracks
are 1 through 13, and track 15 is the intro animation.  mplayer
dvd://14 reports the following:

MPEG-PS file format detected.
MPEG: No audio stream found -> no sound.
VIDEO:  MPEG2  720x576  (aspect 3)  25.000 fps  8000.0 kbps (1000.0 kbyte/s)
==========================================================================
Opening video decoder: [mpegpes] MPEG 1/2 Video passthrough
VDec: vo config request - 720 x 576 (preferred colorspace: Mpeg PES)
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Also try adding the scale filter, e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [libmpeg2] MPEG 1/2 Video decoder libmpeg2-v0.4.0b
Selected video codec: [mpeg12] vfm: libmpeg2 (MPEG-1 or 2 (libmpeg2))
==========================================================================
Audio: no sound
Starting playback...
VDec: vo config request - 720 x 576 (preferred colorspace: Planar YV12)
VDec: using Planar YV12 as output csp (no 0)
Movie-Aspect is 1.78:1 - prescaling to correct movie aspect.
VO: [xv] 720x576 => 1024x576 Planar YV12

The track is very short: the MPlayer window just flashes on the screen.

The title selection menu of this DVD is completely unusable on vdr-dvd.
The cursor is only shown on one position, even though different titles
can apparently be selected.  The menu works perfectly in wxvlc.

Would it help if I tested the dvd plugin on softdevice-xv?  I don't have
X11 on my vdr box, but I can install vdr and softdevice on another
(tuner-less) computer if needed.

Finally, one "bug" that I will have to fix: the vdr-dvd plugin ignores my
"suspend" flag: <http://www.iki.fi/~msmakela/software/vdr/#suspend>.
This is by design, because my patch stops the stream at the source,
either from the DVB tuner in cDevice::Action() or from the file system
in cDvbPlayer::Action().  A similar patch would have to be applied to
the read loop of the vdr-dvd plugin.

	Marko


From juniper81 at gmail.com  Fri Dec  9 08:14:28 2005
From: juniper81 at gmail.com (Ari Koponen)
Date: Fri, 9 Dec 2005 09:14:28 +0200
Subject: [Softdevice-devel] Trouble and crash with vdr-dvd plugin on DirectFB
In-Reply-To: <20051208222414.GC3778@localhost.localdomain>
References: <20051208170348.GA28319@localhost.localdomain>
	 <b7bb36410512080934g7f941cfeo5c1ce6b163976abf@mail.gmail.com>
	 <20051208222414.GC3778@localhost.localdomain>
Message-ID: <b7bb36410512082314j3a40f33aldb68d71a6e27e3b9@mail.gmail.com>

> There's an annoying bug in fast-forward: it will sometimes stuck, especially
> if a clip is fast-forwarded to the end (in which case the clip will usually
> restart from the beginning).  I guess this is a bug in the dvd plugin itself.
>

(clip)

> The dvd plugin doesn't seem to handle read errors gracefully.  I got a
> bad hang when playing one home-burned DVD at 9? speed until a read error
> occurred.  The kernel kept spitting some read error messages, and vdr
> could not be killed for a long time.  It might even have been that the
> disk wouldn't eject until I pressed the reset button.


As at least these seem to be related to the dvd plugin itself, could
you (or have you already) inform the dvd plugin author(s) of these
problems?

> Would it help if I tested the dvd plugin on softdevice-xv?

I can't either help on this because I think I can't use X with my
current setup: Matrox G450 -> TV output.  For monitor output it would
be possible but I have only one monitor and it's quite a job to fiddle
around with the wires and stuff.. Hopefully someone else can give more
insight on this.

- Ari


From zdzisekg at yahoo.com  Fri Dec  9 18:07:33 2005
From: zdzisekg at yahoo.com (Zdzislaw Gorlicki)
Date: Fri, 9 Dec 2005 09:07:33 -0800 (PST)
Subject: [Softdevice-devel] Re: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio problem
In-Reply-To: <6395.1133982966@www69.gmx.net>
Message-ID: <20051209170733.37467.qmail@web35411.mail.mud.yahoo.com>

So I played around with the buffers for last few days. I tried a lot of different possibilities, but with littlle or no success.

increasing dvb_buf_size[] seems to make no diference.

increasing packet_buf_size[] allows the audio to play smooth longer.

I might be wrong about the video frames dropping though. It seems like all the frames are there, it's just that it looks like the video is playing in slow motion so the video falls behind.

As the buffer get's filled, audio starts to sound choppy and it looks like as the buffer gets full, a new buffer is created at which time, the audio and video resyncs, so there is a freeze in audio and video and the process starts all over again.

Martin Wache <M.Wache at gmx.net> wrote: 
> > Did you switch the buffer size to HDTV? You can do
> > that in the
> > setup-menu of the softdevice. After changeing the
> > buffer size you will
> > have to switch the channel to let the change take
> > effect.
> > 
> > Bye,
> > Martin
> 
> yes, of course.
> 

Hmm, the symptons sound like a too small demuxing buffer, I would have
betted that you forgot to switch the buffer size ;-).
If you want you can try to increase the buffer size further, in the file
mpeg2decoder, around line 40:

int dvb_buf_size[] = {64*1024,32*1024,64*1024};
int packet_buf_size[] = {300,150,2000};

The first ist the default, the second the one for the good seeking and
the last one is HDTV. The packet_buf_size should be the relevant size,
but you can play around also with dvb_buf_size.
Please tell me when you find a working buffersize. I'm not sure what
else could cause that... It really sounds like the buffer. Normal streams
play fine? What about recorded HDTV/normal streams?

Bye,
Martin

-- 
10 GB Mailbox, 100 FreeSMS/Monat http://www.gmx.net/de/go/topmail
+++ GMX - die erste Adresse f?r Mail, Message, More +++
_______________________________________________
Softdevice-devel mailing list
Softdevice-devel at lists.berlios.de
http://lists.berlios.de/mailman/listinfo/softdevice-devel



			
---------------------------------
Yahoo! Shopping
 Find Great Deals on Holiday Gifts at Yahoo! Shopping 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051209/fbdd765c/attachment.html>

From M.Wache at gmx.net  Sat Dec 10 16:04:08 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Sat, 10 Dec 2005 16:04:08 +0100
Subject: [Softdevice-devel] Trouble and crash with vdr-dvd plugin on DirectFB
In-Reply-To: <20051208222414.GC3778@localhost.localdomain>
References: <20051208170348.GA28319@localhost.localdomain> <b7bb36410512080934g7f941cfeo5c1ce6b163976abf@mail.gmail.com> <20051208222414.GC3778@localhost.localdomain>
Message-ID: <439AEE68.3020704@gmx.net>

Marko M?kel? schrieb:

> In menus, the navigation cursor was never shown at the correct place,
> no matter which crop mode or screen aspect ratio I selected.  In some
> crop mode setting, the displacement was small - a couple of pixels near
> the top or left of the screen, and maybe 20 pixels when the cursor
> position was closer to the right or bottom of the picture.
> 
This is because the cursor is shown via the spu wich uses the osd, the
osd is not scaled so these layers don't match exactly.

> In some menus, the cursor will not appear at all, or the position will
> not be updated.

Hmm. Don't know why this happens. We use the same technique for
displaying like FF cards, so I would not have expected any softdevice
related problems. Of course except for the shift ;-)

> Would it help if I tested the dvd plugin on softdevice-xv?  I don't have
> X11 on my vdr box, but I can install vdr and softdevice on another
> (tuner-less) computer if needed.
>
I don't think that will make a difference.


Martin


From M.Wache at gmx.net  Sat Dec 10 16:14:17 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Sat, 10 Dec 2005 16:14:17 +0100
Subject: [Softdevice-devel] Re: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync
 video/audio problem
In-Reply-To: <20051209170733.37467.qmail@web35411.mail.mud.yahoo.com>
References: <20051209170733.37467.qmail@web35411.mail.mud.yahoo.com>
Message-ID: <439AF0C9.8050904@gmx.net>

Zdzislaw Gorlicki schrieb:
> So I played around with the buffers for last few days. I tried a lot of
> different possibilities, but with littlle or no success.
> 
> increasing dvb_buf_size[] seems to make no diference.
> 
> increasing packet_buf_size[] allows the audio to play smooth longer.
> 
> I might be wrong about the video frames dropping though. It seems like
> all the frames are there, it's just that it looks like the video is
> playing in slow motion so the video falls behind.
> 
> As the buffer get's filled, audio starts to sound choppy and it looks
> like as the buffer gets full, a new buffer is created at which time, the
> audio and video resyncs, so there is a freeze in audio and video and the
> process starts all over again.
> 
If the demuxing buffer is to small, we get audio buffer underruns
(because the video buffer is full and we can't accept any data). Since
we sync to the audio the video will be displayed slower. So vdr's
buffers fill up, once they are filled vdr triggers a clear buffer which
clears all buffers, and everything starts from the beginnig.
So what you describe matches what one would see with too small demuxing
buffer.

In the mpeg2decoder there is the method cMpeg2Decoder::BufferFill(), if
you activate the printouts in this function you can see the buffer fill
of the audio and video demuxing buffers separatly. So you could see if
the demuxing buffers are really to small or if it is some different problem.

Bye,
Martin



From Neumann at do-net.de  Sun Dec 11 13:52:04 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Sun, 11 Dec 2005 13:52:04 +0100
Subject: [Softdevice-devel] Hardware Deinterlace with Matrox?
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D039D141@sbs2003.do-net.de>

Hi,
 
yesterday i looked live football and noticed how bad the deinterlacer of
softdevice really is.
Apart from using the deinterlacers from tvtime, i saw that directfb
says, that the Matrox cards can deinterlace in hardware.
Is that true? Here is the output:
 
[dfb] RAM: 33554432 bytes
[dfb] Accellerated Functions: FillRectange DrawRectange DrawLine
FillTriangle Blit StretchBlit All
[dfb] Drawing Flags: Blend
[dfb] Surface Blitting Flags: BlendAlpha BlendColorAlpha Colorize
SrcColorkey Deinterlace
[dfb] Supported video Modes are: 1280x720 at 16 1280x1024 at 8
[dfb] Enumerating display Layers
Layer 0 FBDev Primary Layer  Type: graphics
  Caps: brightness contrast saturation surface
Layer 1 Matrox Backend Scaler  Type: graphics picture video
  Caps: brightness contrast deinterlacing dst_colorkey screen_location
surface
[surface capabilities] scrSurface: primary videoonly double-buffered
flipping
[dfb] width = 1280, height = 720
[dfb] got fmt = 0x00418c04 bpp = 32
[dfb] Using this layer for OSD: (FBDev Primary Layer - [736x576])

-------------
Andre Neumann



From seppo.ingalsuo at iki.fi  Sun Dec 11 14:44:07 2005
From: seppo.ingalsuo at iki.fi (Seppo Ingalsuo)
Date: Sun, 11 Dec 2005 15:44:07 +0200
Subject: [Softdevice-devel] Color hue and saturation with XV
Message-ID: <439C2D27.1040604@iki.fi>

Hi,

Since the introduction of these controls to softdevice CVS I get almost 
black and white picture from Nvidia FX5200 s-video out when vdr starts 
with default values (50,50). Is the problem present with other XV 
drivers than Nvidia?

The colors become about correct with settings something like 80,80 but 
as the settings are not stored I need to adjust them each time vdr 
restarts. Would it be possible to read the default XV hue and saturation 
settings from XV use them as default 50,50 values?

BR,
Seppo



From stefan at lucke.in-berlin.de  Sun Dec 11 20:36:20 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Sun, 11 Dec 2005 20:36:20 +0100
Subject: [Softdevice-devel] Color hue and saturation with XV
In-Reply-To: <439C2D27.1040604@iki.fi>
References: <439C2D27.1040604@iki.fi>
Message-ID: <200512112036.21032.stefan@lucke.in-berlin.de>

On Sonntag, 11. Dezember 2005 14:44, Seppo Ingalsuo wrote:
> Hi,
> 
> Since the introduction of these controls to softdevice CVS I get almost 
> black and white picture from Nvidia FX5200 s-video out when vdr starts 
> with default values (50,50). Is the problem present with other XV 
> drivers than Nvidia?
> 
> The colors become about correct with settings something like 80,80 but 
> as the settings are not stored I need to adjust them each time vdr 
> restarts. Would it be possible to read the default XV hue and saturation 
> settings from XV use them as default 50,50 values?

They are stored, but the way this is done is rather counter intuitive.
Go to setup, change to the desired values.
Press OK. So now you are at the previous menu.
Press DOWN one time and OK again. So you are at vdr main menu
and all setup values are stored. All setup values are stored only upon
OK from our main setup menu (_not_ upon OK from a submenu).

The startup messages are now:
..
[setup-softdevice] syncTimerMode: sig
[softdevice] UseStretchBlitset to off
[setup-softdevice] vidBrightness: 87
[setup-softdevice] vidContrast: 50
[setup-softdevice] vidHue: 50
[setup-softdevice] vidSaturation: 50
[setup-softdevice] startup aspect set to (16:9 wide)
[softdevice] initializing Plugin
..


> 
> BR,
> Seppo
> 
> _______________________________________________
> Softdevice-devel mailing list
> Softdevice-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 

-- 
Stefan Lucke



From marko.makela at hut.fi  Sun Dec 11 21:05:52 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Sun, 11 Dec 2005 22:05:52 +0200
Subject: [Softdevice-devel] Trouble and crash with vdr-dvd plugin on DirectFB
In-Reply-To: <439AEE68.3020704@gmx.net>
References: <20051208170348.GA28319@localhost.localdomain> <b7bb36410512080934g7f941cfeo5c1ce6b163976abf@mail.gmail.com> <20051208222414.GC3778@localhost.localdomain> <439AEE68.3020704@gmx.net>
Message-ID: <20051211200552.GB402049@kosh.hut.fi>

On Sat, Dec 10, 2005 at 04:04:08PM +0100, Martin Wache wrote:
> > In menus, the navigation cursor was never shown at the correct place,
> > no matter which crop mode or screen aspect ratio I selected.  In some
> > crop mode setting, the displacement was small - a couple of pixels near
> > the top or left of the screen, and maybe 20 pixels when the cursor
> > position was closer to the right or bottom of the picture.
> > 
> This is because the cursor is shown via the spu wich uses the osd, the
> osd is not scaled so these layers don't match exactly.

Yes, I remember that you wrote about it a few weeks ago.  I hope that it
is not too hard to fix this.  Where do you think it should be fixed?
In softdevice or in the dvd plugin?

> > In some menus, the cursor will not appear at all, or the position will
> > not be updated.
> 
> Hmm. Don't know why this happens. We use the same technique for
> displaying like FF cards, so I would not have expected any softdevice
> related problems. Of course except for the shift ;-)

Okay, then I will report this to the dvd plugin author(s).

	Marko


From marko.makela at hut.fi  Sun Dec 11 21:03:35 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Sun, 11 Dec 2005 22:03:35 +0200
Subject: [Softdevice-devel] cropmode toggle key
In-Reply-To: <20051112204239.GA5776@localhost.localdomain>
References: <435EB27E.1040402@e-dition.fr> <200510270732.31636.stefan@lucke.in-berlin.de> <20051111164552.GA2460@seneca.muc.de> <20051112204239.GA5776@localhost.localdomain>
Message-ID: <20051211200335.GA402049@kosh.hut.fi>

On Sat, Nov 12, 2005 at 10:42:39PM +0200, Marko M?kel? wrote:
> My two cents: It appears that softdevice does not properly write the
> CropModeToggleKey setting to setup.conf if the key has been defined
> for the first time in the menu.

It appears that the setting will sometimes be forgotten, even if it has
been written to setup.conf.

Today, I noticed this way to get a repeatable crash until the next reboot:

(1) observe that softdevice starts in cropmode=None even though I do not
remember changing it from 4:3

(2) select the desired crop mode by pressing CropModeToggleKey or
via the softdevice OSD menu

(3) select Restart from the VDR menu

(4) watch vdr crash and burn when _any_ key is pressed on the remote
control unit:

#0  0xb79ba85c in cDFBVideoOut::ProcessEvents (this=0x8277aa8) at video-dfb.c:646
	event = {clazz = DFEC_INPUT, type = DIET_KEYPRESS, device_id = 3, flags = 249, 
  timestamp = {tv_sec = 1134328262, tv_usec = 932859}, key_code = 139, key_id = DIKI_UNKNOWN, 
  key_symbol = DIKS_MENU, modifiers = 0, locks = 0, button = 4294967295, buttons = 4294967295, 
  axis = 4294967295, axisabs = -1, axisrel = -1}
#1  0xb79bb84e in cDFBVideoOut::YUV (this=0x8277aa8, 
    Py=0xb5c3d630 '\200' <repeats 200 times>..., Pu=0x83f0638 '\200' <repeats 200 times>..., 
    Pv=0x840bb68 '\200' <repeats 200 times>..., Width=704, Height=576, Ystride=736, 
    UVstride=368) at video-dfb.c:1367
	dst = (uint8_t *) 0xb5adf000 ""
	pitch = 704
	hi = <value optimized out>
#2  0xb79aafcc in cVideoOut::DrawVideo_420pl (this=0x8277aa8, syncTimer=0x832ab28, 
    delay=0x832ba40, picture=0x8356d70, context=0x83f1d68) at video.c:433
No locals.
#3  0xb79ae9a2 in cVideoStreamDecoder::DecodePacket (this=0x832b7e0, pkt=0x834c1b0)
    at mpeg2decoder.c:653
	findPTS = <value optimized out>
	aPTS = 714720029
	pts_corr = <value optimized out>
	dispTime = <value optimized out>
	len = 0
	got_picture = 32
	data = (uint8_t *) 0x8555060 ""
	size = 2039
#4  0xb79adf74 in cStreamDecoder::Action (this=0x832b7e0) at mpeg2decoder.c:189
	pkt = (AVPacket *) 0x834c1b0
#5  0x080f6772 in cThread::StartThread (Thread=0x832b7e0) at thread.c:235
No locals.
#6  0xb7fb8cfd in start_thread () from /lib/tls/libpthread.so.0
No symbol table info available.
#7  0xb7e3c19e in clone () from /lib/tls/libc.so.6
No symbol table info available.

Any ideas?  Any gdb commands I should try when the crash occurs?

	Marko


From malcolm.caldwell at ntu.edu.au  Mon Dec 12 06:04:31 2005
From: malcolm.caldwell at ntu.edu.au (Malcolm Caldwell)
Date: Mon, 12 Dec 2005 14:34:31 +0930
Subject: [Softdevice-devel] Re: [Softdevice-devel] softdevice & HDTV
	choppy/out-of-sync video/audio problem
In-Reply-To: <20051209170733.37467.qmail@web35411.mail.mud.yahoo.com>
References: <20051209170733.37467.qmail@web35411.mail.mud.yahoo.com>
Message-ID: <1134363872.7200.32.camel@localhost.localdomain>

On Fri, 2005-12-09 at 09:07 -0800, Zdzislaw Gorlicki wrote:
> So I played around with the buffers for last few days. I tried a lot
> of different possibilities, but with littlle or no success.
> 
> increasing dvb_buf_size[] seems to make no diference.
> 
> increasing packet_buf_size[] allows the audio to play smooth longer.
> 
> I might be wrong about the video frames dropping though. It seems like
> all the frames are there, it's just that it looks like the video is
> playing in slow motion so the video falls behind.

I do not remember what config you have but this sounds familiar.

I use a g450 and TV out via directfb.  If I try to view 768p channels
everything goes in slow motion.  I think what happens is softdevice trys
to display 50 frames a second but only refreshes at 25 Hz...

> As the buffer get's filled, audio starts to sound choppy and it looks
> like as the buffer gets full, a new buffer is created at which time,
> the audio and video resyncs, so there is a freeze in audio and video
> and the process starts all over again.
>
> 
> Martin Wache <M.Wache at gmx.net> wrote:
>         
>         > > Did you switch the buffer size to HDTV? You can do
>         > &! gt; that in the
>         > > setup-menu of the softdevice. After changeing the
>         > > buffer size you will
>         > > have to switch the channel to let the change take
>         > > effect.
>         > > 
>         > > Bye,
>         > > Martin
>         > 
>         > yes, of course.
>         > 
>         
>         Hmm, the symptons sound like a too small demuxing buffer, I
>         would have
>         betted that you forgot to switch the buffer size ;-).
>         If you want you can try to increase the buffer size further,
>         in the file
>         mpeg2decoder, around line 40:
>         
>         int dvb_buf_size[] = {64*1024,32*1024,64*1024};
>         int packet_buf_size[] = {300,150,2000};
>         
>         The first ist the default, the second the one for the good
>         seeking and
>         the last one is HDTV. The packet_buf_size should be the
>         relevant size,
>         but you can play around also with dvb_buf_size.
>         Please tell me when you find a working buffersize. I'm not
>         sure what
>         else could cause that... It really sounds like the buffer.
>         Normal streams
>         play fine! ? What about recorded HDTV/normal streams?
>         
>         Bye,
>         Martin
>         
>         -- 
>         10 GB Mailbox, 100 FreeSMS/Monat
>         http://www.gmx.net/de/go/topmail
>         +++ GMX - die erste Adresse f?r Mail, Message, More +++
>         _______________________________________________
>         Softdevice-devel mailing list
>         Softdevice-devel at lists.berlios.de
>         http://lists.berlios.de/mailman/listinfo/softdevice-devel
> 
> 
> 
> ______________________________________________________________________
> Yahoo! Shopping
> Find Great Deals on Holiday Gifts at Yahoo! Shopping 



From hm at seneca.muc.de  Mon Dec 12 16:58:58 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Mon, 12 Dec 2005 16:58:58 +0100
Subject: [Softdevice-devel] probs with softdevice-0.2.1, FusionSound-0.9.23, linux-fusion-1.1, DirectFB-0.9.24
Message-ID: <20051212155858.GA6556@seneca.muc.de>

Hi,

I'm just trying to upgrade my VDR to kernel 2.6.13-15 (SUSE Linux 10),
together with the said packages. As you may know, SL10 uses tmpfs for /dev,
so you usually can't create permanent device nodes. 

the kernel creates /dev/fusion{0-7} for linux-fusion-1.1 but apparently
FusionSound-0.9.23 / DirectFB-0.9.24 expect /dev/fusion/{0-7}. OK so
following hack does the trick in /etc/rc.d/boot.local: 

/sbin/modprobe fusion
cd /dev
mkdir fusion && cd fusion
for i in $(seq 0 7) ; do ln -s ../fusion$i $i ; done
cd -

Works, but not very clean. What gives? 

Next, softdevice-0.2.1 doesn't compile: 

make[1]: Entering directory `/usr/src/vdr-1.3.26/PLUGINS/src/softdevice-0.2.1' 
g++ -fPIC -g -O2 -Wall -Woverloaded-virtual -c -DUSE_MMX -DUSE_MMX2 -DUSE_SUBPLUGINS -DDFB_SUPPORT -DPP_LIBAVCODEC -DPLUGIN_NAME_I18N='"softdevice"' -D_GNU_SOURCE -DPLUGINLIBDIR='"./PLUGINS/lib"' -I../../../include -I../DVB/include -I/usr/local/include/ffmpeg/ -I/usr/local/include/dfb++ -I/usr/local/include/directfb softdevice.c
/usr/local/include/dfb++/idirectfb.h:45: error: ?DFBCardCapabilities? has not been declared
make[1]: *** [softdevice.o] Fehler 1
make[1]: Leaving directory `/usr/src/vdr-1.3.26/PLUGINS/src/softdevice-0.2.1'

Ummm ... 


-- 
Mencken and Nathan's Second Law of The Average American:
	All the postmasters in small towns read all the postcards.


From zdzisekg at yahoo.com  Mon Dec 12 18:58:25 2005
From: zdzisekg at yahoo.com (Zdzislaw Gorlicki)
Date: Mon, 12 Dec 2005 09:58:25 -0800 (PST)
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio problem
In-Reply-To: <6395.1133982966@www69.gmx.net>
Message-ID: <20051212175825.30917.qmail@web35401.mail.mud.yahoo.com>

Now I'm really clueless. I have recieved my budget card (twinhan 102G) but it did not solve the problem. As a matter of fact, I think it's even worse now. However few strange things happened.

I have three HD clips recorded (about 5 min each)
Clip1: 1080i recorded with Nexus
Clip2: 1080i recorded with Nexus
Clip3: 1080i Recorded with the budget card.

I tried to play back the first clip yasterday, and to my suprise, it played back fine. So I tried to play it back again and again and it works fine everytime. So I playback the second clip and that one has the same problem as LiveTV. So I record the third clip and playing it back also has problems. I try to playback clip #1 and it plays fine again. I restart vdr and the problem returns to clip #1.

With the budget card, I get another error in the syslog that I was not getting it with FF card. I'll post exec log tonight when I get home, but VDR complains about Buffer Over Flow, then about skipping TS frames.

			
---------------------------------
Yahoo! Shopping
 Find Great Deals on Holiday Gifts at Yahoo! Shopping 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051212/d94302f7/attachment.html>

From hm at seneca.muc.de  Mon Dec 12 18:40:57 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Mon, 12 Dec 2005 18:40:57 +0100
Subject: [Softdevice-devel] Re: probs with softdevice-0.2.1, FusionSound-0.9.23, linux-fusion-1.1, DirectFB-0.9.24
In-Reply-To: <20051212155858.GA6556@seneca.muc.de>
References: <20051212155858.GA6556@seneca.muc.de>
Message-ID: <20051212174057.GA1400@seneca.muc.de>

Hmmm - got to follow up myself.. 

On Mon, Dec 12, 2005 at 04:58:58PM +0100, Harald Milz wrote:
> Next, softdevice-0.2.1 doesn't compile: 

It does compile with DFB-0.9.22 and Fusion-0.9.22. Hmmm -

Now VDR starts as before but no decoded image is displayed. Only the
channel OSD is displayed for 3 or 4 seconds. It's probably
this one: 

Dec 12 18:30:30 linvdr vdr[7243]: remote control softdevice-dfb - keys known
Dec 12 18:30:30 linvdr vdr[7243]: remote control KBD - keys known
Dec 12 18:30:30 linvdr vdr[7243]: switching to channel 1
Dec 12 18:30:30 linvdr vdr[7256]: Decruft: cleaning thread started (pid=7256, tid=147466)
Dec 12 18:30:30 linvdr vdr[7257]: KBD remote control thread started (pid=7257, tid=163851)
Dec 12 18:30:34 linvdr vdr[7248]: [VideoOut]: resolution changed: W(720 -> 736); H(576 ->576)
Dec 12 18:30:35 linvdr vdr[7243]: ERROR: device 1 has no lock, can't attach receiver!
Dec 12 18:30:35 linvdr vdr[7243]: OSDTeletext: Did not find appropriate device for teletext receiver for channel Das Erste,
 PID 104
Dec 12 18:30:35 linvdr vdr[7243]: setting watchdog timer to 60 seconds
Dec 12 18:30:35 linvdr vdr[7259]: transfer thread started (pid=7259, tid=196621)

Again, the kernel is 2.6.13-15.7-default (SL10) with the kernel dvb
drivers. With the drivers from the 9.3 kernel (2.6.11.4-21.7) everything
worked fine. The updated was motivated by the Skystar2 driver which is said
to work with more recent drivers
(http://www.vdr-wiki.de/wiki/index.php/DVB-S_Budget-PCI-Karten) but I
haven't gotten that far yet... 

? 

I'm attaching a log of the vdr output. 


PS: BTW the Nova-s card I got
(http://www.vdr-wiki.de/wiki/index.php/Hauppauge_NOVA-S left pic) needs the
budget_ci driver despite the fact that it has no CI connector at all. Duh. 




-- 
In Boston, it is illegal to hold frog-jumping contests in nightclubs.
-------------- next part --------------
/usr/src/VDR

Mon Dec 12 18:30:26 CET 2005

mount: asterisk:/pub/mp3 already mounted or /mp3 busy
mount: according to mtab, asterisk:/pub/mp3 is already mounted on /mp3
[softdevice] processing args
[softdevice]   argv [0] = softdevice
[softdevice]   argv [1] = -ao
[softdevice] using PCM alsa device plug:iec958
[softdevice] using AC3 alsa device plug:iec958
[softdevice]   argv [3] = -vo
[setup-softdevice] alsa ac3Mode set to: 1
[setup-softdevice] A/V Offset set to (0)
[setup-softdevice] Cropping 0 lines from bottom
[setup-softdevice] Cropping 0 columns from left
[setup-softdevice] cropping mode set to 0 (none)
[setup-softdevice] cropping mode toggle key set to 3 (User3)
[setup-softdevice] Cropping 0 columns from right
[setup-softdevice] Cropping 0 lines from top
[setup-softdevice] deinterlace method set to 0 none
[setup-softdevice] mainMenu: 0
[setup-softdevice] setting alpha blend mode to pseudo
[softdevice] picture mirroring set to 0 (off)
[setup-softdevice] pixel format set to (I420)
[setup-softdevice] shouldSuspend to: 0
[setup-softdevice] syncTimerMode: sig
[softdevice] UseStretchBlitset to off
[setup-softdevice] startup aspect set to (4:3 normal)
[softdevice] initializing Plugin
[softdevice] Initializing Video Out
[softdevice] ffmpeg version(0.4.8) build(4680)
[dfb] init
(*) DirectFB/Config: Parsing config file '/etc/directfbrc'.

       ---------------------- DirectFB v0.9.22 ---------------------
             (c) 2000-2002  convergence integrated media GmbH  
             (c) 2002-2004  convergence GmbH                   
        -----------------------------------------------------------

(*) DirectFB/Core: Multi Application Core. (2005-12-12 16:20) 
(*) Direct/Memcpy: Using MMXEXT optimized memcpy()
(*) Direct/Thread: Running 'Fusion Dispatch' (MESSAGING, 7249)...
(*) Direct/Thread: Running 'VT Switcher' (CRITICAL, 7252)...
(*) Direct/Modules: suppress module 'ps2mouse'
(*) Direct/Modules: suppress module 'serialmouse'
(*) Direct/Modules: suppress module 'sonypi'
(*) Direct/Modules: suppress module 'sdlinput'
(*) Direct/Modules: suppress module 'joystick'
(*) Direct/Modules: suppress module 'keyboard'
(*) Direct/Thread: Running 'Linux Input' (INPUT, 7253)...
(*) DirectFB/Input: PC Speaker (1) 0.1 (convergence integrated media GmbH)
(*) Direct/Thread: Running 'Linux Input' (INPUT, 7254)...
(*) DirectFB/Input: AT Translated Set 2 keyboard (2) 0.1 (convergence integrated media GmbH)
(*) DirectFB/Genefx: MMX detected and enabled
(*) DirectFB/Graphics: Matrox G550 0.7 (convergence integrated media GmbH)
(*) DirectFB/Core/WM: Default 0.2 (Convergence GmbH)
[dfb] RAM: 16777216 bytes
[dfb] Accellerated Functions: FillRectange DrawRectange DrawLine FillTriangle Blit StretchBlit All 
[dfb] Drawing Flags: Blend 
[dfb] Surface Blitting Flags: BlendAlpha BlendColorAlpha Colorize SrcColorkey Deinterlace 
[dfb] Supported video Modes are: 1280x720 at 32 
[dfb] Enumerating display Layers
Layer 0 FBDev Primary Layer  Type: graphics 
  Caps: brightness contrast saturation surface 
Layer 1 Matrox Backend Scaler  Type: graphics picture video 
  Caps: brightness contrast deinterlacing dst_colorkey screen_location surface 
[surface capabilities] scrSurface: primary videoonly double-buffered flipping 
[dfb] width = 1280, height = 720
[dfb] got fmt = 0x00418c04 bpp = 32
[dfb] Using this layer for OSD: (FBDev Primary Layer - [736x576])
[surface capabilities] osdSurface: videoonly double-buffered flipping 
 (!!!)  *** WARNING [letting unprivileged IDirectFBDisplayLayer::GetSurface() call pass until cooperative level handling is finished] *** [idirectfbdisplaylayer.c:170 in IDirectFBDisplayLayer_GetSurface()]
[surface capabilities] videoSurface: videoonly 
[dfb] Configuring CooperativeLevel for Overlay
[dfb] Configuring CooperativeLevel for OSD
[dfb] Using this layer for OSD: FBDev Primary Layer
[dfb] Using this layer for Video out: Matrox Backend Scaler
[dfb] Display frame time is 16642 microseconds
[dfb] (re)configuring Videolayer to 720 x 576 (720x576)
[surface capabilities] videoSurface: videoonly double-buffered flipping 
[dfb] (re)configured 0x08100609
[softdevice] Subplugin successfully opend
[softdevice] Video Out seems to be OK
[softdevice] Initializing Audio Out
[softdevice] Audio out seems to be OK
[softdevice] A/V devices initialized, now initializing MPEG2 Decoder
cSoftDevice::MakePrimaryDevice
[dfb] (re)configuring Videolayer to 736 x 576 (720x576)
[surface capabilities] videoSurface: videoonly double-buffered flipping 
[dfb] (re)configured 0x08100609
vdradmind.pl: no process killed
vdradmind.pl 0.97-am3.4.1 wurde mit der Prozess-ID 7264 gestartet.
[dfb] (re)configuring Videolayer to 736 x 576 (720x576)
[surface capabilities] videoSurface: videoonly double-buffered flipping 
[dfb] (re)configured 0x08100609
[dfb] (re)configuring Videolayer to 736 x 576 (720x576)
[surface capabilities] videoSurface: videoonly double-buffered flipping 
[dfb] (re)configured 0x08100609
[dfb] (re)configuring Videolayer to 736 x 576 (720x576)
[surface capabilities] videoSurface: videoonly double-buffered flipping 
[dfb] (re)configured 0x08100609

From hm at seneca.muc.de  Mon Dec 12 22:57:39 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Mon, 12 Dec 2005 22:57:39 +0100
Subject: [Softdevice-devel] Re: probs with softdevice-0.2.1, FusionSound-0.9.23, linux-fusion-1.1, DirectFB-0.9.24
In-Reply-To: <20051212174057.GA1400@seneca.muc.de>
References: <20051212155858.GA6556@seneca.muc.de> <20051212174057.GA1400@seneca.muc.de>
Message-ID: <20051212215739.GA7665@seneca.muc.de>

On Mon, Dec 12, 2005 at 06:40:57PM +0100, Harald Milz wrote:
> Dec 12 18:30:35 linvdr vdr[7243]: ERROR: device 1 has no lock, can't attach receiver!

Duh. 

Double check the wiring. The cable wasn't properly attached, or there was a
loose contact. Whatever. 

I'm still struggling with AC3 passthrough. It did work fine with SL 9.3
alsa but not anymore with SL10. aplay -D spdif plays a test.wav just fine,
albeit no sound... I seem to remember there was a trick w.r.t. SUSE Linux
10 mentioned somewhere, but this time Google lets me down. This hardly
ever happens to me but this time it hits hard. 

Any idea? 

BTW I exchanged all memcpys by fast_memcpys in video-dfb.c and
mpeg2decoder.c, and the image flickers only very slightly with a 1 GHz
Athlon XP-M... good thing IMHO. Why aren't fast_memcpys used anyway? 


-- 
A great nation is any mob of people which produces at least one honest
man a century.


From hm at seneca.muc.de  Wed Dec 14 14:02:11 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Wed, 14 Dec 2005 14:02:11 +0100
Subject: [Softdevice-devel] Xine w/ crop mode or softdevice on CLE266/CN400
Message-ID: <20051214130211.GA23953@seneca.muc.de>

Hi,

as I wrote in an earlier mail, I am using softdevice (with a G550 card)
quite successfully. One of the real advantages of softdevice is its
crop mode that allows you to crop a 14:9 or 16:9 rectangle from a 4:3
broadcasting and rescale it to full screen on a 16:9 capable TV set
(1280x720). Really nice. The downside is that my current living room
machine is just not living room compatible (looks and noise). I would
like to build a new VDR with a mini-ITX board (CLE266 or CN400) and use
the xine libs and plugin.

The question is, does xine provide something similar? I suspect that the
answer is no because the rescaling needs to be done _after_ the MPEG2
decoding, which in case of the VIA chip is done in hardware. Is that
right or is there hope?

And - will xine rescale the picture to 1280x720 if it is encoded
anamorphous, as does softdevice?

Alternatively, how good is the CLE266/CN400 support in DirectFB? That would
be an alternative (with softdevice in turn). Has somebody been there, done
that? 

Most private TV stations in Germany simply don't get it as far as
anamorphous encoding...


-- 
The [Ford Foundation] is a large body of money completely surrounded by
people who want some.
		-- Dwight MacDonald


From M.Wache at gmx.net  Thu Dec 15 19:52:52 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Thu, 15 Dec 2005 19:52:52 +0100
Subject: [Softdevice-devel] Re: [Softdevice-devel] softdevice & HDTV	choppy/out-of-sync
 video/audio problem
In-Reply-To: <1134363872.7200.32.camel@localhost.localdomain>
References: <20051209170733.37467.qmail@web35411.mail.mud.yahoo.com> <1134363872.7200.32.camel@localhost.localdomain>
Message-ID: <43A1BB84.8050305@gmx.net>

Malcolm Caldwell schrieb:
> On Fri, 2005-12-09 at 09:07 -0800, Zdzislaw Gorlicki wrote:
> 
>>So I played around with the buffers for last few days. I tried a lot
>>of different possibilities, but with littlle or no success.
>>
>>increasing dvb_buf_size[] seems to make no diference.
>>
>>increasing packet_buf_size[] allows the audio to play smooth longer.
>>
>>I might be wrong about the video frames dropping though. It seems like
>>all the frames are there, it's just that it looks like the video is
>>playing in slow motion so the video falls behind.
> 
> 
> I do not remember what config you have but this sounds familiar.
> 
> I use a g450 and TV out via directfb.  If I try to view 768p channels
> everything goes in slow motion.  I think what happens is softdevice trys
> to display 50 frames a second but only refreshes at 25 Hz...
> 

Very good point. If the the softdevice gets the framerate wrong for some
reason the symptons would indeed be similar. One could check the value
of default_frametime in cMpeg2Decoder to see if the frametime is
delivered wrong from ffmpeg or maybe the softdevice messes up the
synchronization when trying to sync to the video retrace.

Martin


From M.Wache at gmx.net  Thu Dec 15 19:57:53 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Thu, 15 Dec 2005 19:57:53 +0100
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio
 problem
In-Reply-To: <20051212175825.30917.qmail@web35401.mail.mud.yahoo.com>
References: <20051212175825.30917.qmail@web35401.mail.mud.yahoo.com>
Message-ID: <43A1BCB1.9040608@gmx.net>

Zdzislaw Gorlicki schrieb:
> Now I'm really clueless. I have recieved my budget card (twinhan 102G)
> but it did not solve the problem. As a matter of fact, I think it's even
> worse now. However few strange things happened.
> 
> I have three HD clips recorded (about 5 min each)
> Clip1: 1080i recorded with Nexus
> Clip2: 1080i recorded with Nexus
> Clip3: 1080i Recorded with the budget card.
> 
> I tried to play back the first clip yasterday, and to my suprise, it
> played back fine. So I tried to play it back again and again and it
> works fine everytime. So I playback the second clip and that one has the
> same problem as LiveTV. So I record the third clip and playing it back
> also has problems. I try to playback clip #1 and it plays fine again. I
> restart vdr and the problem returns to clip #1.
> 
Puzzles me too. Except for the wrong frame time which has been suggested
by Malcolm I don't have any clue...
You could try to use Xv-Video out (I think I remember you use
DirectFB...), we have some reports of working HDTV with Xv-Video out.
But I'm not sure if it makes a difference...

Bye,
Martin


From M.Wache at gmx.net  Thu Dec 15 20:04:23 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Thu, 15 Dec 2005 20:04:23 +0100
Subject: [Softdevice-devel] Re: probs with softdevice-0.2.1, FusionSound-0.9.23,
 linux-fusion-1.1, DirectFB-0.9.24
In-Reply-To: <20051212215739.GA7665@seneca.muc.de>
References: <20051212155858.GA6556@seneca.muc.de> <20051212174057.GA1400@seneca.muc.de> <20051212215739.GA7665@seneca.muc.de>
Message-ID: <43A1BE37.2040608@gmx.net>

Harald Milz schrieb:

> BTW I exchanged all memcpys by fast_memcpys in video-dfb.c and
> mpeg2decoder.c, and the image flickers only very slightly with a 1 GHz
> Athlon XP-M... good thing IMHO. Why aren't fast_memcpys used anyway? 
> 

It's used in Xv-Video out. DirectFB didn't work properly on my box, so I
could not test it for DFB ;-).
But as I already said fast_memcpy is only faster if cache can't be used,
otherwise it is slower, so it's not the best to replace all memcpys.
Only the ones which large amounts of data (which doesn't fit into the
cache) should be copied with fast_memcpy.

Martin




From M.Wache at gmx.net  Thu Dec 15 20:13:26 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Thu, 15 Dec 2005 20:13:26 +0100
Subject: [Softdevice-devel] Trouble and crash with vdr-dvd plugin on DirectFB
In-Reply-To: <20051211200552.GB402049@kosh.hut.fi>
References: <20051208170348.GA28319@localhost.localdomain> <b7bb36410512080934g7f941cfeo5c1ce6b163976abf@mail.gmail.com> <20051208222414.GC3778@localhost.localdomain> <439AEE68.3020704@gmx.net> <20051211200552.GB402049@kosh.hut.fi>
Message-ID: <43A1C056.8030805@gmx.net>

Marko M?kel? schrieb:
> On Sat, Dec 10, 2005 at 04:04:08PM +0100, Martin Wache wrote:
> 
>>>In menus, the navigation cursor was never shown at the correct place,
>>>no matter which crop mode or screen aspect ratio I selected.  In some
>>>crop mode setting, the displacement was small - a couple of pixels near
>>>the top or left of the screen, and maybe 20 pixels when the cursor
>>>position was closer to the right or bottom of the picture.
>>>
>>
>>This is because the cursor is shown via the spu wich uses the osd, the
>>osd is not scaled so these layers don't match exactly.
> 
> 
> Yes, I remember that you wrote about it a few weeks ago.  I hope that it
> is not too hard to fix this.  Where do you think it should be fixed?
> In softdevice or in the dvd plugin?
> 
If it happens only with the softdevice in the softdevice of course ;-)
My rewrite of the osd fixes this (well almost, there is still a shift of
about 2-4 pixels, maybe I still have to introduce an constant offset...)
and the best is it's almost finished. Almost...

Bye,

Martin


From zdzisekg at yahoo.com  Thu Dec 15 20:30:27 2005
From: zdzisekg at yahoo.com (Zdzislaw Gorlicki)
Date: Thu, 15 Dec 2005 11:30:27 -0800 (PST)
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio problem
In-Reply-To: <43A1BCB1.9040608@gmx.net>
Message-ID: <20051215193027.91791.qmail@web35410.mail.mud.yahoo.com>

I did try xv few days ago, but it did not seem to make a difference and in addition, HD content would be resized to small window in the corner. Also xv is not something I'm interested in as a long term solutions. I wanna get a true STB experience out of my box.

In a mean time, I've updated to DirectFB, DFB++ and softdevice, all cvs, and it did seem to make some difference. Some HD channels play OK (at best) while others don't, but any increase in postprocessing quality will result in similiar problems as before on all channels. so is my processor really too slow? I can't go much higher then what I have. AMD Athlon64 3700+, 1GB DDR Ram (Dual Channel).

As for the clips, I think the 2 that don't play well are corrupted as I get errors in syslog when I play them back, and I don't see the same errors when I play the first clip. I'll do more testing on that. Quality of playback through softdevice is about the same as through softdevice.

Right now I'm awaiting arrival of a Matrox G450, maybe this will improve performance. I'll keep you posted.

One more thing. On the HD channels that play OK, anything that have faster scenes (ex. car driving or anything that moves faster then 3 miles/hour) the picture looks very jerky (not smooth). it's pretty bad. Could this be a software problem or is it again cpu performance issue.

thanx



Martin Wache <M.Wache at gmx.net> wrote: Zdzislaw Gorlicki schrieb:
> Now I'm really clueless. I have recieved my budget card (twinhan 102G)
> but it did not solve the problem. As a matter of fact, I think it's even
> worse now. However few strange things happened.
> 
> I have three HD clips recorded (about 5 min each)
> Clip1: 1080i recorded with Nexus
> Clip2: 1080i recorded with Nexus
> Clip3: 1080i Recorded with the budget card.
> 
> I tried to play back the first clip yasterday, and to my suprise, it
> played back fine. So I tried to play it back again and again and it
> works fine everytime. So I playback the second clip and that one has the
> same problem as LiveTV. So I record the third clip and playing it back
> also has problems. I try to playback clip #1 and it plays fine again. I
> restart vdr and the problem returns to clip #1.
> 
Puzzles me too. Except for the wrong frame time which has been suggested
by Malcolm I don't have any clue...
You could try to use Xv-Video out (I think I remember you use
DirectFB...), we have some reports of working HDTV with Xv-Video out.
But I'm not sure if it makes a difference...

Bye,
Martin
_______________________________________________
Softdevice-devel mailing list
Softdevice-devel at lists.berlios.de
http://lists.berlios.de/mailman/listinfo/softdevice-devel



			
---------------------------------
Yahoo! Shopping
 Find Great Deals on Holiday Gifts at Yahoo! Shopping 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051215/9668ef30/attachment.html>

From M.Wache at gmx.net  Thu Dec 15 21:20:14 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Thu, 15 Dec 2005 21:20:14 +0100
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio
 problem
In-Reply-To: <20051215193027.91791.qmail@web35410.mail.mud.yahoo.com>
References: <20051215193027.91791.qmail@web35410.mail.mud.yahoo.com>
Message-ID: <43A1CFFE.9080908@gmx.net>

Zdzislaw Gorlicki schrieb:
> I did try xv few days ago, but it did not seem to make a difference and
> in addition, HD content would be resized to small window in the corner.
> Also xv is not something I'm interested in as a long term solutions. I
> wanna get a true STB experience out of my box.
>
Did you use the max-area option with Xv? If you don't use "-vo
xv:max-area" Xv will only allocate a normal resolution picture and you
will see only a part of the picture.


> In a mean time, I've updated to DirectFB, DFB++ and softdevice, all cvs,
> and it did seem to make some difference. Some HD channels play OK (at
> best) while others don't, but any increase in postprocessing quality
> will result in similiar problems as before on all channels. so is my
> processor really too slow? I can't go much higher then what I have. AMD
> Athlon64 3700+, 1GB DDR Ram (Dual Channel).

Postprocessing takes much CPU power, especially on large pictures. But I
don't have any experience on how much CPU power is needed for HDTV, sorry.
I've just commited a small patch to make use of fast_memcpy in DirectFB,
this should improve the performance a bit.


> Ri! ght now I'm awaiting arrival of a Matrox G450, maybe this will
> improve performance. I'll keep you posted.
> 
> One more thing. On the HD channels that play OK, anything that have
> faster scenes (ex. car driving or anything that moves faster then 3
> miles/hour) the picture looks very jerky (not smooth). it's pretty bad.
> Could this be a software problem or is it again cpu performance issue.

Fast moveing scence need more CPU power, so it seems to be a performace
issue. Hmm, or maybe because it is  badly deinterlaced?

Bye,
Martin


From zdzisekg at yahoo.com  Thu Dec 15 21:57:56 2005
From: zdzisekg at yahoo.com (Zdzislaw Gorlicki)
Date: Thu, 15 Dec 2005 12:57:56 -0800 (PST)
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio problem
In-Reply-To: <43A1CFFE.9080908@gmx.net>
Message-ID: <20051215205756.47243.qmail@web35409.mail.mud.yahoo.com>



Martin Wache <M.Wache at gmx.net> wrote:Fast moveing scence need more CPU power, so it seems to be a performace
issue. Hmm, or maybe because it is  badly deinterlaced?

Bye,
Martin
_______________________________________________
Softdevice-devel mailing list
Softdevice-devel at lists.berlios.de
http://lists.berlios.de/mailman/listinfo/softdevice-devel
I think I recall somthing about the G450 being able to deinterlace on it's own. Can it do it for the DVI output or is it just S-Video?

By the way. What are these [softdevice-audio] xrun errors?

thanx
 

			
---------------------------------
Yahoo! Shopping
 Find Great Deals on Holiday Gifts at Yahoo! Shopping 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051215/a1429889/attachment.html>

From marko.makela at hut.fi  Thu Dec 15 22:19:42 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Thu, 15 Dec 2005 23:19:42 +0200
Subject: [Softdevice-devel] Trouble and crash with vdr-dvd plugin on DirectFB
In-Reply-To: <43A1C056.8030805@gmx.net>
References: <20051208170348.GA28319@localhost.localdomain> <b7bb36410512080934g7f941cfeo5c1ce6b163976abf@mail.gmail.com> <20051208222414.GC3778@localhost.localdomain> <439AEE68.3020704@gmx.net> <20051211200552.GB402049@kosh.hut.fi> <43A1C056.8030805@gmx.net>
Message-ID: <20051215211942.GB3659@localhost.localdomain>

On Thu, Dec 15, 2005 at 08:13:26PM +0100, Martin Wache wrote:
> > Yes, I remember that you wrote about it a few weeks ago.  I hope that it
> > is not too hard to fix this.  Where do you think it should be fixed?
> > In softdevice or in the dvd plugin?
> > 
> If it happens only with the softdevice in the softdevice of course ;-)
> My rewrite of the osd fixes this (well almost, there is still a shift of
> about 2-4 pixels, maybe I still have to introduce an constant offset...)
> and the best is it's almost finished. Almost...

A perhaps crazy idea: Would it make sense to implement DVD playback
in a subplugin of softdevice, similar to the softplay plugin?  Without
knowing any details, I have the feeling that DVD menus could perhaps
be handled more easily in that way.

	Marko


From M.Wache at gmx.net  Thu Dec 15 22:27:41 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Thu, 15 Dec 2005 22:27:41 +0100
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio
 problem
In-Reply-To: <20051215205756.47243.qmail@web35409.mail.mud.yahoo.com>
References: <20051215205756.47243.qmail@web35409.mail.mud.yahoo.com>
Message-ID: <43A1DFCD.2070307@gmx.net>

> I think I recall somthing about the G450 being able to deinterlace on
> it's own. Can it do it for the DVI output or is it just S-Video?
>
Sorry, I don't know. I would assume it can do deinteraceing for both..


> By the way. What are these [softdevice-audio] xrun errors?

It's an audio buffer underrun. But you get the same message also after a
channel switch, because the audio is not properly stopped and started on
a channel switch.

Martin


From M.Wache at gmx.net  Thu Dec 15 23:07:24 2005
From: M.Wache at gmx.net (Martin Wache)
Date: Thu, 15 Dec 2005 23:07:24 +0100
Subject: [Softdevice-devel] Trouble and crash with vdr-dvd plugin on DirectFB
In-Reply-To: <20051215211942.GB3659@localhost.localdomain>
References: <20051208170348.GA28319@localhost.localdomain> <b7bb36410512080934g7f941cfeo5c1ce6b163976abf@mail.gmail.com> <20051208222414.GC3778@localhost.localdomain> <439AEE68.3020704@gmx.net> <20051211200552.GB402049@kosh.hut.fi> <43A1C056.8030805@gmx.net> <20051215211942.GB3659@localhost.localdomain>
Message-ID: <43A1E91C.2060006@gmx.net>

Marko M?kel? schrieb:
> On Thu, Dec 15, 2005 at 08:13:26PM +0100, Martin Wache wrote:
> 
>>>Yes, I remember that you wrote about it a few weeks ago.  I hope that it
>>>is not too hard to fix this.  Where do you think it should be fixed?
>>>In softdevice or in the dvd plugin?
>>>
>>
>>If it happens only with the softdevice in the softdevice of course ;-)
>>My rewrite of the osd fixes this (well almost, there is still a shift of
>>about 2-4 pixels, maybe I still have to introduce an constant offset...)
>>and the best is it's almost finished. Almost...
> 
> 
> A perhaps crazy idea: Would it make sense to implement DVD playback
> in a subplugin of softdevice, similar to the softplay plugin?  Without
> knowing any details, I have the feeling that DVD menus could perhaps
> be handled more easily in that way.
> 
Of course that could be done, however I'm not sure if it would be really
easier. The SPU decoder which is (as far as I know) responsible for
displaying the menu and the subtitles is already part of vdr. Also mpeg2
audio and video can be handled by vdr (as well as ac3 and pcm), so many
things which are needed are already in place and you don't need to
bypass vdr (like softplay does) if you want to playback a dvd.

I would prefer to improve the cooperation of the dvd-plugin and the
softdevice rather to start a compeletly new plugin.

Bye,

Martin


From marko.makela at hut.fi  Fri Dec 16 11:18:08 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Fri, 16 Dec 2005 12:18:08 +0200
Subject: [Softdevice-devel] Trouble and crash with vdr-dvd plugin on DirectFB
In-Reply-To: <43A1E91C.2060006@gmx.net>
References: <20051208170348.GA28319@localhost.localdomain> <b7bb36410512080934g7f941cfeo5c1ce6b163976abf@mail.gmail.com> <20051208222414.GC3778@localhost.localdomain> <439AEE68.3020704@gmx.net> <20051211200552.GB402049@kosh.hut.fi> <43A1C056.8030805@gmx.net> <20051215211942.GB3659@localhost.localdomain> <43A1E91C.2060006@gmx.net>
Message-ID: <20051216101808.GB3595@localhost.localdomain>

On Thu, Dec 15, 2005 at 11:07:24PM +0100, Martin Wache wrote:
> > A perhaps crazy idea: Would it make sense to implement DVD playback
> > in a subplugin of softdevice, similar to the softplay plugin?  Without
> > knowing any details, I have the feeling that DVD menus could perhaps
> > be handled more easily in that way.
> > 
> Of course that could be done, however I'm not sure if it would be really
> easier. The SPU decoder which is (as far as I know) responsible for
> displaying the menu and the subtitles is already part of vdr. Also mpeg2
> audio and video can be handled by vdr (as well as ac3 and pcm), so many
> things which are needed are already in place and you don't need to
> bypass vdr (like softplay does) if you want to playback a dvd.

Right.  Bypassing vdr would bring its own set of problems.  Examples of
current problems are vdr being unaware of softdevice.Suspended and
CropModeToggleKey.  (Did you or Stefan have a chance of looking at my
crash report of CropModeToggleKey detection already?)

> I would prefer to improve the cooperation of the dvd-plugin and the
> softdevice rather to start a compeletly new plugin.

Sure.  Starting from the scratch does not make sense unless there is some
fundamental problem with the current solution.  I'm glad there is none.

By the way, this may be a stupid question, but how can I contact the
authors of the vdr-dvd plugin?  It is not obvious from the SourceForge
project page <http://sourceforge.net/projects/dvdplugin/>.  I did not find
any active mailing list.  I see that there is some activity going on:
the latest change in CVS is 3 months old.

	Marko


From itsmebcc at hotmail.com  Sun Dec 18 01:57:57 2005
From: itsmebcc at hotmail.com (itsmebcc)
Date: Sat, 17 Dec 2005 18:57:57 -0600
Subject: [Softdevice-devel] VDR with softdevice only 3 issues
Message-ID: <BAY101-DAV12B8357816AD353B1755C2CB3C0@phx.gbl>

Hello,

I am using VDR 1.3.36 and softdevice 0.2.1 and have a couple issues.  I have read through the archive and have not found the resolution as of yet, so I hope that someone could give me some ideas.  This is all done on a system with a Nexus-s and a "New Grey Remote", and a Matrox G450.

1st problem I am having which I did read a little about is the remote does not seem to finction correctly.  When using softdevice with DFB the remote is found and I can teach it, but several buttons are not found (Blue button, Play button, and Record button).  Everything else seems to work, but those buttons, and a get double clicks half of the time, meaning if I am on channel 100 and I push channel up once it will go to channel 102.  

2nd Problem is while using vidix.  The picture works fine as does the remote, but I get no OSD at all.  I have tried this using i420 and yuv2.  I cannot get this to work for anything.

3rd problem I am having is the biggest pain.  I am going out dvi from a matrox directly to a 42" Plasma, and there is about 3 rows of unused pixels all the way around the screen.  When I crop the top to get rid of the annoying flickering I get about 5 or 6 rows of unused pixels. 

Thanks for any advice.

B
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051217/101877a6/attachment.html>

From zdzisekg at yahoo.com  Sun Dec 18 03:49:00 2005
From: zdzisekg at yahoo.com (Zdzislaw Gorlicki)
Date: Sat, 17 Dec 2005 18:49:00 -0800 (PST)
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio problem  
Message-ID: <20051218024900.44180.qmail@web35412.mail.mud.yahoo.com>

After many hours of fiddling around with this block in
mpeg2decoder.c(as mentioned by you in previous
message)
---------------------------------------------------------------
    if (pkt->pts != (int64_t) AV_NOPTS_VALUE) {
         lastPTS=pkt->pts;
         lastDuration=pkt->duration;

         if (lastDuration) {
#if LIBAVCODEC_BUILD > 4753
                
default_frametime=context->time_base.num*
                         10000/context->time_base.den;
#else
                 default_frametime=lastDuration/100;
#endif
                 if (!default_frametime) {
                  /*
-------------------------------------------------------------------
                   * we should have another/better
guess.
                   */
                  //fprintf (stderr, " --- setting
default frametime !! ---\n");
                  default_frametime =
DEFAULT_FRAMETIME;
                 }
                 MPGDEB("Set default_frametime to
%d\n",default_frametime);
         };
    };
-------------------------------------------------------------------

it has come to me that if I set the DEFAULT_FRAMETIME
in
mpeg2decoder.h to 0 (zero). HD channels display fine,
however SD channels do not. So you were right on that
it
might be a frame detection issue. However I'm hardly a
programmer and my skills are limited, so I have no
idea
how to fix it myself.

Also, how do you calculate the frame time that it ends
up
400 for PAL. What would it be for NTSC?

Debugging the output and looking at the function
above, I'd assume that default_frametime = 0 is only
printed when everything else fails and the
default_frametime is used. However, in my debug log, I
get this message on every frame, which means for me it
always failes back to default. Even on the SD
channels. Any thoughts on that?

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 


From marko.makela at hut.fi  Sun Dec 18 08:04:20 2005
From: marko.makela at hut.fi (Marko =?iso-8859-1?B?TeRrZWzk?=)
Date: Sun, 18 Dec 2005 09:04:20 +0200
Subject: [Softdevice-devel] VDR with softdevice only 3 issues
In-Reply-To: <BAY101-DAV12B8357816AD353B1755C2CB3C0@phx.gbl>
References: <BAY101-DAV12B8357816AD353B1755C2CB3C0@phx.gbl>
Message-ID: <20051218070420.GA4446@localhost.localdomain>

On Sat, Dec 17, 2005 at 06:57:57PM -0600, itsmebcc wrote:
> 1st problem I am having which I did read a little about is the remote does
> not seem to finction correctly.  When using softdevice with DFB the remote
> is found and I can teach it, but several buttons are not found

I assume that the remote control unit uses the linuxinput API.  Have you
tried evtest?  Does dmesg show any error message about unknown key codes?

If the keys are reported correctly by the kernel, then the mapping must be
missing from DirectFB.  Yes, also DirectFB has a translation table.  See
Bug 0000015 in the DirectFB bug tracking system:
http://www.directfb.org/mantis/view.php?id=15
http://www.directfb.org/mantis/login_page.php

> Everything else seems to work, but those buttons, and a get double clicks
> half of the time, meaning if I am on channel 100 and I push channel up
> once it will go to channel 102.  

The key-repeat problem has been fixed in DirectFB 0.9.23 and vdr-softdevice
0.1.3.

	Marko


From stefan at lucke.in-berlin.de  Mon Dec 19 08:49:49 2005
From: stefan at lucke.in-berlin.de (Stefan Lucke)
Date: Mon, 19 Dec 2005 08:49:49 +0100
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio problem
In-Reply-To: <20051218024900.44180.qmail@web35412.mail.mud.yahoo.com>
References: <20051218024900.44180.qmail@web35412.mail.mud.yahoo.com>
Message-ID: <200512190849.49515.stefan@lucke.in-berlin.de>

On Sonntag, 18. Dezember 2005 03:49, Zdzislaw Gorlicki wrote:

> Also, how do you calculate the frame time that it ends
> up
> 400 for PAL. What would it be for NTSC?
> 
> Debugging the output and looking at the function
> above, I'd assume that default_frametime = 0 is only
> printed when everything else fails and the
> default_frametime is used. However, in my debug log, I
> get this message on every frame, which means for me it
> always failes back to default. Even on the SD
> channels. Any thoughts on that?

I think we have a bug here, depending on the ffmpeg version.
I modified quoted code to the following:

    if (pkt->pts != (int64_t) AV_NOPTS_VALUE) {
         lastPTS=pkt->pts;
         lastDuration=pkt->duration;

         if (lastDuration) {
#if LIBAVCODEC_BUILD > 4753
                 default_frametime=context->time_base.num*
                         10000/context->time_base.den;
fprintf(stderr, "tb num %d, tb den %d\n",context->time_base.num,context->time_base.den);
#else
                 default_frametime=lastDuration/100;
#endif
                 if (!default_frametime) {
                  /* ----------------------------------------------------------
                   * we should have another/better guess.
                   */
                  fprintf (stderr, " --- setting default frametime !! ---\n");
                  default_frametime = DEFAULT_FRAMETIME;
                 }
                 MPGDEB("Set default_frametime to %d\n",default_frametime);
         };
         fprintf (stderr, "default frame time:%d - %d\n",default_frametime,lastDuration);
    };

and got this on stderr (1st part is PAL live TV, 2nd is from Madagascar.avi DivX-HDTV 30fps):

default frame time:400 - 0
default frame time:400 - 0
device is of type: [11cSoftDevice]
Softdevice and device are of same types
Streams: 2
Input #0, avi, from 'test':
  Duration: 00:01:54.9, start: 0.000000, bitrate: 4200 kb/s
  Stream #0.0,   inf fps: Video: mpeg4, yuv420p, 1280x720
  Stream #0.1: Audio: mp3, 44100 Hz, stereo, 192 kb/s
tb num 1, tb den 30000
 --- setting default frametime !! ---
default frame time:400 - 1
tb num 1, tb den 30000
 --- setting default frametime !! ---
default frame time:400 - 1
#tb num 1, tb den 30000
 --- setting default frametime !! ---

my ffmpeg version is reported as:

[softdevice] initializing Plugin
[softdevice] Initializing Video Out
[softdevice] ffmpeg version(CVS) build(3277056)
[XvVideoOut]: displayAspect = 1,248175, displayRatio = 1,250000, PAR = 0,998540

-- 
Stefan Lucke



From juniper81 at gmail.com  Mon Dec 19 10:16:14 2005
From: juniper81 at gmail.com (Ari Koponen)
Date: Mon, 19 Dec 2005 11:16:14 +0200
Subject: [Softdevice-devel] Trouble and crash with vdr-dvd plugin on DirectFB
In-Reply-To: <20051216101808.GB3595@localhost.localdomain>
References: <20051208170348.GA28319@localhost.localdomain>
	 <b7bb36410512080934g7f941cfeo5c1ce6b163976abf@mail.gmail.com>
	 <20051208222414.GC3778@localhost.localdomain>
	 <439AEE68.3020704@gmx.net> <20051211200552.GB402049@kosh.hut.fi>
	 <43A1C056.8030805@gmx.net>
	 <20051215211942.GB3659@localhost.localdomain>
	 <43A1E91C.2060006@gmx.net>
	 <20051216101808.GB3595@localhost.localdomain>
Message-ID: <b7bb36410512190116h2d8b9636i4c3b832b2e9304fa@mail.gmail.com>

> By the way, this may be a stupid question, but how can I contact the
> authors of the vdr-dvd plugin?  It is not obvious from the SourceForge
> project page <http://sourceforge.net/projects/dvdplugin/>.  I did not find
> any active mailing list.  I see that there is some activity going on:
> the latest change in CVS is 3 months old.
>

I don't know if they've gone underground because all the other links
they have in the README except the sourceforge seem to be down. But
anyway there are a few e-mail addresses given that you can try, I
think. I don't want to list them here because of possible spam but
look at the README. There's for example the E-mail address of the
original author, Andreas Schultz.   Also the sf-admins seem to have
their sourceforge addresses given at the project page if you click
their names at the summary page.  If all else fails you could file a
bug report at the sf-page although I have a feeling that nobody ever
reads those anyway..

- Ari


From zdzisekg at yahoo.com  Mon Dec 19 18:11:02 2005
From: zdzisekg at yahoo.com (Zdzislaw Gorlicki)
Date: Mon, 19 Dec 2005 09:11:02 -0800 (PST)
Subject: [Softdevice-devel] softdevice & HDTV choppy/out-of-sync video/audio problem
In-Reply-To: <200512190849.49515.stefan@lucke.in-berlin.de>
Message-ID: <20051219171102.78508.qmail@web35407.mail.mud.yahoo.com>

Stefan Lucke <stefan at lucke.in-berlin.de> wrote:I think we have a bug here, depending on the ffmpeg version.
I modified quoted code to the following:

    if (pkt->pts != (int64_t) AV_NOPTS_VALUE) {
         lastPTS=pkt->pts;
         lastDuration=pkt->duration;

         if (lastDuration) {
#if LIBAVCODEC_BUILD > 4753
                 default_frametime=context->time_base.num*
                         10000/context->time_base.den;
fprintf(stderr, "tb num %d, tb den %d\n",context->time_base.num,context->time_base.den);
#else
                 default_frametime=lastDuration/100;
#endif
                 if (!default_frametime) {
                  /* ----------------------------------------------------------
                   * we should have another/better guess.
                   */
                  fprintf (stderr, " --- setting default frametime !! ---\n");
                  default_frametime = DEFAULT_FRAMETIME;
                 }
                 MPGDEB("Set default_frametime to %d\n",default_frametime);
         };
         fprintf (stderr, "default frame time:%d - %d\n",default_frametime,lastDuration);
    };

and got this on stderr (1st part is PAL live TV, 2nd is from Madagascar.avi DivX-HDTV 30fps):

default frame time:400 - 0
default frame time:400 - 0
device is of type: [11cSoftDevice]
Softdevice and device are of same types
Streams: 2
Input #0, avi, from 'test':
  Duration: 00:01:54.9, start: 0.000000, bitrate: 4200 kb/s
  Stream #0.0,   inf fps: Video: mpeg4, yuv420p, 1280x720
  Stream #0.1: Audio: mp3, 44100 Hz, stereo, 192 kb/s
tb num 1, tb den 30000
 --- setting default frametime !! ---
default frame time:400 - 1
tb num 1, tb den 30000
 --- setting default frametime !! ---
default frame time:400 - 1
#tb num 1, tb den 30000
 --- setting default frametime !! ---

my ffmpeg version is reported as:

[softdevice] initializing Plugin
[softdevice] Initializing Video Out
[softdevice] ffmpeg version(CVS) build(3277056)
[XvVideoOut]: displayAspect = 1,248175, displayRatio = 1,250000, PAR = 0,998540

-- 
Stefan Lucke

_______________________________________________
Softdevice-devel mailing list
Softdevice-devel at lists.berlios.de
http://lists.berlios.de/mailman/listinfo/softdevice-devel
Update:

After ugrading to DirectFB, DFB++, ffmpeg and softdevice all cvs as of
12-17-2005, some problems have been resolved. The HD channels that were
causing problems before are playing good now as well as the recordings. All
these channels are 1080i. However, there are some 720p channels on a different
sat, that are still experiencing the same exect problems as the 1080i did when I
originally reported.


__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/softdevice-devel/attachments/20051219/e94b3bbc/attachment.html>

From hm at seneca.muc.de  Wed Dec 28 07:23:59 2005
From: hm at seneca.muc.de (Harald Milz)
Date: Wed, 28 Dec 2005 07:23:59 +0100
Subject: [Softdevice-devel] MPEG4/H.264 w/ softdevice?
Message-ID: <20051228062359.GA3758@seneca.muc.de>

Hi,

I am still unsure about the current status of suftdevice / directfb on
VIA CN400 (Unichrome Pro) with regard to MPEG4/H.264. The VIA kernel and
Xorg drivers basically support MPEG4/H.264 but what about softdevice and
directfb? Can somebody please shed some light on this? 

And - would softdevice still support cropping when decoding the MPEG2/4
stream in hardware?

What software components do I need? 


-- 
Heaven, n.:
	A place where the wicked cease from troubling you with talk of
their personal affairs, and the good listen with attention while you
expound your own.
		-- Ambrose Bierce, "The Devil's Dictionary"


From Neumann at do-net.de  Wed Dec 28 08:33:12 2005
From: Neumann at do-net.de (Andre Neumann)
Date: Wed, 28 Dec 2005 08:33:12 +0100
Subject: [Softdevice-devel] MPEG4/H.264 w/ softdevice?
Message-ID: <FB3B5DB3197CEA429E5FB8E83D01D0390B0CB8@sbs2003.do-net.de>


From voitto.tuomainen at luukku.com  Fri Dec 30 10:13:42 2005
From: voitto.tuomainen at luukku.com (Voitto Tuomainen)
Date: Fri, 30 Dec 2005 11:13:42 +0200 (EET)
Subject: [Softdevice-devel] Softdevice osd flickers in pseudo mode with nvidia cards
Message-ID: <1135934022913.voitto.tuomainen.17497.tFhEa5W-AlRX7LHuv6pMJQ@luukku.com>

Hi,
I noticed the problem first when watching program, which had subtitles on it, from finnish channel 1 (one of the finnish channel that uses DVB texts). Every time when subtitle changes there is a notisable flicker (picture gets rapidly black and then back on with new subtitle).

If subtitle plugin is not installed, problem can be generated using pseudo osd mode. Software mode shows osd ok.

I have had this problem on now for about 2-3 week. I think it could have been occured after upgrading xog-x11 from 6.8.1 to 6.8.2.

I have played with nvidia Options in xorg.xonf, but nothing seems to makes difference (except Rotation).

I have another computer, which has Radeon 9600 graphics card and about the same software, but in that system this problem is not there.

I just upgraded my system from Sempron (32 bit) to Semprom 64 bit, but same effect is there on the new system.

My hardware is 
- AMD64 Sempron
  (old AMD Sempron)
- Palit Geforce 6200 TC, PCI-e
  (old Gainward 5200 FX, AGP)
- 2 x Technisat AirStar 2 

and software
- gentoo amd64 2005.1 + current updates
- kernel: gentoo-sources-2.6.14-r5
- nvidia-kernel & -glx 1.0.8178
-- same with older ones too
- xorg-x11-6.9.0
-- problems with 6.8.2 too
-- can't test with 6.8.1 now, because it's not available
   in gentoo system any more
- b2c2_flexcop_pci
- ffmpeg-0.4.9_p20051216
- vdr-1.3.37
-- same with 36
- newest softdevice from cvs
-- same with 0.2.1

Pictures from both modes is available in 
http://kotisivu.mtv3.fi/vtuomain/

There you can't see flickering...

I took here one session information, where I changed osd from software rendering to pseudo and back.

Here are some logs and configs:
/var/log/messages
-----------------
Dec 30 08:37:29 vdrmiu syslog-ng[10442]: syslog-ng version 1.6.8 starting
Dec 30 08:37:29 vdrmiu syslog-ng[10442]: Changing permissions on special file /dev/tty12
Dec 30 08:37:45 vdrmiu vdr[10477]: VDR version 1.3.37 started
Dec 30 08:37:45 vdrmiu vdr[10477]: loading plugin: ./PLUGINS/lib/libvdr-subtitles.so.1.3.37
Dec 30 08:37:45 vdrmiu vdr[10477]: loading plugin: ./PLUGINS/lib/libvdr-softdevice.so.1.3.37
Dec 30 08:37:45 vdrmiu vdr[10477]: loading plugin: ./PLUGINS/lib/libvdr-osdteletext.so.1.3.37
Dec 30 08:37:45 vdrmiu vdr[10477]: loading plugin: ./PLUGINS/lib/libvdr-femon.so.1.3.37
Dec 30 08:37:45 vdrmiu vdr[10477]: loading plugin: ./PLUGINS/lib/libvdr-dvd.so.1.3.37
Dec 30 08:37:45 vdrmiu vdr[10477]: loading plugin: ./PLUGINS/lib/libvdr-burn.so.1.3.37
Dec 30 08:37:45 vdrmiu vdr[10477]: loading plugin: ./PLUGINS/lib/libvdr-sysinfo.so.1.3.37
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/setup.conf
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/sources.conf
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/diseqc.conf
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/channels.conf
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/timers.conf
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/commands.conf
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/reccmds.conf
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/svdrphosts.conf
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/ca.conf
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/remote.conf
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/keymacros.conf
Dec 30 08:37:45 vdrmiu vdr[10477]: reading EPG data from /video/epg.data
Dec 30 08:37:45 vdrmiu vdr[10477]: video directory scanner thread started (pid=10477, tid=1082132832)
Dec 30 08:37:45 vdrmiu vdr[10477]: video directory scanner thread ended (pid=10477, tid=1082132832)
Dec 30 08:37:45 vdrmiu vdr[10477]: probing /dev/dvb/adapter0/frontend0
Dec 30 08:37:45 vdrmiu vdr[10477]: probing /dev/dvb/adapter1/frontend0
Dec 30 08:37:45 vdrmiu vdr[10477]: tuner on device 1 thread started (pid=10477, tid=1082132832)
Dec 30 08:37:45 vdrmiu vdr[10477]: section handler thread started (pid=10477, tid=1090525536)
Dec 30 08:37:45 vdrmiu vdr[10477]: tuner on device 2 thread started (pid=10477, tid=1098918240)
Dec 30 08:37:45 vdrmiu vdr[10477]: found 2 video devices
Dec 30 08:37:45 vdrmiu vdr[10477]: initializing plugin: subtitles (0.3.8): DVB subtitles decoder
Dec 30 08:37:45 vdrmiu vdr[10477]: initializing plugin: softdevice (0.2.1): A software emulated MPEG2 device
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: patch version (2005-11-06)
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: Initialize XShmCreateImage Successful (0x897090)
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: Initialize shmget Successful (1695744 bytes)
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: Initialize shmat Successful
Dec 30 08:37:45 vdrmiu vdr[10477]: [softdevice-xscreensaver]: xscreensaver not running
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: initialized OK
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: NV17 Video Texture: available ports 274 - 274
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: grabbed port 274
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: max area size 2046 x 2046
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: using area size 736 x 576
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]:   XV_SET_DEFAULTS           NOT-XvGettable     XvSettable (       0 [0x00000000] -        0 [0x00000000]) (       0 [0x00000000]
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]:   XV_ITURBT_709                 XvGettable     XvSettable (       0 [0x00000000] -        1 [0x00000001]) (       0 [0x00000000]
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]:   XV_SYNC_TO_VBLANK             XvGettable     XvSettable (       0 [0x00000000] -        1 [0x00000001]) (       1 [0x00000001]
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: XvShmCreateImage Successful (0x898240)
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: shmget Successful (847872 bytes)
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: shmat Successful
Dec 30 08:37:45 vdrmiu vdr[10477]: [XvVideoOut]: XShmAttach    rc = 1 (should be OK)
Dec 30 08:37:45 vdrmiu vdr[10477]: [softdevice] videoOut OK !
Dec 30 08:37:45 vdrmiu vdr[10477]: [softdevice-audio] Opening alsa device default
Dec 30 08:37:45 vdrmiu vdr[10477]: [softdevice-audio] Using alsa AC3 device spdif
Dec 30 08:37:45 vdrmiu vdr[10477]: section handler thread started (pid=10477, tid=1107310944)
Dec 30 08:37:45 vdrmiu vdr[10477]: Xv remote control thread started (pid=10477)
Dec 30 08:37:45 vdrmiu vdr[10477]: [softdevice-audio] Device opened! Ready to play
Dec 30 08:37:45 vdrmiu vdr[10477]: initializing plugin: osdteletext (0.5.1): Displays teletext on the OSD
Dec 30 08:37:45 vdrmiu vdr[10477]: initializing plugin: femon (0.9.2): DVB Signal Information Monitor (OSD)
Dec 30 08:37:45 vdrmiu vdr[10477]: initializing plugin: dvd (0.3.6-b03): turn VDR into an (almost) full featured DVD player
Dec 30 08:37:45 vdrmiu vdr[10477]: initializing plugin: burn (0.0.6j): Versatile convert-and-burn plugin
Dec 30 08:37:45 vdrmiu vdr[10477]: initializing plugin: sysinfo (0.0.4a): System information plugin
Dec 30 08:37:45 vdrmiu vdr[10477]: setting primary device to 3
Dec 30 08:37:45 vdrmiu vdr[10477]: SVDRP listening on port 2001
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/themes/sttng-default.theme
Dec 30 08:37:45 vdrmiu vdr[10477]: starting plugin: subtitles
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/plugins/subchannels.conf
Dec 30 08:37:45 vdrmiu vdr[10477]: starting plugin: softdevice
Dec 30 08:37:45 vdrmiu vdr[10477]: starting plugin: osdteletext
Dec 30 08:37:45 vdrmiu vdr[10477]: starting plugin: femon
Dec 30 08:37:45 vdrmiu vdr[10477]: starting plugin: dvd
Dec 30 08:37:45 vdrmiu vdr[10477]: starting plugin: burn
Dec 30 08:37:45 vdrmiu vdr[10477]: starting plugin: sysinfo
Dec 30 08:37:45 vdrmiu vdr[10477]: loading /video/themes/sttng-default.theme
Dec 30 08:37:45 vdrmiu lircd-0.7.2[7447]: accepted new client on /dev/lircd
Dec 30 08:37:45 vdrmiu vdr[10477]: remote control softdevice-xv - keys known
Dec 30 08:37:45 vdrmiu vdr[10477]: remote control LIRC - keys known
Dec 30 08:37:45 vdrmiu vdr[10477]: switching to channel 3
Dec 30 08:37:45 vdrmiu vdr[10477]: creating directory /vtx/T-8438-8193-49
Dec 30 08:37:45 vdrmiu vdr[10477]: LIRC remote control thread started (pid=10477, tid=1132489056)
Dec 30 08:37:45 vdrmiu vdr[10477]: transfer thread started (pid=10477, tid=1140881760)
Dec 30 08:37:45 vdrmiu vdr[10477]: receiver on device 1 thread started (pid=10477, tid=1149274464)
Dec 30 08:37:45 vdrmiu vdr[10477]: TS buffer on device 1 thread started (pid=10477, tid=1174452576)
Dec 30 08:37:45 vdrmiu vdr[10477]: timer 4 (1 1105-1252 'George Harrisonin muistokonsertti') set to event Pe  30.12.2005 11:05-12:45 'George Harrisonin muistokonsertti'
Dec 30 08:37:45 vdrmiu vdr[10477]: [VideoOut]: 736x576 [0,0 736x576] -> 768x576 [0,7 768x562]
Dec 30 08:37:45 vdrmiu vdr[10477]: [VideoOut]: 736x576 [0,0 736x576] -> 768x576 [0,7 768x562]
Dec 30 08:37:45 vdrmiu vdr[10477]: [VideoOut]: 736x576 [0,0 736x576] -> 768x576 [0,7 768x562]
Dec 30 08:37:46 vdrmiu vdr[10477]: setting audio track to 1 (0)
Dec 30 08:37:46 vdrmiu vdr[10477]: [VideoOut]: resolution changed: W(736 -> 720); H(576 ->576)
Dec 30 08:37:46 vdrmiu vdr[10477]: [VideoOut]: aspect changed (0 -> 0 ; 1.366667 -> 1.333333)
Dec 30 08:37:46 vdrmiu vdr[10477]: [VideoOut]: 720x576 [0,0 720x576] -> 768x576 [0,0 768x576]
Dec 30 08:37:46 vdrmiu vdr[10477]: [softdevice-audio] samplerate: 48000Hz, channels: #2
Dec 30 08:37:46 vdrmiu vdr[10477]: [softdevice-audio] Period size 1024 Buffer size 16384
Dec 30 08:37:46 vdrmiu vdr[10477]: [softdevice-audio] Hardware initialized
Dec 30 08:37:46 vdrmiu vdr[10477]: channel 10 (Nelonen Plus) event 08:00 'Mobiilipeli: Blockate' status 4
Dec 30 08:37:46 vdrmiu vdr[10477]: channel 3 (MTV3) event 08:25 'Ostoskanava' status 4
Dec 30 08:37:46 vdrmiu vdr[10477]: channel 4 (Nelonen) event 08:30 'Soittis' status 4
Dec 30 08:37:46 vdrmiu vdr[10477]: channel 7 (Subtv) event 06:00 'Sub chat' status 4
Dec 30 08:37:47 vdrmiu vdr[10477]: channel 9 (MTV3+) event 08:35 'Astronautti 3' status 4
Dec 30 08:37:48 vdrmiu vdr[10477]: [VideoOut]: 720x576 [0,0 720x576] -> 768x576 [0,0 768x576]
Dec 30 08:37:48 vdrmiu vdr[10477]: [VideoOut]: 720x576 [0,0 720x576] -> 768x576 [0,0 768x576]
Dec 30 08:37:50 vdrmiu vdr[10477]: assuming manual start of VDR
Dec 30 08:38:02 vdrmiu vdr[10477]: switching to channel 1
Dec 30 08:38:02 vdrmiu vdr[10477]: transfer thread ended (pid=10477, tid=1140881760)
Dec 30 08:38:02 vdrmiu vdr[10477]: buffer stats: 64296 (3%) used
Dec 30 08:38:02 vdrmiu vdr[10477]: buffer stats: 0 (0%) used
Dec 30 08:38:02 vdrmiu vdr[10477]: transfer thread started (pid=10477, tid=1166059872)
Dec 30 08:38:02 vdrmiu vdr[10477]: buffer stats: 0 (0%) used
Dec 30 08:38:02 vdrmiu vdr[10477]: creating directory /vtx/T-8438-4097-17
Dec 30 08:38:03 vdrmiu vdr[10477]: channel 30 (YLE X3M) event 06:00 'Anne och A-laget.' status 4
Dec 30 08:38:03 vdrmiu vdr[10477]: channel 17 (YLE PEILI) event 08:00 'Aamun peili ja Ykk?saamu' status 4
Dec 30 08:38:03 vdrmiu vdr[10477]: channel 1 (YLE TV1) event 08:05 'Kiehtova maailma: Halki Himalajan' status 4
Dec 30 08:38:03 vdrmiu vdr[10477]: [VideoOut]: resolution changed: W(720 -> 704); H(576 ->576)
Dec 30 08:38:03 vdrmiu vdr[10477]: [VideoOut]: aspect changed (0 -> 8 ; 1.333333 -> 1.777778)
Dec 30 08:38:03 vdrmiu vdr[10477]: [VideoOut]: 704x576 [0,0 704x576] -> 768x576 [0,72 768x432]
Dec 30 08:38:03 vdrmiu vdr[10477]: channel 15 (YLEQ) event 06:32 'Aamu Kuussa. Markus Turunen. www.yleq.fi' status 4
Dec 30 08:38:03 vdrmiu vdr[10477]: setting audio track to 1 (0)
Dec 30 08:38:03 vdrmiu vdr[10477]: channel 2 (YLE TV2) event 08:30 'TV2: Lasten joulu' status 4
Dec 30 08:38:03 vdrmiu vdr[10477]: channel 18 (YLEN KLASSINEN) event 06:00 'Aamuklassinen.' status 4
Dec 30 08:38:03 vdrmiu vdr[10477]: [softdevice-audio]: xrun
Dec 30 08:38:03 vdrmiu vdr[10477]: channel 12 (YLE FST) event 04:00 'Ei esityst?' status 4
Dec 30 08:38:03 vdrmiu vdr[10477]: channel 13 (YLE FSR+) event 07:00 'Nyhetsmorgon' status 4
Dec 30 08:38:03 vdrmiu vdr[10477]: channel 6 (YLE24) event 08:10 'Ei esityst?' status 4
Dec 30 08:38:03 vdrmiu vdr[10477]: channel 29 (YLEMONDO) event 08:30 'RFI.' status 4
Dec 30 08:38:03 vdrmiu vdr[10477]: channel 5 (YLE Teema) event 04:00 'Ei esityst?' status 4
Dec 30 08:38:07 vdrmiu vdr[10477]: no translation found for 'SysInfo' in language 8 (suomi)
Dec 30 08:38:28 vdrmiu vdr[10477]: confirm: Sulje vdr ?
Dec 30 08:38:28 vdrmiu vdr[10477]: warning: Sulje vdr ?
Dec 30 08:38:30 vdrmiu vdr[10477]: confirmed
Dec 30 08:38:30 vdrmiu vdr[10477]: executing command '/usr/local/bin/sulje_vdr.sh 2>&1'
Dec 30 08:38:30 vdrmiu lircd-0.7.2[7447]: removed client


/etc/X11/xorg.conf
------------------
Section "ServerLayout"
	Identifier     "Layout0"
	Screen      0  "Screen0" 0 0
	InputDevice    "Keyboard0" "CoreKeyboard"
	InputDevice    "Mouse0" "CorePointer"
	#Option "RandR" "false"
EndSection

Section "Files"
        RgbPath      "/usr/lib64/X11/rgb"
        ModulePath   "/usr/lib64/modules"
        FontPath     "/usr/share/fonts/misc/"
        FontPath     "/usr/share/fonts/TTF/"
        FontPath     "/usr/share/fonts/Type1/"
        FontPath     "/usr/share/fonts/CID/"
        FontPath     "/usr/share/fonts/75dpi/"
        FontPath     "/usr/share/fonts/100dpi/"
EndSection

Section "ServerFlags"
	Option      "blank time"    "0"    
EndSection

Section "Module"
        Load  "glx"
#        Load  "dri"
        Load  "xtrap"
        Load  "extmod"
        Load  "dbe"
        Load  "record"
        Load  "freetype"
        Load  "type1"
EndSection

Section "InputDevice"
	Identifier  "Mouse0"
	Driver      "mouse"
	Option	    "Protocol" "Auto"
	Option      "ZAxisMapping"   "4 5 6 7"
	Option	    "Device" "/dev/input/mice"
EndSection

Section "InputDevice"
	Identifier  "Keyboard0"
	Driver      "kbd"
	Option	    "XkbModel" "pc105"
	Option	    "XkbLayout" "fi"
EndSection

Section "Monitor"
	Identifier   "Monitor0"
	HorizSync    31.5 - 48.5
	VertRefresh  50.0 - 70.0
EndSection

Section "Monitor"
  Identifier   "TV"
  VendorName   "Toshiba"
  Modelname    "foobar"
	ModeLine "720x576 at 50i" 13.875 720 744 808 888 576 581 586 625 -hsync -vsync interlace DisplaySize  400 225
	Modeline "768x576 at 50i" 14.766 768 768 840 944 576 576 580 624 interlace -csync
	HorizSync    15.625
        VertRefresh  50
EndSection

Section "Device"
	Identifier  "Card1"
	Driver      "nvidia"
        VendorName  "nVidia Corporation"
        BoardName   "GeForce 6200 TurboCache(TM)"
        BusID       "PCI:5:0:0"

        Option     "NoLogo" "true"                   # [<bool>]
        Option     "NvAGP" "0"                     # <i>
        Option     "IgnoreEDID" "true"               # [<bool>]
        Option     "RenderAccel" "true"              # [<bool>]
        Option     "MultisampleCompatibility"  "true"
        Option     "RandRRotation" "false"
EndSection

Section "Screen"
	Identifier "Screen0"
	Device     "Card1"
	Monitor    "TV"
	DefaultDepth     24
	SubSection "Display"
		Viewport   0 0
		Depth     24
		Modes    "768x576 at 50i" "720x576 at 50i"
	EndSubSection
EndSection

vdr-start
---------
cd /usr/local/vdr/vdr-1.3.37
./vdr \
--lirc=/dev/lircd \
-Psubtitles \
-P'softdevice -vo xv:full' \
-Posdteletext \
-Pfemon \
-Pdvd \
-Pburn \
-Psysinfo \
-s /usr/local/bin/vdrshutdown > /dev/null 2>&1

______
BR, Voitto Tuomainen

...................................................................
Luukku Plus paketilla p??set eroon tila- ja turvallisuusongelmista.
Hanki Luukku Plus ja helpotat el?m??si. http://www.mtv3.fi/luukku

From gdh at acentral.co.uk  Fri Dec 30 20:42:25 2005
From: gdh at acentral.co.uk (Gavin Hamill)
Date: Fri, 30 Dec 2005 19:42:25 +0000
Subject: [Softdevice-devel] ffmpeg versions with softdevice 0.2.1
Message-ID: <1135971746.4940.17.camel@localhost.localdomain>

Hi :) I'm having identical problems to

http://www.linuxtv.org/pipermail/vdr/2005-November/006152.html

but I don't understand how there could be a version mismatch - I'm using
Ubuntu Breezy and if I rebuild the deb packages omitting the 1394
support, the runtime error changes to 

# ./vdr -Psoftdevice
vdr: ./PLUGINS/lib/libvdr-softdevice.so.1.3.37: undefined symbol:
vorbis_encode_init_vbr

I don't want to recompile again omitting vorbis support, and I can only
assume it'll move the problem a little further down the line, cf.
http://lists.puredata.info/pipermail/gem-dev/2005-02/000839.html

I don't have any other ffmpeg installations on the system in /usr/local
or anywhere else (confirmed with updatedb && locate avcodec.h - the only
one is in /usr/include/ffmpeg/avcodec.h, which is where I've pointed
FFMPEGCFLAGS)

Any ideas would be warmly welcomed! :)

For reference, 
ldd ./PLUGINS/lib/libvdr-softdevice.so.1.3.37
        linux-gate.so.1 =>  (0xffffe000)
        libz.so.1 => /usr/lib/libz.so.1 (0xb7c1b000)
        libdl.so.2 => /lib/tls/i686/cmov/libdl.so.2 (0xb7c18000)
        libvorbis.so.0 => /usr/lib/libvorbis.so.0 (0xb7bf1000)
        libtheora.so.0 => /usr/lib/libtheora.so.0 (0xb7bd3000)
        libogg.so.0 => /usr/lib/libogg.so.0 (0xb7bcd000)
        libasound.so.2 => /usr/lib/libasound.so.2 (0xb7b1a000)
        libstdc++.so.6 => /usr/lib/libstdc++.so.6 (0xb7a31000)
        libm.so.6 => /lib/tls/i686/cmov/libm.so.6 (0xb7a0f000)
        libgcc_s.so.1 => /lib/libgcc_s.so.1 (0xb7a04000)
        libc.so.6 => /lib/tls/i686/cmov/libc.so.6 (0xb78d6000)
        /lib/ld-linux.so.2 (0x80000000)
        libpthread.so.0 => /lib/tls/i686/cmov/libpthread.so.0
(0xb78c3000)

and if I 'strace ./vdr -Psoftdevice' I can see each of these libraries
being opened successfully - the last few lines are:

open("/usr/lib/libtheora.so.0", O_RDONLY) = 4
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\360\245"...,
512) = 512
fstat64(4, {st_mode=S_IFREG|0644, st_size=124816, ...}) = 0
old_mmap(0x4c808000, 122400, PROT_READ|PROT_EXEC, MAP_PRIVATE|
MAP_DENYWRITE, 4, 0) = 0x4c808000
old_mmap(0x4c825000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|
MAP_DENYWRITE, 4, 0x1d000) = 0x4c825000
close(4)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or
directory)
open("/usr/lib/libogg.so.0", O_RDONLY)  = 4
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\220\244"...,
512) = 512
fstat64(4, {st_mode=S_IFREG|0644, st_size=17512, ...}) = 0
old_mmap(0x4db69000, 19316, PROT_READ|PROT_EXEC, MAP_PRIVATE|
MAP_DENYWRITE, 4, 0) = 0x4db69000
old_mmap(0x4db6d000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|
MAP_DENYWRITE, 4, 0x3000) = 0x4db6d000
close(4)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or
directory)
open("/usr/lib/libasound.so.2", O_RDONLY) = 4
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\260\241"...,
512) = 512
fstat64(4, {st_mode=S_IFREG|0644, st_size=731428, ...}) = 0
old_mmap(0x4da8b000, 731916, PROT_READ|PROT_EXEC, MAP_PRIVATE|
MAP_DENYWRITE, 4, 0) = 0x4da8b000
old_mmap(0x4db30000, 57344, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|
MAP_DENYWRITE, 4, 0xa4000) = 0x4db30000
close(4)                                = 0
mprotect(0xb7aa9000, 3362816, PROT_READ|PROT_WRITE) = 0
munmap(0xb7fae000, 83848)               = 0
munmap(0xb7aa9000, 3792356)             = 0
munmap(0x4c137000, 80164)               = 0
munmap(0x4db40000, 158804)              = 0
munmap(0x4c808000, 122400)              = 0
munmap(0x4db69000, 19316)               = 0
munmap(0x4da8b000, 731916)              = 0
time([1135971434])                      = 1135971434
stat64("/etc/localtime", {st_mode=S_IFREG|0644, st_size=1323, ...}) = 0
stat64("/etc/localtime", {st_mode=S_IFREG|0644, st_size=1323, ...}) = 0
stat64("/etc/localtime", {st_mode=S_IFREG|0644, st_size=1323, ...}) = 0
send(3, "<11>Dec 30 19:37:14 vdr[23215]: "..., 122, MSG_NOSIGNAL) = 122
write(2, "vdr: ./PLUGINS/lib/libvdr-softde"...,
89vdr: ./PLUGINS/lib/libvdr-softdevice.so.1.3.37: undefined symbol:
vorbis_encode_init_vbr
) = 89
time([1135971434])                      = 1135971434
stat64("/etc/localtime", {st_mode=S_IFREG|0644, st_size=1323, ...}) = 0
stat64("/etc/localtime", {st_mode=S_IFREG|0644, st_size=1323, ...}) = 0
stat64("/etc/localtime", {st_mode=S_IFREG|0644, st_size=1323, ...}) = 0
send(3, "<14>Dec 30 19:37:14 vdr[23215]: "..., 39, MSG_NOSIGNAL) = 39
close(3)                                = 0
ioctl(0, SNDCTL_TMR_TIMEBASE or TCGETS, {B38400 opost isig icanon
echo ...}) = 0
ioctl(0, SNDCTL_TMR_START or TCSETS, {B38400 opost isig icanon
echo ...}) = 0
ioctl(0, SNDCTL_TMR_TIMEBASE or TCGETS, {B38400 opost isig icanon
echo ...}) = 0
exit_group(2)                           = ?

Cheers,
Gavin.




From gdh at acentral.co.uk  Sat Dec 31 00:47:09 2005
From: gdh at acentral.co.uk (Gavin Hamill)
Date: Fri, 30 Dec 2005 23:47:09 +0000
Subject: [Softdevice-devel] ffmpeg versions with softdevice 0.2.1
In-Reply-To: <1135971746.4940.17.camel@localhost.localdomain>
References: <1135971746.4940.17.camel@localhost.localdomain>
Message-ID: <1135986433.8965.2.camel@localhost.localdomain>

On Fri, 2005-12-30 at 19:42 +0000, Gavin Hamill wrote:
> Hi :) I'm having identical problems to

Gah :/

I fixed it just by using the ffmpeg + libavcodeccvs-dev packages from
Christian Marillat's Debian repos at ftp://nerim.net - recompiled
softdevice, ran and all is perfect.

And I thought the Ubuntu-compiled ones would be solid and reliable :/

gdh




