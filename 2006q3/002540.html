<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Softdevice-devel] Hang after suspending MPEG stream for a long time
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/softdevice-devel/2006q3/index.html" >
   <LINK REL="made" HREF="mailto:softdevice-devel%40lists.berlios.de?Subject=Re%3A%20%5BSoftdevice-devel%5D%20Hang%20after%20suspending%20MPEG%20stream%20for%20a%20long%0A%20time&In-Reply-To=%3C45199409.7090004%40gmx.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002539.html">
   <LINK REL="Next"  HREF="002541.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Softdevice-devel] Hang after suspending MPEG stream for a long time</H1>
    <B>Martin Wache</B> 
    <A HREF="mailto:softdevice-devel%40lists.berlios.de?Subject=Re%3A%20%5BSoftdevice-devel%5D%20Hang%20after%20suspending%20MPEG%20stream%20for%20a%20long%0A%20time&In-Reply-To=%3C45199409.7090004%40gmx.net%3E"
       TITLE="[Softdevice-devel] Hang after suspending MPEG stream for a long time">M.Wache at gmx.net
       </A><BR>
    <I>Tue Sep 26 22:56:41 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002539.html">[Softdevice-devel] Hang after suspending MPEG stream for a long	time
</A></li>
        <LI>Next message: <A HREF="002541.html">[Softdevice-devel] Hang after suspending MPEG stream for a long	time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2540">[ date ]</a>
              <a href="thread.html#2540">[ thread ]</a>
              <a href="subject.html#2540">[ subject ]</a>
              <a href="author.html#2540">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Marko M&#228;kel&#228; schrieb:
&gt;<i> I got another hang today.  I don't know the circumstances, since I was not
</I>&gt;<i> there when the hang occurred.  But I think it was caused by a decoding
</I>&gt;<i> error or by suspending and resuming vdr (using my patch), as the log
</I>&gt;<i> ended with this:
</I>&gt;<i> 
</I>&gt;<i> [dfb] (re)configured 0x00200806
</I>&gt;<i> [dfb] (re)configuring Videolayer to 720 x 576 (720x576)
</I>&gt;<i> [dfb] creating new surface (stretchBlit)
</I>&gt;<i> [surface capabilities] videoSurface: videoonly interlaced PixelFormat = 0x00200806
</I>&gt;<i> [dfb] (re)configured 0x00200806
</I>&gt;<i> [dfb] (re)configuring Videolayer to 704 x 576 (704x576)
</I>&gt;<i> [dfb] creating new surface (stretchBlit)
</I>&gt;<i> [surface capabilities] videoSurface: videoonly interlaced PixelFormat = 0x00200806
</I>&gt;<i> [dfb] (re)configured 0x00200806
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 17 20
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]00 motion_type at 4 18
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]invalid mb type in P Frame at 13 19
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]00 motion_type at 1 20
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]00 motion_type at 5 21
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 3 22
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]invalid cbp at 25 23
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]00 motion_type at 7 24
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]00 motion_type at 3 25
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]00 motion_type at 1 26
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]00 motion_type at 1 27
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]00 motion_type at 14 29
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 29
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 30
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 31
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 32
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 33
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 34
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 35
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]Warning MVs not available
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]concealing 792 DC, 792 AC, 792 MV errors
</I>&gt;<i> +++[mpeg2video @ 0xa7af58a8]ac-tex damaged at 39 15
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 1 15
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 16
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]invalid mb type in I Frame at 0 17
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 18
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 19
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 20
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 21
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]invalid mb type in I Frame at 0 22
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]skipped MB in I frame at 1 23
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 24
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 25
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 26
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 27
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 1 28
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 29
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 30
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 31
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 32
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 33
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 34
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]ac-tex damaged at 0 35
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]Warning MVs not available
</I>&gt;<i> [mpeg2video @ 0xa7af58a8]concealing 924 DC, 924 AC, 924 MV errors
</I>&gt;<i> *hang*
</I>&gt;<i> 
</I>&gt;<i> By the way, it could be useful to have timestamps in the log entries,
</I>&gt;<i> or to log via syslog.
</I>&gt;<i> 
</I>&gt;<i> Attached are the full stack traces of the two running vdr processes.
</I>&gt;<i> 
</I>The gdb-637 stack trace looks perfectly normal. The video decoder thread
waits for displaying a picture, the audio decoder thread is in some alsa
routine waiting to put more sound data into the alsa buffer.
That means both audio and video data are available, which means that
both threads are running. If one of them would have been deadlocked, the
other one would continue to consume data until the buffers are full
because the other thread doesn't consume any data. Then the not locked
thread would have starved... But maybe that argumentation is wrong.
Sorry I didn't get new ideas from that backtrace...

The other backtrace is a vdr which is stuck somewhere during the
initialization, probably because the it could not open the alsa device.
The only strange thing is why it didn't die... Maybe there is something
wrong with alsa or the softdevice -&gt; alsa communication?

&gt;<i> Software:
</I>&gt;<i> 
</I>&gt;<i> vdr 1.4.2
</I>&gt;<i> ffmpeg CVS from months ago
</I>&gt;<i> DirectFB CVS from weeks ago
</I>&gt;<i> softdevice CVS from 2006-09-22, plus dfb-blbar-clear-03.patch and the
</I>I assume this contains the fixes by Stefan on 09-22? And the
dfb-blbar-clear-03.patch is the one without osdMutex, okay.

Laz, how do you suspend your vdr? Do you use Marko's patch or the
softdevice suspend method?

Bye,
Martin

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002539.html">[Softdevice-devel] Hang after suspending MPEG stream for a long	time
</A></li>
	<LI>Next message: <A HREF="002541.html">[Softdevice-devel] Hang after suspending MPEG stream for a long	time
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2540">[ date ]</a>
              <a href="thread.html#2540">[ thread ]</a>
              <a href="subject.html#2540">[ subject ]</a>
              <a href="author.html#2540">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/softdevice-devel">More information about the Softdevice-devel
mailing list</a><br>
</body></html>
